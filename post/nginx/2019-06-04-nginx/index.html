<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="nginxÊúçÂä° - https://hobocat.github.io/post/nginx/2019-06-04-nginx/">
    <meta name="author" content="Jack - https://hobocat.github.io/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>nginxÊúçÂä°</title>
    
    <base target="_blank">
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    
    
    
    
    <link rel="stylesheet" href="https://hobocat.github.io/style.min.94e7ed14b48117025ebd1148adc11f7268f1ebf50d97297ac663edf1aa6f52dc.css">
    
    <script>const DARK =  false ;</script>
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div class="container-floating-box">
	<div class="box box1"></div>
	<div class="box box11"></div>
	<div class="box box12"></div>
	<div class="box box2"></div>
	<div class="box box3"></div>
	<div class="box box4"></div>
	<div class="box box5"></div>
	<div class="box box6"></div>
	<div class="box box7"></div>
	<div class="box box8"></div>
	<div class="box box9"></div>
</div>
        <div class="cool-before" style="background: url('/imgs/bg/wallhaven-6qr21l.jpg') left top/100% no-repeat fixed;"></div>
        <div id="header" class=""><div class="container-header">

    
    
    
    <div class="right">
        
        <h1 class="title">nginxÊúçÂä°</h1>
    
        
        
            <div id="toc">üìú</div>
        
    </div>
</div>
</div>
        <div id="content">










<div class="container-main container-page ">

    

    
    
    
    <div class="rel">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </div>
    
    

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="7409" width="12" height="12">
                <path
                    d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z"
                    p-id="7410" fill="#adb5bd"></path>
            </svg>
            2019-06-04&nbsp;&nbsp;&nbsp;
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="23838" width="11" height="11">
                <path
                    d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z"
                    p-id="23839" fill="#adb5bd"></path>
            </svg>
            2024-05-15&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="33866" width="12" height="12">
                <path
                    d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z"
                    fill="#adb5bd" p-id="33867"></path>
                <path
                    d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z"
                    fill="#adb5bd" p-id="33868"></path>
            </svg>
            11993 Â≠ó</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="32892" width="12" height="12">
                <path
                    d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z"
                    p-id="32893" fill="#adb5bd"></path>
                <path
                    d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z"
                    p-id="32894" fill="#adb5bd"></path>
            </svg>
            24 ÂàÜÈíü</span>
        <div class="container-ctgtag">
	<div class="taxonomy">
		<div class="tag">
			
			
			<a href="/tags/nginx">nginx</a>
			
		</div>
	</div>
</div>
        
    </div>

    <div class="toc">
        <div class="container-page-operation">
	<div class="page-operation">
		<div><a href="/"><img src="/imgs/icons/home-2.svg" alt=""></a></div>
		<div><a href="/nav"><img src="/imgs/icons/iov-navigate-1.svg" alt=""></a></div>
		<div><a href="/wiki"><img src="/imgs/icons/wiki.svg" alt=""></a></div>
		<div><a href="/tags"><img src="/imgs/icons/treetags.svg" alt=""></a></div>
		<div id="light-dark"><a><img src="/imgs/icons/moon2.svg" alt=""></a></div>
		<div><a href="#"><img src="/imgs/icons/up2.svg" alt=""></a></div>
	</div>
</div>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#‰∏ÄnginxÊ¶ÇËø∞">‰∏Ä„ÄÅNginxÊ¶ÇËø∞</a>
      <ul>
        <li><a href="#ÁÆÄ‰ªã">ÁÆÄ‰ªã</a></li>
        <li><a href="#yumÂÆâË£Önginx">YUMÂÆâË£ÖNginx</a></li>
        <li><a href="#nginxÊ∫êÁ†ÅÂÆâË£Ö">NginxÊ∫êÁ†ÅÂÆâË£Ö</a></li>
        <li><a href="#ÂÆâË£ÖÁºñËØëÂèÇÊï∞">ÂÆâË£ÖÁºñËØëÂèÇÊï∞</a></li>
      </ul>
    </li>
    <li><a href="#‰∫ånginxÂü∫Êú¨ÂëΩ‰ª§">‰∫å„ÄÅNginxÂü∫Êú¨ÂëΩ‰ª§</a></li>
    <li><a href="#‰∏âÁÆÄÂçïÈÖçÁΩÆ">‰∏â„ÄÅÁÆÄÂçïÈÖçÁΩÆ</a>
      <ul>
        <li><a href="#ÈÖçÁΩÆÊñá‰ª∂‰ΩçÁΩÆ">ÈÖçÁΩÆÊñá‰ª∂‰ΩçÁΩÆ</a></li>
        <li><a href="#nginxconfÈÖçÁΩÆ">nginx.confÈÖçÁΩÆ</a></li>
        <li><a href="#nginxÈÖçÁΩÆÁªìÊûÑ">NginxÈÖçÁΩÆÁªìÊûÑ</a></li>
        <li><a href="#nginxÊó•ÂøóÊ†ºÂºè">NginxÊó•ÂøóÊ†ºÂºè</a></li>
      </ul>
    </li>
    <li><a href="#ÂõõÂÆòÊñπÊ®°Âùó">Âõõ„ÄÅÂÆòÊñπÊ®°Âùó</a>
      <ul>
        <li><a href="#http_stub_status_module">http_stub_status_module</a></li>
        <li><a href="#http_random_index_module">http_random_index_module</a></li>
        <li><a href="#http_sub_module">http_sub_module</a></li>
        <li><a href="#http_limit_conn_module">http_limit_conn_module</a></li>
        <li><a href="#http_limit_req_module">http_limit_req_module</a></li>
        <li><a href="#http_access_module">http_access_module</a></li>
        <li><a href="#http_auth_basic_module">http_auth_basic_module</a></li>
        <li><a href="#http_secure_link_module">http_secure_link_module</a></li>
        <li><a href="#http_geoip2_module">http_geoip2_module</a></li>
      </ul>
    </li>
    <li><a href="#‰∫înginxÊúçÂä°">‰∫î„ÄÅNginxÊúçÂä°</a>
      <ul>
        <li><a href="#nginx‰Ωú‰∏∫ÈùôÊÄÅwebÊúçÂä°">Nginx‰Ωú‰∏∫ÈùôÊÄÅwebÊúçÂä°</a></li>
        <li><a href="#nginx‰Ωú‰∏∫‰ª£ÁêÜÊúçÂä°">Nginx‰Ωú‰∏∫‰ª£ÁêÜÊúçÂä°</a></li>
        <li><a href="#nginx‰Ωú‰∏∫Ë¥üËΩΩÂùáË°°ÊúçÂä°">Nginx‰Ωú‰∏∫Ë¥üËΩΩÂùáË°°ÊúçÂä°</a></li>
        <li><a href="#nginx‰Ωú‰∏∫ÁºìÂ≠òÊúçÂä°">Nginx‰Ωú‰∏∫ÁºìÂ≠òÊúçÂä°</a></li>
      </ul>
    </li>
    <li><a href="#ÂÖ≠Âä®ÈùôÂàÜÁ¶ª">ÂÖ≠„ÄÅÂä®ÈùôÂàÜÁ¶ª</a></li>
    <li><a href="#‰∏ÉrewriteËßÑÂàô">‰∏É„ÄÅrewriteËßÑÂàô</a></li>
    <li><a href="#ÂÖ´https">ÂÖ´„ÄÅHttps</a>
      <ul>
        <li><a href="#ÂØπÁß∞Âä†ÂØÜÂéüÁêÜ">ÂØπÁß∞Âä†ÂØÜÂéüÁêÜ</a></li>
        <li><a href="#ÈùûÂØπÁß∞Âä†ÂØÜÂéüÁêÜ">ÈùûÂØπÁß∞Âä†ÂØÜÂéüÁêÜ</a></li>
        <li><a href="#httpsÂä†ÂØÜÂéüÁêÜ">HttpsÂä†ÂØÜÂéüÁêÜ</a></li>
        <li><a href="#Ëá™Âª∫caËØÅ‰π¶ÁîüÊàêÈùûÂèó‰ø°Êú∫ÊûÑÈ¢ÅÂèë">Ëá™Âª∫CAËØÅ‰π¶ÁîüÊàêÔºàÈùûÂèó‰ø°Êú∫ÊûÑÈ¢ÅÂèëÔºâ</a></li>
        <li><a href="#ÈÖçÁΩÆÂ∫îÁî®">ÈÖçÁΩÆÂ∫îÁî®</a></li>
      </ul>
    </li>
    <li><a href="#‰πùnginx‰∏éluaÂºÄÂèë">‰πù„ÄÅNginx‰∏éLuaÂºÄÂèë</a>
      <ul>
        <li><a href="#Ê∫êÁ†ÅÂÆâË£ÖÊ≠•È™§">Ê∫êÁ†ÅÂÆâË£ÖÊ≠•È™§</a></li>
        <li><a href="#nginxË∞ÉÁî®luaÊ®°ÂùóÊåá‰ª§È°∫Â∫è">NginxË∞ÉÁî®LuaÊ®°ÂùóÊåá‰ª§È°∫Â∫è</a></li>
        <li><a href="#nginx-lua-api">Nginx Lua API</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅÂ∏∏ËßÅÈóÆÈ¢ò">ÂçÅ„ÄÅÂ∏∏ËßÅÈóÆÈ¢ò</a>
      <ul>
        <li><a href="#server_nameÂ§öËôöÊãü‰∏ªÊú∫‰ºòÂÖàÁ∫ßËÆøÈóÆ">server_nameÂ§öËôöÊãü‰∏ªÊú∫‰ºòÂÖàÁ∫ßËÆøÈóÆ</a></li>
        <li><a href="#locationÂåπÈÖç‰ºòÂÖàÁ∫ß">LocationÂåπÈÖç‰ºòÂÖàÁ∫ß</a></li>
        <li><a href="#try_filesÁöÑ‰ΩøÁî®">try_filesÁöÑ‰ΩøÁî®</a></li>
        <li><a href="#aliasÂíårootÂå∫Âà´">aliasÂíårootÂå∫Âà´</a></li>
        <li><a href="#Â¶Ç‰ΩïËé∑ÂèñÁî®Êà∑ÁöÑÁúüÂÆûip">Â¶Ç‰ΩïËé∑ÂèñÁî®Êà∑ÁöÑÁúüÂÆûIP</a></li>
        <li><a href="#Â∏∏ËßÅÈîôËØØÁ†Å">Â∏∏ËßÅÈîôËØØÁ†Å</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅ‰∏ÄnginxÊÄßËÉΩ‰ºòÂåñ">ÂçÅ‰∏Ä„ÄÅNginxÊÄßËÉΩ‰ºòÂåñ</a>
      <ul>
        <li><a href="#Êñá‰ª∂Âè•ÊüÑËÆæÁΩÆ">Êñá‰ª∂Âè•ÊüÑËÆæÁΩÆ</a></li>
        <li><a href="#cpu‰∫≤Âíå">CPU‰∫≤Âíå</a></li>
        <li><a href="#ÈÄöÁî®ÈÖçÁΩÆ‰ºòÂåñ">ÈÄöÁî®ÈÖçÁΩÆ‰ºòÂåñ</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅ‰∫ånginx_luaÈò≤ÁÅ´Â¢ô">ÂçÅ‰∫å„ÄÅNginx_LuaÈò≤ÁÅ´Â¢ô</a></li>
    <li><a href="#ÈôÑÂΩï">ÈôÑÂΩï</a>
      <ul>
        <li><a href="#curlÂëΩ‰ª§">curlÂëΩ‰ª§</a></li>
        <li><a href="#abÂëΩ‰ª§">abÂëΩ‰ª§</a></li>
        <li><a href="#gzipÂëΩ‰ª§">gzipÂëΩ‰ª§</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div class='content  '>
        <h2 id="‰∏ÄnginxÊ¶ÇËø∞">‰∏Ä„ÄÅNginxÊ¶ÇËø∞</h2>
<h3 id="ÁÆÄ‰ªã">ÁÆÄ‰ªã</h3>
<p>‚Äã	NginxÊòØ‰∏Ä‰∏™ÂºÄÊ∫ê‰∏îÈ´òÊïà„ÄÅÂèØÈù†ÁöÑHTTP‰∏≠Èó¥‰ª∂„ÄÅ‰ª£ÁêÜÊúçÂä°„ÄÇ</p>
<p><strong>nginx‰ºòÂäøÔºö</strong></p>
<ul>
<li>IOÂ§öË∑ØÂ§çÁî®ÁöÑepoll</li>
<li>ËΩªÈáèÁ∫ß„ÄêÂäüËÉΩÊ®°ÂùóÂ∞ë„ÄÅ‰ª£Á†ÅÊ®°ÂùóÂåñ„Äë</li>
<li>CPU‰∫≤Âíå„ÄêÂ∞Ü‰∏Ä‰∏™ËøõÁ®ã&quot;ÁªëÂÆö&quot; Âà∞‰∏Ä‰∏™Êàñ‰∏ÄÁªÑCPU‰∏äÔºåÈÅøÂÖçCacahe Miss„Äë</li>
<li>Â§ÑÁêÜÊñá‰ª∂ÈááÁî®SendFileÊñπÂºè„ÄêmmapÁ≥ªÁªüË∞ÉÁî®„Äë</li>
</ul>
<p><strong>nginxÁâàÊú¨ÈÄâÊã©</strong></p>
<ul>
<li>Mainline Version		ÂºÄÂèëÁâà</li>
<li>Stable Version			Á®≥ÂÆöÁâà</li>
<li>Legacy Version			ÂéÜÂè≤ÁâàÊú¨</li>
</ul>
<h3 id="yumÂÆâË£Önginx">YUMÂÆâË£ÖNginx</h3>
<p><strong>Á¨¨‰∏ÄÊ≠•ÔºöÂÆâË£ÖÂâçÂáÜÂ§á</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂÆâË£ÖnginxÂøÖË¶ÅÂ∫ì</span>
</span></span><span style="display:flex;"><span>yum -y install gcc-c++ gcc autoconf pcre-devel make automake
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂÆâË£ÖÂèØÈÄâÂëΩ‰ª§Â∑•ÂÖ∑</span>
</span></span><span style="display:flex;"><span>yum -y install wget httpd-tools
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂÆòÊñπË¶ÅÊ±ÇÊâßË°å</span>
</span></span><span style="display:flex;"><span>sudo yum install yum-utils
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∫åÊ≠•Ôºö‰øÆÊîπ<code>/etc/yum.repos.d/nginx.repo</code></strong></p>
<pre tabindex="0"><code class="language-repo" data-lang="repo">[nginx-stable]
name=nginx stable repo
baseurl=http://nginx.org/packages/centos/$releasever/$basearch/
gpgcheck=1
enabled=1
gpgkey=https://nginx.org/keys/nginx_signing.key

[nginx-mainline]
name=nginx mainline repo
baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/
gpgcheck=1
enabled=0
gpgkey=https://nginx.org/keys/nginx_signing.key
</code></pre><p><strong>Á¨¨‰∏âÊ≠•ÔºöÊâßË°åÂÆâË£Ö</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sudo yum install nginx
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÂÆâË£ÖÊñá‰ª∂</strong></p>
<p><code>rpm -ql nginx</code>Êü•ÁúãÂÆâË£ÖÁõÆÂΩïÂèäÊñá‰ª∂</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>/etc/logrotate.d/nginx          #NginxÊó•ÂøóËΩÆËΩ¨ÔºåÁî®‰∫éÊó•ÂøóÂàáÂâ≤
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/etc/nginx/nginx.conf           #nginx‰∏ªË¶ÅÈÖçÁΩÆÊñá‰ª∂
</span></span><span style="display:flex;"><span>/etc/nginx/conf.d/default.conf  #ÂÆâË£Ö‰πãÂêéÈªòËÆ§Âä†ËΩΩÁöÑÊñá‰ª∂
</span></span><span style="display:flex;"><span>/etc/nginx/fastcgi_params       #cgiÈÖçÁΩÆ
</span></span><span style="display:flex;"><span>/etc/nginx/scgi_params          #cgiÈÖçÁΩÆ
</span></span><span style="display:flex;"><span>/etc/nginx/uwsgi_params         #cgiÈÖçÁΩÆ
</span></span><span style="display:flex;"><span>/etc/nginx/koi-utf              #ÁºñÁ†ÅËΩ¨Êç¢ÁöÑÊò†Â∞ÑÊñá‰ª∂
</span></span><span style="display:flex;"><span>/etc/nginx/koi-win              #ÁºñÁ†ÅËΩ¨Êç¢ÁöÑÊò†Â∞ÑÊñá‰ª∂
</span></span><span style="display:flex;"><span>/etc/nginx/win-utf              #ÁºñÁ†ÅËΩ¨Êç¢ÁöÑÊò†Â∞ÑÊñá‰ª∂
</span></span><span style="display:flex;"><span>/etc/nginx/mime.types           #ËÆæÁΩÆHttpÂçèËÆÆContent-Type‰∏éÊâ©Â±ïÂêçÂØπÂ∫îÂÖ≥Á≥ª
</span></span><span style="display:flex;"><span>/etc/nginx/modules              #nginxÊ®°ÂùóÁõÆÂΩïÊåáÂêë/usr/lib64/nginx/modules
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/usr/lib64/nginx/modules        #nginxÊ®°ÂùóÁõÆÂΩï
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/etc/sysconfig/nginx                         #Áî®‰∫éÂÆàÊä§ËøõÁ®ã
</span></span><span style="display:flex;"><span>/etc/sysconfig/nginx-debug                   #Áî®‰∫éÂÆàÊä§ËøõÁ®ã
</span></span><span style="display:flex;"><span>/usr/lib/systemd/system/nginx-debug.service  #Áî®‰∫éÂÆàÊä§ËøõÁ®ã	
</span></span><span style="display:flex;"><span>/usr/lib/systemd/system/nginx.service        #Áî®‰∫éÂÆàÊä§ËøõÁ®ã
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/usr/sbin/nginx                 #nginxÂëΩ‰ª§
</span></span><span style="display:flex;"><span>/usr/sbin/nginx-debug           #nginx-debugÂëΩ‰ª§
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/usr/share/doc/nginx-1.16.0            #nginxÊâãÂÜå
</span></span><span style="display:flex;"><span>/usr/share/doc/nginx-1.16.0/COPYRIGHT  #nginxÊâãÂÜå
</span></span><span style="display:flex;"><span>/usr/share/man/man8/nginx.8.gz         #nginxÂ∏ÆÂä©Êñá‰ª∂
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/usr/share/nginx/html/50x.html     #nginxÈªòËÆ§50xÁïåÈù¢
</span></span><span style="display:flex;"><span>/usr/share/nginx/html/index.html   #nginxÈªòËÆ§indexÁïåÈù¢
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/var/cache/nginx  #nginxÁºìÂÜ≤ÁõÆÂΩï
</span></span><span style="display:flex;"><span>/var/log/nginx    #nginxÊó•ÂøóÁõÆÂΩï
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="nginxÊ∫êÁ†ÅÂÆâË£Ö">NginxÊ∫êÁ†ÅÂÆâË£Ö</h3>
<p>ÊèêÂâçÂáÜÂ§áÔºö</p>
<ul>
<li>‰∏ãËΩΩÂπ∂Ëß£ÂéãÊ∫êÁ†Å</li>
<li>ÂÆâË£ÖÂøÖË¶ÅÂ∫ì</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yum -y install gcc-c++ gcc autoconf pcre-devel make automake zlib-devel openssl openssl-devel
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∏ÄÊ≠•ÔºöËÆæÁΩÆÁºñËØëÂèÇÊï∞</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>./configure <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--prefix<span style="color:#000;font-weight:bold">=</span>/etc/nginx <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--sbin-path<span style="color:#000;font-weight:bold">=</span>/usr/sbin/nginx <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--modules-path<span style="color:#000;font-weight:bold">=</span>/usr/lib64/nginx/modules <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--conf-path<span style="color:#000;font-weight:bold">=</span>/etc/nginx/nginx.conf <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--error-log-path<span style="color:#000;font-weight:bold">=</span>/var/log/nginx/error.log <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--http-log-path<span style="color:#000;font-weight:bold">=</span>/var/log/nginx/access.log <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--pid-path<span style="color:#000;font-weight:bold">=</span>/var/run/nginx.pid <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--lock-path<span style="color:#000;font-weight:bold">=</span>/var/run/nginx.lock <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--http-client-body-temp-path<span style="color:#000;font-weight:bold">=</span>/var/cache/nginx/client_temp <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--http-proxy-temp-path<span style="color:#000;font-weight:bold">=</span>/var/cache/nginx/proxy_temp <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--http-fastcgi-temp-path<span style="color:#000;font-weight:bold">=</span>/var/cache/nginx/fastcgi_temp <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--http-uwsgi-temp-path<span style="color:#000;font-weight:bold">=</span>/var/cache/nginx/uwsgi_temp <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--http-scgi-temp-path<span style="color:#000;font-weight:bold">=</span>/var/cache/nginx/scgi_temp <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--user<span style="color:#000;font-weight:bold">=</span>nginx <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--group<span style="color:#000;font-weight:bold">=</span>nginx <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-compat <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-file-aio <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-threads <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_addition_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_auth_request_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_dav_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_flv_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_gunzip_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_gzip_static_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_mp4_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_random_index_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_realip_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_secure_link_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_slice_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_ssl_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_stub_status_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_sub_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-http_v2_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-mail <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-mail_ssl_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-stream <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-stream_realip_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-stream_ssl_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-stream_ssl_preread_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-cc-opt<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -fPIC&#39;</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--with-ld-opt<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;-Wl,-z,relro -Wl,-z,now -pie&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∫åÊ≠•ÔºöÁºñËØë&amp;ÂÆâË£Ö</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>make
</span></span><span style="display:flex;"><span>make install
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÂÆâË£ÖÁºñËØëÂèÇÊï∞">ÂÆâË£ÖÁºñËØëÂèÇÊï∞</h3>
<p>‰ΩøÁî®<code>nginx -V</code>Êü•ÁúãÁâàÊú¨‰ø°ÊÅØÂíåÂÆâË£ÖÁºñËØëÂèÇÊï∞</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>#ÂÆâË£ÖÁõÆÂΩïÊàñÊñá‰ª∂Ë∑ØÂæÑ
</span></span><span style="display:flex;"><span>--prefix=/etc/nginx 										
</span></span><span style="display:flex;"><span>--sbin-path=/usr/sbin/nginx 
</span></span><span style="display:flex;"><span>--modules-path=/usr/lib64/nginx/modules 
</span></span><span style="display:flex;"><span>--conf-path=/etc/nginx/nginx.conf 
</span></span><span style="display:flex;"><span>--error-log-path=/var/log/nginx/error.log 
</span></span><span style="display:flex;"><span>--http-log-path=/var/log/nginx/access.log 
</span></span><span style="display:flex;"><span>--pid-path=/var/run/nginx.pid 
</span></span><span style="display:flex;"><span>--lock-path=/var/run/nginx.lock 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#ÊâßË°åÂØπÂ∫îÊ®°ÂùóÊó∂ÔºånginxÊâÄ‰øùÁïôÁöÑ‰∏¥Êó∂Êñá‰ª∂
</span></span><span style="display:flex;"><span>--http-client-body-temp-path=/var/cache/nginx/client_temp 	
</span></span><span style="display:flex;"><span>--http-proxy-temp-path=/var/cache/nginx/proxy_temp 
</span></span><span style="display:flex;"><span>--http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp 
</span></span><span style="display:flex;"><span>--http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp 
</span></span><span style="display:flex;"><span>--http-scgi-temp-path=/var/cache/nginx/scgi_temp 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#nginxËøõÁ®ãÂêØÂä®ÁöÑÁî®Êà∑ÂíåÁî®Êà∑ÁªÑ
</span></span><span style="display:flex;"><span>--user=nginx												
</span></span><span style="display:flex;"><span>--group=nginx
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--with-compat 
</span></span><span style="display:flex;"><span>--with-file-aio                   #‰ΩøÁî®aio‰º†ËæìÊñá‰ª∂ÔºåÊïàÁéá‰∏ç‰∏ÄÂÆöÊØîsendfileÈ´ò
</span></span><span style="display:flex;"><span>--with-threads
</span></span><span style="display:flex;"><span>--with-http_addition_module
</span></span><span style="display:flex;"><span>--with-http_auth_request_module
</span></span><span style="display:flex;"><span>--with-http_dav_module
</span></span><span style="display:flex;"><span>--with-http_flv_module
</span></span><span style="display:flex;"><span>--with-http_gunzip_module         #ÊîØÊåÅgunzipÁöÑÂéãÁº©ÊñπÂºè„ÄÇÁî®‰∫éÂÆ¢Êà∑Á´Ø‰∏çÊîØÊåÅgzipÂéãÁº©ÂäüËÉΩ‰∏ã
</span></span><span style="display:flex;"><span>--with-http_gzip_static_module    #È¢ÑËØªgzipÂäüËÉΩ
</span></span><span style="display:flex;"><span>--with-http_mp4_module
</span></span><span style="display:flex;"><span>--with-http_random_index_module   #ÁõÆÂΩï‰∏≠ÈöèÊú∫ÈÄâÂèñ‰∏ªÈ°µÊ®°Âùó
</span></span><span style="display:flex;"><span>--with-http_realip_module
</span></span><span style="display:flex;"><span>--with-http_secure_link_module    #ÂÆâÂÖ®‰∏ãËΩΩÈìæÊé•Ê®°Âùó
</span></span><span style="display:flex;"><span>--with-http_slice_module          #Â§ßÊñá‰ª∂ÊãÜÂàÜ‰ΩøÁî®
</span></span><span style="display:flex;"><span>--with-http_ssl_module            #httpsÁöÑËØÅ‰π¶Áõ∏ÂÖ≥
</span></span><span style="display:flex;"><span>--with-http_stub_status_module    #Êü•ÁúãnginxÂÆ¢Êà∑Á´ØÁä∂ÊÄÅÊ®°Âùó
</span></span><span style="display:flex;"><span>--with-http_sub_module            #HTTPÂÜÖÂÆπÊõøÊç¢Ê®°Âùó
</span></span><span style="display:flex;"><span>--with-http_v2_module
</span></span><span style="display:flex;"><span>--with-mail 
</span></span><span style="display:flex;"><span>--with-mail_ssl_module 
</span></span><span style="display:flex;"><span>--with-stream                     #ÁºñËØëngx_stream_core_module
</span></span><span style="display:flex;"><span>--with-stream_realip_module 
</span></span><span style="display:flex;"><span>--with-stream_ssl_module 
</span></span><span style="display:flex;"><span>--with-stream_ssl_preread_module 
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>#ÂÆö‰πâË¶Å‰º†ÈÄíÂà∞CÁºñËØëÂô®ÂëΩ‰ª§Ë°åÁöÑÂÖ∂‰ªñÈÄâÈ°π
</span></span><span style="display:flex;"><span>--with-cc-opt=&#39;-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -fPIC&#39;  
</span></span><span style="display:flex;"><span>#ÂÆö‰πâË¶Å‰º†ÈÄíÂà∞CÈìæÊé•Âô®ÂëΩ‰ª§Ë°åÁöÑÂÖ∂‰ªñÈÄâÈ°π
</span></span><span style="display:flex;"><span>--with-ld-opt=&#39;-Wl,-z,relro -Wl,-z,now -pie&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="‰∫ånginxÂü∫Êú¨ÂëΩ‰ª§">‰∫å„ÄÅNginxÂü∫Êú¨ÂëΩ‰ª§</h2>
<ul>
<li>
<p><strong>Ê£ÄÊü•nginxÈÖçÁΩÆÊñá‰ª∂ËØ≠Ê≥ïÊòØÂê¶Ê≠£Á°Æ</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>nginx -t -c nginx.conf          <span style="color:#998;font-style:italic">#t‰ª£Ë°®Ê£ÄÊü• cÊåáÂÆöÊñá‰ª∂Ë∑ØÂæÑ</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>ÈáçÊñ∞Âä†ËΩΩÈÖçÁΩÆÊñá‰ª∂</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>nginx -s reload -c nginx.conf 	<span style="color:#998;font-style:italic">#s‰ª£Ë°®‰ø°Âè∑relaodÂèÇÊï∞Ë°®Á§∫ÈáçÂä†ËΩΩ cÊåáÂÆöÊñá‰ª∂Ë∑ØÂæÑ</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>Êü•ÁúãÂÆâË£ÖÊ®°Âùó</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>nginx  -V                       <span style="color:#998;font-style:italic">#Êü•ÁúãÁºñËØëÊó∂Ëá™Â∑±ËÆæÁΩÆÁöÑÂèÇÊï∞ÂåÖÂê´Ê®°Âùó‰ø°ÊÅØ</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>Âø´ÈÄüÂÅúÊ≠¢</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>nginx -s stop
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p><strong>‰ºòÈõÖÂÅúÊú∫ÔºàÁé∞Êúâ‰ªªÂä°ËøêË°åÂÆåÊàêÔºåÂÖ∂ÂÆÉËØ∑Ê±ÇÊãíÁªùÔºâ</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>nginx -s quit
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="‰∏âÁÆÄÂçïÈÖçÁΩÆ">‰∏â„ÄÅÁÆÄÂçïÈÖçÁΩÆ</h2>
<h3 id="ÈÖçÁΩÆÊñá‰ª∂‰ΩçÁΩÆ">ÈÖçÁΩÆÊñá‰ª∂‰ΩçÁΩÆ</h3>
<p><code>/etc/nginx/nginx.conf</code>‰∏∫‰∏ªË¶ÅÈÖçÁΩÆÊñá‰ª∂ÔºåÂú®Ê≠§ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÈªòËÆ§ÈÖçÁΩÆ‰∫Ü<code> include /etc/nginx/conf.d/*.conf</code>Âç≥‰ºöÂä†ËΩΩconf.d‰∏ãÁöÑÈÖçÁΩÆÊñá‰ª∂</p>
<h3 id="nginxconfÈÖçÁΩÆ">nginx.confÈÖçÁΩÆ</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">user</span>  <span style="color:#d14">nginx</span>;                                <span style="color:#998;font-style:italic">#ËÆæÁΩÆnginxÊúçÂä°ÁöÑÁ≥ªÁªüÂêØÂä®Áî®Êà∑
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">worker_processes</span>  <span style="color:#099">1</span>;                        <span style="color:#998;font-style:italic">#Â∑•‰ΩúËøõÁ®ãÊï∞ÔºåÂª∫ËÆÆËÆæÁΩÆ‰ΩçCPUÊ†∏ÂøÉÊï∞
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">error_log</span>  <span style="color:#d14">/var/log/nginx/error.log</span> <span style="color:#d14">warn</span>;   <span style="color:#998;font-style:italic">#nginxÈîôËØØÊó•Âøó
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">pid</span>        <span style="color:#d14">/var/run/nginx.pid</span>;              <span style="color:#998;font-style:italic">#pidÊñá‰ª∂‰ΩçÁΩÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">events</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">worker_connections</span>  <span style="color:#099">1024</span>;               <span style="color:#998;font-style:italic">#ÊØè‰∏™ËøõÁ®ãÂÖÅËÆ∏ÁöÑÊúÄÂ§ßËøûÊé•Êï∞ÔºåÁîüÊàêÁéØÂ¢ÉÂøÖÈ°ªË∞ÉÊï¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">http</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">include</span>       <span style="color:#d14">/etc/nginx/mime.types</span>;    <span style="color:#998;font-style:italic">#Content_TypeÈÖçÁΩÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">default_type</span>  <span style="color:#d14">application/octet-stream</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#Êó•ÂøóÊ†ºÂºèÂÆö‰πâ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">log_format</span>  <span style="color:#d14">main</span>  <span style="color:#d14">&#39;</span><span style="color:#008080">$remote_addr</span> <span style="color:#d14">-</span> <span style="color:#008080">$remote_user</span> <span style="color:#d14">[</span><span style="color:#008080">$time_local]</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$request&#34;</span> <span style="color:#d14">&#39;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#d14">&#39;</span><span style="color:#008080">$status</span> <span style="color:#008080">$body_bytes_sent</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$http_referer&#34;</span> <span style="color:#d14">&#39;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#d14">&#39;&#34;</span><span style="color:#008080">$http_user_agent&#34;</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$http_x_forwarded_for&#34;&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#ËÆøÈóÆÊó•ÂøóÂÆö‰πâ‰ΩøÁî®mainÊ†ºÂºèÊâìÂç∞
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">access_log</span>  <span style="color:#d14">/var/log/nginx/access.log</span>  <span style="color:#d14">main</span>;	
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">sendfile</span>        <span style="color:#008080">on</span>;       <span style="color:#998;font-style:italic">#ÊòØÂê¶ÂºÄÂêØsendfile
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">#tcp_nopush     on;       #ÊòØÂê¶‰∏çÁ´ãÂç≥‰º†ËæìËÄåÊòØÁ≠âÂæÖÂåÖÂ§ßÂ∞èÊàñËÄÖÊó∂Èó¥Âà∞ËææÊù°‰ª∂Ôºå‰ª•ÊèêÈ´òÊïàÁéá
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">keepalive_timeout</span>  <span style="color:#099">65</span>;    <span style="color:#998;font-style:italic">#ÂÆ¢Êà∑Á´ØÂíåÊúçÂä°ÁöÑkeepaliveË∂ÖÂ∏ÇÊó∂Èó¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#gzip  on;                          #ÂéãÁº©‰º†Ëæì
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">include</span> <span style="color:#d14">/etc/nginx/conf.d/*.conf</span>;   <span style="color:#998;font-style:italic">#ÂºïÂÖ•ËæÖÂä©ÈÖçÁΩÆÊñá‰ª∂
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="nginxÈÖçÁΩÆÁªìÊûÑ">NginxÈÖçÁΩÆÁªìÊûÑ</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">http</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  <span style="color:#000;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">listen</span> <span style="color:#099">80</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server_name</span> <span style="color:#d14">localhost</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">root</span>   <span style="color:#d14">/usr/share/nginx/html</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">index</span>  <span style="color:#d14">index.html</span> <span style="color:#d14">index.htm</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">error_page</span>   <span style="color:#099">500</span> <span style="color:#099">502</span> <span style="color:#099">503</span> <span style="color:#099">504</span>  <span style="color:#d14">/50x.html</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">location</span> = <span style="color:#d14">/50x.html</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">root</span>   <span style="color:#d14">/usr/share/nginx/html</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="nginxÊó•ÂøóÊ†ºÂºè">NginxÊó•ÂøóÊ†ºÂºè</h3>
<p><strong>NginxÂèØÁî®Êó•ÂøóÂèòÈáè</strong></p>
<ul>
<li>
<p>HTTPËØ∑Ê±ÇÂèòÈáèÔºö$arg_PARAMETER„ÄÅ$http_HEADER„ÄÅ$sent_http_HEADER</p>
</li>
<li>
<p>ÂÜÖÁΩÆÂèòÈáèÔºö</p>
<table>
<thead>
<tr>
<th>ÂêçÁß∞</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td>$bytes_sent</td>
<td>ÂèëÈÄÅÂà∞ÂÆ¢Êà∑Á´ØÁöÑÂ≠óËäÇÊï∞</td>
</tr>
<tr>
<td>$connection</td>
<td>ËøûÊé•Â∫èÂàóÂè∑</td>
</tr>
<tr>
<td>$connection_requests</td>
<td>ÈÄöËøáËøûÊé•ÂèëÂá∫ÁöÑÂΩìÂâçËØ∑Ê±ÇÊï∞</td>
</tr>
<tr>
<td>$msec</td>
<td>‰ª•Áßí‰∏∫Âçï‰ΩçÁöÑÊó∂Èó¥</td>
</tr>
<tr>
<td>$pipe</td>
<td><code>p</code>‰ª£Ë°®pipelinedÊñπÂºèËØ∑Ê±ÇÔºå<code>.</code>‰ª£Ë°®ÂÖ∂ÂÆÉÊñπÂºè</td>
</tr>
<tr>
<td>$request_length</td>
<td>ËØ∑Ê±ÇÈïøÂ∫¶ÔºàÂåÖÊã¨ËØ∑Ê±ÇË°åÔºåËØ∑Ê±ÇÂ§¥ÂíåËØ∑Ê±ÇÊ≠£ÊñáÔºâ</td>
</tr>
<tr>
<td>$request_time</td>
<td>‰ª•ÊØ´Áßí‰∏∫Âçï‰ΩçËØ∑Ê±ÇÂ§ÑÁêÜÊó∂Èó¥</td>
</tr>
<tr>
<td>$status</td>
<td>ÂõûÂ∫îÁä∂ÊÄÅ</td>
</tr>
<tr>
<td>$time_iso8601</td>
<td>ISO 8601Ê†ºÂºèÁöÑÂΩìÂú∞Êó∂Èó¥</td>
</tr>
<tr>
<td>$time_local</td>
<td>Êú¨Âú∞Êó∂Èó¥Ê†ºÂºè</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Ëá™ÂÆö‰πâÂèòÈáè</p>
</li>
</ul>
<p><strong>NginxÈªòËÆ§Êó•ÂøóÊ†ºÂºè</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">log_format</span>  <span style="color:#d14">main</span>  <span style="color:#d14">&#39;</span><span style="color:#008080">$remote_addr</span> <span style="color:#008080">$status</span> <span style="color:#d14">-</span> <span style="color:#008080">$remote_user</span> <span style="color:#d14">[</span><span style="color:#008080">$time_local]</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$request&#34;</span> <span style="color:#d14">&#39;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#d14">&#39;</span><span style="color:#008080">$status</span> <span style="color:#008080">$body_bytes_sent</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$http_referer&#34;</span> <span style="color:#d14">&#39;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#d14">&#39;&#34;</span><span style="color:#008080">$http_user_agent&#34;</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$http_x_forwarded_for&#34;&#39;</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂõõÂÆòÊñπÊ®°Âùó">Âõõ„ÄÅÂÆòÊñπÊ®°Âùó</h2>
<h3 id="http_stub_status_module">http_stub_status_module</h3>
<p><strong>‰ΩúÁî®ÔºöÁõëÊéßnginxÂÆ¢Êà∑Á´ØÁä∂ÊÄÅ</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Syntax:	 stub_status;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÖçÁΩÆÁ§∫‰æã</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/stub_status</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">stub_status</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#-------------------------------ËÆøÈóÆ/stub_statusËøîÂõûÊï∞ÊçÆ--------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Active connections: 2 					ÂΩìÂâçËøûÊé•Êï∞
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#server accepts handled requests
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 13 13 16                            Êè°ÊâãÊ¨°Êï∞ ËøûÊé•Ê¨°Êï∞ ËØ∑Ê±ÇÊ¨°Êï∞
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Reading: 0 Writing: 1 Waiting: 1     ËØª‰∏™Êï∞   ÂÜô‰∏™Êï∞   Á≠âÂæÖ‰∏™Êï∞
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="http_random_index_module">http_random_index_module</h3>
<p><strong>‰ΩúÁî®ÔºöËÆøÈóÆÈöèÊú∫‰∏ªÈ°µ</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Syntax:	 random_index on | off;
</span></span><span style="display:flex;"><span>Default: random_index off;
</span></span><span style="display:flex;"><span>Context: location
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÖçÁΩÆÁ§∫‰æã</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Âè™ËÉΩÈÖçÁΩÆÂú®‚Äú/‚Äù‰∏ã
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {		
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span>         <span style="color:#d14">/opt/nginx/app/randmon_page</span>;	
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">random_index</span> <span style="color:#008080">on</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="http_sub_module">http_sub_module</h3>
<p><strong>‰ΩúÁî®ÔºöHTTPÂÜÖÂÆπÊõøÊç¢</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>„ÄêÊõøÊç¢ÊåáÂÆöÂ≠óÁ¨¶‰∏≤„Äë
</span></span><span style="display:flex;"><span>Syntax:	 sub_filter string replacement;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÊòØÂê¶ÈòªÊ≠¢response header‰∏≠ÂÜôÂÖ•Last-ModifiedÔºåÈò≤Ê≠¢ÁºìÂ≠òÔºåÈªòËÆ§ÊòØoffÔºåÂç≥Èò≤Ê≠¢ÁºìÂ≠ò„Äë
</span></span><span style="display:flex;"><span>Syntax:	 sub_filter_last_modified on | off;
</span></span><span style="display:flex;"><span>Default: sub_filter_last_modified off;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÊòØÂê¶Âè™ÊõøÊç¢‰∏ÄÊ¨°Â≠óÁ¨¶‰∏≤„Äë
</span></span><span style="display:flex;"><span>Syntax:	 sub_filter_once on | off;
</span></span><span style="display:flex;"><span>Default: sub_filter_once on;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Syntax:	 sub_filter_types mime-type ...;
</span></span><span style="display:flex;"><span>Default: sub_filter_types text/html;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÖçÁΩÆÁ§∫‰æã</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">sub_filter</span>      <span style="color:#d14">&#39;kun&#39;</span> <span style="color:#d14">&#39;KUN&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">sub_filter_once</span> <span style="color:#008080">off</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span>            <span style="color:#d14">/opt/nginx/app/sub_module</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">index</span>           <span style="color:#d14">submodule.html</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="http_limit_conn_module">http_limit_conn_module</h3>
<p><strong>‰ΩúÁî®ÔºöÈôêÂà∂ËøûÊé•È¢ëÁéá</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>„ÄêÂºÄËæü‰øùÂ≠òËøûÊé•‰ø°ÊÅØÁöÑÁ©∫Èó¥ key:Â≠òÂÇ®‰ø°ÊÅØÔºånameÁ©∫Èó¥ÂêçÁß∞ÔºåsizeÁ©∫Èó¥Â§ßÂ∞è„Äë
</span></span><span style="display:flex;"><span>Syntax:	 limit_conn_zone key zone=name:size;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÈôêÂà∂ÂêåÊó∂ËøûÊé•ÁöÑÂπ∂ÂèëÊï∞Èáè zone:Á©∫Èó¥ÂêçÁß∞Ôºånumber:ÈôêÂà∂‰∏™Êï∞„Äë
</span></span><span style="display:flex;"><span>Syntax:	 limit_conn zone number;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÖçÁΩÆÁ§∫‰æã</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">limit_conn_zone</span> <span style="color:#008080">$binary_remote_addr</span> <span style="color:#d14">zone=coon_addr:10m</span>;   <span style="color:#998;font-style:italic">#ÂºÄËæü10MÁ©∫Èó¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">limit_conn</span>   <span style="color:#d14">addr</span> <span style="color:#099">1</span>;                              <span style="color:#998;font-style:italic">#ÊØèÊ¨°‰∏Ä‰∏™ipÂè™ÂÖÅËÆ∏1Ê¨°ËøûÊé•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">root</span>        <span style="color:#d14">/usr/share/nginx/html</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">index</span>       <span style="color:#d14">index.html</span> <span style="color:#d14">index.htm</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="http_limit_req_module">http_limit_req_module</h3>
<p><strong>‰ΩúÁî®ÔºöÈôêÂà∂ËØ∑Ê±ÇÈ¢ëÁéá</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>„ÄêÂºÄËæü‰øùÂ≠òËØ∑Ê±Ç‰ø°ÊÅØÁöÑÁ©∫Èó¥ key:Â≠òÂÇ®‰ø°ÊÅØÔºånameÁ©∫Èó¥ÂêçÁß∞ÔºåsizeÁ©∫Èó¥Â§ßÂ∞èÔºårateËØ∑Ê±ÇÈÄüÁéá„Äë
</span></span><span style="display:flex;"><span>Syntax:  limit_req_zone key zone=name:size rate=rate [sync];
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÈôêÂà∂ÂêåÊó∂ËØ∑Ê±ÇÁöÑÂπ∂ÂèëÊï∞Èáè zone:Á©∫Èó¥ÂêçÁß∞ÔºåburstÂÖÅËÆ∏Ë∂ÖËøá‰∏™Êï∞ÔºånodelayÊòØÂê¶Âª∂ËøüÊâßË°åburst „Äë
</span></span><span style="display:flex;"><span>Syntax:	limit_req zone=name [burst=number] [nodelay | delay=number];
</span></span><span style="display:flex;"><span>Default:	‚Äî
</span></span><span style="display:flex;"><span>Context:	http, server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÖçÁΩÆÁ§∫‰æã</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂºÄËæü10MÁ©∫Èó¥ÔºåÊØèIPÊØèÁßíÂè™ÂÖÅËÆ∏ËØ∑Ê±Ç‰∏ÄÊ¨°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">limit_req_zone</span>  <span style="color:#008080">$binary_remote_addr</span> <span style="color:#d14">zone=req_addr:10m</span> <span style="color:#d14">rate=1r/s</span>; 
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">limit_req</span>   <span style="color:#d14">zone=req_addr</span> <span style="color:#d14">burst=3</span> <span style="color:#d14">nodelay</span>;	<span style="color:#998;font-style:italic">#ÂÖÅËÆ∏Á™ÅÂèëËøûÊé•Êï∞‰∏∫3Ôºå‰∏çÂª∂Ëøü
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">root</span>        <span style="color:#d14">/usr/share/nginx/html</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">index</span>       <span style="color:#d14">index.html</span> <span style="color:#d14">index.htm</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#------------------------------------‰ΩøÁî®abÂ∑•ÂÖ∑ÂéãÊµã#-----------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ab -n 20 -c 20 http://localhost/
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÁªìÊûúÊàêÂäü4‰∏™ËØ∑Ê±ÇÔºåÂ§±Ë¥•16‰∏™ËØ∑Ê±Ç
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="http_access_module">http_access_module</h3>
<p><strong>‰ΩúÁî®ÔºöÊéßÂà∂ËÆøÈóÆÁöÑipÔºåÂ¶ÇÊûúÂ§öÂ±Ç‰ª£ÁêÜÊ≠§ÁßçÊñπÂºèÊúâÈóÆÈ¢ò„ÄêÂü∫‰∫éremote_addrËØÜÂà´„Äë</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>„ÄêÂÖÅËÆ∏ËÆøÈóÆÂêçÂçï„Äë
</span></span><span style="display:flex;"><span>Syntax:  allow address | CIDR | unix: | all;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location, limit_except
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÊãíÁªùËÆøÈóÆÂêçÂçï„Äë
</span></span><span style="display:flex;"><span>Syntax:  deny address | CIDR | unix: | all;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location, limit_except
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÖçÁΩÆÁ§∫‰æã</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">^/admin.html</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span>    <span style="color:#d14">/opt/nginx/app/access_module</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">index</span>   <span style="color:#d14">admin.html</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">allow</span>   <span style="color:#099">192</span><span style="color:#d14">.168.1.0/24</span>;         <span style="color:#998;font-style:italic">#ÂÖÅËÆ∏Ê¨°ÁΩëÊÆµËÆøÈóÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">deny</span>    <span style="color:#d14">all</span>;                    <span style="color:#998;font-style:italic">#‰∏çÂÖÅËÆ∏ÂÖ∂ÂÆÉ‰∫∫ËÆøÈóÆÔºåÊ≥®ÊÑèÂ∏¶allÂèÇÊï∞ÁöÑÊîæÊúÄÂêé
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="http_auth_basic_module">http_auth_basic_module</h3>
<p><strong>‰ΩúÁî®ÔºöÁî®Êà∑ÁôªÈôÜËÆ§ËØÅ</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>„ÄêÈúÄÂºÄÂêØÊ¨°Ê®°ÂùóËøõË°åËÆ§ËØÅÔºåstring‰ª£Ë°®È°µÈù¢‰∏äÁöÑÁôªÈôÜÊèêÁ§∫‰ø°ÊÅØ„Äë
</span></span><span style="display:flex;"><span>Syntax:  auth_basic string | off;
</span></span><span style="display:flex;"><span>Default: auth_basic off;
</span></span><span style="display:flex;"><span>Context: http, server, location, limit_excep
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÂ≠òÂÇ®Áî®Êà∑Âêç„ÄÅÂØÜÁ†Å‰ø°ÊÅØÁöÑÊ®°Âùó„Äë
</span></span><span style="display:flex;"><span>Syntax:  auth_basic_user_file file;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location, limit_except
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÖçÁΩÆÁ§∫‰æã</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">^/auth.html</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span>        	<span style="color:#d14">/opt/nginx/app/auth_module</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">auth_basic</span>  	<span style="color:#d14">&#34;manager</span> <span style="color:#d14">site&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">auth_basic_user_file</span> <span style="color:#d14">/etc/nginx/auth_conf</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#-------------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#‰ΩøÁî®„Äêhtpasswd -c /etc/nginx/auth_conf username „ÄëÂà∂‰ΩúÂ≠òÊîæÂØÜÁ†ÅÊñá‰ª∂
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="http_secure_link_module">http_secure_link_module</h3>
<p><img src="/img/nginx/secure_link.png" alt="secure_link"></p>
<p>‰ΩúÁî®ÔºöÂà∂ÂÆöÂπ∂ÂÖÅËÆ∏Ê£ÄÊü•ËØ∑Ê±ÇÁöÑÁúüÂÆûÊÄß‰ª•Âèä‰øùÊä§ËµÑÊ∫êÂÖçÈÅ≠Êú™ÊéàÊùÉÁöÑËÆøÈóÆ‰πüÂèØÈôêÂà∂ÈìæÊé•ÁîüÊïàÊó∂Èïø</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Syntax:  secure_link expression;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Syntax:  secure_link_md5 expression;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÖçÁΩÆÁ§∫‰æã</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#echo -n &#39;$expire$uri kun&#39;| openssl md5 -binary | openssl base64 | tr +/ -_ | tr -d =
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Âç≥ÂèØÁ≠âÂæÖmd5ÂÄº
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">^/download</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#ÂÆö‰πâmd5ÂíåexpireÂèòÈáè‰ΩçÁΩÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">secure_link</span>  <span style="color:#008080">$arg_md5,$arg_expire</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#kunÊú™Ê∑∑Ê∑Ü‰∏≤
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">secure_link_md5</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$secure_link_expires$uri</span> <span style="color:#d14">kun&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#Â¶ÇÊûúmd5‰∏çÊ≠£Á°Æ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">if</span> <span style="color:#d14">(</span><span style="color:#008080">$secure_link</span> = <span style="color:#d14">&#34;&#34;)</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">403</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#Â¶ÇÊûúexpireÂ∑≤ÁªèÂ§±Êïà
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">if</span> <span style="color:#d14">(</span><span style="color:#008080">$secure_link</span> = <span style="color:#d14">&#34;0&#34;)</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">410</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span> <span style="color:#d14">/opt/nginx/app/secure_link</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="http_geoip2_module">http_geoip2_module</h3>
<p>‰ΩúÁî®ÔºöÂü∫‰∫éIPÂú∞ÂùÄÂåπÈÖçMaxMind GeoIP‰∫åËøõÂà∂Êñá‰ª∂ÔºåËØªÂèñIPÊâÄÂú®Âú∞Âüü‰ø°ÊÅØ„ÄÇ</p>
<p>Âú∫ÊôØÔºöÂå∫Âà´ÂõΩÂÜÖÂõΩÂ§ñ‰ΩúHttpËÆøÈóÆËßÑÂàôÔºåÂå∫Âà´ÂõΩÂÜÖÂüéÂ∏Ç‰ΩúHTTPËÆøÈóÆËßÑÂàô</p>
<p>ÂáÜÂ§áÔºö<a href="https://geolite.maxmind.com/download/geoip/database/GeoLite2-City.tar.gz">‰∏ãËΩΩÂüéÂ∏Ç‰ø°ÊÅØ</a>   <a href="https://geolite.maxmind.com/download/geoip/database/GeoLite2-Country.tar.gz">‰∏ãËΩΩÂõΩÂÆ∂‰ø°ÊÅØ</a></p>
<p>ÂÆâË£ÖÔºö</p>
<ul>
<li>ÂÆâË£ÖlibmaxminddbÔºå<a href="https://github.com/maxmind/libmaxminddb">ËØ¶ËßÅÂú∞ÂùÄ</a></li>
<li>‰∏ãËΩΩngx_http_geoip2_moduleÊ®°ÂùóÔºå<a href="https://github.com/leev/ngx_http_geoip2_module">ËØ¶ËßÅÂú∞ÂùÄ</a></li>
<li>nginxÈáçÊñ∞ÁºñËØëÂÆâË£ÖÔºåÊ∑ªÂä†ÁºñËØëÂèÇÊï∞</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Ë∑ØÂæÑÂú∞ÂùÄ‰∏∫Ëß£ÂéãÁöÑngx_http_geoip2_moduleÊ®°ÂùóÁöÑË∑ØÂæÑ</span>
</span></span><span style="display:flex;"><span>./configure „ÄêÂéüÂèÇÊï∞„Äë --add-dynamic-module<span style="color:#000;font-weight:bold">=</span>/path/to/ngx_http_geoip2_module
</span></span></code></pre></td></tr></table>
</div>
</div><p>nginx.confÈÖçÁΩÆÔºö</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">load_module</span> <span style="color:#d14">modules/ngx_http_geoip2_module.so</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">http</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">geoip2</span> <span style="color:#d14">/etc/maxmind-country.mmdb</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">auto_reload</span> <span style="color:#099">5m</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">$geoip2_metadata_country_build</span> <span style="color:#d14">metadata</span> <span style="color:#d14">build_epoch</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">#$variable_with_ip‰∏∫Áî®‰∫éËæ®Âà´IPÂú∞ÂùÄÁöÑÂèòÈáèÔºåÂèØËÆæÁΩÆ‰∏∫$remote_addrÊàñËá™ÂÆö‰πâÂèòÈáè
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      <span style="color:#000;font-weight:bold">$geoip2_data_country_code</span> <span style="color:#d14">default=US</span> <span style="color:#d14">source=</span><span style="color:#008080">$variable_with_ip</span> <span style="color:#d14">country</span> <span style="color:#d14">iso_code</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">$geoip2_data_country_name</span> <span style="color:#d14">country</span> <span style="color:#d14">names</span> <span style="color:#d14">en</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">geoip2</span> <span style="color:#d14">/etc/maxmind-city.mmdb</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">$geoip2_data_city_name</span> <span style="color:#d14">default=London</span> <span style="color:#d14">city</span> <span style="color:#d14">names</span> <span style="color:#d14">en</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="‰∫înginxÊúçÂä°">‰∫î„ÄÅNginxÊúçÂä°</h2>
<h3 id="nginx‰Ωú‰∏∫ÈùôÊÄÅwebÊúçÂä°">Nginx‰Ωú‰∏∫ÈùôÊÄÅwebÊúçÂä°</h3>
<p><strong>CDNÊúçÂä°ÁÆÄ‰ªã</strong></p>
<p><img src="/img/nginx/cdn.png" alt="cdn"></p>
<p>Áî®Êà∑ËØ∑Ê±ÇÂüüÂêçÔºåÈÄöËøáDNSÊúçÂä°Âô®Ëß£Êûê‰πãÂêéÔºåÂØºÂêë‰∫ÜÊúÄËøëÁöÑÊúçÂä°Âô®‰ª•ÂèñÂæóÊúÄÂø´ÁöÑËÆøÈóÆÊúçÂä°„ÄÇnginx‰Ωú‰∏∫ÈùôÊÄÅËµÑÊ∫êÁºìÂ≠òËΩΩ‰ΩìÂçÅÂàÜÈ´òÊïà</p>
<p><strong>ÈÖçÁΩÆNginxÊñá‰ª∂ËØªÂèñÁõ∏ÂÖ≥</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>„ÄêÈááÂèñepollÊñπÂºèÂèëÈÄÅÊñá‰ª∂„Äë
</span></span><span style="display:flex;"><span>Syntax:  sendfile on | off;
</span></span><span style="display:flex;"><span>Default: sendfile off;
</span></span><span style="display:flex;"><span>Context: http, server, location, if in location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„Äê‰∏çÁ´ãÂç≥ÂèëÈÄÅÊï∞ÊçÆÂåÖÔºåÂ∞ÜÂ§ö‰∏™ÂåÖÊï¥‰ΩìËøõË°åÊï¥Âêà‰∏ÄÊ¨°ÂèëÈÄÅÔºåÊèêÈ´ò‰º†ËæìÊïàÁéáÔºåsendfileÂºÄÂêØÊó∂ÊâçËÉΩ‰ΩøÁî®„Äë
</span></span><span style="display:flex;"><span>Syntax:	 tcp_nopush on | off;
</span></span><span style="display:flex;"><span>Default: tcp_nopush off;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„Äê‰∏étcp_nopushÁõ∏ÂèçÔºåÁ´ãÂç≥ÂèëÈÄÅÊï∞ÊçÆÂåÖÔºåkeepaliveÂºÄÂêØÊó∂ÊâçËÉΩ‰ΩøÁî®„Äë
</span></span><span style="display:flex;"><span>Syntax:  tcp_nodelay on | off;
</span></span><span style="display:flex;"><span>Default: tcp_nodelay on;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>--------------------------------ngx_http_gzip_module---------------------------------
</span></span><span style="display:flex;"><span>„ÄêÂÖÅËÆ∏‰º†ËæìgzipÊñá‰ª∂ÔºåÂú®ÂÆ¢Êà∑Á´ØËß£ÂéãÔºåÂáèÂ∞ëÂ∏¶ÂÆΩÂéãÂäõ„Äë
</span></span><span style="display:flex;"><span>Syntax:  gzip on | off;
</span></span><span style="display:flex;"><span>Default: gzip off;
</span></span><span style="display:flex;"><span>Context: http, server, location, if in location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÂéãÁº©Á∫ßÂà´Ôºà1-9Ôºâ‰æùÊ¨°‰∏äÂçá„Äë
</span></span><span style="display:flex;"><span>Syntax:  gzip_comp_level level;
</span></span><span style="display:flex;"><span>Default: gzip_comp_level 1;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêgzipÁöÑhttpÂçèËÆÆÁâàÊú¨„Äë
</span></span><span style="display:flex;"><span>Syntax:  gzip_http_version 1.0 | 1.1;
</span></span><span style="display:flex;"><span>Default: gzip_http_version 1.1;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-------------------------------http_gzip_static_module-------------------------------
</span></span><span style="display:flex;"><span>„ÄêÈ¢ÑËØªgzipÂäüËÉΩ„Äë
</span></span><span style="display:flex;"><span>Syntax:  gzip_static on | off | always;
</span></span><span style="display:flex;"><span>Default: gzip_static off;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">.*\.(jpg|gif|png)$</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">gzip</span>    <span style="color:#008080">on</span>;				      <span style="color:#998;font-style:italic">#ÂºÄÂêØÂéãÁº©
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">gzip_http_version</span> <span style="color:#099">1</span><span style="color:#d14">.1</span>;  <span style="color:#998;font-style:italic">#ÁâàÊú¨1.1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">gzip_comp_level</span> <span style="color:#099">2</span>;      <span style="color:#998;font-style:italic">#ÂéãÁº©Á≠âÁ∫ß2
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">gzip_types</span> <span style="color:#d14">text/plain</span> <span style="color:#d14">application/javascript</span> <span style="color:#d14">application/x-javascript</span> <span style="color:#d14">text/css</span> <span style="color:#d14">application/xml</span> <span style="color:#d14">text/javascript</span> <span style="color:#d14">application/x-httpd-php</span> <span style="color:#d14">image/jpeg</span> <span style="color:#d14">image/gif</span> <span style="color:#d14">image/png</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span>    <span style="color:#d14">/opt/nginx/app/gzip/img</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">.*\.(txt|xml)$</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">gzip</span>    <span style="color:#008080">on</span>;             <span style="color:#998;font-style:italic">#ÂºÄÂêØÂéãÁº©
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">gzip_http_version</span> <span style="color:#099">1</span><span style="color:#d14">.1</span>;  <span style="color:#998;font-style:italic">#ÁâàÊú¨1.1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">gzip_comp_level</span> <span style="color:#099">2</span>;      <span style="color:#998;font-style:italic">#ÂéãÁº©Á≠âÁ∫ß2
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">gzip_types</span> <span style="color:#d14">text/plain</span> <span style="color:#d14">application/javascript</span> <span style="color:#d14">application/x-javascript</span> <span style="color:#d14">text/css</span> <span style="color:#d14">application/xml</span> <span style="color:#d14">text/javascript</span> <span style="color:#d14">application/x-httpd-php</span> <span style="color:#d14">image/jpeg</span> <span style="color:#d14">image/gif</span> <span style="color:#d14">image/png</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span>    <span style="color:#d14">/opt/nginx/app/gzip/doc</span>;
</span></span><span style="display:flex;"><span>}  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">^/download</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">gzip_static</span> <span style="color:#008080">on</span>;     <span style="color:#998;font-style:italic">#ÂºÄÂêØgzipÈ¢ÑËØªÂèñÔºåÂøÖÈ°ªË¶ÅÂ≠òÂú®gzipÂéãÁº©Êñá‰ª∂
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">tcp_nopush</span> <span style="color:#008080">on</span>;      <span style="color:#998;font-style:italic">#ÂºÄÂêØtcp_nopushÔºåÁ¥ØËÆ°ÂåÖ‰∏ÄËµ∑ÂèëÈÄÅ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">root</span>    <span style="color:#d14">/opt/nginx/app/gzip</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÖçÁΩÆNginxÊµèËßàÂô®ÁºìÂ≠òÁõ∏ÂÖ≥</strong></p>
<p><img src="/img/nginx/cache-read.png" alt="cache-read"></p>
<ul>
<li>Ê£ÄÈ™åÊòØÂê¶ËøáÊúüÁöÑÊñπÊ≥ïÔºöexpires„Äêhttp1.0„Äë„ÄÅCache-control(max-age)„Äêhttp1.1„Äë</li>
</ul>
<p>Áõ∏ÂÖ≥ËØ≠Ê≥ï</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>----------------------------------http_headers_module---------------------------------
</span></span><span style="display:flex;"><span>„ÄêËÆæÁΩÆÁºìÂ≠òËøáÊúüÊó∂Èó¥„Äë
</span></span><span style="display:flex;"><span>Syntax:  expires [modified] time;
</span></span><span style="display:flex;"><span>Default: expires off;
</span></span><span style="display:flex;"><span>Context: http, server, location, if in location
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂìçÂ∫îÂ§¥ËøîÂõûmax-age=86400,‰ΩÜÊµèËßàÂô®ÂèØËÉΩ‰ºöÂèëÈÄÅmax-age=0Âπ∂‰∏ç‰ΩøÁî®ÔºåÁõÆÁöÑÊòØÊØèÊ¨°‰∫§‰∫íÊãøÂà∞ÊúÄÊñ∞Êï∞ÊçÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">.*\.html$</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">expires</span> <span style="color:#d14">24h</span>; 
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span> <span style="color:#d14">/opt/nginx/app/expires</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Ë∑®ÂüüËÆøÈóÆ</strong></p>
<p>‰∏∫ÈÅøÂÖçCSRFÊîªÂáªÔºåÊµèËßàÂô®ÈªòËÆ§Á¶ÅÊ≠¢Ë∑®ÂüüËÆøÈóÆ„ÄÇ‰ΩÜÂõ†‰∏∫‰∏öÂä°ËÆæËÆ°ÊàñËÄÖÂÖ∂ÂÆÉÂéüÂõ†Êàë‰ª¨ÊúâÊó∂ÈúÄË¶ÅÊâìÂºÄË∑®ÂüüËÆøÈóÆ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>---------------------------------http_headers_module----------------------------------
</span></span><span style="display:flex;"><span>„ÄêÊ∑ªÂä†Access-Control-Allow-Origin‰∏éAccess-Control-Allow-MethodsËØ∑Ê±ÇÂ§¥„Äë
</span></span><span style="display:flex;"><span>Syntax:	 add_header name value [always];
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location, if in location
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">server</span> {		
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">listen</span>       <span style="color:#099">81</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server_name</span>  <span style="color:#d14">www.kun.com</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">.*\.html$</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">root</span>    <span style="color:#d14">/opt/nginx/app/oringin</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">#Ë¢´ÂèëËµ∑ajaxËØ∑Ê±ÇÁöÑÈ°µÈù¢ÂºÄÂêØÂÖÅËÆ∏Ë∑®ÂüüËÆøÈóÆÔºå*‰ª£Ë°®ÂÖÅËÆ∏ÊâÄÊúâipË∑®ÂüüËÆøÈóÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">add_header</span>  <span style="color:#d14">Access-Control-Allow-Origin</span>  <span style="color:#d14">http://192.168.1.155</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">add_header</span>  <span style="color:#d14">Access-Control-Allow-Methods</span> <span style="color:#d14">GET,POST,PUT,DELETE,OPTIONS</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Âü∫‰∫éhttp_referÈò≤ÁõóÈìæ</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>----------------------------------http_referer_module---------------------------------
</span></span><span style="display:flex;"><span>„ÄêÊúâÊïàÁöÑreferers‰ø°ÊÅØÔºånone‰ª£Ë°®Á©∫Ôºåblock‰ª£Ë°®ÂÖÅËÆ∏‰∏çÂ∏¶ÂçèËÆÆ‰ø°ÊÅØÁöÑ„Äë
</span></span><span style="display:flex;"><span>Syntax:	 valid_referers none | blocked | server_names | string ...;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">.*\.(jpg|gif|png)$</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#ÂÖÅËÆ∏ÁöÑreferers‰ø°ÊÅØÔºånone‰ª£Ë°®Á©∫Ôºåblock‰ª£Ë°®ÂÖÅËÆ∏‰∏çÂ∏¶ÂçèËÆÆ‰ø°ÊÅØÁöÑ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">valid_referers</span> <span style="color:#d14">none</span> <span style="color:#d14">blocked</span> <span style="color:#099">192</span><span style="color:#d14">.168.1.155</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#ÂΩìinvalid_referer‰ø°ÊÅØÊó†ÊïàÊó∂$invalid_referer‰∏∫1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">if</span> <span style="color:#d14">(</span><span style="color:#008080">$invalid_referer</span><span style="color:#d14">)</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">403</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span>    <span style="color:#d14">/opt/nginx/app/gzip/img</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#------------------------------------------------------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#curl -I http://192.168.1.155/wei.png  ËøîÂõû200
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#curl -I http://192.168.1.155/wei.png -e &#34;http://www.baidu.com&#34;	ËøîÂõû403
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="nginx‰Ωú‰∏∫‰ª£ÁêÜÊúçÂä°">Nginx‰Ωú‰∏∫‰ª£ÁêÜÊúçÂä°</h3>
<p><img src="/img/nginx/proxy-type.png" alt="proxy-type"></p>
<p><strong>Ê≠£Âêë‰ª£ÁêÜ&amp;ÂèçÂêë‰ª£ÁêÜ</strong></p>
<p>Ê≠£Âêë‰ª£ÁêÜÔºöÂÆ¢Êà∑Á´ØÊòéÁ°ÆË¶ÅÂà∞ËææÁöÑÁõÆÁöÑÊúçÂä°Âô®ÔºåÂçïÊó†Ê≥ïËá™Â∑±ÂéªËÆøÈóÆÔºåÂÄüÂä©Ê≠£Âêë‰ª£ÁêÜËÆøÈóÆÁõÆÁöÑÊúçÂä°Âô®ÔºåÂ¶ÇÁøªÂ¢ô„ÄÅÈÄöËøá‰∏ÄÂè∞ËÉΩ‰∏äÁΩëÁöÑ‰∏ªÊú∫‰ª£ÁêÜ‰∏äÁΩë</p>
<p>Ê≠£Âêë‰ª£ÁêÜÔºöÂÆ¢Êà∑Á´ØÁü•ÈÅìË¶ÅËÆøÈóÆÁöÑÊúçÂä°Âô®‰ΩÜÊòØÂπ∂‰∏ç‰∫ÜËß£ÊúÄÁªàÊèê‰æõÊúçÂä°ÁöÑÊúçÂä°Âô®ÔºåÂ¶ÇËÆøÈóÆ/adminÂíå/merchantÂÆûÈôÖË¢´‰ª£ÁêÜÂà∞‰∏§Êù°‰∏çÂêåÊúçÂä°Âô®</p>
<p><strong>Ê≠£Âêë‰ª£ÁêÜÂå∫Âà´ÂíåÂèçÂêë‰ª£ÁêÜÁöÑÂå∫Âà´Âú®‰∫é‰ª£ÁêÜÁöÑÂØπË±°‰∏ç‰∏ÄÊ†∑</strong></p>
<ul>
<li>Ê≠£Âêë‰ª£ÁêÜ‰ª£ÁêÜÁöÑÂØπË±°ÊòØÂÆ¢Êà∑Á´Ø</li>
<li>ÂèçÂêë‰ª£ÁêÜ‰ª£ÁêÜÁöÑÂØπË±°ÊòØÊúçÂä°Âô®</li>
</ul>
<p>ÈÖçÁΩÆ‰ª£ÁêÜ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>-----------------------------------http_proxy_module---------------------------------
</span></span><span style="display:flex;"><span>„ÄêËÆæÁΩÆ‰ª£ÁêÜÁöÑÁõÆÁöÑÂú∞ÂùÄ„Äë
</span></span><span style="display:flex;"><span>Syntax:  proxy_pass URL;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: location, if in location, limit_except
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÁºìÂ≠òÁõ∏ÂÖ≥„ÄÅÊòØÂê¶Â∞ΩÂèØËÉΩÂ§öÁöÑÁºìÂ≠òÂìçÂ∫î‰ø°ÊÅØÁÑ∂Âêé‰∏ÄÊ¨°ÊÄßÂèëÈÄÅÁªôÂÆ¢Êà∑Á´Ø„Äë
</span></span><span style="display:flex;"><span>Syntax:  proxy_buffering on | off;
</span></span><span style="display:flex;"><span>Default: proxy_buffering on;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Syntax:  proxy_buffer_size size;
</span></span><span style="display:flex;"><span>Default: proxy_buffer_size 4k|8k;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Syntax:	 proxy_buffers number size;
</span></span><span style="display:flex;"><span>Default: proxy_buffers 8 4k|8k;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Syntax:  proxy_busy_buffers_size size;
</span></span><span style="display:flex;"><span>Default: proxy_busy_buffers_size 8k|16k;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÈáçÂÆöÂêëÁõ∏ÂÖ≥„ÄÅÂØπÈáçÂÆöÂêëÁöÑ‰ø°ÊÅØÊòØÂê¶ÈáçÂÜô„Äë
</span></span><span style="display:flex;"><span>Syntax:	 proxy_redirect default;
</span></span><span style="display:flex;"><span>         proxy_redirect off;
</span></span><span style="display:flex;"><span>         proxy_redirect redirect replacement;
</span></span><span style="display:flex;"><span>Default: proxy_redirect default;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêËØ∑Ê±ÇÁõ∏ÂÖ≥„ÄÅÊõ¥ÊîπËØ∑Ê±Ç‰ø°ÊÅØ„Äë
</span></span><span style="display:flex;"><span>Syntax:	 proxy_set_header field value;
</span></span><span style="display:flex;"><span>Default: proxy_set_header Host $proxy_host;
</span></span><span style="display:flex;"><span>         proxy_set_header Connection close;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Syntax:  proxy_hide_header field;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Syntax:  proxy_set_body value;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêË∂ÖÊó∂Áõ∏ÂÖ≥„Äë
</span></span><span style="display:flex;"><span>Syntax:	 proxy_connect_timeout time;
</span></span><span style="display:flex;"><span>Default: proxy_connect_timeout 60s;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Syntax:	 proxy_read_timeout time;
</span></span><span style="display:flex;"><span>Default: proxy_read_timeout 60s;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Syntax:	 proxy_send_timeout time;
</span></span><span style="display:flex;"><span>Default: proxy_send_timeout 60s;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#---------------------------------------ÂèçÂêë‰ª£ÁêÜ--------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">listen</span>       <span style="color:#099">81</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server_name</span>  <span style="color:#d14">www.kun.com</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">root</span>    <span style="color:#d14">/opt/nginx/app/proxy</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËÆæÁΩÆÂèçÂêë‰ª£ÁêÜ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">^/proxy.html$</span> {				
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">proxy_pass</span> <span style="color:#d14">http://192.168.1.155:81</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#--------------------------------------httpÊ≠£Âêë‰ª£ÁêÜ------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#ÈÖçÁΩÆDNSËß£ÊûêIPÂú∞ÂùÄÔºå‰ª•ÂèäË∂ÖÊó∂Êó∂Èó¥Ôºà5ÁßíÔºâ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">resolver</span> <span style="color:#099">8</span><span style="color:#d14">.8.8.8</span>;    <span style="color:#998;font-style:italic"># ÂøÖÈúÄ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">resolver_timeout</span> <span style="color:#d14">5s</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">#ÈÖçÁΩÆÊ≠£Âêë‰ª£ÁêÜÂèÇÊï∞
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">proxy_pass</span> <span style="color:#d14">http://</span><span style="color:#008080">$host$request_uri</span>;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">#ËÆæÁΩÆËØ∑Ê±ÇÂ§¥‰ø°ÊÅØ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">proxy_set_header</span> <span style="color:#d14">Host</span> <span style="color:#008080">$http_host</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_set_header</span> <span style="color:#d14">X-Real-IP</span> <span style="color:#008080">$remote_addr</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">#ÈáçÂÆöÂêëËÆæÁΩÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#d14">proxy_redirect</span> <span style="color:#d14">default</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">#ËÆæÁΩÆË∂ÖÊó∂Êó∂Èó¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">proxy_connect_timeout</span> <span style="color:#099">30</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_send_timeout</span> <span style="color:#d14">60s</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_read_timeout</span> <span style="color:#d14">60s</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">#ÈÖçÁΩÆÁºìÂ≠òÂ§ßÂ∞è
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">proxy_buffering</span> <span style="color:#008080">on</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_buffer_size</span> <span style="color:#099">32k</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_buffers</span> <span style="color:#099">8</span> <span style="color:#099">128k</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_busy_buffers_size</span> <span style="color:#099">256k</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">#ÂÖ≥Èó≠Á£ÅÁõòÁºìÂ≠òËØªÂÜôÂáèÂ∞ëI/O
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">proxy_max_temp_file_size</span> <span style="color:#099">256k</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#-------------------------------------httpsÊ≠£Âêë‰ª£ÁêÜ------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">server{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d14">resolver</span> <span style="color:#099">8</span><span style="color:#d14">.8.8.8</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">access_log</span> <span style="color:#d14">/var/log/nginx/access_proxy-443.log</span> <span style="color:#d14">main</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">listen</span> <span style="color:#099">443</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>    	<span style="color:#000;font-weight:bold">root</span> <span style="color:#d14">html</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#000;font-weight:bold">index</span> <span style="color:#d14">index.html</span> <span style="color:#d14">index.htm</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#000;font-weight:bold">proxy_pass</span> <span style="color:#d14">https://</span><span style="color:#008080">$host$request_uri</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#000;font-weight:bold">proxy_buffers</span> <span style="color:#099">8</span> <span style="color:#099">128k</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#000;font-weight:bold">proxy_max_temp_file_size</span> <span style="color:#099">0k</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#000;font-weight:bold">proxy_connect_timeout</span> <span style="color:#099">30</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#000;font-weight:bold">proxy_send_timeout</span> <span style="color:#099">60</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#000;font-weight:bold">proxy_read_timeout</span> <span style="color:#099">60</span>;
</span></span><span style="display:flex;"><span>    	<span style="color:#000;font-weight:bold">proxy_next_upstream</span> <span style="color:#d14">error</span> <span style="color:#d14">timeout</span> <span style="color:#d14">invalid_header</span> <span style="color:#d14">http_502</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">error_page</span> <span style="color:#099">500</span> <span style="color:#099">502</span> <span style="color:#099">503</span> <span style="color:#099">504</span> <span style="color:#d14">/50x.html</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">location</span> = <span style="color:#d14">/50x.html</span> {
</span></span><span style="display:flex;"><span>    	<span style="color:#000;font-weight:bold">root</span> <span style="color:#d14">html</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#curl --proxy proxy.cn:443 http://www.alipay.comÊµãËØï‰ª£ÁêÜÊòØÂê¶ÂèØÁî®
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="nginx‰Ωú‰∏∫Ë¥üËΩΩÂùáË°°ÊúçÂä°">Nginx‰Ωú‰∏∫Ë¥üËΩΩÂùáË°°ÊúçÂä°</h3>
<p><img src="/img/nginx/Load-balancing.png" alt="Load-balancing"></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>--------------------------------stream_upstream_module--------------------------------
</span></span><span style="display:flex;"><span>Syntax:  upstream name { ... }
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: stream
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„Äêurl_hashÁ≠ñÁï•„Äë
</span></span><span style="display:flex;"><span>Syntax:	 hash key [consistent];
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: upstream
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÂêéÁ´ØÊúçÂä°Âô®Âú®Ë¥üËΩΩÂùáË°°Ë∞ÉÂ∫¶‰∏≠ÁöÑÁä∂ÊÄÅ</p>
<table>
<thead>
<tr>
<th>Áä∂ÊÄÅ</th>
<th>Ëß£Èáä</th>
</tr>
</thead>
<tbody>
<tr>
<td>down</td>
<td>ÂΩìÂâçserverÊöÇÊó∂‰∏çÂèÇ‰∏éË¥üËΩΩÂùáË°°</td>
</tr>
<tr>
<td>backup</td>
<td>È¢ÑÁïôÁöÑÂ§á‰ªΩÊúçÂä°Âô®ÔºåÂΩìÊèê‰æõÊúçÂä°ÁöÑserverÂÆïÊú∫È°∂‰∏ä,ÊÅ¢Â§çÊó∂ÈöêÈÄÄ</td>
</tr>
<tr>
<td>max_fails</td>
<td>ÂÖÅËÆ∏ËØ∑Ê±ÇÂ§±Ë¥•ÁöÑÊ¨°Êï∞</td>
</tr>
<tr>
<td>fail_timeout</td>
<td>ÁªèËøámax_failsÂ§±Ë¥•ÂêéÔºåÊúçÂä°ÊöÇÂÅúÁöÑÊó∂Èó¥</td>
</tr>
<tr>
<td>max_conns</td>
<td>ÈôêÂà∂ÊúÄÂ§ßÁöÑÊé•Êî∂ÁöÑËøûÊé•Êï∞</td>
</tr>
</tbody>
</table>
<p>Ë∞ÉÂ∫¶ÁÆóÊ≥ï</p>
<table>
<thead>
<tr>
<th>ÁÆóÊ≥ï</th>
<th>ÁÆÄ‰ªã</th>
</tr>
</thead>
<tbody>
<tr>
<td>ËΩÆËØ¢</td>
<td>ÈªòËÆ§ÁÆóÊ≥ïÔºåÊåâÊó∂Èó¥È°∫Â∫èÈÄê‰∏ÄÂàÜÈÖçÂà∞‰∏çÂêåÁöÑÂêéÁ´ØÊúçÂä°Âô®</td>
</tr>
<tr>
<td>weight</td>
<td>Âä†ÊùÉËΩÆËØ¢weightÂÄºË∂äÂ§ßÔºåÂàÜÈÖçËÆøÈóÆÂá†ÁéáË∂äÈ´ò</td>
</tr>
<tr>
<td>ip_hash</td>
<td>ÊØè‰∏™ËØ∑Ê±ÇÊåâËÆøÈóÆipÁöÑhashÁªìÊûúÂàÜÈÖç</td>
</tr>
<tr>
<td>least_conn</td>
<td>ËøûÊé•Êï∞ÊúÄÂ∞ëÁöÑÊú∫Âô®Ë¢´ËøûÊé•</td>
</tr>
<tr>
<td>hash ÂÖ≥ÈîÆÊï∞ÂÄº</td>
<td>hashËá™ÂÆö‰πâÁöÑkey</td>
</tr>
</tbody>
</table>
<p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">upstream</span> <span style="color:#d14">app</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#ip_hash;             #Á≠ñÁï•ÈÖçÁΩÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">#hash  $request_uri;  #‰ΩøÁî®uri‰Ωú‰∏∫hashÁöÑkey
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">server</span> 192.168.1.158:<span style="color:#099">8001</span> <span style="color:#d14">backup</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server</span> 192.168.1.158:<span style="color:#099">8002</span> <span style="color:#d14">down</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server</span> 192.168.1.158:<span style="color:#099">8003</span> <span style="color:#d14">max_fails=3</span> <span style="color:#d14">fail_timeout=30s</span> <span style="color:#d14">weight=3</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_pass</span> <span style="color:#d14">http://app</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="nginx‰Ωú‰∏∫ÁºìÂ≠òÊúçÂä°">Nginx‰Ωú‰∏∫ÁºìÂ≠òÊúçÂä°</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>----------------------------------http_proxy_module----------------------------------
</span></span><span style="display:flex;"><span>„ÄêÁºìÂ≠òÊñá‰ª∂ÂÆö‰πâ„Äë
</span></span><span style="display:flex;"><span>Syntax:  proxy_cache_path path [levels=levels] [use_temp_path=on|off] keys_zone=name:size [inactive=time] [max_size=size] [manager_files=number] [manager_sleep=time] [manager_threshold=time] [loader_files=number] [loader_sleep=time] [loader_threshold=time] [purger=on|off] [purger_files=number] [purger_sleep=time] [purger_threshold=time];
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÊòØÂê¶ÂºÄÂêØÁºìÂ≠ò„Äë
</span></span><span style="display:flex;"><span>Syntax:	proxy_cache zone | off;
</span></span><span style="display:flex;"><span>Default:	
</span></span><span style="display:flex;"><span>proxy_cache off;
</span></span><span style="display:flex;"><span>Context:	http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÁºìÂ≠òËøáÊúüÂë®Êúü„Äë
</span></span><span style="display:flex;"><span>Syntax:  proxy_cache_valid [code ...] time;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêÁºìÂ≠òÁöÑÁª¥Â∫¶„Äë
</span></span><span style="display:flex;"><span>Syntax:  proxy_cache_key string;
</span></span><span style="display:flex;"><span>Default: proxy_cache_key $scheme$proxy_host$request_uri;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê∏ÖÈô§ÊåáÂÆöÁºìÂ≠òÁöÑÊñπÂºè</p>
<ul>
<li>rm -rf ÁºìÂ≠òÁõÆÂΩï</li>
<li>Á¨¨‰∏âÊñπÊâ©Â±ïÊ®°Âùóngx_cache_purge</li>
</ul>
<p>ÈÉ®ÂàÜÈ°µÈù¢‰∏çÁºìÂ≠òÊñπÂºè</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Syntax:  proxy_no_cache string ...;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">upstream</span> <span style="color:#d14">app</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server</span> 192.168.1.158:<span style="color:#099">8001</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server</span> 192.168.1.158:<span style="color:#099">8002</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server</span> 192.168.1.158:<span style="color:#099">8003</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÁºìÂ≠òÊñá‰ª∂ÈÖçÁΩÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂèÇÊï∞‰ΩçÁΩÆ1ÔºöË∑ØÂæÑ„ÄêÁõÆÂΩïÂøÖÈ°ªÂ≠òÂú®„Äë
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂèÇÊï∞‰ΩçÁΩÆ2ÔºöÁõÆÂΩïÁªìÊûÑÔºåÊé®Ëçê1:2
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂèÇÊï∞‰ΩçÁΩÆ3ÔºözoneÂêçÁß∞:zoneÁ©∫Èó¥Â§ßÂ∞è„Äê1mÂ§ßÁ∫¶ËÉΩÂ≠ò8ÂçÉkey‰ø°ÊÅØ„Äë
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂèÇÊï∞‰ΩçÁΩÆ4ÔºöÁºìÂ≠òÊñá‰ª∂ÊúÄÂ§ßÂç†Áî®Á©∫Èó¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂèÇÊï∞‰ΩçÁΩÆ5ÔºöÊüê‰∏™ÁºìÂ≠òÂú®inactiveÊåáÂÆöÁöÑÊó∂Èó¥ÂÜÖÂ¶ÇÊûú‰∏çËÆøÈóÆÔºåÂ∞Ü‰ºö‰ªéÁºìÂ≠ò‰∏≠Âà†Èô§
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂèÇÊï∞‰ΩçÁΩÆ6ÔºöÊòØÂê¶‰ΩøÁî®‰∏¥Êó∂Ë∑ØÂæÑÂ≠òÂÇ®ÔºåÂª∫ËÆÆÂÖ≥Èó≠
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">proxy_cache_path</span> <span style="color:#d14">/var/cache/nginx/app</span> <span style="color:#d14">levels=1:2</span> <span style="color:#d14">keys_zone=proxy_cache_zone:10m</span> <span style="color:#d14">max_size=10g</span> <span style="color:#d14">inactive=60m</span> <span style="color:#d14">use_temp_path=off</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_cache</span> <span style="color:#d14">proxy_cache_zone</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_cache_valid</span> <span style="color:#099">200</span> <span style="color:#099">304</span> <span style="color:#d14">12h</span>;                   <span style="color:#998;font-style:italic">#200„ÄÅ304ÂìçÂ∫î‰øùÂ≠ò12Â∞èÊó∂
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">proxy_cache_valid</span> <span style="color:#d14">any</span> <span style="color:#099">10m</span>;                       <span style="color:#998;font-style:italic">#‰ªª‰ΩïÂìçÂ∫î‰øùÂ≠ò10ÂàÜÈíü
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">proxy_cache_key</span> <span style="color:#008080">$host$uri$is_args$args</span>;          <span style="color:#998;font-style:italic">#ÁºìÂ≠òÁöÑkey
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">add_header</span> <span style="color:#d14">Nginx-Cache</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$upstream_cache_status&#34;</span>; <span style="color:#998;font-style:italic">#ËøîÂõûÂâçÁ´ØÂìçÂ∫îÂ§¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#998;font-style:italic">#ÂΩìÂèëÁîüÈîôËØØÊó∂ÈáçÊñ∞ËØ∑Ê±Ç
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">proxy_next_upstream</span> <span style="color:#d14">error</span> <span style="color:#d14">timeout</span> <span style="color:#d14">invalid_header</span> <span style="color:#d14">http_500</span> <span style="color:#d14">http_502</span> <span style="color:#d14">http_503</span> <span style="color:#d14">http_504</span>;	
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_pass</span> <span style="color:#d14">http://app</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Â§ßÊñá‰ª∂ÂàÜÁâáËØ∑Ê±Ç</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>-----------------------------------http_slice_module----------------------------------
</span></span><span style="display:flex;"><span>„ÄêÂ∞ÜËØ∑Ê±ÇÁöÑÂ§ßÊñá‰ª∂ËøõË°åÊãÜÂàÜÔºåÂàÜÂà´ÂêëÂá†Âè∞ÂêéÁ´ØÊúçÂä°Âô®ÂèëÈÄÅËØªÂèñËØ∑Ê±Ç„Äë
</span></span><span style="display:flex;"><span>Syntax:  slice size;
</span></span><span style="display:flex;"><span>Default: slice 0;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ºòÂäøÔºöÊØè‰∏™Â≠êËØ∑Ê±ÇÊî∂Âà∞ÁöÑÊï∞ÊçÆÈÉΩ‰ºöÂΩ¢Êàê‰∏Ä‰∏™Áã¨Á´ãÁöÑÊñá‰ª∂Ôºå‰∏Ä‰∏™ËØ∑Ê±ÇÊñ≠‰∫ÜÔºåÂÖ∂ÂÆÉËØ∑Ê±Ç‰∏çÂèóÂΩ±Âìç</p>
<p>Áº∫ÁÇπÔºösliceËÆæÁΩÆ‰∏çÂêàÁêÜÊó∂ÂèØËÉΩ‰ºöÂØºËá¥Êñá‰ª∂ÊèèËø∞Á¨¶ËÄóÂ∞ΩÁ≠âÊÉÖÂÜµ</p>
<h2 id="ÂÖ≠Âä®ÈùôÂàÜÁ¶ª">ÂÖ≠„ÄÅÂä®ÈùôÂàÜÁ¶ª</h2>
<p>Â∞ÜÂä®ÊÄÅËµÑÊ∫êÂíåÈùôÊÄÅËµÑÊ∫êÂàÜÁ¶ªÔºåÊèêÈ´òÁ®ãÂ∫èÊïàÁéáÔºåÂáèÂ∞ëÊúçÂä°Âô®ÂéãÂäõËÄå‰∏îÂΩìÂêéÂè∞ÊúçÂä°Êó†Ê≥ïÊ≠£Â∏∏Êèê‰æõÊó∂ÈùôÊÄÅÊúçÂä°‰æùÊóßÂèØÁî®„ÄÇÁ≠ñÁï•ÊòØ‰ΩøÁî®Âä®ÊÄÅ‰ª£ÁêÜÁöÑÊñπÂºèËΩ¨ÂèëËØ∑Ê±ÇÂà∞ÂêéÂè∞ÊúçÂä°Âô®„ÄÇ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">upstream</span> <span style="color:#d14">api</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server</span> 192.168.1.117:<span style="color:#099">8080</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">root</span> <span style="color:#d14">/opt/nginx/app/dynamic</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">^/api</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_pass</span> <span style="color:#d14">http://api</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="‰∏ÉrewriteËßÑÂàô">‰∏É„ÄÅrewriteËßÑÂàô</h2>
<p>Â∫îÁî®Âú∫ÊôØÔºö</p>
<ol>
<li>URLËÆøÈóÆË∑≥ËΩ¨ÔºåÊîØÊåÅÂºÄÂèëËÆæËÆ°ÔºàÈ°µÈù¢Ë∑≥ËΩ¨„ÄÅÂÖºÂÆπÊÄßÊîØÊåÅ„ÄÅÂ±ïÁ§∫ÊïàÊûúÁ≠âÔºâ</li>
<li>SEO‰ºòÂåñÔºå‰æø‰∫éÊéíÂêçÈù†Ââç</li>
<li>Áª¥Êä§ÔºàÂêéÂè∞Áª¥Êä§„ÄÅÊµÅÈáèËΩ¨ÂèëÔºâ</li>
<li>ÂÆâÂÖ®</li>
</ol>
<p>ÈÖçÁΩÆËØ≠Ê≥ï</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>---------------------------------http_rewrite_module---------------------------------
</span></span><span style="display:flex;"><span>Syntax:  rewrite regex replacement [flag];
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: server, location, if
</span></span></code></pre></td></tr></table>
</div>
</div><p>flagÈÄâÈ°πËØ¥Êòé</p>
<table>
<thead>
<tr>
<th>ÂÄº</th>
<th>Ëß£Èáä</th>
</tr>
</thead>
<tbody>
<tr>
<td>last</td>
<td>ÂÅúÊ≠¢ÂêéÁª≠rewriteÊåá‰ª§ÈõÜÔºåÂà©Áî®‰øÆÊîπÂêéÁöÑuriÂú®nginx‰∏≠ÈáçÊñ∞ÂåπÈÖç</td>
</tr>
<tr>
<td>break</td>
<td>ÂÅúÊ≠¢ÂêéÁª≠rewriteÊåá‰ª§ÈõÜÔºåË°®Á§∫ÂÆåÊàêrewriteÂØªÊâæÁªìÊûúÊñá‰ª∂</td>
</tr>
<tr>
<td>redirect</td>
<td>ËøîÂõû302‰∏¥Êó∂ÈáçÂÆöÂêëÔºåÂú∞ÂùÄÊ†è‰ºöÊòæÁ§∫Ë∑≥ËΩ¨ÂêéÁöÑÂú∞ÂùÄÔºåÁî®Êà∑‰∏ãÊ¨°ËøòËÆøÈóÆÊ≠§ÈìæÊé•</td>
</tr>
<tr>
<td>permanent</td>
<td>ËøîÂõû301Ê∞∏‰πÖÈáçÂÆöÂêëÔºåÂú∞ÂùÄÊ†è‰ºöÊòæÁ§∫Ë∑≥ËΩ¨ÂêéÁöÑÂú∞ÂùÄÔºåÊµèËßàÂô®‰ºöÁºìÂ≠òÔºåÁî®Êà∑‰∏ãÊ¨°Áõ¥Êé•ËÆøÈóÆÂç≥‰ΩønginxÂÖ≥Èó≠‰πü‰ºöÈáçÂÆöÂêëÈìæÊé•</td>
</tr>
</tbody>
</table>
<p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#------------------------------------break&amp;last--------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËØ∑Ê±Ç http://hostname/last  ‰ºöÂÆö‰ΩçÂà∞/testËøîÂõû200ÂìçÂ∫îÁ†ÅÔºåÊµèËßàÂô®Âú∞ÂùÄ‰∏çÂèò
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËØ∑Ê±Ç http://hostname/break ÂõûÂéªÂØªÊâæroot‰∏ã/testÊñá‰ª∂ÔºåÊâæ‰∏çÂà∞ËøîÂõû404ÂìçÂ∫îÁ†ÅÔºåÊµèËßàÂô®Âú∞ÂùÄ‰∏çÂèò
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">^/break</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">rewrite</span> <span style="color:#d14">^/break</span> <span style="color:#d14">/test</span> <span style="color:#d14">break</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">^/last</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">rewrite</span> <span style="color:#d14">^/last</span> <span style="color:#d14">/test</span> <span style="color:#d14">last</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/test</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">default_type</span> <span style="color:#d14">application/json</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">200</span> <span style="color:#d14">&#39;</span>{<span style="color:#000;font-weight:bold">&#34;status&#34;:&#34;success&#34;}&#39;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#---------------------------------redirect&amp;permanent---------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËØ∑Ê±Ç http://hostname/redirect ‰ºöË¢´‰∏¥Êó∂ÈáçÂÆöÂêëÂà∞www.baidu.com
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËØ∑Ê±Ç http://hostname/permanent ‰ºöË¢´Ê∞∏‰πÖÈáçÂÆöÂêëÂà∞www.baidu.comÔºå‰∏ãÊ¨°‰∏ç‰ºöÂÜçËØ∑Ê±ÇÊ¨°nginx
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">/redirect</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">rewrite</span> <span style="color:#d14">/redirect</span> <span style="color:#d14">http://www.baidu.com</span> <span style="color:#d14">redirect</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">/permanent</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">rewrite</span> <span style="color:#d14">/permanent</span> <span style="color:#d14">http://www.baidu.com</span> <span style="color:#d14">permanent</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>rewirteÂä†ÂÖ•ÊéßÂà∂ÊµÅÁ®ã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Syntax:	 if (condition) { ... }
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: server, location
</span></span></code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>Á¨¶Âè∑</th>
<th>Âê´‰πâ</th>
</tr>
</thead>
<tbody>
<tr>
<td>=Ôºå!=</td>
<td>ÂÅöÊòØÂê¶ÂÆåÂÖ®ÂåπÈÖç</td>
</tr>
<tr>
<td>~Ôºå!~</td>
<td>Âå∫ÂàÜÂ§ßÂ∞èÂÜôÊòØÂê¶ÂåπÈÖçÂ≠óÁ¨¶‰∏≤</td>
</tr>
<tr>
<td>~*Ôºå!~*</td>
<td>‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÊòØÂê¶ÂåπÈÖçÂ≠óÁ¨¶‰∏≤</td>
</tr>
<tr>
<td>-fÔºå!-f</td>
<td>Êñá‰ª∂Â≠òÂú®ÔºåÊñá‰ª∂ÊòØÂê¶Â≠òÂú®</td>
</tr>
<tr>
<td>-dÔºå!-d</td>
<td>ÁõÆÂΩïÂ≠òÂú®ÔºåÁõÆÂΩïÊòØÂê¶Â≠òÂú®</td>
</tr>
<tr>
<td>-e Ôºå!-e</td>
<td>Êñá‰ª∂„ÄÅÁõÆÂΩï„ÄÅÁ¨¶Âè∑ÈìæÊé•ÊòØÂê¶Â≠òÂú®</td>
</tr>
<tr>
<td>-x Ôºå!-x</td>
<td>Êñá‰ª∂ÊòØÂê¶ÂèØÊâßË°å</td>
</tr>
</tbody>
</table>
<p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#http://hostname/course-11-22-33.html‰ºöÂØªÊâæ/opt/nginx/app/course/11/22/course_33.html
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Â¶ÇÊûúÈ°µÈù¢Â≠òÂú®ÂàôËøîÂõûÔºåÂ¶ÇÊûú‰∏çÂ≠òÂú®ÂàôËøîÂõû404
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Â¶ÇÊûúËÆøÈóÆË∑ØÂæÑÊúâËØØÂàôËøõÂÖ•ifÂà§Êñ≠
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Â¶ÇÊûúÊòØchromeÂàôÈáçÂÆöÂêëÂà∞163
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Â¶ÇÊûúÊñá‰ª∂‰∏çÂ≠òÂú®ÂàôÈáçÂÆöÂêëÂà∞baidu
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> ~ <span style="color:#009926">^/course</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">rewrite</span> <span style="color:#d14">/course-(\d+)-(\d+)-(\d+).html</span> <span style="color:#d14">/course/</span><span style="color:#008080">$1/$2/course_$3.html</span> <span style="color:#d14">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> <span style="color:#d14">(</span><span style="color:#008080">$http_user_agent</span> ~<span style="color:#009926">*</span> <span style="color:#d14">chrome)</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">rewrite</span> <span style="color:#d14">^/(.*)</span>$ <span style="color:#d14">http://www.163.com</span> <span style="color:#d14">redirect</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> <span style="color:#d14">(!-f</span> <span style="color:#008080">$request_filename</span><span style="color:#d14">)</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">rewrite</span> <span style="color:#d14">^/(.*)</span>$ <span style="color:#d14">http://www.baidu.com?wd=</span><span style="color:#008080">$1</span> <span style="color:#d14">redirect</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span> <span style="color:#d14">/opt/nginx/app</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>rewirteÁöÑ‰ºòÂÖàÁ∫ßÔºöhttp&gt;server&gt;location</p>
<p>‰æãÔºöÂ∞ÜËØ∑Ê±ÇÂÖ®ÈÉ®ÂÆöÂêëÂà∞Áª¥Êä§È°µ rewrite ^(.*)$ /pages/maintain.html break;</p>
</blockquote>
<h2 id="ÂÖ´https">ÂÖ´„ÄÅHttps</h2>
<h3 id="ÂØπÁß∞Âä†ÂØÜÂéüÁêÜ">ÂØπÁß∞Âä†ÂØÜÂéüÁêÜ</h3>
<p><img src="/img/nginx/sy-encry.png" alt="sy-encry"></p>
<h3 id="ÈùûÂØπÁß∞Âä†ÂØÜÂéüÁêÜ">ÈùûÂØπÁß∞Âä†ÂØÜÂéüÁêÜ</h3>
<p><img src="/img/nginx/asy-encry.png" alt="asy-encry"></p>
<h3 id="httpsÂä†ÂØÜÂéüÁêÜ">HttpsÂä†ÂØÜÂéüÁêÜ</h3>
<p><img src="/img/nginx/https-principle.png" alt="https-principle"></p>
<h3 id="Ëá™Âª∫caËØÅ‰π¶ÁîüÊàêÈùûÂèó‰ø°Êú∫ÊûÑÈ¢ÅÂèë">Ëá™Âª∫CAËØÅ‰π¶ÁîüÊàêÔºàÈùûÂèó‰ø°Êú∫ÊûÑÈ¢ÅÂèëÔºâ</h3>
<p>Ê≠•È™§‰∏ÄÔºöÁîüÊàêkeyÂØÜÈí•</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>openssl genrsa -idea -out kun.key <span style="color:#099">1024</span>       <span style="color:#998;font-style:italic">#idea‰∏∫Âä†ÂØÜÁÆóÊ≥ïÔºåËøáÁ®ã‰∏≠ÈúÄË¶ÅÂ°´ÂÜôÂØÜÁ†ÅÔºåÈúÄË¶ÅËÆ∞‰Ωè</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê≠•È™§‰∫åÔºöÁîüÊàêËØÅ‰π¶Á≠æÂêçËØ∑Ê±ÇÊñá‰ª∂ÔºàCSRÊñá‰ª∂Ôºâ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>openssl req -new -key kun.key -out kun.csr   <span style="color:#998;font-style:italic">#Â¶ÇÊûúÁªôÁ¨¨‰∏âÊñπÊú∫ÊûÑÈúÄË¶ÅÊåâÈúÄÂ°´ÂÜô</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê≠•È™§‰∏âÔºöÁîüÊàêËØÅ‰π¶Á≠æÂêçÊñá‰ª∂ÔºàCAÊñá‰ª∂Ôºâ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>openssl x509 -req -days <span style="color:#099">3650</span> -in kun.csr -signkey kun.key -out kun.crt <span style="color:#998;font-style:italic">#daysÊúâÊïàÊúü</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈôÑkeyËÑ±ÂØÜÊ≠•È™§</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÂΩìkeyÊñá‰ª∂ÊúâÂØÜÁ†ÅÊó∂ÔºåÊØèÊ¨°ÂêØÂä®nginxÂøÖÈ°ªËæìÂÖ•ÂØÜÁ†ÅÔºåÈÄ†Êàê‰∏ç‰æø</span>
</span></span><span style="display:flex;"><span>openssl rsa -in kun.key -out kun_nopass.key
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê†πÊçÆËãπÊûúË¶ÅÊ±ÇÁîüÊàêËØÅ‰π¶ÊñπÂºè</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#1„ÄÅopensslÁâàÊú¨Ë¶ÅÊ±Ç1.2‰ª•‰∏ä</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#2„ÄÅHTTPSËØÅ‰π¶ÂøÖÈ°ª‰ΩøÁî®SHA256‰ª•‰∏äÂìàÂ∏åÁÆóÊ≥ïÁ≠æÂêç</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#3„ÄÅHTTPSËØÅ‰π¶ÂøÖÈ°ª‰ΩøÁî®RSA 2048‰ΩçÊàñECC 256‰ª•‰∏äÂÖ¨Èí•ÁÆóÊ≥ï</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#4„ÄÅ‰ΩøÁî®ÂâçÂêëÂä†ÂØÜÊäÄÊúØ</span>
</span></span><span style="display:flex;"><span>openssl genrsa -idea -out kun.key <span style="color:#099">1024</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#-keyout ‰ºöÈáçÊñ∞ÁîüÊàê‰∏çÈúÄË¶ÅÂØÜÁ†ÅËÆøÈóÆÁöÑkey</span>
</span></span><span style="display:flex;"><span>openssl req -days <span style="color:#099">3650</span> -x509 -sha256 -nodes -newkey rsa:2048 -keyout kun.key -out kun_apple.crt
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÈÖçÁΩÆÂ∫îÁî®">ÈÖçÁΩÆÂ∫îÁî®</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>-----------------------------------http_ssl_module-----------------------------------
</span></span><span style="display:flex;"><span>„ÄêÂºÄÂêØSSlÔºåÊ≠§ËØ≠Ê≥ïÂú®1.15.0‰ª•ÂêéÂ∫üÂºÉÔºåÁõ¥Êé•Âú®ÁõëÂê¨Á´ØÂè£ÂêéÂä†sslÂç≥ÂèØ„Äë
</span></span><span style="display:flex;"><span>Syntax:	 ssl on | off;
</span></span><span style="display:flex;"><span>Default: ssl off;
</span></span><span style="display:flex;"><span>Context: http, server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêcrtÊñá‰ª∂‰ΩçÁΩÆ„Äë
</span></span><span style="display:flex;"><span>Syntax:  ssl_certificate file;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„ÄêkeyÊñá‰ª∂‰ΩçÁΩÆ„Äë
</span></span><span style="display:flex;"><span>Syntax:  ssl_certificate_key file;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: http, server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„Äêssl sessionÁºìÂ≠ò„Äë
</span></span><span style="display:flex;"><span>Syntax:	ssl_session_cache off | none | [builtin[:size]] [shared:name:size];
</span></span><span style="display:flex;"><span>Default: ssl_session_cache none;
</span></span><span style="display:flex;"><span>Context: http, server
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>„Äêssl sessionÁºìÂ≠òÊó∂Èïø„Äë
</span></span><span style="display:flex;"><span>Syntax:	 ssl_session_timeout time;
</span></span><span style="display:flex;"><span>Default: ssl_session_timeout 5m;
</span></span><span style="display:flex;"><span>Context: http, server
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Â¶ÇÊûúcrtÊ≤°ÊúâËÑ±ÂØÜÔºåË¶Å‰ΩøÁî®nginx -c /etc/nginx/nginx.confÂêØÂä®Ôºå‰∏çÂèØ‰ΩøÁî®ÊúçÂä°ÈáçÂêØ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">server{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#ÁõëÂê¨443
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#d14">listen</span> <span style="color:#099">443</span> <span style="color:#d14">ssl</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server_name</span> <span style="color:#d14">localhost</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">ssl_certificate</span> <span style="color:#d14">/etc/nginx/ssl_key/kun.crt</span>;     <span style="color:#998;font-style:italic">#crtÊñá‰ª∂‰ΩçÁΩÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">ssl_certificate_key</span> <span style="color:#d14">/etc/nginx/ssl_key/kun.key</span>; <span style="color:#998;font-style:italic">#keyÊñá‰ª∂‰ΩçÁΩÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">ssl_session_cache</span> <span style="color:#d14">shared:SSL:10m</span>;               <span style="color:#998;font-style:italic">#10mË¥°ÁåÆÁºìÂ≠òÂ§ßÁ∫¶ÂèØÂ≠òÂÇ®8k-10k‰ºöËØù
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">ssl_session_timeout</span> <span style="color:#099">10m</span>;                        <span style="color:#998;font-style:italic">#10ÂàÜÈíüsessionËøáÊúü
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">root</span> <span style="color:#d14">/usr/share/nginx/html</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">index</span> <span style="color:#d14">index.html</span> <span style="color:#d14">index.htm</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Âª∫ËÆÆÊøÄÊ¥ªkeepaliveÈïøËøûÊé•„ÄêÂáèÂ∞ëSSLÊè°ÊâãÁΩëÁªúÁöÑÊ∂àËÄó„ÄëÂíåËÆæÁΩÆssl sessionÁºìÂ≠ò</p>
</blockquote>
<h2 id="‰πùnginx‰∏éluaÂºÄÂèë">‰πù„ÄÅNginx‰∏éLuaÂºÄÂèë</h2>
<p>NginxÁõ¥Êé•‰ΩøÁî®Ê∑ªÂä†LuaÊ®°ÂùóÂ∑≤Áªè‰∏çÂª∫ËÆÆ‰ΩøÁî®Ôºå‰ºöÂ∏¶Êù•ÊïàÁéáÊçüÂ§±ÔºåÂ∑≤Áªè‰∏çÁ®≥ÂÆö„ÄÇÂª∫ËÆÆ‰ΩøÁî®OpenResty„ÄÇ</p>
<p>OpenRestyÊòØ‰∏Ä‰∏™Âü∫‰∫éNginx‰∏éLuaÁöÑÈ´òÊÄßËÉΩWebÂπ≥Âè∞ÔºåÂÖ∂ÂÜÖÈÉ®ÈõÜÊàê‰∫ÜÂ§ßÈáèÁ≤æËâØÁöÑLuaÂ∫ì„ÄÅÁ¨¨‰∏âÊñπÊ®°Âùó‰ª•ÂèäÂ§ßÂ§öÊï∞ÁöÑ‰æùËµñÈ°π„ÄÇÁî®‰∫éÊñπ‰æøÂú∞Êê≠Âª∫ËÉΩÂ§üÂ§ÑÁêÜË∂ÖÈ´òÂπ∂Âèë„ÄÅÊâ©Â±ïÊÄßÊûÅÈ´òÁöÑÂä®ÊÄÅ Web Â∫îÁî®„ÄÅWeb ÊúçÂä°ÂíåÂä®ÊÄÅÁΩëÂÖ≥„ÄÇ</p>
<h3 id="Ê∫êÁ†ÅÂÆâË£ÖÊ≠•È™§">Ê∫êÁ†ÅÂÆâË£ÖÊ≠•È™§</h3>
<p>Á¨¨‰∏ÄÊ≠•ÔºöÂÆâË£ÖpcreÂíåopenssl</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>yum install -y pcre openssl
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∫åÊ≠•ÔºöÊâßË°åÊûÑÂª∫ÂëΩ‰ª§</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÈÖçÁΩÆÂÆâË£ÖÊ®°ÂùóÔºåÂèØÊõ¥ÂÖ∑ÁéØÂ¢ÉËá™Â∑±ÊåëÈÄâÔºå‰ΩøÁî®./configure --helpÂèØÊü•ÁúãÂèØÁºñËØëÊ®°Âùó</span>
</span></span><span style="display:flex;"><span>./configure --prefix<span style="color:#000;font-weight:bold">=</span>/opt/openresty <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>            --with-luajit <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>            --without-http_redis2_module <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>            --with-http_iconv_module 
</span></span><span style="display:flex;"><span>make
</span></span><span style="display:flex;"><span>make install
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∏âÊ≠•ÔºöÂ∞ÜÂëΩ‰ª§Âä†ÂÖ•PATHÂèòÈáè„ÄêÂèØÈÄâ„Äë</p>
<p>Á¨¨ÂõõÊ≠•ÔºöÊµãËØï</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Â∞Ü‰∏Ä‰∏ã‰ª£Á†ÅÂä†ÂÖ•/opt/openresty/nginx/conf/nginx.conf
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/hello_lua</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">default_type</span> <span style="color:#d14">&#39;text/plain&#39;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">content_by_lua</span> <span style="color:#d14">&#39;ngx.say(&#34;hello,</span> <span style="color:#d14">lua&#34;)&#39;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËÆøÈóÆhttp://hostname/hello_luaÊü•ÁúãÊòØÂê¶ÊâìÂç∞Âá∫hello, lua
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="nginxË∞ÉÁî®luaÊ®°ÂùóÊåá‰ª§È°∫Â∫è">NginxË∞ÉÁî®LuaÊ®°ÂùóÊåá‰ª§È°∫Â∫è</h3>
<table>
<thead>
<tr>
<th>ÂëΩ‰ª§</th>
<th>Êó∂Èó¥</th>
</tr>
</thead>
<tbody>
<tr>
<td>init_by_lua„ÄÅinit_by_lua_file</td>
<td>ÂΩìnginx masterËøõÁ®ãÂú®Âä†ËΩΩnginxÈÖçÁΩÆÊñá‰ª∂Êó∂ËøêË°åÊåáÂÆöÁöÑluaËÑöÊú¨ÔºåÈÄöÂ∏∏Áî®Êù•Ê≥®ÂÜå lua ÁöÑÂÖ®Â±ÄÂèòÈáèÊàñÂú®ÊúçÂä°Âô®ÂêØÂä®Êó∂È¢ÑÂä†ËΩΩluaÊ®°ÂùóÂíåÂàÜÈÖçÂÜÖÂ≠ò</td>
</tr>
<tr>
<td>init_worker_by_lua„ÄÅinit_worker_by_lua_file</td>
<td>Âú®ÊØè‰∏™nginx workerËøõÁ®ãÂêØÂä®Êó∂Ë∞ÉÁî®ÊåáÂÆöÁöÑlua‰ª£Á†Å</td>
</tr>
<tr>
<td>set_by_lua„ÄÅset_by_lua_file</td>
<td>ËÆæÁΩÆ‰∏Ä‰∏™ÂèòÈáèÔºåÂ∏∏Áî®‰∏éËÆ°ÁÆó‰∏Ä‰∏™ÈÄªËæëÔºåÁÑ∂ÂêéËøîÂõûÁªìÊûú ËØ•Èò∂ÊÆµ‰∏çËÉΩËøêË°åOutput API„ÄÅControl API„ÄÅSubrequest API„ÄÅCosocket API</td>
</tr>
<tr>
<td>rewrite_by_lua„ÄÅrewrite_by_lua_file</td>
<td>‰Ωú‰∏∫rewriteÈò∂ÊÆµÁöÑÂ§ÑÁêÜÔºå‰∏∫ÊØè‰∏™ËØ∑Ê±ÇÊâßË°åÊåáÂÆöÁöÑlua‰ª£Á†Å</td>
</tr>
<tr>
<td>access_by_luaÔºåaccess_by_lua_file</td>
<td>ÊØè‰∏™ËØ∑Ê±ÇÂú®ËÆøÈóÆÈò∂ÊÆµÁöÑË∞ÉÁî®luaËÑöÊú¨ËøõË°åÂ§ÑÁêÜ</td>
</tr>
<tr>
<td>content_by_luaÔºåcontent_by_lua_file</td>
<td>‰Ωú‰∏∫‚Äúcontent handler‚Äù‰∏∫ÊØè‰∏™ËØ∑Ê±ÇÊâßË°ålua‰ª£Á†ÅÔºå‰∏∫ËØ∑Ê±ÇËÄÖËæìÂá∫ÂìçÂ∫îÂÜÖÂÆπ</td>
</tr>
<tr>
<td>header_filter_by_luaÔºåheader_filter_by_lua_file</td>
<td>‰∏ÄËà¨Áî®Êù•ËÆæÁΩÆcookieÂíåheaders</td>
</tr>
<tr>
<td>body_filter_by_luaÔºåbody_filter_by_lua_file</td>
<td>‰∏ÄËà¨‰ºöÂú®‰∏ÄÊ¨°ËØ∑Ê±Ç‰∏≠Ë¢´Ë∞ÉÁî®Â§öÊ¨°, Âõ†‰∏∫ËøôÊòØÂÆûÁé∞Âü∫‰∫é HTTP 1.1 chunked ÁºñÁ†ÅÁöÑÊâÄË∞ì‚ÄúÊµÅÂºèËæìÂá∫‚ÄùÁöÑ</td>
</tr>
<tr>
<td>log_by_luaÔºålog_by_lua_file</td>
<td>Âú®logÈò∂ÊÆµË∞ÉÁî®ÊåáÂÆöÁöÑluaËÑöÊú¨ÔºåÂπ∂‰∏ç‰ºöÊõøÊç¢access logÔºåËÄåÊòØÂú®ÈÇ£‰πãÂêéËøõË°åË∞ÉÁî®</td>
</tr>
</tbody>
</table>
<h3 id="nginx-lua-api">Nginx Lua API</h3>
<table>
<thead>
<tr>
<th>ÂêçÁß∞</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td>ngx.cookie_time</td>
<td>ËÆæÁΩÆcookieÊó∂Èó¥</td>
</tr>
<tr>
<td>ngx.ctx</td>
<td>ÂΩìÂâçËØ∑Ê±ÇÁöÑ‰∏ä‰∏ãÊñá</td>
</tr>
<tr>
<td>ngx.exec</td>
<td>ÂÜÖÈÉ®ÈáçÂÆöÂêë</td>
</tr>
<tr>
<td>ngx.var</td>
<td>nginxÂèòÈáè</td>
</tr>
<tr>
<td>ngx.req.get_header</td>
<td>Ëé∑ÂèñËØ∑Ê±ÇÂ§¥</td>
</tr>
<tr>
<td>ngx.req.get_url_args</td>
<td>Ëé∑ÂèñurlËØ∑Ê±ÇÂèÇÊï∞</td>
</tr>
<tr>
<td>ngx.redirct</td>
<td>ÈáçÂÆöÂêë</td>
</tr>
<tr>
<td>ngx.print</td>
<td>ËæìÂá∫ÂìçÂ∫îÂÜÖÂÆπ‰Ωì</td>
</tr>
<tr>
<td>ngx.say</td>
<td>Âêångx.printÔºåÂçï‰ºöÂä†ÂÖ•Êç¢Ë°åÁ¨¶</td>
</tr>
</tbody>
</table>
<h2 id="ÂçÅÂ∏∏ËßÅÈóÆÈ¢ò">ÂçÅ„ÄÅÂ∏∏ËßÅÈóÆÈ¢ò</h2>
<h3 id="server_nameÂ§öËôöÊãü‰∏ªÊú∫‰ºòÂÖàÁ∫ßËÆøÈóÆ">server_nameÂ§öËôöÊãü‰∏ªÊú∫‰ºòÂÖàÁ∫ßËÆøÈóÆ</h3>
<p>ÂΩìÂá∫Áé∞ÂêåÂêçÂêåÁ´ØÂè£ÁöÑËôöÊãü‰∏ªÊú∫Êó∂ÔºånginxÂú®Âä†ËΩΩÈÖçÁΩÆÊó∂‰ºöÊä•ÂÜ≤Á™ÅË≠¶ÂëäÔºå‰ΩÜÊòØ‰∏ç‰ºöÊä•Èîô„ÄÇ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">listen</span> <span style="color:#099">80</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server_name</span> <span style="color:#d14">www.test_server1.com</span> <span style="color:#d14">www.kun.com</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">}</span>
</span></span><span style="display:flex;"><span><span style="color:#d14">server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">listen</span> <span style="color:#099">80</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server_name</span> <span style="color:#d14">www.test_server2.com</span> <span style="color:#d14">www.kun.com</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">#......
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#a61717;background-color:#e3d2d2">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>‰ΩøÁî®<code>www.test_server1.com</code>ÊàñËÄÖ<code>www.test_server2.com</code>ËÆøÈóÆ‰ºöÂÆö‰ΩçÂà∞Áõ∏Â∫îÁöÑËôöÊãü‰∏ªÊú∫</li>
<li>‰ΩøÁî®<code>www.kun.com</code>ËÆøÈóÆ‰ºöÂÆö‰ΩçÂà∞Á¨¨‰∏Ä‰∏™ÂåπÈÖçÁöÑËôöÊãü‰∏ªÊú∫ÔºåÂç≥Âíå<code>www.test_server1.com</code>ÂêåÂè∞</li>
<li>‰ΩøÁî®IPÂú∞ÂùÄËÆøÈóÆ‰ºöÂåπÈÖçÁ¨¨‰∏Ä‰∏™Âá∫Áé∞ÁöÑËôöÊãü‰∏ªÊú∫ÔºåÂç≥Âíå<code>www.test_server1.com</code>ÂêåÂè∞</li>
</ul>
<h3 id="locationÂåπÈÖç‰ºòÂÖàÁ∫ß">LocationÂåπÈÖç‰ºòÂÖàÁ∫ß</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Syntax:	 location [ = | ~ | ~* | ^~ ] uri { ... }
</span></span><span style="display:flex;"><span>         location @name { ... }
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>~ </code>Âíå<code>~* </code>ÂâçÁºÄË°®Á§∫Ê≠£Âàôlocation</p>
<p><code>=</code>Ôºå<code>^~ </code>„ÄÅ<code>@ </code>Âíå<code>Êó†‰ªª‰ΩïÂâçÁºÄ</code>ÁöÑÈÉΩÂ±û‰∫éÊôÆÈÄölocation</p>
<p>ÂåπÈÖç‰ºòÂÖàÁ∫ß</p>
<ul>
<li>ÊôÆÈÄölocation‰ºòÂÖàÁ∫ßÂ§ß‰∫éÊ≠£Âàôlocation</li>
<li>ÊôÆÈÄölocationÂåπÈÖçÊó∂Á≤æÁ°ÆÂåπÈÖç<code>=</code>Á∫ßÂà´ÊúÄÈ´òÔºå<code>^~</code>Â¶ÇÊûúÂêåÊó∂ÂåπÈÖç‰∏äÂ§ö‰∏™ÔºåÂåπÈÖçÈïøÂ∫¶ÊúÄÈïøÁöÑ‰ºòÂÖàÔºàÊúÄÂ§ßÂâçÁºÄÂåπÈÖçÔºâ</li>
<li>Ê≠£ÂàôlocationÂåπÈÖçÊó∂Ë∞ÅÁâ©ÁêÜÈ°∫Â∫èÂÖàÔºåË∞ÅÊúÄ‰ºòÂÖà</li>
<li>ÂΩìÊôÆÈÄölocation‰∏≠ÁöÑÂâçÁºÄÂåπÈÖçÂíåÊ≠£ÂàôÂåπÈÖçÂùáÂ≠òÂú®Êó∂„ÄÇÂåπÈÖçÂà∞ÊúÄÂ§ßÂâçÁºÄÂåπÈÖç‰πãÂêéÁªßÁª≠Ê≠£ÂàôÂåπÈÖçÔºåÂ¶ÇÊûúÊ≠£ÂàôÂåπÈÖç‰∏äÂàôË¶ÜÁõñÂâçÁºÄÂåπÈÖçÁªìÊûú</li>
<li>Â¶ÇÊûú‰ΩøÁî®<code>=</code>ÊàñËÄÖ<code>^~</code>Êó∂Ôºå‰ºöÁªàÊ≠¢ÂêéÁª≠ÁöÑÊ≠£ÂàôÂåπÈÖç</li>
</ul>
<h3 id="try_filesÁöÑ‰ΩøÁî®">try_filesÁöÑ‰ΩøÁî®</h3>
<p>ÂΩìËµÑÊ∫êÊñá‰ª∂Êú™ÊâæÂà∞Êó∂ÁöÑËá™ÂÆö‰πâÂ§ÑÁêÜ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Syntax:	 try_files file ... uri;
</span></span><span style="display:flex;"><span>         try_files file ... =code;
</span></span><span style="display:flex;"><span>Default: ‚Äî
</span></span><span style="display:flex;"><span>Context: server, location
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÈÖçÁΩÆÁ§∫‰æã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span>   <span style="color:#d14">/opt/nginx/app/try_files</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">try_files</span> <span style="color:#008080">$uri</span>  <span style="color:#d14">@resource_not_ready</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËµÑÊ∫êÊú™ÊâæÂà∞ÔºåÁõ¥Êé•ËøîÂõûÈ°µÈù¢
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">@resource_not_ready</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> <span style="color:#d14">&#34;200&#34;</span> <span style="color:#d14">&#34;ËµÑÊ∫êÊú™ÂáÜÂ§áÂ•ΩÔºåËØ∑Á®çÂêéÂÜçËØï&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="aliasÂíårootÂå∫Âà´">aliasÂíårootÂå∫Âà´</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#----------------------------------------root----------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/request_path/image/</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">root</span> <span style="color:#d14">/local_path/image/</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËÆøÈóÆ http:www.kun.com/request_path/image/cat.png
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Êñá‰ª∂ /local_path/image/request_path/image/cat.png
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#----------------------------------------root----------------------------------------
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/request_path/image/</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">alias</span> <span style="color:#d14">/local_path/image/</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËÆøÈóÆ http:www.kun.com/request_path/image/cat.png
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Êñá‰ª∂ /local_path/image/cat.png
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="Â¶Ç‰ΩïËé∑ÂèñÁî®Êà∑ÁöÑÁúüÂÆûip">Â¶Ç‰ΩïËé∑ÂèñÁî®Êà∑ÁöÑÁúüÂÆûIP</h3>
<p><img src="/img/nginx/Real-IP.png" alt="Real-IP"></p>
<p>Âú®Á¨¨‰∏ÄÂ±Ç‰ª£ÁêÜËÆæÁΩÆ<code>X-Real-IP</code>ÔºåÂêéÁª≠‰ª£ÁêÜ‰∏çÂèØËÆæÁΩÆÊ≠§Â§¥‰ø°ÊÅØ</p>
<h3 id="Â∏∏ËßÅÈîôËØØÁ†Å">Â∏∏ËßÅÈîôËØØÁ†Å</h3>
<p>Nginx:413 Request Entity Too Large</p>
<p>ÂéüÂõ†ÔºöÁî®Êà∑‰∏ä‰º†Êñá‰ª∂Êó∂Â§ßÂ∞èÂèóÈôêÔºàÊñá‰ª∂‰ø°ÊÅØÂú®request bodyÂÜÖÔºâ</p>
<p>Ëß£ÂÜ≥ÊñπÊ°àÔºöÂêàÁêÜËÆæÁΩÆclient_max_body_sizeÂ§ßÂ∞è</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Syntax:  client_max_body_size size;
</span></span><span style="display:flex;"><span>Default: client_max_body_size 1m;
</span></span><span style="display:flex;"><span>Context: http, server, location
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<p>502 bad gateway</p>
<p>ÂéüÂõ†ÔºöÂêéÁ´ØÊúçÂä°Êú™ÂìçÂ∫î</p>
<hr>
<p>504 Gateway Time-out</p>
<p>ÂéüÂõ†ÔºöÂêéÁ´ØÊúçÂä°ÊâßË°åË∂ÖÊó∂</p>
<h2 id="ÂçÅ‰∏ÄnginxÊÄßËÉΩ‰ºòÂåñ">ÂçÅ‰∏Ä„ÄÅNginxÊÄßËÉΩ‰ºòÂåñ</h2>
<h3 id="Êñá‰ª∂Âè•ÊüÑËÆæÁΩÆ">Êñá‰ª∂Âè•ÊüÑËÆæÁΩÆ</h3>
<p><strong>Á≥ªÁªüÊéßÂà∂</strong></p>
<p>‰øÆÊîπ<code>/etc/security/limits.conf</code>ÈÖçÁΩÆÔºåÊ∑ªÂä†nginxÁî®Êà∑ÈôêÂà∂</p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">nginx    hard    nproc    65535
nginx    soft    nproc    65535
</code></pre><p><strong>nginxÂÜÖÈÉ®ÊéßÂà∂</strong></p>
<p>Ê≠§ËÆæÁΩÆÂÄºË¶ÅËÆæÁΩÆÊØîÁ≥ªÁªüÊéßÂà∂Â∞è</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">worker_rlimit_core</span> <span style="color:#099">65535</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="cpu‰∫≤Âíå">CPU‰∫≤Âíå</h3>
<p>‰ΩøÁî®<code>cat /proc/cpuinfo | grep &quot;processor&quot;</code>Êü•ÁúãÂΩìÂâçCPUÊ†∏ÂøÉÊï∞</p>
<p>‰ΩøÁî®<code>ps -eo pid,args,psr |grep nginx</code>Êü•ÁúãËøõÁ®ãËøêË°åÂú®Âì™‰∫õCPUÊ†∏ÂøÉ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">worker_processes</span>  <span style="color:#099">4</span>;                     <span style="color:#998;font-style:italic">#ËÆæÁΩÆnginxËøõÁ®ãÊï∞Âª∫ËÆÆÂíåCPUÊ†∏ÂøÉÊï∞‰∏ÄËá¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#worker_cpu_affinity 0001 0010 0100 1000 #ÊåáÂÆöÁªëÂÆöÁöÑCPUÊ†∏ÂøÉ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#worker_cpu_affinity auto;               #Ëá™Âä®ÁªëÂÆö
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÈÄöÁî®ÈÖçÁΩÆ‰ºòÂåñ">ÈÄöÁî®ÈÖçÁΩÆ‰ºòÂåñ</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">user</span>  <span style="color:#d14">nginx</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">worker_processes</span>  <span style="color:#099">4</span>;      <span style="color:#998;font-style:italic">#Âª∫ËÆÆÂíåCPUÊ†∏ÂøÉÊï∞‰∏ÄËá¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">worker_cpu_affinity</span> <span style="color:#d14">auto</span>; <span style="color:#998;font-style:italic">#Ëá™Âä®ÁªëÂÆö
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">error_log</span>  <span style="color:#d14">/var/log/nginx/error.log</span> <span style="color:#d14">warn</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">pid</span>        <span style="color:#d14">/var/run/nginx.pid</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">events</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">use</span> <span style="color:#d14">epoll</span>;                  <span style="color:#998;font-style:italic">#‰ΩøÁî®epollÊ®°Âºè
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">worker_connections</span>  <span style="color:#099">10240</span>;  <span style="color:#998;font-style:italic">#Ë∞ÉËäÇËøûÊé•Êï∞
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">http</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">include</span>       <span style="color:#d14">/etc/nginx/mime.types</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">default_type</span>  <span style="color:#d14">application/octet-stream</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">charset</span> <span style="color:#d14">utf-8</span>;     <span style="color:#998;font-style:italic">#ËÆæÁΩÆÂ≠óÁ¨¶ÈõÜ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">log_format</span>  <span style="color:#d14">main</span>  <span style="color:#d14">&#39;</span><span style="color:#008080">$remote_addr</span> <span style="color:#d14">-</span> <span style="color:#008080">$remote_user</span> <span style="color:#d14">[</span><span style="color:#008080">$time_local]</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$request&#34;</span> <span style="color:#d14">&#39;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#d14">&#39;</span><span style="color:#008080">$status</span> <span style="color:#008080">$body_bytes_sent</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$http_referer&#34;</span> <span style="color:#d14">&#39;</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#d14">&#39;&#34;</span><span style="color:#008080">$http_user_agent&#34;</span> <span style="color:#d14">&#34;</span><span style="color:#008080">$http_x_forwarded_for&#34;&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">access_log</span>  <span style="color:#d14">/var/log/nginx/access.log</span>  <span style="color:#d14">main</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">sendfile</span>        <span style="color:#008080">on</span>;     <span style="color:#998;font-style:italic">#‰ΩøÁî®sendfile
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">tcp_nopush</span>      <span style="color:#008080">on</span>;     <span style="color:#998;font-style:italic">#Â∞ΩÈáèÂ§öÁöÑÂêàÂπ∂ÂåÖÂèëÈÄÅ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">#tcp_nodeny     on;     #ÂÆûÊó∂ÊÄßËæÉÈ´òÁöÑÂú∫ÊâÄÂèØ‰ΩøÁî®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">keepalive_timeout</span>  <span style="color:#099">65</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">gzip</span>  <span style="color:#008080">on</span>;                   <span style="color:#998;font-style:italic">#ÂºÄÂêØÂéãÁº©
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">gzip_disable</span> <span style="color:#d14">&#34;MIS</span> <span style="color:#d14">[1-6]\.&#34;</span>; <span style="color:#998;font-style:italic">#ÂØπIEÂÖ≥Èó≠
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">gzip_http_version</span> <span style="color:#099">1</span><span style="color:#d14">.1</span>;      <span style="color:#998;font-style:italic">#ÁâàÊú¨1.1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">include</span> <span style="color:#d14">/etc/nginx/conf.d/*.conf</span>;
</span></span><span style="display:flex;"><span>}                 
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂçÅ‰∫ånginx_luaÈò≤ÁÅ´Â¢ô">ÂçÅ‰∫å„ÄÅNginx_LuaÈò≤ÁÅ´Â¢ô</h2>
<p>ngx_lua_wafÂêØÂä®Êó∂‰ºöÊä•ÈîôÔºå‰ΩÜÊòØÂèØ‰ª•‰ΩøÁî®ÔºåÂª∫ËÆÆ‰ΩøÁî®ÂÆòÊñπÁöÑ<a href="https://docs.nginx.com/nginx/admin-guide/dynamic-modules/nginx-waf">wafÊ®°Âùó</a></p>
<p><a href="https://github.com/loveshell/ngx_lua_waf">Nginx-LuaÂºÄÊ∫êÈò≤ÁÅ´Â¢ô‰∏ãËΩΩÂú∞ÂùÄ</a></p>
<p><strong>ÂÆâË£ÖÊ≠•È™§</strong></p>
<ul>
<li>
<p>Á¨¨‰∏ÄÊ≠•ÔºöÊñ∞Âª∫Êñá‰ª∂Â§πÊîæÁΩÆwaf</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Â≠òÊîæNginx_Lua</span>
</span></span><span style="display:flex;"><span>mkdir /etc/nginx/waf
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Á¨¨‰∫åÊ≠•ÔºöËß£ÂéãÊñá‰ª∂ÂΩìwafÁõÆÂΩï‰∏ã</p>
</li>
<li>
<p>Á¨¨‰∏âÊ≠•Ôºönginx.confÁöÑhttpÊÆµÂä†ÂÖ•ÈÖçÁΩÆ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">lua_package_path</span> <span style="color:#d14">&#34;/etc/nginx/waf/?.lua&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">lua_shared_dict</span> <span style="color:#d14">limit</span> <span style="color:#099">10m</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">init_by_lua_file</span>   <span style="color:#d14">/etc/nginx/waf/init.lua</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">access_by_lua_file</span> <span style="color:#d14">/etc/nginx/waf/waf.lua</span>;
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Á¨¨ÂõõÊ≠•Ôºö‰øÆÊîπ<code>/etc/nginx/waf/config.lua</code></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span>RulePath <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;/etc/nginx/waf/wafconf/&#34;</span>    <span style="color:#998;font-style:italic">--wafconfËßÑÂàôÁõÆÂΩïÊñá‰ª∂</span>
</span></span><span style="display:flex;"><span>attacklog <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;on&#34;</span>                        <span style="color:#998;font-style:italic">--ÊòØÂê¶ÂºÄÂêØÊó•Âøó</span>
</span></span><span style="display:flex;"><span>logdir <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;/var/log/nginx/hack/&#34;</span>         <span style="color:#998;font-style:italic">--hackÊñá‰ª∂Â§πÈúÄË¶ÅÊñ∞Âª∫</span>
</span></span><span style="display:flex;"><span>UrlDeny<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;on&#34;</span>                            <span style="color:#998;font-style:italic">--ÊòØÂê¶Êã¶Êà™urlËÆøÈóÆ</span>
</span></span><span style="display:flex;"><span>Redirect<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;on&#34;</span>                           <span style="color:#998;font-style:italic">--Êã¶Êà™ÂêéÊòØÂê¶ÈáçÂÆöÂêë</span>
</span></span><span style="display:flex;"><span>CookieMatch<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;on&#34;</span>                        <span style="color:#998;font-style:italic">--ÊòØÂê¶Êã¶Êà™cookieÊîªÂáª</span>
</span></span><span style="display:flex;"><span>postMatch<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;on&#34;</span>                          <span style="color:#998;font-style:italic">--ÊòØÂê¶Êã¶Êà™postÊîªÂáª</span>
</span></span><span style="display:flex;"><span>whiteModule<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;on&#34;</span>                        <span style="color:#998;font-style:italic">--ÊòØÂê¶ÂºÄÂêØURLÁôΩÂêçÂçï</span>
</span></span><span style="display:flex;"><span>black_fileExt<span style="color:#000;font-weight:bold">=</span>{<span style="color:#d14">&#34;php&#34;</span>,<span style="color:#d14">&#34;jsp&#34;</span>}             <span style="color:#998;font-style:italic">--Â°´ÂÜô‰∏çÂÖÅËÆ∏‰∏ä‰º†Êñá‰ª∂ÂêéÁºÄÁ±ªÂûã</span>
</span></span><span style="display:flex;"><span>ipWhitelist<span style="color:#000;font-weight:bold">=</span>{<span style="color:#d14">&#34;127.0.0.1&#34;</span>}               <span style="color:#998;font-style:italic">--ipÁôΩÂêçÂçïÔºåÂ§ö‰∏™ipÁî®ÈÄóÂè∑ÂàÜÈöî</span>
</span></span><span style="display:flex;"><span>ipBlocklist<span style="color:#000;font-weight:bold">=</span>{<span style="color:#d14">&#34;1.0.0.1&#34;</span>}                 <span style="color:#998;font-style:italic">--ipÈªëÂêçÂçïÔºåÂ§ö‰∏™ipÁî®ÈÄóÂè∑ÂàÜÈöî</span>
</span></span><span style="display:flex;"><span>CCDeny<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;on&#34;</span>                             <span style="color:#998;font-style:italic">--ÊòØÂê¶ÂºÄÂêØÊã¶Êà™ccÊîªÂáª</span>
</span></span><span style="display:flex;"><span>CCrate<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;100/60&#34;</span>                         <span style="color:#998;font-style:italic">--ËÆæÁΩÆccÊîªÂáªÈ¢ëÁéáÔºåÂçï‰Ωç‰∏∫Áßí.ÊØèÂàÜÈíüÈªòËÆ§ÈíüÂêå‰∏Ä‰∏™IPÂè™ËÉΩËØ∑Ê±ÇÂêå‰∏Ä‰∏™Âú∞ÂùÄ100Ê¨°</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--Ë≠¶ÂëäÂÜÖÂÆπ,ÂèØÂú®‰∏≠Êã¨Âè∑ÂÜÖËá™ÂÆö‰πâ</span>
</span></span><span style="display:flex;"><span>html<span style="color:#000;font-weight:bold">=</span>[[
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>html xmlns<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;http://www.w3.org/1999/xhtml&#34;</span><span style="color:#000;font-weight:bold">&gt;&lt;</span>head<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>meta http<span style="color:#000;font-weight:bold">-</span>equiv<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;Content-Type&#34;</span> content<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;text/html; charset=utf-8&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>title<span style="color:#000;font-weight:bold">&gt;</span><span style="color:#a61717;background-color:#e3d2d2">ÁΩëÁ´ôÈò≤ÁÅ´Â¢ô</span><span style="color:#000;font-weight:bold">&lt;/</span>title<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>style<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>p {
</span></span><span style="display:flex;"><span>        line<span style="color:#000;font-weight:bold">-</span>height:<span style="color:#099">20</span>px;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>ul{ list<span style="color:#000;font-weight:bold">-</span>style<span style="color:#000;font-weight:bold">-</span>type:none;}
</span></span><span style="display:flex;"><span>li{ list<span style="color:#000;font-weight:bold">-</span>style<span style="color:#000;font-weight:bold">-</span>type:none;}
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;/</span>style<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;/</span>head<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>body style<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34; padding:0; margin:0; font:14px/1.5 Microsoft Yahei, ÂÆã‰Ωì,sans-serif; color:#555;&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ÈáçÊñ∞Âä†ËΩΩnginxÈÖçÁΩÆÊñá‰ª∂Âç≥ÂèØ</p>
</li>
</ul>
<h2 id="ÈôÑÂΩï">ÈôÑÂΩï</h2>
<h3 id="curlÂëΩ‰ª§">curlÂëΩ‰ª§</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>curl http://www.baidu.com                                      <span style="color:#998;font-style:italic">#‰ªÖËøîÂõûÊúçÂä°Á´ØÁöÑÁöÑÂìçÂ∫îÊä•Êñá</span>
</span></span><span style="display:flex;"><span>curl -v http://www.baidu.com &gt;/dev/null                        <span style="color:#998;font-style:italic">#ËøîÂõûËØ∑Ê±ÇÂ§¥ÂíåÂìçÂ∫îÂ§¥‰ø°ÊÅØÂπ∂Â∞ÜÂìçÂ∫îÊä•ÊñáÈáçÂÆöÂêëÁ©∫ËÆæÂ§á</span>
</span></span><span style="display:flex;"><span>curl -I http://192.168.1.155/wei.png                           <span style="color:#998;font-style:italic">#I‰ªÖÊü•ÁúãËøîÂõûÂ§¥‰ø°ÊÅØ</span>
</span></span><span style="display:flex;"><span>curl -I http://192.168.1.155/wei.png -e <span style="color:#d14">&#34;http://www.baidu.com&#34;</span> <span style="color:#998;font-style:italic">#eËÆæÁΩÆrefererÂÄº</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="abÂëΩ‰ª§">abÂëΩ‰ª§</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ab -n50 -c20 http://www.baidu.com/       <span style="color:#998;font-style:italic">#ÂéãÊµãÂëΩ‰ª§Ôºån‰ª£Ë°®ËØ∑Ê±ÇÊÄª‰∏™Êï∞Ôºåc‰ª£Ë°®ÂêåÊó∂Âπ∂Âèë‰∏™Êï∞</span>
</span></span><span style="display:flex;"><span>ab -n50 -c20 -k http://www.baidu.com/    <span style="color:#998;font-style:italic">#-k‰ª£Ë°®ÈïøËøûÊé• </span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊåáÊ†áÂ±ïÁ§∫</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>Server Software:        BWS/1.1
</span></span><span style="display:flex;"><span>Server Hostname:        www.baidu.com
</span></span><span style="display:flex;"><span>Server Port:            80
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Document Path:          /
</span></span><span style="display:flex;"><span>Document Length:        153380 bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Concurrency Level:      20              #Âπ∂ÂèëÁ∫ßÂà´
</span></span><span style="display:flex;"><span>Time taken for tests:   3.636 seconds   #Ëä±Ë¥πÊÄªÊó∂Êâç
</span></span><span style="display:flex;"><span>Complete requests:      50              #ÂÆåÊàêËØ∑Ê±Ç‰∏™Êï∞
</span></span><span style="display:flex;"><span>Failed requests:        45              #Â§±Ë¥•‰∏™Êï∞
</span></span><span style="display:flex;"><span>   (Connect: 0, Receive: 0, Length: 45, Exceptions: 0)
</span></span><span style="display:flex;"><span>Write errors:           0
</span></span><span style="display:flex;"><span>Keep-Alive requests:    0
</span></span><span style="display:flex;"><span>Total transferred:      7728364 bytes
</span></span><span style="display:flex;"><span>HTML transferred:       7680157 bytes
</span></span><span style="display:flex;"><span>Requests per second:    13.75 [#/sec] (mean)          #QPS„ÄêÊØèÁßíËØ∑Ê±ÇÈáè„Äë
</span></span><span style="display:flex;"><span>Time per request:       1454.312 [ms] (mean)          #‰∏Ä‰∏™ËØ∑Ê±ÇÊ∂àËÄóÁöÑÊó∂Èó¥
</span></span><span style="display:flex;"><span>Time per request:       72.716 [ms] (mean, across all concurrent requests) #ÊúçÂä°Á´ØÂ§ÑÁêÜËØ∑Ê±ÇÊó∂Èó¥Ôºå‰∏çÂåÖÂê´ÁΩëÁªúÊó∂Èó¥
</span></span><span style="display:flex;"><span>Transfer rate:          2075.82 [Kbytes/sec] received                      #ÁΩëÁªú‰º†ËæìÈÄüÁéá
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Connection Times (ms)
</span></span><span style="display:flex;"><span>              min  mean[+/-sd] median   max
</span></span><span style="display:flex;"><span>Connect:        4    8   2.0      9      14
</span></span><span style="display:flex;"><span>Processing:   358 1288 716.1   1075    3609
</span></span><span style="display:flex;"><span>Waiting:        9  196 157.0    193     576
</span></span><span style="display:flex;"><span>Total:        366 1296 716.6   1086    3617
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Percentage of the requests served within a certain time (ms)
</span></span><span style="display:flex;"><span>  50%   1086						
</span></span><span style="display:flex;"><span>  66%   1408
</span></span><span style="display:flex;"><span>  75%   1570
</span></span><span style="display:flex;"><span>  80%   1932
</span></span><span style="display:flex;"><span>  90%   2421
</span></span><span style="display:flex;"><span>  95%   2853
</span></span><span style="display:flex;"><span>  98%   3617
</span></span><span style="display:flex;"><span>  99%   3617
</span></span><span style="display:flex;"><span> 100%   3617 (longest request)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="gzipÂëΩ‰ª§">gzipÂëΩ‰ª§</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gzip ‚Äìc filename &gt; filename.gz  <span style="color:#998;font-style:italic">#ÂéãÁº©‰∏∫gzipÊ†ºÂºèÔºåÂπ∂‰øùÁïôÊ∫êÊñá‰ª∂</span>
</span></span><span style="display:flex;"><span>gunzip filename                 <span style="color:#998;font-style:italic">#Ëß£ÂéãgzipÊñá‰ª∂haproxy</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
    </div>

    

    <div class="container-comment-giscus">
        <script src="https://giscus.app/client.js"
        data-repo="loveminimal/comment"
        data-repo-id="R_kgDOJNJQ8g"
        data-category="General"
        data-category-id="DIC_kwDOJNJQ8s4CYl0m"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="noborder_light"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
        </script>
</div>
</div>

        </div>
        <div id="footer"><div class="container-footer">
    

    <div class="beian">
        
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41092802000242">
            

        </a>

        
        <a href="//beian.miit.gov.cn" target="_blank">
            
            <span class="some">icp...<span>
            
        </a>
    </div>

    
    <div class="info">
        
        <a href="https://github.com/loveminimal/hugo-theme-virgo">üïäÔ∏è</a> 2016 - <span id="info-date"></span>
    </div>

</div></div>
        <div class="cool-after" style="
            
                background-color: rgba(255, 255, 255, 0.49); 
                backdrop-filter: saturate(100%) blur(6px);
            
            "></div>
    </body>
</html>
