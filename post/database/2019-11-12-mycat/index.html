<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="MyCatçš„ä½¿ç”¨ - https://hobocat.github.io/post/database/2019-11-12-mycat/">
    <meta name="author" content="Jack - https://hobocat.github.io/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>MyCatçš„ä½¿ç”¨</title>
    
    <base target="_blank">
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    
    
    
    
    <link rel="stylesheet" href="https://hobocat.github.io/style.min.94e7ed14b48117025ebd1148adc11f7268f1ebf50d97297ac663edf1aa6f52dc.css">
    
    <script>const DARK =  false ;</script>
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div class="container-floating-box">
	<div class="box box1"></div>
	<div class="box box11"></div>
	<div class="box box12"></div>
	<div class="box box2"></div>
	<div class="box box3"></div>
	<div class="box box4"></div>
	<div class="box box5"></div>
	<div class="box box6"></div>
	<div class="box box7"></div>
	<div class="box box8"></div>
	<div class="box box9"></div>
</div>
        <div class="cool-before" style="background: url('/imgs/bg/wallhaven-6qr21l.jpg') left top/100% no-repeat fixed;"></div>
        <div id="header" class=""><div class="container-header">

    
    
    
    <div class="right">
        
        <h1 class="title">MyCatçš„ä½¿ç”¨</h1>
    
        
        
            <div id="toc">ğŸ“œ</div>
        
    </div>
</div>
</div>
        <div id="content">










<div class="container-main container-page ">

    

    
    
    
    <div class="rel">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </div>
    
    

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="7409" width="12" height="12">
                <path
                    d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z"
                    p-id="7410" fill="#adb5bd"></path>
            </svg>
            2019-11-12&nbsp;&nbsp;&nbsp;
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="23838" width="11" height="11">
                <path
                    d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z"
                    p-id="23839" fill="#adb5bd"></path>
            </svg>
            2024-05-15&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="33866" width="12" height="12">
                <path
                    d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z"
                    fill="#adb5bd" p-id="33867"></path>
                <path
                    d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z"
                    fill="#adb5bd" p-id="33868"></path>
            </svg>
            7460 å­—</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="32892" width="12" height="12">
                <path
                    d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z"
                    p-id="32893" fill="#adb5bd"></path>
                <path
                    d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z"
                    p-id="32894" fill="#adb5bd"></path>
            </svg>
            15 åˆ†é’Ÿ</span>
        <div class="container-ctgtag">
	<div class="taxonomy">
		<div class="tag">
			
			
			<a href="/tags/database">database</a>
			
		</div>
	</div>
</div>
        
    </div>

    <div class="toc">
        <div class="container-page-operation">
	<div class="page-operation">
		<div><a href="/"><img src="/imgs/icons/home-2.svg" alt=""></a></div>
		<div><a href="/nav"><img src="/imgs/icons/iov-navigate-1.svg" alt=""></a></div>
		<div><a href="/wiki"><img src="/imgs/icons/wiki.svg" alt=""></a></div>
		<div><a href="/tags"><img src="/imgs/icons/treetags.svg" alt=""></a></div>
		<div id="light-dark"><a><img src="/imgs/icons/moon2.svg" alt=""></a></div>
		<div><a href="#"><img src="/imgs/icons/up2.svg" alt=""></a></div>
	</div>
</div>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#ä¸€mycatæ¦‚è§ˆ">ä¸€ã€MyCatæ¦‚è§ˆ</a>
      <ul>
        <li><a href="#mycatç®€ä»‹">MyCatç®€ä»‹</a></li>
        <li><a href="#mycatçš„åŸºæœ¬å…ƒç´ ">MyCatçš„åŸºæœ¬å…ƒç´ </a></li>
        <li><a href="#å®‰è£…mycat">å®‰è£…MyCat</a></li>
      </ul>
    </li>
    <li><a href="#äºŒmycatæ ¸å¿ƒé…ç½®">äºŒã€MyCatæ ¸å¿ƒé…ç½®</a>
      <ul>
        <li><a href="#serverxmlç›¸å…³é…ç½®">server.xmlç›¸å…³é…ç½®</a></li>
        <li><a href="#rulexmlç›¸å…³é…ç½®">rule.xmlç›¸å…³é…ç½®</a></li>
        <li><a href="#schemaxmlç›¸å…³é…ç½®">schema.xmlç›¸å…³é…ç½®</a></li>
      </ul>
    </li>
    <li><a href="#ä¸‰æ•°æ®åº“çš„å‚ç›´åˆ‡åˆ†">ä¸‰ã€æ•°æ®åº“çš„å‚ç›´åˆ‡åˆ†</a>
      <ul>
        <li><a href="#å‚ç›´åˆ‡åˆ†é…ç½®ç¤ºä¾‹">å‚ç›´åˆ‡åˆ†é…ç½®ç¤ºä¾‹</a></li>
        <li><a href="#å‚ç›´åˆ‡åˆ†çš„ä¼˜ç¼ºç‚¹">å‚ç›´åˆ‡åˆ†çš„ä¼˜ç¼ºç‚¹</a></li>
      </ul>
    </li>
    <li><a href="#å››æ•°æ®åº“çš„æ°´å¹³åˆ‡åˆ†">å››ã€æ•°æ®åº“çš„æ°´å¹³åˆ‡åˆ†</a>
      <ul>
        <li><a href="#åˆ†ç‰‡åçš„æŸ¥è¯¢å¤„ç†">åˆ†ç‰‡åçš„æŸ¥è¯¢å¤„ç†</a></li>
        <li><a href="#åˆ†ç‰‡é”®çš„é€‰æ‹©">åˆ†ç‰‡é”®çš„é€‰æ‹©</a></li>
        <li><a href="#æ°´å¹³åˆ‡åˆ†é…ç½®ç¤ºä¾‹">æ°´å¹³åˆ‡åˆ†é…ç½®ç¤ºä¾‹</a></li>
        <li><a href="#æ°´å¹³åˆ‡åˆ†å¼•å‘ä¸»é”®é—®é¢˜">æ°´å¹³åˆ‡åˆ†å¼•å‘ä¸»é”®é—®é¢˜</a></li>
      </ul>
    </li>
    <li><a href="#äº”mycaté«˜å¯ç”¨æ­å»º">äº”ã€MyCaté«˜å¯ç”¨æ­å»º</a>
      <ul>
        <li><a href="#mycaté›†ç¾¤æ­å»º">MyCaté›†ç¾¤æ­å»º</a></li>
        <li><a href="#mycatè‡ªèº«é«˜å¯ç”¨">MyCatè‡ªèº«é«˜å¯ç”¨</a></li>
      </ul>
    </li>
    <li><a href="#å…­mycatç›‘æ§">å…­ã€MyCatç›‘æ§</a>
      <ul>
        <li><a href="#ä½¿ç”¨mycatç”Ÿæˆæ‰§è¡Œsqlè®°å½•">ä½¿ç”¨MyCatç”Ÿæˆæ‰§è¡ŒSQLè®°å½•</a></li>
        <li><a href="#mycatå‘½ä»¤è¡Œç®¡ç†å·¥å…·">MyCatå‘½ä»¤è¡Œç®¡ç†å·¥å…·</a></li>
        <li><a href="#mycatçš„guiç®¡ç†å·¥å…·">MyCatçš„GUIç®¡ç†å·¥å…·</a></li>
      </ul>
    </li>
    <li><a href="#ä¸ƒmycatçš„é™åˆ¶">ä¸ƒã€MyCatçš„é™åˆ¶</a>
      <ul>
        <li><a href="#mycatä¸æ”¯æŒçš„sqlè¯­å¥">MyCatä¸æ”¯æŒçš„SQLè¯­å¥</a></li>
        <li><a href="#å¯¹äº‹åŠ¡çš„æ”¯æŒæœ‰é™xa-äº‹åŠ¡">å¯¹äº‹åŠ¡çš„æ”¯æŒæœ‰é™ï¼ˆXA äº‹åŠ¡ï¼‰</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div class='content  content-card'>
        <h2 id="ä¸€mycatæ¦‚è§ˆ">ä¸€ã€MyCatæ¦‚è§ˆ</h2>
<h3 id="mycatç®€ä»‹">MyCatç®€ä»‹</h3>
<p>â€‹	æ”¯æŒå¯¹MySQLç­‰æ•°æ®åº“è¿›è¡Œå‚ç›´åˆ‡åˆ†ï¼Œæ°´å¹³åˆ‡åˆ†å¹¶å®ç°äº†è¯»å†™åˆ†ç¦»å’Œè´Ÿè½½å‡è¡¡çš„æ•°æ®åº“ä¸­é—´ä»¶</p>
<h3 id="mycatçš„åŸºæœ¬å…ƒç´ ">MyCatçš„åŸºæœ¬å…ƒç´ </h3>
<p><strong>é€»è¾‘åº“</strong>
<img src="/img/mycat/Logic-library.png" style='float:right;margin-rigth:100px;padding:3px; zoom:35%;' /></p>
<ul>
<li>
<p>å¯¹äºåº”ç”¨æ¥è¯´ç›¸å½“äºMySQLçš„æ•°æ®åº“</p>
</li>
<li>
<p>é€»è¾‘åº“å¯å¯¹åº”åç«¯çš„å¤šä¸ªç‰©ç†æ•°æ®åº“</p>
</li>
<li>
<p>é€»è¾‘åº“å¹¶ä¸ä¿å­˜æ•°æ®</p>
</li>
</ul>
<hr>
<p><strong>é€»è¾‘è¡¨</strong>
<img src="/img/mycat/Logic-table.png" style='float:right;margin-rigth:100px;padding:3px; zoom:35%;' /></p>
<ul>
<li>å¯¹äºåº”ç”¨æ¥è¯´ç›¸å½“äºMySQLçš„æ•°æ®è¡¨</li>
<li>é€»è¾‘è¡¨å¯å¯¹åº”åç«¯çš„å¤šä¸ªç‰©ç†æ•°æ®è¡¨</li>
<li>é€»è¾‘è¡¨å¹¶ä¸ä¿å­˜æ•°æ®</li>
</ul>
<hr>
<p><strong>é€»è¾‘è¡¨çš„ç±»åˆ«</strong></p>
<ul>
<li>æŒ‰ç…§æ˜¯å¦è¢«æ°´å¹³åˆ†ç‰‡åˆ’åˆ†ä¸ºï¼šåˆ†ç‰‡è¡¨äºéåˆ†ç‰‡è¡¨</li>
<li>å…¨å±€è¡¨ï¼šåœ¨æ‰€æœ‰åˆ†ç‰‡æ•°æ®åº“éƒ½å­˜åœ¨çš„è¡¨</li>
<li>ERå…³ç³»è¡¨ï¼šæŒ‰ç…§ERå…³ç³»è¿›è¡Œåˆ†ç‰‡çš„è¡¨ï¼ˆå­è¡¨å’Œå¤«è¡¨å­˜åœ¨äºåŒä¸€æ•°æ®åº“ç¤ºä¾‹ï¼‰</li>
</ul>
<h3 id="å®‰è£…mycat">å®‰è£…MyCat</h3>
<p>å‰ç½®æ¡ä»¶ï¼šJDK7ä»¥ä¸Š</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå»ºç«‹MyCatè¿è¡Œçš„ç³»ç»Ÿè´¦å·</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>adduser mycat
</span></span><span style="display:flex;"><span>groupadd mycat
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬äºŒæ­¥ï¼šè§£å‹MyCatå¹¶å°†ç›®å½•æ‰€å±è€…</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>tar -zxvf Mycat-server-X.Y-RELEASE-linux.tar.gz
</span></span><span style="display:flex;"><span>chgrp -R mycat mycat
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬ä¸‰æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡(/etc/profile)</strong></p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">PATH=$PATH:/opt/mycat/bin
export MYCAT_HOME=/opt/mycat
</code></pre><p><strong>ç¬¬å››æ­¥ï¼šå¯åŠ¨mycat</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>mycat start
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å¦‚æœæµ‹è¯•ç¯å¢ƒå†…å­˜æœ‰é™éœ€è¦ä¿®æ”¹MyCatä¸‹<code>bin/wrapper.conf</code>å½“ä¸­çš„å†…å­˜é™åˆ¶</p>
</blockquote>
<h2 id="äºŒmycatæ ¸å¿ƒé…ç½®">äºŒã€MyCatæ ¸å¿ƒé…ç½®</h2>
<p>æ ¸å¿ƒé…ç½®æ–‡ä»¶æ€»è§ˆ</p>
<p><strong>server.xml</strong>ï¼šé…ç½®ç³»ç»Ÿå‚æ•°ã€ç”¨æˆ·è®¿é—®æƒé™ã€SQLé˜²ç«å¢™ä»¥åŠSQLæ‹¦æˆª</p>
<p><strong>log4j2.xml</strong>ï¼šæ—¥å¿—é…ç½®</p>
<p><strong>schema.xml</strong> - é€»è¾‘åº“ã€é€»è¾‘è¡¨ã€ç‰©ç†åº“å®šä¹‰</p>
<p><strong>rule.xml</strong> - é€»è¾‘è¡¨æ°´å¹³åˆ‡åˆ†è§„åˆ™</p>
<h3 id="serverxmlç›¸å…³é…ç½®">server.xmlç›¸å…³é…ç½®</h3>
<p><strong>ç³»ç»Ÿå‚æ•°é…ç½®</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;system&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- 1ä¸ºå¼€å¯å®æ—¶ç»Ÿè®¡ã€0ä¸ºå…³é—­ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;useSqlStat&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- 1ä¸ºå¼€å¯å…¨å±€ä¸€è‡´æ€§æ£€æµ‹ã€0ä¸ºå…³é—­ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;useGlobleTableCheck&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>  
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- æŒ‡å®šä½¿ç”¨ Mycat å…¨å±€åºåˆ—çš„ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            0 ä¸ºæœ¬åœ°æ–‡ä»¶æ–¹å¼
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            1 ä¸ºæ•°æ®åº“æ–¹å¼
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            2 ä¸ºæ—¶é—´æˆ³åºåˆ—æ–¹å¼
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            3 ä¸ºåˆ†å¸ƒå¼ ZK ID ç”Ÿæˆå™¨
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            4 ä¸º zk é€’å¢ id ç”Ÿæˆã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;sequnceHandlerType&#34;</span><span style="color:#000080">&gt;</span>2<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- 1ä¸ºå¼€å¯mysqlå‹ç¼©åè®® --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;useCompression&#34;&gt;1&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- è®¾ç½®æ¨¡æ‹Ÿçš„MySQLç‰ˆæœ¬å· --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;fakeMySQLVersion&#34;&gt;5.6.20&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!--  è¿™ä¸ªå±æ€§æŒ‡å®šæ¯æ¬¡åˆ†é… Socket Direct Buffer çš„å¤§å° --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;processorBufferChunk&#34;&gt;40960&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- å¤„ç†å™¨ç¼“å†²æ± ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            0: DirectByteBufferPool
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">            1 ByteBufferArena
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;processorBufferPoolType&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- é»˜è®¤æ˜¯65535 64K ç”¨äºsqlè§£ææ—¶æœ€å¤§æ–‡æœ¬é•¿åº¦ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;maxStringLiteralLength&#34;&gt;65535&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- åå°ä»»åŠ¡socketéå»¶è¿Ÿ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;backSocketNoDelay&#34;&gt;1&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- å‰å°ä»»åŠ¡socketéå»¶è¿Ÿ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;frontSocketNoDelay&#34;&gt;1&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- NIOçº¿ç¨‹æ± å¤§å°ç”¨äºå¤„ç†å¼‚æ­¥ä»»åŠ¡ï¼Œéœ€æ±‚å°ï¼Œå»ºè®®è®¾ç½®ä¸ºè¾ƒå°å€¼ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;processorExecutor&#34;&gt;16&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- MyCatæœåŠ¡è¿æ¥ç«¯å£ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;serverPort&#34;&gt;8066&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- MyCatç®¡ç†è¿æ¥ç«¯å£ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;managerPort&#34;&gt;9066&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- è¿æ¥æœ€é•¿é—²ç½®æ—¶é—´ï¼Œè¶…è¿‡æ—¶é—´MyCatä¸»åŠ¨æ–­å¼€è¿æ¥ï¼Œå•ä½æ¯«ç§’ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;idleTimeout&#34;&gt;300000&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- ç›‘å¬ç½‘å¡ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;bindIp&#34;&gt;0.0.0.0&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- å‰ç«¯å†™é˜Ÿåˆ—å¤§å° --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;frontWriteQueueSize&#34;&gt;4096&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- è¿›ç¨‹æ•°é‡ï¼Œé»˜è®¤å’ŒCPUæ ¸æ•°ï¼Œå»ºè®®æœ€å¤§å€¼ä¸ºcpuçš„3å€ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;processors&#34;&gt;32&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!--åˆ†å¸ƒå¼äº‹åŠ¡å¼€å…³
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">           0ä¸ºä¸è¿‡æ»¤åˆ†å¸ƒå¼äº‹åŠ¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">           1ä¸ºè¿‡æ»¤åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆå¦‚æœåˆ†å¸ƒå¼äº‹åŠ¡å†…åªæ¶‰åŠå…¨å±€è¡¨ï¼Œåˆ™ä¸è¿‡æ»¤ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">           2ä¸ºä¸è¿‡æ»¤åˆ†å¸ƒå¼äº‹åŠ¡,ä½†æ˜¯è®°å½•åˆ†å¸ƒå¼äº‹åŠ¡æ—¥å¿—
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;handleDistributedTransactions&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- æ˜¯å¦å¯ç”¨éå †å†…å­˜å¤„ç†è·¨åˆ†ç‰‡ç»“æœé›†ï¼š1å¼€å¯ã€0å…³é—­ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;useOffHeapForMerge&#34;</span><span style="color:#000080">&gt;</span>1<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- å†…å­˜ä¹Ÿå¤§å°ï¼Œå•ä½ä¸ºm --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;memoryPageSize&#34;</span><span style="color:#000080">&gt;</span>1m<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- æº¢å‡ºæ–‡ä»¶ç¼“å†²åŒºå¤§å°ï¼Œå•ä½ä¸ºk --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;spillsFileBufferSize&#34;</span><span style="color:#000080">&gt;</span>1k<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- ä½¿ç”¨æµè¾“å‡ºï¼Œ0ä»£è¡¨å¦ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;useStreamOutput&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- ç³»ç»Ÿä¿ç•™å†…å­˜å¤§å°ï¼Œå•ä½ä¸ºm --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;systemReserveMemorySize&#34;</span><span style="color:#000080">&gt;</span>384m<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!--æ˜¯å¦é‡‡ç”¨zookeeperåè°ƒåˆ‡æ¢  --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;useZKSwitch&#34;</span><span style="color:#000080">&gt;</span>true<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- ä»¥ä¸‹å‚æ•°é»˜è®¤é…ç½®æœªå‡ºç° --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- é»˜è®¤å­—ç¬¦é›† --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;charset&#34;&gt;utf8&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- Sqlæ‰§è¡Œè¶…æ—¶æ—¶é—´ï¼Œå•ä½ç§’ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;sqlExecuteTimeout&#34;&gt;300&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- è¿”å›æ•°æ®é›†é»˜è®¤å¤§å° --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;defaultMaxLimit&#34;&gt;100&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- å…è®¸çš„æœ€å¤§åŒ…å¤§å° --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;maxPacketSize&#34;&gt;104857600&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/system&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>é…ç½®ç”¨æˆ·åŠç”¨æˆ·è®¿é—®æƒé™</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- ç”¨æˆ·å --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;user</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;root&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- å¯†ç  --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;password&#34;</span><span style="color:#000080">&gt;</span>123456<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- æ‰€èƒ½è®¿é—®åˆ°çš„é€»è¾‘åº“,å¯åˆ†é…å¤šä¸ªæ•°æ®åº“ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;schemas&#34;&gt;B1,DB2,DB3...&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;schemas&#34;</span><span style="color:#000080">&gt;</span>TESTDB<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- ä½¿ç”¨åŠ å¯†å¯†ç ç™»é™† --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- &lt;property name=&#34;usingDecrypt&#34;&gt;1&lt;/property&gt; --&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- å¯¹è¡¨çº§DMLæƒé™è®¾ç½® --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- checkï¼šæ˜¯å¦å¯ç”¨è¿™ä¸ªæƒé™
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         dmlé¡ºåºï¼šinsertã€updateã€selectã€deleteï¼ˆtableä¸Šçš„è¡¨ç¤ºä¸ºæ‰€æœ‰åº“ä¸‹çš„é»˜è®¤æƒé™ï¼‰	
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    &lt;privileges check=&#34;false&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">      &lt;schema name=&#34;TESTDB&#34; dml=&#34;0110&#34; &gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        &lt;table name=&#34;tb01&#34; dml=&#34;0000&#34;&gt;&lt;/table&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">        &lt;table name=&#34;tb02&#34; dml=&#34;1111&#34;&gt;&lt;/table&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">      &lt;/schema&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    &lt;/privileges&gt;		
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/user&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;user</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;user&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;password&#34;</span><span style="color:#000080">&gt;</span>user<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;schemas&#34;</span><span style="color:#000080">&gt;</span>TESTDB<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- ç”¨æˆ·æ˜¯å¦æ—¶åªè¯»ç”¨æˆ·åªèƒ½æŸ¥è¯¢æ•°æ®åº“ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;readOnly&#34;</span><span style="color:#000080">&gt;</span>true<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/user&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å¯†ç å¯åŠ å¯†é…ç½®ï¼šMyCatçš„libæ–‡ä»¶ä¸‹æ‰§è¡Œ<code>java -cp Mycat-server-X.Y.Z.jar io.mycat.util.DecryptUtil 0:[user]:[password]</code>åŠ å¯†å¯†ç </p>
</blockquote>
<p><strong>SQLé˜²ç«å¢™ä»¥åŠSQLæ‹¦æˆª</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- 
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">å…¨å±€SQLé˜²ç«å¢™è®¾ç½® 
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  whitehost å…è®¸è®¿é—®çš„åå•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  blacklist-&gt;check æ˜¯å¦å¯ç”¨é»‘åå•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;firewall&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;whitehost&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;host</span> <span style="color:#008080">host=</span><span style="color:#d14">&#34;127.0.0.1&#34;</span> <span style="color:#008080">user=</span><span style="color:#d14">&#34;mycat&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;host</span> <span style="color:#008080">host=</span><span style="color:#d14">&#34;127.0.0.2&#34;</span> <span style="color:#008080">user=</span><span style="color:#d14">&#34;mycat&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/whitehost&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;blacklist</span> <span style="color:#008080">check=</span><span style="color:#d14">&#34;true&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- å¼€å¯æ£€æŸ¥DELETEè¯­å¥åé¢whereæ˜¯å¦ä¸ºç©º --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;deleteWhereNoneCheck&#34;</span><span style="color:#000080">&gt;</span>true<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- å¼€å¯æ£€æŸ¥éåŸºæœ¬è¯­å¥çš„å…¶ä»–è¯­å¥(DDL) --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;noneBaseStatementAllow&#34;</span><span style="color:#000080">&gt;</span>true<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/blacklist&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/firewall&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="rulexmlç›¸å…³é…ç½®">rule.xmlç›¸å…³é…ç½®</h3>
<p><strong>rule.xmlçš„è§„åˆ™ç¤ºä¾‹</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- 
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    tableRuleä»£è¡¨è¡¨çš„åˆ†ç‰‡è§„åˆ™ï¼Œnameä¸ºå”¯ä¸€æ ‡è¯†ç¬¦å·
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    columnsï¼šæ°´å¹³åˆ‡åˆ†ä¾æ®çš„åˆ—
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    algorithmï¼šä»£è¡¨ä½¿ç”¨çš„å…·ä½“ç®—æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;tableRule</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mod-long&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;rule&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;columns&gt;</span>id<span style="color:#000080">&lt;/columns&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;algorithm&gt;</span>mod-long<span style="color:#000080">&lt;/algorithm&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/rule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/tableRule&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- 
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    functionä»£è¡¨æ°´å¹³åˆ‡åˆ†çš„ç®—æ³•ï¼Œnameä¸ºå”¯ä¸€æ ‡è¯†ç¬¦å·ï¼Œclassä¸ºå®ç°ç±»
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    propertyæ ‡ç­¾ï¼šjavabeanè§„èŒƒæ³¨å…¥çš„å±æ€§
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;function</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mod-long&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;io.mycat.route.function.PartitionByMod&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;count&#34;</span><span style="color:#000080">&gt;</span>3<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/function&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å¸¸ç”¨çš„åˆ‡åˆ†ç®—æ³•</strong></p>
<ul>
<li>ç®€å•å–æ¨¡åˆ†ç‰‡</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;tableRule</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mod-long&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;rule&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;columns&gt;</span>user_id<span style="color:#000080">&lt;/columns&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;algorithm&gt;</span>mod-long<span style="color:#000080">&lt;/algorithm&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/rule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/tableRule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;function</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mod-long&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;io.mycat.route.function.PartitionByMod&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;count&#34;</span><span style="color:#000080">&gt;</span>3<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/function&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯¹columnsåˆ—è¿›è¡Œåè¿›åˆ¶å–æ¨¡è¿ç®—è¿›è¡Œï¼Œæ‰€ä»¥columnsåˆ—å¿…é¡»ä¸ºæ•´æ•°ï¼Œcountä¸ºåˆ†ç‰‡æ•°é‡</p>
<ul>
<li>Hashå–æ¨¡åˆ†ç‰‡</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;tableRule</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;user_login&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;rule&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;columns&gt;</span>user_name<span style="color:#000080">&lt;/columns&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;algorithm&gt;</span>mod-hash<span style="color:#000080">&lt;/algorithm&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/rule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/tableRule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;function</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mod-hash&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;io.mycat.route.function.PartitionByHashMod&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;count&#34;</span><span style="color:#000080">&gt;</span>3<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/function&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥å¯¹å­—ç¬¦ä¸²ã€æ•°å­—ç±»å‹çš„åˆ—åšhashè¿ç®—ä¹‹åå†å–æ¨¡è¿›è¡Œåˆ†ç‰‡ï¼Œcountä¸ºåˆ†ç‰‡æ•°é‡</p>
<ul>
<li>æšä¸¾åˆ†ç‰‡</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;tableRule</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;sharding-by-intfile&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;rule&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;columns&gt;</span>area_id<span style="color:#000080">&lt;/columns&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;algorithm&gt;</span>area-map-file<span style="color:#000080">&lt;/algorithm&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/rule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/tableRule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;function</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;area-map-file&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;io.mycat.route.function.PartitionByFileMap&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mapFile&#34;</span><span style="color:#000080">&gt;</span>area-map-file.txt<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;type&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;defaultNode&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/function&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- 
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> area-map-filet.txt é…ç½®ï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">   10000=0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">   10010=1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">   DEFAULT_NODE=1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>typeé»˜è®¤å€¼ä¸º0ï¼Œ0è¡¨ç¤ºkeyä¸ºIntegerï¼Œé0è¡¨ç¤ºkeyä¸º Stringï¼Œ æ‰€æœ‰çš„èŠ‚ç‚¹é…ç½®éƒ½æ˜¯ä»0å¼€å§‹ï¼ŒåŠ0ä»£è¡¨èŠ‚ç‚¹1</p>
<p>defaultNodeé»˜è®¤èŠ‚ç‚¹ï¼šå°äº0è¡¨ç¤ºä¸è®¾ç½®é»˜è®¤èŠ‚ç‚¹ï¼Œå¤§äºç­‰äº0è¡¨ç¤ºè®¾ç½®é»˜è®¤èŠ‚ç‚¹ã€å¦‚æœä¸é…ç½®é»˜è®¤èŠ‚ç‚¹ç¢°åˆ°ä¸è¯†åˆ«çš„æšä¸¾å€¼å°±ä¼šæŠ¥é”™ã€‘</p>
<ul>
<li>å­—ç¬¦ä¸²èŒƒå›´å–æ¨¡åˆ†ç‰‡</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;tableRule</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mod-string-rang-prefix&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;rule&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;columns&gt;</span>user_id<span style="color:#000080">&lt;/columns&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;algorithm&gt;</span>sharding-by-prefixpattern<span style="color:#000080">&lt;/algorithm&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/rule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/tableRule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;function</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mod-string-rang-prefix&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#008080">class=</span><span style="color:#d14">&#34;io.mycat.route.function.PartitionByPrefixPattern&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;patternValue&#34;</span><span style="color:#000080">&gt;</span>256<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;prefixLength&#34;</span><span style="color:#000080">&gt;</span>5<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mapFile&#34;</span><span style="color:#000080">&gt;</span>partition-pattern.txt<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/function&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  partition-pattern.txt
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    0-127=0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    128-255=1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€‹	å­—ç¬¦ä¸²èŒƒå›´å–æ¨¡åˆ†ç‰‡æ˜¯å°†å­—ç¬¦ä¸²å‰ç¼€ASCIIç æŒ‡å®šå‰ç¼€ç›¸åŠ ç„¶åè¿›è¡Œå–æ¨¡è¿ç®—ã€‚prefixLengthï¼šéœ€è¦æˆªå–çš„å­—ç¬¦ä¸²é•¿åº¦ï¼ŒpatternValueï¼šå–æ¨¡çš„æ¨¡æ•°ã€‚å¦‚æœmapFileæ–‡ä»¶æœ‰äº›å–æ¨¡ä¹‹åå€¼æœªåŒ…å«ï¼Œæ’å…¥å–æ¨¡åæœªåŒ…å«çš„å€¼ä¼šæŠ¥é”™ã€‚</p>
<ul>
<li>èŒƒå›´åˆ†ç‰‡</li>
</ul>
<p>æ­¤åˆ†ç‰‡é€‚ç”¨äºï¼Œæå‰è§„åˆ’å¥½åˆ†ç‰‡å­—æ®µæŸä¸ªèŒƒå›´å±äºå“ªä¸ªåˆ†ç‰‡ã€start &lt;= range &lt;= end ã€‘</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;tableRule</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;file-rang-partition&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;rule&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;columns&gt;</span>user_id<span style="color:#000080">&lt;/columns&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;algorithm&gt;</span>&gt;rang-long<span style="color:#000080">&lt;/algorithm&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/rule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/tableRule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;function</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;rang-long&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;io.mycat.route.function.AutoPartitionByLong&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mapFile&#34;</span><span style="color:#000080">&gt;</span>file-rang-partition.txt<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;defaultNode&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/function&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  file-rang-partition.txt
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    0-10000000=0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    10000001-20000000=1
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>è‡ªç„¶æœˆåˆ†ç‰‡</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;tableRule</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;sharding-by-month&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;rule&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;columns&gt;</span>create_time<span style="color:#000080">&lt;/columns&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;algorithm&gt;</span>sharding-by-month<span style="color:#000080">&lt;/algorithm&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/rule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/tableRule&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;function</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;sharding-by-month&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;io.mycat.route.function.PartitionByMonth&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dateFormat&#34;</span><span style="color:#000080">&gt;</span>yyyy-MM-dd<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;sBeginDate&#34;</span><span style="color:#000080">&gt;</span>2014-01-01<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/function&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Mycatè¿˜æä¾›äº†ç±»ä¼¼redisçš„crc32slotåˆ†ç‰‡ï¼Œéœ€è¦å»ºç«‹æ§½æ˜ å°„è¡¨</p>
</blockquote>
<h3 id="schemaxmlç›¸å…³é…ç½®">schema.xmlç›¸å…³é…ç½®</h3>
<p><strong>schemaæ ‡ç­¾å®šä¹‰MyCatå®ä¾‹ä¸­çš„é€»è¾‘åº“</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  nameï¼šé€»è¾‘åº“çš„åç§°ï¼Œå…¨å±€å”¯ä¸€
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  checkSQLschema
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> true: å¦‚æœSQLä¸­åˆ¶å®šäº†äº†DBåç§°åˆ™ä¼šå‘—MyCatè‡ªåŠ¨åˆ é™¤åæ‰§è¡Œ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> false:ä¸æ£€æŸ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  sqlMaxLimitï¼šè¿”å›ç»“æœé›†æ•°é‡çš„æœ€å¤§å€¼ï¼Œå¦‚æœschemaæ ‡ç­¾æœ‰é…ç½®ï¼Œåˆ™ä¸ä¼šå–serveræ–‡ä»¶çš„é…ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;schema</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;TESTDB&#34;</span> <span style="color:#008080">checkSQLschema=</span><span style="color:#d14">&#34;false&#34;</span> <span style="color:#008080">sqlMaxLimit=</span><span style="color:#d14">&#34;100&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- tableæ ‡ç­¾ã€‚ã€‚ã€‚ --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/schema&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>tableæ ‡ç­¾å®šä¹‰äº†MyCatä¸­çš„é€»è¾‘è¡¨</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  nameï¼šé€»è¾‘è¡¨çš„åç§°ä¹Ÿæ˜¯ç‰©ç†è¡¨åç§°ï¼Œæ¯ä¸ªschemaä¸‹å”¯ä¸€
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  dataNodeï¼šæ‰€å±çš„ dataNodeéœ€è¦å’ŒdataNodeæ ‡ç­¾ä¸­nameå±æ€§çš„å€¼ç›¸äº’å¯¹åº”ï¼Œé¡ºåºä¸åˆ†ç‰‡è§„åˆ™æšä¸¾æœ‰å¯¹åº”å…³ç³»
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  ruleï¼šç”¨äºæŒ‡å®šé€»è¾‘è¡¨è¦ä½¿ç”¨çš„è§„åˆ™ï¼ˆrule.xmlä¸­å®šä¹‰ï¼‰å¿…é¡»ä¸tableRuleæ ‡ç­¾ä¸­nameå±æ€§å±æ€§å€¼ä¸€ä¸€å¯¹åº”
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  primaryKeyï¼šè¯¥é€»è¾‘è¡¨å¯¹åº”çœŸå®è¡¨çš„ä¸»é”®ï¼Œå¦‚æœåˆ†ç‰‡é”®ä¸æ˜¯ä¸»é”®åˆ™ä¼šç¼“å­˜ä¸»é”®å’Œåˆ†ç‰‡é”®çš„æ˜ å°„å…³ç³»
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">              å¦‚æœå‘½ä¸­ç¼“å­˜ï¼Œåˆ™ä½¿ç”¨éä¸»é”®è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™å°±ä¸ä¼šè¿›è¡Œå¹¿æ’­å¼çš„æŸ¥è¯¢ï¼Œå°±ä¼šç›´æ¥å‘é€è¯­å¥ç»™å…·ä½“çš„DataNode
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  typeï¼šå¦‚æœæ˜¯å…¨å±€è¡¨éœ€è¦æŒ‡å®šglobal
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  autoIncrementï¼šå¦‚æœä½¿ç”¨è‡ªå¢IDéœ€è¦é…ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  needAddLimitï¼šSQLæŸ¥è¯¢ä¸åŒ…å«limitæ—¶MyCatè‡ªåŠ¨æ·»åŠ limité»˜è®¤trueï¼Œlimitå€¼ä¸ºé…ç½®çš„æœ€å¤§è¿”å›ç»“æœé›†
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- dataNode=&#34;dn1,dn2,dn3&#34; ==&gt; dataNode=&#34;dn$1-3&#34; --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;travelrecord&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn1,dn2,dn3&#34;</span> <span style="color:#008080">rule=</span><span style="color:#d14">&#34;auto-sharding-long&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;ID&#34;</span> <span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!--å¯èƒ½å­˜åœ¨childTable --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/table&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>dataNodeæ ‡ç­¾å®šä¹‰äº†MyCatä¸­çš„æ•°æ®èŠ‚ç‚¹</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- 
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  nameï¼šå…¨å±€å”¯ä¸€æ ‡è¯†
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  dataHostï¼šå¯¹åº”çš„dataHostæ ‡ç­¾ï¼Œç”¨äºæŒ‡å®šå…·ä½“æ•°æ®åº“ç¤ºä¾‹
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  databaseï¼šçœŸå®çš„ç‰©ç†åº“åç§°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;dataNode</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dn1&#34;</span> <span style="color:#008080">dataHost=</span><span style="color:#d14">&#34;DH100&#34;</span> <span style="color:#008080">database=</span><span style="color:#d14">&#34;db1&#34;</span> <span style="color:#000080">&gt;&lt;/dataNode&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>dataHostæ ‡ç­¾å®šä¹‰äº†æ•°æ®åº“å®ä¾‹ã€è¯»å†™åˆ†ç¦»é…ç½®å’Œå¿ƒè·³è¯­å¥</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- 
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  nameï¼šå”¯ä¸€æ ‡è¯†dataHostæ ‡ç­¾å…¨å±€å”¯ä¸€
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  balance
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    0ï¼šä¸å¼€å¯è¯»å†™åˆ†ç¦»æœºåˆ¶ï¼Œæ‰€æœ‰è¯»æ“ä½œéƒ½å‘é€åˆ°å½“å‰å¯ç”¨çš„writeHostä¸Š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    1ï¼šå…¨éƒ¨çš„readHostä¸stand by writeHostå‚ä¸selectè¯­å¥çš„è´Ÿè½½å‡è¡¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">       ç®€å•çš„è¯´ï¼Œå½“åŒä¸»ä¸»å¤‡æ¨¡å¼ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼ŒM2,S1,S2 éƒ½å‚ä¸ select è¯­å¥çš„è´Ÿè½½å‡è¡¡ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    2ï¼šæ‰€æœ‰è¯»æ“ä½œéƒ½éšæœºçš„åœ¨writeHostã€readhostä¸Šåˆ†å‘
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    3ï¼šæ‰€æœ‰è¯»è¯·æ±‚éšæœºçš„åˆ†å‘åˆ°wiriterHostå¯¹åº”çš„readhostæ‰§è¡Œï¼Œé€‚åˆä¸€ä¸»å¤šä»æ¨¡å¼
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  dbTypeï¼šåç«¯æ•°æ®åº“ç±»å‹
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  writeType
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    0ï¼šæ‰€æœ‰å†™æ“ä½œå‘é€åˆ°é…ç½®çš„ç¬¬ä¸€ä¸ªwriteHostï¼Œç¬¬ä¸€ä¸ªæŒ‚äº†åˆ‡åˆ°è¿˜ç”Ÿå­˜çš„ç¬¬äºŒä¸ªwriteHost
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">      é‡æ–°å¯åŠ¨åå·²åˆ‡æ¢åçš„ä¸ºå‡†ï¼Œåˆ‡æ¢è®°å½•åœ¨é…ç½®æ–‡ä»¶ä¸­:dnindex.properties
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    1ï¼šæ‰€æœ‰å†™æ“ä½œéƒ½éšæœºçš„å‘é€åˆ°é…ç½®çš„ writeHostï¼Œ1.5 ä»¥ååºŸå¼ƒä¸æ¨è
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  switchTypeï¼š
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    -1ï¼šè¡¨ç¤ºä¸è‡ªåŠ¨åˆ‡æ¢ï¼Œå¦‚æœåå°å·²ç»ä½¿ç”¨MMMæˆ–MHAè¿™ç§é«˜å¯ç”¨ç®¡ç†å·¥å…·ï¼Œåˆ™éœ€è¦å…³é—­
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    1ï¼šé»˜è®¤å€¼ï¼Œè‡ªåŠ¨åˆ‡æ¢ã€‚å½“ç¬¬ä¸€ä¸ªwriteHostå®•æœºè‡ªåŠ¨åˆ‡æ¢ä¸ºç¬¬äºŒä¸ªwriteHost
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    2ï¼šåŸºäºMySQLä¸»ä»åŒæ­¥çš„çŠ¶æ€å†³å®šæ˜¯å¦åˆ‡æ¢ï¼Œå¿ƒè·³è¯­å¥ä¸º show slave status
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  maxConï¼šæ•°æ®åº“è¿æ¥æ± æœ€å¤§è¿æ¥æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  minConï¼šæ•°æ®åº“è¿æ¥æ± æœ€å°è¿æ¥æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  dbDriverï¼šnativeä¸ºMySQLåŸèº«åè®®ï¼Œå¦‚æœdbTypeä¸æ˜¯mysqlåˆ™éœ€è¦è®¾ç½®ä¸ºå…·ä½“çš„Driverç±»å
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;dataHost</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;DH100&#34;</span> <span style="color:#008080">maxCon=</span><span style="color:#d14">&#34;1000&#34;</span> <span style="color:#008080">minCon=</span><span style="color:#d14">&#34;10&#34;</span> <span style="color:#008080">balance=</span><span style="color:#d14">&#34;0&#34;</span> <span style="color:#008080">switchType=</span><span style="color:#d14">&#34;-1&#34;</span> <span style="color:#008080">writeType=</span><span style="color:#d14">&#34;0&#34;</span> <span style="color:#008080">dbType=</span><span style="color:#d14">&#34;mysql&#34;</span> <span style="color:#008080">dbDriver=</span><span style="color:#d14">&#34;native&#34;</span> <span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- heartbeat:å¿ƒè·³æµ‹è¯•è¯­å¥ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;heartbeat&gt;</span>select user()<span style="color:#000080">&lt;/heartbeat&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;writeHost</span> <span style="color:#008080">host=</span><span style="color:#d14">&#34;hostM1&#34;</span> <span style="color:#008080">url=</span><span style="color:#d14">&#34;localhost:3306&#34;</span> <span style="color:#008080">user=</span><span style="color:#d14">&#34;root&#34;</span> <span style="color:#008080">password=</span><span style="color:#d14">&#34;123456&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> &lt;readHost host=&#34;hostS1&#34; url=&#34;localhost:3306&#34; user=&#34;root&#34; password=&#34;123456&#34;/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/writeHost&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- 
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  &lt;writeHost host=&#34;hostM2&#34; url=&#34;localhost:3316&#34; user=&#34;root&#34; password=&#34;123456&#34;/&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/dataHost&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ä¸‰æ•°æ®åº“çš„å‚ç›´åˆ‡åˆ†">ä¸‰ã€æ•°æ®åº“çš„å‚ç›´åˆ‡åˆ†</h2>
<p>â€‹	é¡¹ç›®åˆæœŸå¯èƒ½åªæ˜¯ä¸€ä¸ªå•ä¸€çš„æ•°æ®åº“ï¼Œéšç€ä¸šåŠ¡çš„å¢é•¿è€Œå‡ºç°äº†æ€§èƒ½ç“¶é¢ˆã€‚å½“æ— æ³•é€šè¿‡ä¼˜åŒ–æ¥è§£å†³æ€§èƒ½ç“¶é¢ˆæ—¶åº”è¯¥é¦–å…ˆé€šè¿‡åˆ†åº“çš„æ–¹å¼è¿›è¡Œè§£å†³ã€‚å¼•å…¥MyCatè¿›è¡Œåˆ†åº“çš„å¥½å¤„æ˜¯æœ‰è¿æ¥æ± çš„ç®¡ç†å’Œå°½é‡å°‘çš„ä¿®æ”¹åå°çš„ä»£ç ã€‚</p>
<p><strong>è¿›è¡Œå‚ç›´åˆ‡åˆ†çš„æ­¥éª¤</strong></p>
<p>â‘ ã€æ”¶é›†åˆ†æä¸šåŠ¡æ¨¡å—ä¹‹é—´çš„å…³ç³»</p>
<p>â‘¡ã€å¤åˆ¶å…¨é‡æ•°æ®åˆ°å…¶å®ƒå®ä¾‹ï¼ˆå»ºç«‹ä¸»ä»å…³ç³»ï¼Œåœ¨é…ç½®å¥½MyCatä¹‹å‰ä¿æŒæ•°æ®éƒ½ä¸ºçº¿ä¸Šå…¨é‡æ•°æ®ï¼‰</p>
<p>â‘¢ã€é…ç½®MyCatå‚ç›´åˆ†åº“</p>
<p>â‘£ã€é€šè¿‡MyCatè®¿é—®DB</p>
<p>â‘¤ã€åˆ é™¤åŸåº“ä¸­å·²è¿ç§»çš„è¡¨</p>
<blockquote>
<p>ä¸»ä»å…³ç³»å»ºç«‹æ—¶ä»åº“ä¸Šçš„DBåå­—å¯èƒ½å‘ç”Ÿäº†æ”¹å˜ï¼Œéœ€è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¿®æ”¹å¤‡ä»½åˆ°ä»æ•°æ®åº“çš„åç§°</p>
<p><code>change replication filter replicate_rewrite_db(([masterDBName],[slaveDBName]))</code></p>
</blockquote>
<h3 id="å‚ç›´åˆ‡åˆ†é…ç½®ç¤ºä¾‹">å‚ç›´åˆ‡åˆ†é…ç½®ç¤ºä¾‹</h3>
<p><strong>é…ç½®MyCatå‚ç›´åˆ†åº“</strong></p>
<ul>
<li><strong>schema.xml</strong></li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;!DOCTYPE mycat:schema SYSTEM &#34;schema.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;mycat:schema</span> <span style="color:#008080">xmlns:mycat=</span><span style="color:#d14">&#34;http://io.mycat/&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;schema</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;app_db&#34;</span> <span style="color:#008080">checkSQLschema=</span><span style="color:#d14">&#34;false&#34;</span> <span style="color:#008080">sqlMaxLimit=</span><span style="color:#d14">&#34;100&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- è®¢å•æ¨¡å— --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;order_cart&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;cart_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;order_customer_addr&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;customer_addr_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;order_master&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;order_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;order_detail&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;order_detail_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- ä»“é…æ¨¡å— --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;shipping_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;ship_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;warehouse_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;w_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;warehouse_proudct&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;wp_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- å•†å“æ¨¡å— --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_brand_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;brand_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_category&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;category_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_comment&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;comment_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;product_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_pic_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;product_pic_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_supplier_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;supplier_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- ç”¨æˆ·æ¨¡å— --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_balance_log&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;balance_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_inf&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;customer_inf_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_level_inf&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;customer_level&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_login&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;customer_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_login_log&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;login_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_point_log&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;point_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- åœ°åŒºä¿¡æ¯,å…¨å±€è¡¨ --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;region_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;region_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149,dn151,dn152&#34;</span>  <span style="color:#008080">type=</span><span style="color:#d14">&#34;global&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/schema&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataNode</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dn152&#34;</span> <span style="color:#008080">dataHost=</span><span style="color:#d14">&#34;dh152&#34;</span> <span style="color:#008080">database=</span><span style="color:#d14">&#34;order_db&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataNode</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dn151&#34;</span> <span style="color:#008080">dataHost=</span><span style="color:#d14">&#34;dh151&#34;</span> <span style="color:#008080">database=</span><span style="color:#d14">&#34;product_db&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataNode</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dn149&#34;</span> <span style="color:#008080">dataHost=</span><span style="color:#d14">&#34;dh149&#34;</span> <span style="color:#008080">database=</span><span style="color:#d14">&#34;consumers_db&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataHost</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dh152&#34;</span> <span style="color:#008080">maxCon=</span><span style="color:#d14">&#34;1000&#34;</span> <span style="color:#008080">minCon=</span><span style="color:#d14">&#34;10&#34;</span> <span style="color:#008080">balance=</span><span style="color:#d14">&#34;2&#34;</span> <span style="color:#008080">writeType=</span><span style="color:#d14">&#34;0&#34;</span> <span style="color:#008080">dbType=</span><span style="color:#d14">&#34;mysql&#34;</span> <span style="color:#008080">dbDriver=</span><span style="color:#d14">&#34;native&#34;</span> <span style="color:#008080">switchType=</span><span style="color:#d14">&#34;1&#34;</span>  <span style="color:#008080">slaveThreshold=</span><span style="color:#d14">&#34;100&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;heartbeat&gt;</span>select user()<span style="color:#000080">&lt;/heartbeat&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;writeHost</span> <span style="color:#008080">host=</span><span style="color:#d14">&#34;192.168.1.152&#34;</span> <span style="color:#008080">url=</span><span style="color:#d14">&#34;192.168.1.152:3306&#34;</span> <span style="color:#008080">user=</span><span style="color:#d14">&#34;root&#34;</span> <span style="color:#008080">password=</span><span style="color:#d14">&#34;123456&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/dataHost&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataHost</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dh151&#34;</span> <span style="color:#008080">maxCon=</span><span style="color:#d14">&#34;1000&#34;</span> <span style="color:#008080">minCon=</span><span style="color:#d14">&#34;10&#34;</span> <span style="color:#008080">balance=</span><span style="color:#d14">&#34;2&#34;</span> <span style="color:#008080">writeType=</span><span style="color:#d14">&#34;0&#34;</span> <span style="color:#008080">dbType=</span><span style="color:#d14">&#34;mysql&#34;</span> <span style="color:#008080">dbDriver=</span><span style="color:#d14">&#34;native&#34;</span> <span style="color:#008080">switchType=</span><span style="color:#d14">&#34;1&#34;</span>  <span style="color:#008080">slaveThreshold=</span><span style="color:#d14">&#34;100&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;heartbeat&gt;</span>select user()<span style="color:#000080">&lt;/heartbeat&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;writeHost</span> <span style="color:#008080">host=</span><span style="color:#d14">&#34;192.168.1.151&#34;</span> <span style="color:#008080">url=</span><span style="color:#d14">&#34;192.168.1.151:3306&#34;</span> <span style="color:#008080">user=</span><span style="color:#d14">&#34;root&#34;</span> <span style="color:#008080">password=</span><span style="color:#d14">&#34;123456&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/dataHost&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataHost</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dh149&#34;</span> <span style="color:#008080">maxCon=</span><span style="color:#d14">&#34;1000&#34;</span> <span style="color:#008080">minCon=</span><span style="color:#d14">&#34;10&#34;</span> <span style="color:#008080">balance=</span><span style="color:#d14">&#34;2&#34;</span> <span style="color:#008080">writeType=</span><span style="color:#d14">&#34;0&#34;</span> <span style="color:#008080">dbType=</span><span style="color:#d14">&#34;mysql&#34;</span> <span style="color:#008080">dbDriver=</span><span style="color:#d14">&#34;native&#34;</span> <span style="color:#008080">switchType=</span><span style="color:#d14">&#34;1&#34;</span>  <span style="color:#008080">slaveThreshold=</span><span style="color:#d14">&#34;100&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;heartbeat&gt;</span>select user()<span style="color:#000080">&lt;/heartbeat&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;writeHost</span> <span style="color:#008080">host=</span><span style="color:#d14">&#34;192.168.1.149&#34;</span> <span style="color:#008080">url=</span><span style="color:#d14">&#34;192.168.1.149:3306&#34;</span> <span style="color:#008080">user=</span><span style="color:#d14">&#34;root&#34;</span> <span style="color:#008080">password=</span><span style="color:#d14">&#34;123456&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/writeHost&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/dataHost&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/mycat:schema&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>server.xml</strong></li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;!DOCTYPE mycat:server SYSTEM &#34;server.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;mycat:server</span> <span style="color:#008080">xmlns:mycat=</span><span style="color:#d14">&#34;http://io.mycat/&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;system&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;useGlobleTableCheck&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;sequnceHandlerType&#34;</span><span style="color:#000080">&gt;</span>2<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;processorBufferPoolType&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;serverPort&#34;</span><span style="color:#000080">&gt;</span>8066<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;managerPort&#34;</span><span style="color:#000080">&gt;</span>9066<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;idleTimeout&#34;</span><span style="color:#000080">&gt;</span>300000<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;bindIp&#34;</span><span style="color:#000080">&gt;</span>0.0.0.0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;frontWriteQueueSize&#34;</span><span style="color:#000080">&gt;</span>4096<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;processors&#34;</span><span style="color:#000080">&gt;</span>4<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;handleDistributedTransactions&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;useOffHeapForMerge&#34;</span><span style="color:#000080">&gt;</span>1<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;memoryPageSize&#34;</span><span style="color:#000080">&gt;</span>1m<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;spillsFileBufferSize&#34;</span><span style="color:#000080">&gt;</span>1k<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;useStreamOutput&#34;</span><span style="color:#000080">&gt;</span>0<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;systemReserveMemorySize&#34;</span><span style="color:#000080">&gt;</span>100m<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;useZKSwitch&#34;</span><span style="color:#000080">&gt;</span>false<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/system&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;user</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;root&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;password&#34;</span><span style="color:#000080">&gt;</span>123456<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;schemas&#34;</span><span style="color:#000080">&gt;</span>app_db<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/user&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/mycat:server&gt;</span>          
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>è·¨åˆ†ç‰‡æŸ¥è¯¢è§£å†³æ–¹æ³•</p>
<p>â€‹	â‘ ã€ä½¿ç”¨MyCatå…¨å±€è¡¨</p>
<p>â€‹	â‘¡ã€å†—ä½™éƒ¨åˆ†å…³é”®æ•°æ®</p>
<p>â€‹	â‘¢ã€ä½¿ç”¨APIçš„æ–¹å¼è·å–æ•°æ®</p>
</blockquote>
<h3 id="å‚ç›´åˆ‡åˆ†çš„ä¼˜ç¼ºç‚¹">å‚ç›´åˆ‡åˆ†çš„ä¼˜ç¼ºç‚¹</h3>
<p>ä¼˜ç‚¹</p>
<ul>
<li>æ‹†åˆ†ç®€å•æ˜äº†ï¼Œæ‹†åˆ†è§„åˆ™æ˜ç¡®</li>
<li>åº”ç”¨ç¨‹åºæ¨¡å—æ¸…æ™°æ˜ç¡®ï¼Œæ•´åˆå®¹æ˜“</li>
<li>æ•°æ®ç»´æŠ¤æ–¹ä¾¿ï¼Œå®¹æ˜“å®šä½</li>
</ul>
<p>ç¼ºç‚¹</p>
<ul>
<li>éƒ¨åˆ†è¡¨å…³è”æ— æ³•åœ¨æ•°æ®åº“çº§åˆ«å®Œæˆï¼Œéœ€è¦åœ¨ç¨‹åºä¸­å®Œæˆ</li>
<li>å¯¹äºè®¿é—®æå…¶é¢‘ç¹ä¸”æ•°æ®é‡è¶…å¤§çš„è¡¨ä¾æ—§ä¼šæœ‰æ€§èƒ½ç“¶é¢ˆ</li>
</ul>
<h2 id="å››æ•°æ®åº“çš„æ°´å¹³åˆ‡åˆ†">å››ã€æ•°æ®åº“çš„æ°´å¹³åˆ‡åˆ†</h2>
<p>â€‹	ä¸€èˆ¬æƒ…å†µä¸‹æ°´å¹³åˆ‡åˆ†æ˜¯åœ¨å‚ç›´åˆ‡åˆ†ä¾æ—§ä¸èƒ½æ»¡è¶³æ€§èƒ½è¦æ±‚çš„æ—¶å€™è¿›è¡Œçš„ï¼Œåº”è¯¥æŒ‰ç…§æ€§èƒ½éœ€æ±‚å’Œä¸šåŠ¡è§„åˆ™è¿›è¡Œæ°´å¹³åˆ‡åˆ†ï¼Œå³å¯ä»¥ä¸æ°´å¹³åˆ‡åˆ†çš„è¡¨ä¸è¦æ°´å¹³åˆ‡åˆ†ã€‚</p>
<h3 id="åˆ†ç‰‡åçš„æŸ¥è¯¢å¤„ç†">åˆ†ç‰‡åçš„æŸ¥è¯¢å¤„ç†</h3>
<p><img src="/img/mycat/Shard-Query.png" alt="Shard Query"></p>
<p>1ã€MyCatæŸ¥æ‰¾æŸ¥è¯¢SQLä¸­çš„è¡¨å¯¹åº”çš„åˆ†ç‰‡ä¿¡æ¯</p>
<p>2ã€åˆ¤æ–­æŸ¥è¯¢ä¸­æ˜¯å¦åŒ…å«åˆ†ç‰‡é”®</p>
<ul>
<li>
<p>å¦‚æœæŸ¥è¯¢ä¸­åŒ…å«åˆ†ç‰‡é”®ï¼Œåˆ™æ ¹æ®åˆ†ç‰‡é”®çš„åˆ†ç‰‡è§„åˆ™è¿›è¡Œè®¡ç®—æŸ¥æ‰¾åˆ°åå°çœŸå®ç‰©ç†DBå¹¶å‘é€SQL</p>
</li>
<li>
<p>å¦‚æœä¸åŒ…å«åˆ†ç‰‡é”®åˆ™å¯¹åå°æ‰€æœ‰é…æœ‰æ­¤Tableçš„ç‰©ç†èŠ‚ç‚¹å‘é€SQL</p>
</li>
</ul>
<h3 id="åˆ†ç‰‡é”®çš„é€‰æ‹©">åˆ†ç‰‡é”®çš„é€‰æ‹©</h3>
<ul>
<li>å¦‚æœæ²¡æœ‰åˆ†ç‰‡é”®å¯é€‰é‚£å°±é€‰æ‹©ä¸»é”®</li>
<li>å¦‚æœæœ‰å¤šä¸ªåˆ†ç‰‡é”®é€‰æ‹©
<ul>
<li>åˆ†ç‰‡é”®å¯ä»¥å°½å¯èƒ½çš„å°†æ•°æ®å‡åŒ€åˆ†å¸ƒåˆ°å„ä¸ªèŠ‚ç‚¹ä¸Š</li>
<li>è¯¥ä¸šåŠ¡å­—æ®µæ˜¯æœ€é¢‘ç¹çš„æˆ–æœ€é‡è¦çš„æŸ¥è¯¢æ¡ä»¶</li>
</ul>
</li>
</ul>
<h3 id="æ°´å¹³åˆ‡åˆ†é…ç½®ç¤ºä¾‹">æ°´å¹³åˆ‡åˆ†é…ç½®ç¤ºä¾‹</h3>
<p><strong>schema.xmlé…ç½®</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;!DOCTYPE mycat:schema SYSTEM &#34;schema.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;mycat:schema</span> <span style="color:#008080">xmlns:mycat=</span><span style="color:#d14">&#34;http://io.mycat/&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;schema</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;app_db&#34;</span> <span style="color:#008080">checkSQLschema=</span><span style="color:#d14">&#34;false&#34;</span> <span style="color:#008080">sqlMaxLimit=</span><span style="color:#d14">&#34;100&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- è®¢å•æ¨¡å— --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;order_cart&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;cart_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152_order&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;order_customer_addr&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;customer_addr_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152_order&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- è®¢å•è¡¨å•ç‹¬æ°´å¹³åˆ‡åˆ† --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;order_master&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;order_id&#34;</span> <span style="color:#008080">rule=</span><span style="color:#d14">&#34;order_master_mod_long&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152_order01,dn151_order02,dn149_order03&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">&lt;!-- ERåˆ†ç‰‡ï¼Œæ ¹æ®joinKeyæ¥è¿›è¡Œåˆ†ç‰‡ --&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&lt;childTable</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;order_detail&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;order_detail_id&#34;</span> <span style="color:#008080">joinKey=</span><span style="color:#d14">&#34;order_id&#34;</span> <span style="color:#008080">parentKey=</span><span style="color:#d14">&#34;order_id&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/table&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- ä»“é…æ¨¡å— --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;shipping_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;ship_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152_order&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;warehouse_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;w_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152_order&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;warehouse_proudct&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;wp_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn152_order&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- å•†å“æ¨¡å— --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_brand_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;brand_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151_product&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_category&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;category_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151_product&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_comment&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;comment_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151_product&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;product_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151_product&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_pic_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;product_pic_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151_product&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;product_supplier_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;supplier_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn151_product&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- ç”¨æˆ·æ¨¡å— --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_balance_log&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;balance_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149_consumers&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_inf&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;customer_inf_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149_consumers&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_level_inf&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;customer_level&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149_consumers&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_login&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;customer_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149_consumers&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_login_log&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;login_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149_consumers&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;customer_point_log&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;point_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149_consumers&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!-- åœ°åŒºä¿¡æ¯,å…¨å±€è¡¨ --&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;table</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;region_info&#34;</span> <span style="color:#008080">primaryKey=</span><span style="color:#d14">&#34;region_id&#34;</span> <span style="color:#008080">dataNode=</span><span style="color:#d14">&#34;dn149_consumers,dn151_product,dn152_order&#34;</span>  <span style="color:#008080">type=</span><span style="color:#d14">&#34;global&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/schema&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataNode</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dn152_order01&#34;</span> <span style="color:#008080">dataHost=</span><span style="color:#d14">&#34;dh152&#34;</span> <span style="color:#008080">database=</span><span style="color:#d14">&#34;order_db01&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataNode</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dn151_order02&#34;</span> <span style="color:#008080">dataHost=</span><span style="color:#d14">&#34;dh151&#34;</span> <span style="color:#008080">database=</span><span style="color:#d14">&#34;order_db02&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataNode</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dn149_order03&#34;</span> <span style="color:#008080">dataHost=</span><span style="color:#d14">&#34;dh149&#34;</span> <span style="color:#008080">database=</span><span style="color:#d14">&#34;order_db03&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataNode</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dn152_order&#34;</span> <span style="color:#008080">dataHost=</span><span style="color:#d14">&#34;dh152&#34;</span> <span style="color:#008080">database=</span><span style="color:#d14">&#34;order_db&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataNode</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dn151_product&#34;</span> <span style="color:#008080">dataHost=</span><span style="color:#d14">&#34;dh151&#34;</span> <span style="color:#008080">database=</span><span style="color:#d14">&#34;product_db&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataNode</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dn149_consumers&#34;</span> <span style="color:#008080">dataHost=</span><span style="color:#d14">&#34;dh149&#34;</span> <span style="color:#008080">database=</span><span style="color:#d14">&#34;consumers_db&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataHost</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dh152&#34;</span> <span style="color:#008080">maxCon=</span><span style="color:#d14">&#34;1000&#34;</span> <span style="color:#008080">minCon=</span><span style="color:#d14">&#34;10&#34;</span> <span style="color:#008080">balance=</span><span style="color:#d14">&#34;2&#34;</span> <span style="color:#008080">writeType=</span><span style="color:#d14">&#34;0&#34;</span> <span style="color:#008080">dbType=</span><span style="color:#d14">&#34;mysql&#34;</span> <span style="color:#008080">dbDriver=</span><span style="color:#d14">&#34;native&#34;</span> <span style="color:#008080">switchType=</span><span style="color:#d14">&#34;1&#34;</span>  <span style="color:#008080">slaveThreshold=</span><span style="color:#d14">&#34;100&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;heartbeat&gt;</span>select user()<span style="color:#000080">&lt;/heartbeat&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;writeHost</span> <span style="color:#008080">host=</span><span style="color:#d14">&#34;192.168.1.152&#34;</span> <span style="color:#008080">url=</span><span style="color:#d14">&#34;192.168.1.152:3306&#34;</span> <span style="color:#008080">user=</span><span style="color:#d14">&#34;root&#34;</span> <span style="color:#008080">password=</span><span style="color:#d14">&#34;123456&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/dataHost&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataHost</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dh151&#34;</span> <span style="color:#008080">maxCon=</span><span style="color:#d14">&#34;1000&#34;</span> <span style="color:#008080">minCon=</span><span style="color:#d14">&#34;10&#34;</span> <span style="color:#008080">balance=</span><span style="color:#d14">&#34;2&#34;</span> <span style="color:#008080">writeType=</span><span style="color:#d14">&#34;0&#34;</span> <span style="color:#008080">dbType=</span><span style="color:#d14">&#34;mysql&#34;</span> <span style="color:#008080">dbDriver=</span><span style="color:#d14">&#34;native&#34;</span> <span style="color:#008080">switchType=</span><span style="color:#d14">&#34;1&#34;</span>  <span style="color:#008080">slaveThreshold=</span><span style="color:#d14">&#34;100&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;heartbeat&gt;</span>select user()<span style="color:#000080">&lt;/heartbeat&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;writeHost</span> <span style="color:#008080">host=</span><span style="color:#d14">&#34;192.168.1.151&#34;</span> <span style="color:#008080">url=</span><span style="color:#d14">&#34;192.168.1.151:3306&#34;</span> <span style="color:#008080">user=</span><span style="color:#d14">&#34;root&#34;</span> <span style="color:#008080">password=</span><span style="color:#d14">&#34;123456&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/dataHost&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;dataHost</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;dh149&#34;</span> <span style="color:#008080">maxCon=</span><span style="color:#d14">&#34;1000&#34;</span> <span style="color:#008080">minCon=</span><span style="color:#d14">&#34;10&#34;</span> <span style="color:#008080">balance=</span><span style="color:#d14">&#34;2&#34;</span> <span style="color:#008080">writeType=</span><span style="color:#d14">&#34;0&#34;</span> <span style="color:#008080">dbType=</span><span style="color:#d14">&#34;mysql&#34;</span> <span style="color:#008080">dbDriver=</span><span style="color:#d14">&#34;native&#34;</span> <span style="color:#008080">switchType=</span><span style="color:#d14">&#34;1&#34;</span>  <span style="color:#008080">slaveThreshold=</span><span style="color:#d14">&#34;100&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;heartbeat&gt;</span>select user()<span style="color:#000080">&lt;/heartbeat&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;writeHost</span> <span style="color:#008080">host=</span><span style="color:#d14">&#34;192.168.1.149&#34;</span> <span style="color:#008080">url=</span><span style="color:#d14">&#34;192.168.1.149:3306&#34;</span> <span style="color:#008080">user=</span><span style="color:#d14">&#34;root&#34;</span> <span style="color:#008080">password=</span><span style="color:#d14">&#34;123456&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/writeHost&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/dataHost&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/mycat:schema&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>rule.xmlé…ç½®</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;!DOCTYPE mycat:rule SYSTEM &#34;rule.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;mycat:rule</span> <span style="color:#008080">xmlns:mycat=</span><span style="color:#d14">&#34;http://io.mycat/&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;tableRule</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;order_master_mod_long&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;rule&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&lt;columns&gt;</span>customer_id<span style="color:#000080">&lt;/columns&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&lt;algorithm&gt;</span>mod-long<span style="color:#000080">&lt;/algorithm&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/rule&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/tableRule&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;function</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;mod-long&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;io.mycat.route.function.PartitionByMod&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;count&#34;</span><span style="color:#000080">&gt;</span>3<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/function&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/mycat:rule&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ°´å¹³åˆ‡åˆ†å¼•å‘ä¸»é”®é—®é¢˜">æ°´å¹³åˆ‡åˆ†å¼•å‘ä¸»é”®é—®é¢˜</h3>
<p>â€‹	æ°´å¹³åˆ‡åˆ†å¸¦æ¥äº†ä¸»é”®è‡ªå¢é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨æœ¬åœ°æ–‡ä»¶æ–¹å¼ã€æ•°æ®åº“æ–¹å¼ ã€æœ¬åœ°æ—¶é—´æˆ³æ–¹å¼ ã€ZK ID ç”Ÿæˆå™¨å’Œç¨‹åºä½¿ç”¨Redisç”Ÿæˆè‡ªå¢IDçš„æ–¹å¼</p>
<p><strong>Zk é€’å¢æ–¹å¼</strong></p>
<p>å‰ææ¡ä»¶MyCatæ˜¯é›†ç¾¤æ¨¡å¼ï¼Œå·²åŠ å…¥zookeeperå»ºç«‹è¿æ¥</p>
<ul>
<li>é…ç½®<code>server.xml</code>åŠ å…¥ä»¥ä¸‹éƒ¨åˆ†</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;system&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;sequnceHandlerType&#34;</span><span style="color:#000080">&gt;</span>4<span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/system&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>é…ç½®<code>sequence_conf.properties </code></li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># å…¨å±€</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">GLOBAL.HISIDS</span><span style="color:#000;font-weight:bold">=</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">GLOBAL.MINID</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">10001</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">GLOBAL.MAXID</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">20000</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">GLOBAL.CURID</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">10000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># è‡ªå®šä¹‰æ•°æ®</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">ORDER.HISIDS</span><span style="color:#000;font-weight:bold">=</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">ORDER.MINID</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">1001</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">ORDER.MAXID</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">2000</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">ORDER.CURID</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">1000</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>æ’å…¥SQLæ”¹é€ </li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic">-- ä½¿ç”¨å…¨å±€é…ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">insert</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">into</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">order</span>(id,<span style="color:#bbb"> </span>...)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span>(next<span style="color:#bbb"> </span>value<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>MYCATSEQ_GLOBAL,<span style="color:#bbb"> </span>...);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- ä½¿ç”¨å•ç‹¬è¡¨é…ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">insert</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">into</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">order</span>(id,<span style="color:#bbb"> </span>...)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span>(next<span style="color:#bbb"> </span>value<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>MYCATSEQ_ORDER,<span style="color:#bbb"> </span>...);<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="äº”mycaté«˜å¯ç”¨æ­å»º">äº”ã€MyCaté«˜å¯ç”¨æ­å»º</h2>
<p><img src="/img/mycat/ha.png" alt="ha"></p>
<h3 id="mycaté›†ç¾¤æ­å»º">MyCaté›†ç¾¤æ­å»º</h3>
<p>å‰æœŸå‡†å¤‡ï¼šæ­å»ºå¥½zookeeperé›†ç¾¤</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šæ‹·è´ä¿®æ”¹å’Œå¢åŠ çš„é…ç½®æ–‡ä»¶åˆ°<code>$MyCat/conf/zkconf</code>ä¸‹</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># éœ€å°†æ‰€æœ‰ä¿®æ”¹çš„é…ç½®å…¨éƒ¨è¦†ç›–</span>
</span></span><span style="display:flex;"><span>cp rule.xml schema.xml server.xml zkconf/
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬äºŒæ­¥ï¼šé…ç½®<code>$MyCat/conf/myid.properties</code></strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#008080">loadZk</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">true</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">zkURL</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">192.168.1.158:2181,192.168.1.158:2182,192.168.1.158:2183</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># é›†ç¾¤IDï¼Œè§„åˆ’ä¸ºåŒä¸€ä¸ªé›†ç¾¤çš„clusterIdè¦ç›¸åŒ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">clusterId</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mycat-cluster</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># æ¯ä¸ªèŠ‚ç‚¹çš„ID,ä¸èƒ½é‡å¤</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">myid</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mycat_fz_01</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># æ¯ä¸ªèŠ‚ç‚¹çš„åç§°ï¼Œéœ€è¦å…¨éƒ¨å†™è¿™é‡Œ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">clusterNodes</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mycat_fz_01,mycat_fz_02</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">server</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">boosterDataHosts</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">dataHost1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼ æ–‡ä»¶å†…å®¹åˆ°zké›†ç¾¤</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># è¿™ä¸ªå‘½ä»¤éœ€è¦åœ¨$MyCat/binç›®å½•ä¸‹æ‰§è¡Œå¦åˆ™ç›®å½•ä½ç½®ä¼šå‡ºç°é—®é¢˜</span>
</span></span><span style="display:flex;"><span>init_zk_data.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬å››æ­¥ï¼šé‡å¯mycat</strong></p>
<blockquote>
<p>æ­¤æ—¶å¯ä»¥æŸ¥çœ‹é›†ç¾¤ä¸­æ‰€æœ‰mycaté…ç½®æ˜¯å¦ä¸€è‡´</p>
</blockquote>
<h3 id="mycatè‡ªèº«é«˜å¯ç”¨">MyCatè‡ªèº«é«˜å¯ç”¨</h3>
<h4 id="æ­å»ºhaproxyå®ç°mycatåå°è´Ÿè½½å‡è¡¡">æ­å»ºHaproxyå®ç°Mycatåå°è´Ÿè½½å‡è¡¡</h4>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå®‰è£…Haproxy</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yum install haproxy
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬äºŒæ­¥ï¼šä¿®æ”¹<code>/etc/haproxy/haproxy.cfg</code>çš„é…ç½®</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cfg" data-lang="cfg"><span style="display:flex;"><span><span style="color:#008080">global</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">chroot      /var/lib/haproxy</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">pidfile     /var/run/haproxy.pid</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">maxconn     4000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">user        haproxy</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">group       haproxy</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">daemon</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">stats socket /var/lib/haproxy/stats</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008080">defaults</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">mode                    http</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">log                     global</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">option                  httplog</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">option                  dontlognull</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">option http-server-close</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># ä½¿ç”¨tcpæ—¶æ³¨é‡Šæ‰è¦ä¸ä¼šæœ‰è­¦å‘Š</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># option forwardfor       except 127.0.0.0/8</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">option                  redispatch</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">retries                 3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">timeout http-request    10s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">timeout queue           1m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">timeout connect         10s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">timeout client          1m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">timeout server          1m</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">timeout http-keep-alive 10s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">timeout check           10s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">maxconn                 3000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># haproxyç®¡ç†å‘˜ç™»é™†ç•Œé¢</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">listen admin_stats</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">bind 0.0.0.0:4001</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">mode http</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">stats uri /stats</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">stats realm Haproxy\ Statistics</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">stats auth admin:admin</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">stats admin if TRUE</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># mycatæœåŠ¡è´Ÿè½½</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">listen allmycat_service</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">bind    0.0.0.0:8069</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">mode    tcp</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">option  tcplog</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">balance roundrobin</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">server  mycat1 192.168.1.158:8066 check inter 5s rise 2 fall 3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">server  mycat2 192.168.1.149:8066 check inter 5s rise 2 fall 3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">option  tcpka  #keepalivedæ­»é“¾æ£€æµ‹</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># mycatç›‘æ§ç«¯å£è´Ÿè½½</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">listen allmycat_admin</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">bind    0.0.0.0:9069</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">mode    tcp</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">option  tcplog</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">balance roundrobin</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">server  mycat1 192.168.1.158:9066 check inter 5s rise 2 fall 3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">server  mycat2 192.168.1.149:9066 check inter 5s rise 2 fall 3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008080">option  tcpka  #keepalivedæ­»é“¾æ£€æµ‹</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬ä¸‰æ­¥ï¼šæ£€æŸ¥å¯åŠ¨</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®</span>
</span></span><span style="display:flex;"><span>haproxy -c -f /etc/haproxy/haproxy.cfg
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># å¯åŠ¨</span>
</span></span><span style="display:flex;"><span>haproxy -f /etc/haproxy/haproxy.cfg
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="æ­å»ºkeepalivedä½œç”¨äºhaproxyå®ç°é«˜å¯ç”¨">æ­å»ºkeepalivedä½œç”¨äºhaproxyå®ç°é«˜å¯ç”¨</h4>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå®‰è£…keepalived</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yum install keepalived
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬äºŒæ­¥ï¼šä¿®æ”¹<code>/etc/keepalived/keepalived.conf</code>çš„é…ç½®</strong></p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">! Configuration File for keepalived

global_defs {
   # æ¯ä¸ªèŠ‚ç‚¹ä¸ä¸€æ ·
   router_id 152
}

# æ£€æŸ¥è„šæœ¬é…ç½®ã€‚å¿…é¡»åœ¨ä½¿ç”¨è„šæœ¬ä¹‹å‰é…ç½®å¥½
vrrp_script check_haproxy {
    script &#34;/etc/keepalived/check_haproxy.sh&#34;
    interval 2  #æ£€æµ‹æ—¶é—´é—´éš”
    weight -20  #å¦‚æœæ¡ä»¶æˆç«‹åˆ™æƒé‡å‡20
}

vrrp_instance VI_1 {
    # åˆ†ä¸ºMASTERå’ŒBACKUP
    state MASTER
    # ç½‘å¡
    interface enp0s3
    # åŒä¸€ç»„keepaliveæ­¤å€¼ä¸€æ ·ç”¨äºåŒºåˆ†ç»„
    virtual_router_id 101
    # ä¼˜å…ˆçº§åˆ«
    priority 100
    # éæŠ¢å æ¨¡å¼ï¼ŒMASTERæœ‰ç”¨
    nopreempt
    # å¹¿æ’­ä¼˜å…ˆçº§é—´éš”æ—¶é—´
    advert_int 1
    authentication {
        auth_type PASS
        auth_pass 1111
    }
    virtual_ipaddress {
      192.168.1.101
    }
    # è¦æ”¾åœ¨VIPåé¢
    track_script {
        check_haproxy
    }
}
</code></pre><p><strong>ç¬¬ä¸‰æ­¥ï¼šé…ç½®æ£€æŸ¥è„šæœ¬ã€å¿…é¡»è¦æœ‰æ‰§è¡Œæƒé™ã€‘</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic"></span>
</span></span><span style="display:flex;"><span><span style="color:#008080">A</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">`</span>ps -C haproxy --no-header |wc -l<span style="color:#d14">`</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">[</span> <span style="color:#008080">$A</span> -eq <span style="color:#099">0</span> <span style="color:#000;font-weight:bold">]</span>;<span style="color:#000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> <span style="color:#d14">&#34;`date` haproxy is dead&#34;</span> &gt;&gt; /tmp/lvs.log
</span></span><span style="display:flex;"><span>    haproxy  -f /etc/haproxy/haproxy.cfg
</span></span><span style="display:flex;"><span>    sleep <span style="color:#099">2</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">[</span> <span style="color:#d14">`</span>ps -C haproxy --no-header |wc -l<span style="color:#d14">`</span> -eq <span style="color:#099">0</span> <span style="color:#000;font-weight:bold">]</span>;<span style="color:#000;font-weight:bold">then</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> <span style="color:#d14">&#34;`date` haproxy cannot start,stop keepalived&#34;</span> &gt;&gt; /tmp/lvs.log
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># æ€æ­»keepalived</span>
</span></span><span style="display:flex;"><span>    ps -C keepalived --no-header | awk <span style="color:#d14">&#39;{print $1}&#39;</span>|xargs <span style="color:#0086b3">kill</span> -9
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">exit</span> <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">echo</span> <span style="color:#d14">&#34;`date` haproxy restart&#34;</span> &gt;&gt; /tmp/lvs.log
</span></span><span style="display:flex;"><span>    <span style="color:#0086b3">exit</span> <span style="color:#099">1</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬å››æ­¥ï¼šå¯åŠ¨keepalivedå’ŒæŸ¥çœ‹æ—¥å¿—</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>keepalived -f /etc/keepalived/keepalived.conf
</span></span><span style="display:flex;"><span>tail -f -n <span style="color:#099">50</span> /var/log/messages
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å…­mycatç›‘æ§">å…­ã€MyCatç›‘æ§</h2>
<h3 id="ä½¿ç”¨mycatç”Ÿæˆæ‰§è¡Œsqlè®°å½•">ä½¿ç”¨MyCatç”Ÿæˆæ‰§è¡ŒSQLè®°å½•</h3>
<p>åœ¨server.xmlçš„systemæ ‡ç­¾ä¸‹é…ç½®æ‹¦æˆª</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;system&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- é…ç½®æ‹¦æˆªå™¨ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;sqlInterceptor&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    io.mycat.server.interceptor.impl.StatisticsSqlInterceptor
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- é…ç½®æ‹¦æˆªSQLç±»å‹ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;sqlInterceptorType&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    selectï¼Œupdateï¼Œinsertï¼Œdelete
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- é…ç½®SQLç”Ÿæˆæ–‡ä»¶ä½ç½® --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;sqlInterceptorFile&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    /opt/mycat/InterceptorFile/sql.txt
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/property&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/system&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mycatå‘½ä»¤è¡Œç®¡ç†å·¥å…·">MyCatå‘½ä»¤è¡Œç®¡ç†å·¥å…·</h3>
<p>ä½¿ç”¨å<code> mysql -u[username] -p -P[ç®¡ç†ç«¯å£ï¼Œé»˜è®¤9066] -h[ip]</code>è¿æ¥MyCatå‘½ä»¤è¡Œç®¡ç†ç«¯</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic">-- å¸®åŠ©å‘½ä»¤
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span>help<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">\</span>G;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- é‡æ–°åŠ è½½é…ç½®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>reload<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span>config;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>reload<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span>config_all;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- æ˜¾ç¤ºç‰©ç†æœåŠ¡å™¨ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span><span style="color:#000;font-weight:bold">databases</span><span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">\</span>G;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- æ˜¾ç¤ºdatanodeèŠ‚ç‚¹
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span>datanode<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">\</span>G;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- æ˜¾ç¤ºæ‰€æœ‰è¿æ¥ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span>connection<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">\</span>G;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- æ€æ­»è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">kill</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span>connection<span style="color:#bbb"> </span>id1,id2,...<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- å±•ç¤ºåå°é“¾æ¥è¯¦ç»†ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span>backend<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">\</span>G;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- æ˜¾ç¤ºå½“å‰ç¼“å­˜ä¿¡æ¯ï¼ˆERåˆ†ç‰‡ä¿¡æ¯ã€ä¸»é”®ç¼“å­˜ã€è·¯ç”±ç¼“å­˜ï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span>cache<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">\</span>G;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- æ˜¾ç¤ºé…ç½®çš„ç‰©ç†æœåŠ¡å™¨ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">@@</span>datasource<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">\</span>G;<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="mycatçš„guiç®¡ç†å·¥å…·">MyCatçš„GUIç®¡ç†å·¥å…·</h3>
<p>ä½¿ç”¨mycat-webå¯ä»¥æ›´åŠ ç›´è§‚çš„çœ‹åˆ°<strong>mycaté›†ç¾¤çŠ¶æ€</strong>ï¼Œ<a href="http://dl.mycat.io/mycat-web-1.0">ä¸‹è½½åœ°å€</a>ï¼Œé…ç½®æ—¶æ³¨æ„ä¿®æ”¹<code>mycat-web/WEB-INF/classes/mycat.properties</code>ï¼Œé»˜è®¤è®¿é—®åœ°å€<code>http://ip:8082/mycat</code></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># åªéœ€ä¿®æ”¹zookeeperè¿™è¡Œ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">zookeeper</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">localhost:2181</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/img/mycat/mycat-web.png" alt="mycat-web"></p>
<h2 id="ä¸ƒmycatçš„é™åˆ¶">ä¸ƒã€MyCatçš„é™åˆ¶</h2>
<h3 id="mycatä¸æ”¯æŒçš„sqlè¯­å¥">MyCatä¸æ”¯æŒçš„SQLè¯­å¥</h3>
<ul>
<li>DDLè¯­å¥ã€å¦‚ï¼šcreate table like xxx / create table select xxx / create tableã€‘</li>
<li>è·¨åº“å¤šè¡¨å…³è”ï¼Œå­æŸ¥è¯¢</li>
<li>select for update/select lock in share modeã€è¿™ä¿©è¯­å¥åªä¼šéšæœºå‘é€åˆ°åç«¯ä¸€ä¸ªèŠ‚ç‚¹å¯¼è‡´æ•°æ®åº“å‡ºç°é—®é¢˜ã€‘</li>
<li>å¤šè¡¨updateæˆ–updateåˆ†ç‰‡é”®</li>
<li>è·¨åˆ†ç‰‡çš„å¸¦æœ‰limitçš„update/delete</li>
</ul>
<h3 id="å¯¹äº‹åŠ¡çš„æ”¯æŒæœ‰é™xa-äº‹åŠ¡">å¯¹äº‹åŠ¡çš„æ”¯æŒæœ‰é™ï¼ˆXA äº‹åŠ¡ï¼‰</h3>
<p><img src="/img/mycat/xa.png" alt="xa"></p>
<p>ç¬¬ä¸€æ­¥ï¼šåƒåå°æ•°æ®åº“å‘é€begin</p>
<p>ç¬¬äºŒæ­¥ï¼šå‘é€æ‰§è¡Œçš„SQLï¼Œç­‰å¾…æ‰€æœ‰èŠ‚ç‚¹éƒ½è¿”å›æˆåŠŸæ‰æ‰§è¡Œä¸‹é¢æ­¥éª¤ï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªè¿”å›å¤±è´¥ï¼Œå…¨éƒ¨rollback</p>
<p>ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œcommitç­‰å¾…æ‰€æœ‰èŠ‚ç‚¹è¿”å›ï¼Œç­‰å¾…ç»“æœè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªè¿”å›å¤±è´¥ï¼Œè¿”å›äº‹åŠ¡å¤„ç†å¤±è´¥</p>
<blockquote>
<p>å¦‚æœæœ‰commitè¿‡ç¨‹ä¸­ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹æŠ¥é”™ï¼Œæ•°æ®ä¸€è‡´æ€§å°†æ— æ³•ä¿è¯ï¼ˆå¯èƒ½æ€§å¾ˆå°ï¼‰</p>
</blockquote>

    </div>

    

    <div class="container-comment-giscus">
        <script src="https://giscus.app/client.js"
        data-repo="loveminimal/comment"
        data-repo-id="R_kgDOJNJQ8g"
        data-category="General"
        data-category-id="DIC_kwDOJNJQ8s4CYl0m"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="noborder_light"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
        </script>
</div>
</div>

        </div>
        <div id="footer"><div class="container-footer">
    

    <div class="beian">
        
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41092802000242">
            

        </a>

        
        <a href="//beian.miit.gov.cn" target="_blank">
            
            <span class="some">icp...<span>
            
        </a>
    </div>

    
    <div class="info">
        
        <a href="https://github.com/loveminimal/hugo-theme-virgo">ğŸ•Šï¸</a> 2016 - <span id="info-date"></span>
    </div>

</div></div>
        <div class="cool-after" style="
            
                background-color: rgba(255, 255, 255, 0.49); 
                backdrop-filter: saturate(100%) blur(6px);
            
            "></div>
    </body>
</html>
