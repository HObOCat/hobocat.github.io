<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="MySQLÊï∞ÊçÆÂ∫ìÊÄßËÉΩÂèäÂÖ∂Êû∂ÊûÑ‰ºòÂåñ - https://hobocat.github.io/post/database/2019-11-06-mysql/">
    <meta name="author" content="Jack - https://hobocat.github.io/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>MySQLÊï∞ÊçÆÂ∫ìÊÄßËÉΩÂèäÂÖ∂Êû∂ÊûÑ‰ºòÂåñ</title>
    
    <base target="_blank">
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    
    
    
    
    <link rel="stylesheet" href="https://hobocat.github.io/style.min.94e7ed14b48117025ebd1148adc11f7268f1ebf50d97297ac663edf1aa6f52dc.css">
    
    <script>const DARK =  false ;</script>
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div class="container-floating-box">
	<div class="box box1"></div>
	<div class="box box11"></div>
	<div class="box box12"></div>
	<div class="box box2"></div>
	<div class="box box3"></div>
	<div class="box box4"></div>
	<div class="box box5"></div>
	<div class="box box6"></div>
	<div class="box box7"></div>
	<div class="box box8"></div>
	<div class="box box9"></div>
</div>
        <div class="cool-before" style="background: url('/imgs/bg/wallhaven-6qr21l.jpg') left top/100% no-repeat fixed;"></div>
        <div id="header" class=""><div class="container-header">

    
    
    
    <div class="right">
        
        <h1 class="title">MySQLÊï∞ÊçÆÂ∫ìÊÄßËÉΩÂèäÂÖ∂Êû∂ÊûÑ‰ºòÂåñ</h1>
    
        
        
            <div id="toc">üìú</div>
        
    </div>
</div>
</div>
        <div id="content">










<div class="container-main container-page ">

    

    
    
    
    <div class="rel">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </div>
    
    

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="7409" width="12" height="12">
                <path
                    d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z"
                    p-id="7410" fill="#adb5bd"></path>
            </svg>
            2019-11-06&nbsp;&nbsp;&nbsp;
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="23838" width="11" height="11">
                <path
                    d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z"
                    p-id="23839" fill="#adb5bd"></path>
            </svg>
            2024-05-15&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="33866" width="12" height="12">
                <path
                    d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z"
                    fill="#adb5bd" p-id="33867"></path>
                <path
                    d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z"
                    fill="#adb5bd" p-id="33868"></path>
            </svg>
            25436 Â≠ó</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="32892" width="12" height="12">
                <path
                    d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z"
                    p-id="32893" fill="#adb5bd"></path>
                <path
                    d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z"
                    p-id="32894" fill="#adb5bd"></path>
            </svg>
            51 ÂàÜÈíü</span>
        <div class="container-ctgtag">
	<div class="taxonomy">
		<div class="tag">
			
			
			<a href="/tags/database">database</a>
			
		</div>
	</div>
</div>
        
    </div>

    <div class="toc">
        <div class="container-page-operation">
	<div class="page-operation">
		<div><a href="/"><img src="/imgs/icons/home-2.svg" alt=""></a></div>
		<div><a href="/nav"><img src="/imgs/icons/iov-navigate-1.svg" alt=""></a></div>
		<div><a href="/wiki"><img src="/imgs/icons/wiki.svg" alt=""></a></div>
		<div><a href="/tags"><img src="/imgs/icons/treetags.svg" alt=""></a></div>
		<div id="light-dark"><a><img src="/imgs/icons/moon2.svg" alt=""></a></div>
		<div><a href="#"><img src="/imgs/icons/up2.svg" alt=""></a></div>
	</div>
</div>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#‰∏ÄÂÆâË£Ömysql">‰∏Ä„ÄÅÂÆâË£ÖMySQL</a>
      <ul>
        <li><a href="#yumÊ∫ê‰∏ãËΩΩÊñπÂºè">YumÊ∫ê‰∏ãËΩΩÊñπÂºè</a></li>
      </ul>
    </li>
    <li><a href="#‰∫åÊìç‰ΩúÁ≥ªÁªüÊÄßËÉΩ‰ºòÂåñ">‰∫å„ÄÅÊìç‰ΩúÁ≥ªÁªüÊÄßËÉΩ‰ºòÂåñ</a>
      <ul>
        <li><a href="#ÂÜÖÊ†∏Áõ∏ÂÖ≥ÂèÇÊï∞ËÆæÁΩÆetcsysctlconf">ÂÜÖÊ†∏Áõ∏ÂÖ≥ÂèÇÊï∞ËÆæÁΩÆÔºà/etc/sysctl.confÔºâ</a></li>
        <li><a href="#ËµÑÊ∫êÊñá‰ª∂ËÆæÁΩÆetcsecuritylimitsconf">ËµÑÊ∫êÊñá‰ª∂ËÆæÁΩÆÔºà/etc/security/limits.confÔºâ</a></li>
        <li><a href="#Á£ÅÁõòË∞ÉÂ∫¶Á≠ñÁï•">Á£ÅÁõòË∞ÉÂ∫¶Á≠ñÁï•</a></li>
        <li><a href="#Êñá‰ª∂Á≥ªÁªüÈÄâÊã©">Êñá‰ª∂Á≥ªÁªüÈÄâÊã©</a></li>
      </ul>
    </li>
    <li><a href="#‰∏âmysqlÂ≠òÂÇ®ÂºïÊìéÁöÑÈÄâÊã©">‰∏â„ÄÅMySQLÂ≠òÂÇ®ÂºïÊìéÁöÑÈÄâÊã©</a>
      <ul>
        <li><a href="#myisamÂ≠òÂÇ®ÂºïÊìé">MyISAMÂ≠òÂÇ®ÂºïÊìé</a></li>
        <li><a href="#innodbÂ≠òÂÇ®ÂºïÊìé">InnoDBÂ≠òÂÇ®ÂºïÊìé</a></li>
        <li><a href="#csvÂ≠òÂÇ®ÂºïÊìé">CSVÂ≠òÂÇ®ÂºïÊìé</a></li>
        <li><a href="#archiveÂ≠òÂÇ®ÂºïÊìé">ArchiveÂ≠òÂÇ®ÂºïÊìé</a></li>
        <li><a href="#memoryÂ≠òÂÇ®ÂºïÊìé">MemoryÂ≠òÂÇ®ÂºïÊìé</a></li>
        <li><a href="#federatedÂ≠òÂÇ®ÂºïÊìé">FederatedÂ≠òÂÇ®ÂºïÊìé</a></li>
      </ul>
    </li>
    <li><a href="#ÂõõmysqlÊúçÂä°ÂèÇÊï∞ÈÖçÁΩÆ">Âõõ„ÄÅMySQLÊúçÂä°ÂèÇÊï∞ÈÖçÁΩÆ</a>
      <ul>
        <li><a href="#ÂÜÖÂ≠òÁõ∏ÂÖ≥ÂèÇÊï∞">ÂÜÖÂ≠òÁõ∏ÂÖ≥ÂèÇÊï∞</a></li>
        <li><a href="#ioÁõ∏ÂÖ≥ÂèÇÊï∞">I/OÁõ∏ÂÖ≥ÂèÇÊï∞</a></li>
        <li><a href="#ÂÆâÂÖ®Áõ∏ÂÖ≥ÂèÇÊï∞">ÂÆâÂÖ®Áõ∏ÂÖ≥ÂèÇÊï∞</a></li>
        <li><a href="#ÂÖ∂ÂÆÉÁõ∏ÂÖ≥ÂèÇÊï∞">ÂÖ∂ÂÆÉÁõ∏ÂÖ≥ÂèÇÊï∞</a></li>
      </ul>
    </li>
    <li><a href="#‰∫îmysqlÂü∫ÂáÜÊµãËØï">‰∫î„ÄÅMySQLÂü∫ÂáÜÊµãËØï</a>
      <ul>
        <li><a href="#Âü∫ÂáÜÊµãËØïÁöÑÂÆö‰πâ">Âü∫ÂáÜÊµãËØïÁöÑÂÆö‰πâ</a></li>
        <li><a href="#Â∏∏ËßÅÊµãËØïÊåáÊ†á">Â∏∏ËßÅÊµãËØïÊåáÊ†á</a></li>
        <li><a href="#sysbenchÂÅöÂü∫ÂáÜÊµãËØï">sysbenchÂÅöÂü∫ÂáÜÊµãËØï</a></li>
      </ul>
    </li>
    <li><a href="#ÂÖ≠mysqlÂéãÂäõÊµãËØï">ÂÖ≠„ÄÅMySQLÂéãÂäõÊµãËØï</a></li>
    <li><a href="#‰∏ÉÊï∞ÊçÆÂ∫ìÁªìÊûÑËÆæËÆ°">‰∏É„ÄÅÊï∞ÊçÆÂ∫ìÁªìÊûÑËÆæËÆ°</a>
      <ul>
        <li><a href="#Êï∞ÊçÆÂ∫ìËÆæËÆ°ËåÉÂºè">Êï∞ÊçÆÂ∫ìËÆæËÆ°ËåÉÂºè</a></li>
        <li><a href="#Êï∞ÊçÆÂ∫ìÁâ©ÁêÜËÆæËÆ°">Êï∞ÊçÆÂ∫ìÁâ©ÁêÜËÆæËÆ°</a></li>
        <li><a href="#ÂàÜÂå∫Ë°®ÁöÑ‰ΩøÁî®">ÂàÜÂå∫Ë°®ÁöÑ‰ΩøÁî®</a></li>
      </ul>
    </li>
    <li><a href="#ÂÖ´‰∏ª‰ªéÊ®°Âºè">ÂÖ´„ÄÅ‰∏ª‰ªéÊ®°Âºè</a>
      <ul>
        <li><a href="#mysql‰∫åËøõÂà∂Êó•Âøó">MySQL‰∫åËøõÂà∂Êó•Âøó</a></li>
        <li><a href="#mysqlÁöÑÂ§çÂà∂Â∑•‰ΩúÊñπÂºè">MySQLÁöÑÂ§çÂà∂Â∑•‰ΩúÊñπÂºè</a></li>
        <li><a href="#mysql‰∏ª‰ªéÊê≠Âª∫">MySQL‰∏ª‰ªéÊê≠Âª∫</a></li>
        <li><a href="#mysqlÁöÑÂ§çÂà∂ÊãìÊâë">MySQLÁöÑÂ§çÂà∂ÊãìÊâë</a></li>
        <li><a href="#Â§çÂà∂ÊÄßËÉΩ‰ºòÂåñ">Â§çÂà∂ÊÄßËÉΩ‰ºòÂåñ</a></li>
        <li><a href="#ÂçäÂêåÊ≠•Â§çÂà∂">ÂçäÂêåÊ≠•Â§çÂà∂</a></li>
        <li><a href="#span-iddelay-repÂª∂ËøüÂ§çÂà∂span"><span id="delay-rep">Âª∂ËøüÂ§çÂà∂</span></a></li>
      </ul>
    </li>
    <li><a href="#‰πùÈ´òÂèØÁî®Êû∂ÊûÑ">‰πù„ÄÅÈ´òÂèØÁî®Êû∂ÊûÑ</a>
      <ul>
        <li><a href="#mmmmulti-master-replication-manager">MMM(Multi-Master Replication Manager)</a></li>
        <li><a href="#mhamaster-high-availability">MHA(Master High Availability)</a></li>
        <li><a href="#‰ΩøÁî®‰∏≠Èó¥‰ª∂ËØªÂÜôÂàÜÁ¶ªÂíåË¥üËΩΩÂùáË°°">‰ΩøÁî®‰∏≠Èó¥‰ª∂ËØªÂÜôÂàÜÁ¶ªÂíåË¥üËΩΩÂùáË°°</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅÁ¥¢Âºï‰ºòÂåñ">ÂçÅ„ÄÅÁ¥¢Âºï‰ºòÂåñ</a>
      <ul>
        <li><a href="#btreeÁ¥¢Âºï">BTreeÁ¥¢Âºï</a></li>
        <li><a href="#hashÁ¥¢Âºï">HashÁ¥¢Âºï</a></li>
        <li><a href="#‰ΩøÁî®Á¥¢ÂºïÁöÑ‰ºòÁÇπ">‰ΩøÁî®Á¥¢ÂºïÁöÑ‰ºòÁÇπ</a></li>
        <li><a href="#Êü•ÊâæÂÜ≤Á™Å‰∏çÂøÖË¶ÅÁöÑÁ¥¢Âºï">Êü•ÊâæÂÜ≤Á™Å‰∏çÂøÖË¶ÅÁöÑÁ¥¢Âºï</a></li>
        <li><a href="#Êü•Áúã‰ªéÊú™‰ΩøÁî®ÁöÑÁ¥¢Âºï">Êü•Áúã‰ªéÊú™‰ΩøÁî®ÁöÑÁ¥¢Âºï</a></li>
        <li><a href="#Êõ¥Êñ∞Á¥¢ÂºïÁªüËÆ°‰ø°ÊÅØÂáèÂ∞ëÁ¥¢ÂºïÁ¢éÁâáÂåñ">Êõ¥Êñ∞Á¥¢ÂºïÁªüËÆ°‰ø°ÊÅØ&amp;ÂáèÂ∞ëÁ¥¢ÂºïÁ¢éÁâáÂåñ</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅ‰∏Äsql‰ºòÂåñ">ÂçÅ‰∏Ä„ÄÅSQL‰ºòÂåñ</a>
      <ul>
        <li><a href="#Ëé∑ÂèñÂ≠òÂú®ÊÄßËÉΩÈóÆÈ¢òÁöÑsql">Ëé∑ÂèñÂ≠òÂú®ÊÄßËÉΩÈóÆÈ¢òÁöÑSQL</a></li>
        <li><a href="#È¢ÑÂ§ÑÁêÜÂèäÁîüÊàêÊâßË°åËÆ°Âàí">È¢ÑÂ§ÑÁêÜÂèäÁîüÊàêÊâßË°åËÆ°Âàí</a></li>
        <li><a href="#Á°ÆÂÆöÊü•ËØ¢Â§ÑÁêÜÂêÑ‰∏™Èò∂ÊÆµÊ∂àËÄóÁöÑÊó∂Èó¥">Á°ÆÂÆöÊü•ËØ¢Â§ÑÁêÜÂêÑ‰∏™Èò∂ÊÆµÊ∂àËÄóÁöÑÊó∂Èó¥</a></li>
        <li><a href="#‰øÆÊîπÂ§ßË°®ÁªìÊûÑ">‰øÆÊîπÂ§ßË°®ÁªìÊûÑ</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅ‰∫åÂàÜÂ∫ìÂàÜË°®">ÂçÅ‰∫å„ÄÅÂàÜÂ∫ìÂàÜË°®</a></li>
    <li><a href="#ÂçÅ‰∏âÈÉ®ÂàÜÊ¶ÇÂøµ">ÂçÅ‰∏â„ÄÅÈÉ®ÂàÜÊ¶ÇÂøµ</a>
      <ul>
        <li><a href="#ÈîÅÁöÑÊ¶ÇÂøµ">ÈîÅÁöÑÊ¶ÇÂøµ</a></li>
        <li><a href="#b-Ê†ë--b-Ê†ë">B Ê†ë &amp; B+ Ê†ë</a></li>
        <li><a href="#span-idmysqlÂ§ÑÁêÜsqlËØ∑Ê±ÇÁöÑÂ§ßËá¥ÊµÅÁ®ãmysqlÂ§ÑÁêÜsqlËØ∑Ê±ÇÁöÑÂ§ßËá¥ÊµÅÁ®ãspan"><span id='MySQLÂ§ÑÁêÜSQLËØ∑Ê±ÇÁöÑÂ§ßËá¥ÊµÅÁ®ã'>MySQLÂ§ÑÁêÜSQLËØ∑Ê±ÇÁöÑÂ§ßËá¥ÊµÅÁ®ã</span></a></li>
        <li><a href="#mysqlÊó•ÂøóÂàÜÁ±ª">MySQLÊó•ÂøóÂàÜÁ±ª</a></li>
        <li><a href="#sqlÁöÑÊâßË°åÈ°∫Â∫èmysql‰∏∫‰æã">SQLÁöÑÊâßË°åÈ°∫Â∫èÔºàMySQL‰∏∫‰æãÔºâ</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅÂõõÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÊÅ¢Â§ç">ÂçÅÂõõ„ÄÅÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÊÅ¢Â§ç</a>
      <ul>
        <li><a href="#Êó•ÂøóÈó™Âõû">Êó•ÂøóÈó™Âõû</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅ‰∫î‰ºòÂåñÈô∑Èò±">ÂçÅ‰∫î„ÄÅ‰ºòÂåñÈô∑Èò±</a>
      <ul>
        <li><a href="#mysqlÊï∞ÊçÆÂ∫ìËÆæËÆ°Â∏∏ÁäØÁöÑÈîô‰ª•ÂèäÂØπÊÄßËÉΩÁöÑÂΩ±Âìç">MySQLÊï∞ÊçÆÂ∫ìËÆæËÆ°Â∏∏ÁäØÁöÑÈîô‰ª•ÂèäÂØπÊÄßËÉΩÁöÑÂΩ±Âìç</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div class='content  '>
        <h2 id="‰∏ÄÂÆâË£Ömysql">‰∏Ä„ÄÅÂÆâË£ÖMySQL</h2>
<h3 id="yumÊ∫ê‰∏ãËΩΩÊñπÂºè">YumÊ∫ê‰∏ãËΩΩÊñπÂºè</h3>
<p><strong>È¢ÑÂ§áÂ∑•‰Ωú</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yum -y install yum-utils		<span style="color:#998;font-style:italic">#ÂÆâË£Öyum-utils</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∏ÄÊ≠•Ôºö‰∏ãËΩΩyumÊ∫ê</strong></p>
<p>Âú®ÂÆòÁΩëÈÄâÊã©Downloads&ndash;&raquo;Community (GPL) Downloads &ndash;&raquo;MySQL Yum RepositoryÊúÄÊñ∞yumÊ∫ê</p>
<p><strong>Á¨¨‰∫åÊ≠•ÔºöÂÆâË£ÖyumÊ∫ê</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yum localinstall mysqlxx-community-release-ÁâàÊú¨Âè∑.rpm    <span style="color:#998;font-style:italic">#ÂÆâË£Öyum‰ø°ÊÅØ</span>
</span></span><span style="display:flex;"><span>yum repolist all | grep mysql                           <span style="color:#998;font-style:italic">#Êü•ÁúãÈªòËÆ§ÂÆâË£Ö‰ø°ÊÅØ</span>
</span></span><span style="display:flex;"><span>yum-config-manager --disable mysql80-community          <span style="color:#998;font-style:italic">#Á¶ÅÁî®mysql80</span>
</span></span><span style="display:flex;"><span>yum-config-manager --enable mysql57-community           <span style="color:#998;font-style:italic">#ÂêØÁî®mysql57</span>
</span></span><span style="display:flex;"><span>yum repolist enabled | grep mysql                       <span style="color:#998;font-style:italic">#Êü•ÁúãÊòØÂê¶Ê≠£Á°Æ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∏âÊ≠•ÔºöÂÆâË£Ömysql</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yum install -y mysql-community-server
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨ÂõõÊ≠•ÔºöÂêØÂä®mysqlÊúçÂä°</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>systemctl start mysqld
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∫îÊ≠•ÔºöÁôªÈôÜmysql</strong></p>
<p>mysqlÂàùÂßãÂåñrootÂØÜÁ†ÅÂú®logÊñá‰ª∂‰∏≠Ôºå‰ΩøÁî®more /etc/my.cnfÊü•ÁúãÊó•ÂøóÊñá‰ª∂‰ΩçÁΩÆÔºàÈªòËÆ§/var/log/mysqld.log)</p>
<p><strong>Á¨¨ÂÖ≠Ê≠•Ôºö‰øÆÊîπrootÂØÜÁ†Å</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">alter</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">user</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;root&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;localhost&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">identified</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;root&#39;</span>;<span style="color:#bbb">   </span><span style="color:#998;font-style:italic">-- Ê≤°Êúâ‰øÆÊîπÂØÜÁ†ÅÁ≠ñÁï•‰ºöÊèêÁ§∫ÂØÜÁ†ÅÂ§çÊùÇÂ∫¶‰∏çÂ§ü
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∏ÉÊ≠•ÔºöÂºÄÊîærootËøúÁ®ãÁôªÈôÜÊùÉÈôê</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">GRANT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ALL</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">PRIVILEGES</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ON</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span>.<span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">TO</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;root&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;%&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">IDENTIFIED</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">BY</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[newpwd]&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">WITH</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">GRANT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">OPTION</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">flush</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">privileges</span>;<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Ê≥®ÔºöÊµãËØïÁéØÂ¢É‰∏ãÂèØ‰ª•‰øÆÊîπÂØÜÁ†ÅÁ≠ñÁï•</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#458;font-weight:bold">set</span><span style="color:#bbb"> </span>global<span style="color:#bbb"> </span>validate_password_policy<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>;<span style="color:#bbb">  </span><span style="color:#998;font-style:italic">-- ËÆæÁΩÆÊ£ÄÊü•Á≠ñÁï•‰∏∫ÊúÄ‰Ωé0ÂíåLOW‰∏ÄÊ†∑
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#458;font-weight:bold">set</span><span style="color:#bbb"> </span>global<span style="color:#bbb"> </span>validate_password_length<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>;<span style="color:#bbb">  </span><span style="color:#998;font-style:italic">-- ËÆæÁΩÆÂØÜÁ†ÅÈïøÂ∫¶ÊúÄÂ∞ë‰∏∫1ÔºàÂÆûÈôÖ‰∏ämysql‰ºöËÆæÁΩÆ‰∏∫4Ôºâ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span>variables<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">like</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;%password%&#39;</span>;<span style="color:#bbb">       </span><span style="color:#998;font-style:italic">-- Êü•ÁúãÂØÜÁ†ÅÁõ∏ÂÖ≥‰ø°ÊÅØ
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="‰∫åÊìç‰ΩúÁ≥ªÁªüÊÄßËÉΩ‰ºòÂåñ">‰∫å„ÄÅÊìç‰ΩúÁ≥ªÁªüÊÄßËÉΩ‰ºòÂåñ</h2>
<h3 id="ÂÜÖÊ†∏Áõ∏ÂÖ≥ÂèÇÊï∞ËÆæÁΩÆetcsysctlconf">ÂÜÖÊ†∏Áõ∏ÂÖ≥ÂèÇÊï∞ËÆæÁΩÆÔºà/etc/sysctl.confÔºâ</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#############################################################</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#   ‰ª•‰∏ãÂèÇÊï∞‰ΩøÁî® sudo cat /proc/sys/x/y/zÊ†ºÂºèÂèØ‰ª•Êü•ÁúãÁ≥ªÁªüÂΩìÂâçÂÄº   #</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#   Â¶ÇÔºösudo cat /proc/sys/net/core/somaxconn                #</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#############################################################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÈªòËÆ§ÂÄºÊòØ128ÔºàÁ≥ªÁªü‰∏≠ÊØè‰∏™Á´ØÂè£ÊúÄÂ§ßÁõëÂê¨ÈòüÂàóÈïøÂ∫¶ÔºâÔºåÂØπ‰∫éË¥üËΩΩÂ§ßÁöÑÊúçÂä°Ëøú‰∏çÂ§ü„ÄÇ‰∏ÄËà¨‰ºöÂ∞ÜÂÆÉ‰øÆÊîπ‰∏∫2048ÊàñËÄÖÊõ¥Â§ß</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.core.somaxconn</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">2048	</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊØè‰∏™ÁΩëÁªúÊé•Âè£Êé•Êî∂Êï∞ÊçÆÂåÖÁöÑÈÄüÁéáÊØîÂÜÖÊ†∏Â§ÑÁêÜËøô‰∫õÂåÖÁöÑÈÄüÁéáÂø´Êó∂ÔºåÁºìÂÜ≤ÈòüÂàóÁöÑÊï∞ÊçÆÂåÖÁöÑÊúÄÂ§ßÊï∞ÁõÆÔºåÈªòËÆ§ÂÄº‰∏∫1000</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.core.netdev_max_backlog</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">2000</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Â∞öÊú™Êî∂Âà∞ÂÆ¢Êà∑Á´ØÁ°ÆËÆ§‰ø°ÊÅØÁöÑËøûÊé•ËØ∑Ê±ÇÁöÑÊúÄÂ§ßÂÄºÔºàÊéíÈòüÊè°ÊâãÂÄºÔºåÈªòËÆ§128Ôºâ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.ipv4.tcp_max_syn_backlog</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">2048</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># tcpËøûÊé•ÈªòËÆ§ÁöÑtimeoutÊó∂ÈïøÔºåÈªòËÆ§60</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.ipv4.tcp_fin_timeout</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">10</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Êõ¥Âø´ÁöÑÂõûÊî∂Â•óÊé•Â≠óÔºåÈªòËÆ§0</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.ipv4.tcp_tw_recycle</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">1</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂÖÅËÆ∏Â∞ÜTIME-WAIT socketsÈáçÊñ∞Áî®‰∫éÊñ∞ÁöÑTCPËøûÊé•ÔºåÈªòËÆ§‰∏∫0</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.ipv4.tcp_tw_reuse</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÈªòËÆ§TCPÊï∞ÊçÆÂèëÈÄÅÁ™óÂè£Â§ßÂ∞èÔºåÈªòËÆ§229376ÔºàÂ≠óËäÇÔºâ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.core.wmem_default</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">256960</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊúÄÂ§ßTCPÊï∞ÊçÆÂèëÈÄÅÁ™óÂè£Â§ßÂ∞èÔºåÈªòËÆ§229376ÔºàÂ≠óËäÇÔºâ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.core.wmem_max</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">16777216</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÈªòËÆ§TCPÊï∞ÊçÆÊé•Êî∂Á™óÂè£Â§ßÂ∞è,ÈªòËÆ§229376</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.core.rmem_default</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">256960</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊúÄÂ§ßTCPÊï∞ÊçÆÊé•Êî∂Á™óÂè£Â§ßÂ∞èÔºåÈªòËÆ§229376ÔºàÂ≠óËäÇÔºâ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.core.rmem_max</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">16777216</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># TCPÂèëÈÄÅkeepaliveÊ∂àÊÅØÁöÑÊó∂Èó¥Èó¥ÈöîÔºåÈªòËÆ§7200</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.ipv4.tcp_keepalive_time</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">120</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Êé¢ÊµãÊ∂àÊÅØÊú™Ëé∑ÂæóÂìçÂ∫îÊó∂ÔºåÈáçÂèëËØ•Ê∂àÊÅØÁöÑÊó∂Èó¥Èó¥ÈöîÔºåÈªòËÆ§75</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.ipv4.tcp_keepalive_intvl</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">30</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ËÆ§ÂÆöTCPËøûÊé•Â§±Ë¥•Â§±Êïà‰πãÂâçÔºåÊúÄÂ§öÂèëÈÄÅÂ§öÂ∞ëkeepaliveÊ∂àÊÅØÔºåÈªòËÆ§9</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">net.ipv4.tcp_keepalive_probes</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âçï‰∏™ÂÖ±‰∫´ÂÜÖÂ≠òÊÆµÁöÑÊúÄÂ§ßÂÄº„ÄÇËøô‰∏™ÂÄºÂ∫îËØ•ËÆæÁΩÆË∂≥Â§üÂ§ßÔºå‰æø‰∫é‰∏Ä‰∏™ÂÖ±‰∫´ÂÜÖÂ≠òÊÆµÂèØ‰ª•ÂÆπÁ∫≥Êï¥‰∏™innodbÁºìÂÜ≤Ê±†Â§ßÂ∞è</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âª∫ËÆÆËÆæÁΩÆ‰∏∫Áâ©ÁêÜÂÜÖÂ≠ò‰∏ÄÂçä</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">kernel.shmmax</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">17179869184</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># swappinessÁöÑÂÄºË∂äÂ§ßÔºåË°®Á§∫Ë∂äÁßØÊûÅ‰ΩøÁî®swapÂàÜÂå∫Ôºå‰∏∫0Ë°®Á§∫Èô§ÈùûÂÜÖÂ≠òÊª°‰∫ÜÊâç‰ΩøÁî®„ÄÇÈªòËÆ§ÂÄºswappiness=60</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">vm.swappiness</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">0</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰ΩøÁî® <code>sysctl -p</code>‰Ωø‰πãÁîüÊïà</p>
<h3 id="ËµÑÊ∫êÊñá‰ª∂ËÆæÁΩÆetcsecuritylimitsconf">ËµÑÊ∫êÊñá‰ª∂ËÆæÁΩÆÔºà/etc/security/limits.confÔºâ</h3>
<pre tabindex="0"><code class="language-conf" data-lang="conf">#&lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;
 mysql         hard    nofile         65535			#ËÆæÁΩÆmysqlÂèØÊâìÂºÄÊñá‰ª∂Êï∞
 mysql         soft    nofile         65535
</code></pre><p>ÈúÄÈáçÂêØÁîüÊïà</p>
<h3 id="Á£ÅÁõòË∞ÉÂ∫¶Á≠ñÁï•">Á£ÅÁõòË∞ÉÂ∫¶Á≠ñÁï•</h3>
<ul>
<li>cfqÔºöÂÆåÂÖ®ÂÖ¨Âπ≥Ë∞ÉÂ∫¶Á≠ñÁï•ÔºåÊ°åÈù¢Á∫ßÁ≥ªÁªüËæÉ‰∏∫ÂêàÈÄÇ</li>
<li>noopÔºö ÁîµÊ¢ØÂºèË∞ÉÂ∫¶Á®ãÂ∫è ÔºåFIFOÈòüÂàóÔºåÂÆÉÂÉèÁîµÊ¢ØÁöÑÂ∑•‰Ωú‰∏ªÊ≥ï‰∏ÄÊ†∑ÂØπI/OËØ∑Ê±ÇËøõË°åÁªÑÁªáÔºåÂΩìÊúâ‰∏Ä‰∏™Êñ∞ÁöÑËØ∑Ê±ÇÂà∞Êù•Êó∂ÔºåÂÆÉÂ∞ÜËØ∑Ê±ÇÂêàÂπ∂Âà∞ÊúÄËøëÁöÑËØ∑Ê±Ç‰πãÂêé,‰ª•Ê≠§Êù•‰øùËØÅËØ∑Ê±ÇÂêå‰∏Ä‰ªãË¥®</li>
<li>deadlineÔºöÊà™Ëá≥Êó∂Èó¥Ë∞ÉÂ∫¶Á≠ñÁï•ÔºåËøô‰∏™Êà™Ê≠¢Êó∂Èó¥ÊòØÂèØË∞ÉÊï¥ÁöÑ,ËÄåÈªòËÆ§ËØªÊúüÈôêÁü≠‰∫éÂÜôÊúüÈôê.ËøôÊ†∑Â∞±Èò≤Ê≠¢‰∫ÜÂÜôÊìç‰ΩúÂõ†‰∏∫‰∏çËÉΩË¢´ËØªÂèñËÄåÈ•øÊ≠ªÁöÑÁé∞Ë±°[ÈÄÇÂêàmysql]</li>
</ul>
<p><code>echo deadline &gt; /sys/block/[devName]/queue/scheduler</code>‰øÆÊîπË∞ÉÂ∫¶Á≠ñÁï•</p>
<h3 id="Êñá‰ª∂Á≥ªÁªüÈÄâÊã©">Êñá‰ª∂Á≥ªÁªüÈÄâÊã©</h3>
<p>LinuxÊèê‰æõÁöÑEXT3„ÄÅEXT4„ÄÅXFSÊñá‰ª∂Á≥ªÁªüÂùáÂÖ∑ÊúâÊó•ÂøóÂäüËÉΩÔºåÂèØ‰øùËØÅÊï∞ÊçÆÂÆâÂÖ®„ÄÇÂÖ∂‰∏≠Â±ûXFSÊÄßËÉΩÊúÄÈ´ò„ÄÇ<code> df -T</code>Êü•ÁúãÊñá‰ª∂Á≥ªÁªüÊ†ºÂºè</p>
<p>Â¶ÇÊûúÊòØEXT3/EXT4ÂèØËøõË°å‰ª•‰∏ã‰ºòÂåñÔºà/etc/fastabÔºâ</p>
<pre tabindex="0"><code class="language-conf" data-lang="conf"># noatime     Á¶ÅÊ≠¢ËÆ∞ÂΩïËÆøÈóÆÊó∂Èó¥
# nodirname   Á¶ÅÊ≠¢ËÆ∞ÂΩïÁõÆÂΩïÊó∂Èó¥
# data
#    wirteback   ‰ªÖÂÜôÂÖ•ÂÖÉÊï∞ÊçÆ‚ÄìinnodbÊúÄÂ•Ω
#    ordered     ÂÜôÂÖÉÊï∞ÊçÆÂíåÊï∞ÊçÆ
#    journal     ÂÖàËÆ°ÂÖ•Êó•Âøó
/dev/[devName]/ext4 noatime,nodirname,data=wirteback 1 1
</code></pre><h2 id="‰∏âmysqlÂ≠òÂÇ®ÂºïÊìéÁöÑÈÄâÊã©">‰∏â„ÄÅMySQLÂ≠òÂÇ®ÂºïÊìéÁöÑÈÄâÊã©</h2>
<p><img src="/img/mysql/mysql-sturct.png" alt="mysql-sturct"></p>
<h3 id="myisamÂ≠òÂÇ®ÂºïÊìé">MyISAMÂ≠òÂÇ®ÂºïÊìé</h3>
<p>‚Äã	MyISAMÊòØMySQL5.5‰πãÂâçÁâàÊú¨ÊâÄ‰ΩøÁî®ÁöÑÈªòËÆ§Â≠òÂÇ®ÂºïÊìéÔºå‰πüÊòØÁé∞Âú®Á≥ªÁªüË°®„ÄÅ‰∏¥Êó∂Ë°®ÔºàÊéíÂ∫è„ÄÅÂàÜÁªÑÊìç‰Ωú‰∏≠ÂΩìÊï∞ÈáèË∂ÖËøá‰∏ÄÂÆöÂ§ßÂ∞èÔºåÁî±Êü•ËØ¢‰ºòÂåñÂô®Âª∫Á´ãÁöÑ‰∏¥Êó∂Ë°®ÔºâÊâÄ‰ΩøÁî®ÁöÑÂ≠òÂÇ®ÂºïÊìé„ÄÇ</p>
<p>Êï∞ÊçÆÊñá‰ª∂ÔºöMyISAMË°®ÁöÑÂ≠òÂÇ®Êñá‰ª∂ÊúâÁâπÊúâÁöÑ‰∏§ÁßçÔºåÂàÜÂà´ÊòØ<code>.myd</code>[Â≠òÂÇ®Êï∞ÊçÆ]„ÄÅ<code>.myi</code>[Â≠òÂÇ®Á¥¢Âºï]
<strong>MyISAMÁâπÊÄß</strong></p>
<ul>
<li>
<p>Ë°®Á∫ßÈîÅÔºàÂÖ±‰∫´ËØªÈîÅÔºå‰∫íÊñ•ÂÜôÈîÅÔºâ</p>
</li>
<li>
<p>‰∏çÊîØÊåÅ‰∫ãÂä°</p>
</li>
<li>
<p>ÊîØÊåÅÂÖ®ÊñáÁ¥¢ÂºïÔºå‰ª•Âèätext„ÄÅblobÂâç500Â≠óËäÇÂª∫Á´ãÁ¥¢Âºï„ÄÇÂú®5.7‰πãÂâçinnodb‰∏çÊîØÊåÅ</p>
</li>
<li>
<p>ÊîØÊåÅÊï∞ÊçÆÂéãÁº©„ÄêÂçïË°åÂéãÁº©Ôºå‰∏çÁî®Êï¥Ë°®Ëß£Âéã„Äë, Ë°®Âèò‰∏∫Âè™ËØªÔºå‰∏çËÉΩËøõË°åÂÜôÊìç‰Ωú</p>
<ul>
<li><code>myisampack -f [tableName].myi</code></li>
</ul>
</li>
<li>
<p>Ë°®ÊîØÊåÅÊï∞ÊçÆÊÅ¢Â§çÊìç‰Ωú</p>
<ul>
<li>MySQLÁªàÁ´Ø‰ΩøÁî®<code>check table [tableName] </code>           Ê£ÄÊü•Ë°®ÊòØÂê¶ÊçüÂùè</li>
<li>MySQLÁªàÁ´Ø‰ΩøÁî®<code>repair table [tableName]</code>         ‰øÆÂ§çË°®</li>
<li>Á≥ªÁªüÁªàÁ´Ø‰ΩøÁî®<code>myisamchk -im /path/[tableName].myi</code>             Ê£ÄÊü•Ë°®ÊòØÂê¶ÊçüÂùè</li>
<li>Á≥ªÁªüÁªàÁ´Ø‰ΩøÁî®<code>myisamchk -iBfqr /path/[tableName].myi</code>       Âø´ÈÄü‰øÆÂ§çË°®Ôºà<strong>ÂøÖÈ°ªÂÅúÊ≠¢MySQLÊúçÂä°</strong> Ôºâ</li>
<li>Á≥ªÁªüÁªàÁ´Ø‰ΩøÁî®<code>myisamchk -iBfqo /path/[tableName].myi</code>       ËÉΩ‰øÆÂ§çr‰∏çËÉΩ‰øÆÂ§çÁöÑÊÉÖÂÜµÔºà<strong>ÂøÖÈ°ªÂÅúÊ≠¢MySQLÊúçÂä°</strong> Ôºâ</li>
</ul>
</li>
</ul>
<p><strong>MyISAMÂ∫îÁî®Âú∫ÊôØ</strong></p>
<ul>
<li>Èùû‰∫ãÂä°ÂûãÂ∫îÁî®ÔºàÊä•Ë°®Á±ªÂàá‰∏çÊ∂âÂèäË¥¢Âä°Ë¶ÅÊ±ÇËØªÂèñÊÄßËÉΩÈ´òÔºâ</li>
<li>Âè™ËØª</li>
<li>Á©∫Èó¥Á±ªÂ∫îÁî®ÔºàÂú®5.7‰πãÂâçÂè™ÊúâMyISAMÊîØÊåÅÁ©∫Èó¥ÂáΩÊï∞Á≠âÔºâ</li>
</ul>
<h3 id="innodbÂ≠òÂÇ®ÂºïÊìé">InnoDBÂ≠òÂÇ®ÂºïÊìé</h3>
<p>‚Äã	InnoDBÊòØMySQL5.5‰πãÂêéÁâàÊú¨ÊâÄ‰ΩøÁî®ÁöÑÈªòËÆ§Â≠òÂÇ®ÂºïÊìéÔºåÊîØÊåÅ‰∫ãÂä°„ÄÅÈÄÇÁî®‰∫éÂ∞èËÄåÂ§öÁöÑ‰∫ãÂä°Âú∫ÊôØ„ÄÇ</p>
<p>Êï∞ÊçÆÊñá‰ª∂ÔºöInnodbË°®Âè™Êúâ‰∏ÄÁßçÁâπÊúâÊ†ºÂºè<code>ibd</code>[Á¥¢Âºï„ÄÅÊï∞ÊçÆ]</p>
<p><strong>InnodbË°®Á©∫Èó¥ËøõË°åÊï∞ÊçÆÂ≠òÂÇ®ÁöÑÈÄâÊã©</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[mysqld]</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">innodb_file_per_table</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">1    #ÂºÄÂêØÁã¨Á´ãË°®Á©∫Èó¥ÔºåÂ≠òÂÇ®Êñá‰ª∂‰∏∫[tableName].idb</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">innodb_file_per_table</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">0    #ÂÖ≥Èó≠Áã¨Á´ãË°®Á©∫Èó¥Ôºå‰ΩøÁî®Á≥ªÁªüË°®Á©∫Èó¥ÔºåÂ≠òÂÇ®Êñá‰ª∂‰∏∫ibdate[num]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Áã¨Á´ãË°®Á©∫Èó¥&amp;Á≥ªÁªüË°®Á©∫Èó¥</strong></p>
<ul>
<li>
<p>MySQL5.6‰πãÂâçÈªòËÆ§‰ΩøÁî®Á≥ªÁªüË°®Á©∫Èó¥Ôºå5.6ÂèäÂÖ∂‰πãÂêéÈªòËÆ§‰ΩøÁî®Áã¨Á´ãË°®Á©∫Èó¥</p>
</li>
<li>
<p>Á≥ªÁªüË°®Á©∫Èó¥Êó†Ê≥ïÁÆÄÂçïÁöÑÊî∂Áº©Êñá‰ª∂Â§ßÂ∞èÔºåÂ§ßÈáèÂπ∂ÂèëËøò‰ºö‰∫ßÁîüIOÁì∂È¢à</p>
</li>
<li>
<p>Áã¨Á´ãË°®Á©∫Èó¥ÂèØ‰ª•ÈÄöËøá<code>optimize table [tableName]</code>ÂëΩ‰ª§Ôºà‰ºöÈîÅË°®ÔºâÈáçÊñ∞Âà©Áî®Êú™‰ΩøÁî®ÁöÑÁ©∫Èó¥ÔºåÂπ∂Êï¥ÁêÜÊï∞ÊçÆÊñá‰ª∂ÁöÑÁ¢éÁâá</p>
</li>
<li>
<p>Áã¨Á´ãË°®Á©∫Èó¥ÂèØ‰ª•ÂêåÊó∂ÂêëÂ§ö‰∏™Êñá‰ª∂Âà∑Êñ∞Êï∞ÊçÆÔºåÊîØÊíëÂ§ßÈáèIOÂπ∂Âèë</p>
</li>
</ul>
<p><strong>InnoDBÂºïÊìéÁâπÊÄß</strong></p>
<ul>
<li>ÂÆåÂÖ®ÊîØÊåÅ‰∫ãÂä°ÁöÑACIDÁâπÊÄß</li>
<li>ÂÖ∑ÊúâRedo LogÊó•Âøó[ËÆ∞ÂΩïÂ∑≤Êèê‰∫§ÁöÑ‰∫ãÂä°]ÔºåUndo LogÊó•Âøó[ËÆ∞ÂΩïÊú™Êèê‰∫§ÁöÑ‰∫ãÂä°ÔºåÈúÄË¶ÅÈöèÊú∫ËØªÂÜô]</li>
<li>ÊîØÊåÅË°åÁ∫ßÈîÅ„ÄêÈó¥ÈöôÈîÅ„ÄëÔºåÂèØ‰ª•ÊîØÊåÅÂπ∂ÂèëÊìç‰Ωú</li>
<li>ÂèØ‰ΩøÁî®<code>show engine innodb status</code>„ÄêÈó¥ÈöîÈááÊ†∑ÔºåÊúÄÂ∞ë‰ΩøÁî®2Ê¨°„ÄëÈááÈõÜÁõ∏ÂÖ≥ÂºïÊìéËøêË°åÁä∂ÊÄÅ‰ø°ÊÅØ</li>
</ul>
<p><strong>ÈÄÇÁî®Âú∫ÊôØ</strong></p>
<ul>
<li>ÈúÄË¶Å‰∫ãÂä°</li>
<li>ÈúÄË¶ÅÂ§ßÈáèÂπ∂ÂèëÂÜôÂÖ•„ÄÅËØªÂèñ</li>
</ul>
<h3 id="csvÂ≠òÂÇ®ÂºïÊìé">CSVÂ≠òÂÇ®ÂºïÊìé</h3>
<p>‚Äã	CSVÂ≠òÂÇ®ÂºïÊìéÂ∞ÜÊï∞ÊçÆ‰ª•ÊñáÊú¨ÁöÑÊñπÂºèÂ≠òÂÇ®Âú®Êñá‰ª∂‰∏≠ÔºåÂèØ‰ª•Áõ¥Êé•ÊâìÂºÄÊñá‰ª∂ËøõË°åÊü•Áúã„ÄÇ</p>
<p>Êï∞ÊçÆÊñá‰ª∂ÔºöCSVË°®ÁöÑÂ≠òÂÇ®Êñá‰ª∂ÊúâÁâπÊúâÁöÑ‰∏§ÁßçÔºåÂàÜÂà´ÊòØ<code>.csv</code>[Â≠òÂÇ®Êï∞ÊçÆ]„ÄÅ<code>.csm</code>[Â≠òÂÇ®ÂÖÉÊï∞ÊçÆÂ¶ÇË°®ÁöÑÁä∂ÊÄÅÂíåÊï∞ÊçÆÈáè]</p>
<p><strong>CSVÂºïÊìéÁâπÁÇπ</strong></p>
<ul>
<li>
<p>‰ª•CSVÊ†ºÂºèËøõË°åÊï∞ÊçÆÂ≠òÂÇ®</p>
</li>
<li>
<p>ÊâÄÊúâÂàóÁöÑÈÉΩ‰∏çËÉΩ‰∏∫NULL</p>
</li>
<li>
<p>‰∏çÊîØÊåÅÁ¥¢Âºï„Äê‰∏çÈÄÇÂêàÂ§ßË°®Ôºå‰∏çÈÄÇÂêàÂú®Á∫øÂ§ÑÁêÜ„Äë</p>
</li>
<li>
<p>ÊîØÊåÅÂØπÊï∞ÊçÆÊñá‰ª∂Áõ¥Êé•ÁºñËæë„ÄêÁºñËæë‰πãÂêéÁî®flush tablesÂà∑Êñ∞Ë°®ÊâçÂèØËßÅÁºñËæëÂèòÂåñ„Äë</p>
</li>
<li>
<p>ÂÆö‰πâÊï∞ÊçÆË°®ÊòØÂøÖÈ°ªÊòæÁ§∫ÊåáÂá∫Âàó‰∏ç‰∏∫Á©∫Âê¶Âàô‰ºöÊä•Âá∫‰ª•‰∏ãÂºÇÂ∏∏</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>The<span style="color:#bbb"> </span>storage<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">engine</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>the<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">table</span><span style="color:#bbb"> </span>doesn<span style="color:#d14">&#39;t support nullable columns
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p><strong>ÈÄÇÁî®Âú∫ÊôØ</strong></p>
<ul>
<li>ÈÄÇÂêà‰Ωú‰∏∫Êï∞ÊçÆ‰∫§Êç¢ÁöÑ‰∏≠Èó¥Ë°®„ÄêÂèØÈöèÊó∂Êã∑ÂÖ•„ÄÅÊã∑Ë¥ùÊñá‰ª∂„Äë</li>
</ul>
<h3 id="archiveÂ≠òÂÇ®ÂºïÊìé">ArchiveÂ≠òÂÇ®ÂºïÊìé</h3>
<p>Êï∞ÊçÆÊñá‰ª∂ÔºöCSVË°®ÁöÑÂ≠òÂÇ®Êñá‰ª∂ÊúâÁâπÊúâÁöÑ‰∏ÄÁßç<code>.arz</code>[Â≠òÂÇ®Êï∞ÊçÆ]</p>
<p><strong>ArchiveÂ≠òÂÇ®ÂºïÊìéÁâπÁÇπ</strong></p>
<ul>
<li>‰ª•zlibÂØπË°®Êï∞ÊçÆËøõË°åÂéãÁº©ÔºåÁ£ÅÁõòIOÊõ¥Â∞ë</li>
<li>Âè™ÊîØÊåÅinsertÂíåselectÊìç‰Ωú„ÄêÊîØÊåÅË°åÁ∫ßÈîÅÂíåÁâπÂÆöÁºìÂÜ≤Âå∫‰ΩÜ‰∏çÊîØÊåÅ‰∫ãÂä°ÔºåÂèØÂ§ßÂπ∂ÂèëÊèíÂÖ•„Äë</li>
<li>Âè™ÂÖÅËÆ∏Âú®Ëá™Â¢ûID‰∏äÂª∫Á´ãÁ¥¢Âºï</li>
</ul>
<p><strong>ÈÄÇÁî®Âú∫ÊôØ</strong></p>
<ul>
<li>Êó•ÂøóÂíåÊï∞ÊçÆÈááÈõÜÁ±ªÂ∫îÁî®</li>
</ul>
<h3 id="memoryÂ≠òÂÇ®ÂºïÊìé">MemoryÂ≠òÂÇ®ÂºïÊìé</h3>
<p>‚Äã	MemoryÂ≠òÂÇ®ÂºïÊìéÊòØMySQLÂú®ÂàõÂª∫‰∏¥Êó∂Ë°®ÔºàÊéíÂ∫è„ÄÅÂàÜÁªÑÊìç‰Ωú‰∏≠Êó∂Áî±Êü•ËØ¢‰ºòÂåñÂô®Âª∫Á´ãÁöÑ‰∏¥Êó∂Ë°®ÔºåMemory‰∏çÊª°Ë∂≥Êù°‰ª∂Êó∂‰ΩøÁî®MyISAM‰Ωú‰∏∫‰∏¥Êó∂Ë°®ÂºïÊìéÔºâÊâÄ‰ΩøÁî®ÁöÑÂ≠òÂÇ®ÂºïÊìé„ÄÇ</p>
<p><strong>MemoryÂ≠òÂÇ®ÂºïÊìéÁâπÁÇπ</strong></p>
<ul>
<li>ÊâÄÊúâÊï∞ÊçÆÈÉΩÂ≠òÂú®‰∫éÂÜÖÂ≠ò‰∏≠ÔºåÈáçÂêØMySQLÊï∞ÊçÆ‰∏¢Â§±ÔºåË°®ÂÆö‰πâ‰∏ç‰∏¢Â§±Ôºà<code>.frm</code>Êñá‰ª∂ÊòØÂú®Á≥ªÁªüÊñá‰ª∂‰∏≠Ôºâ</li>
<li>ÊîØÊåÅHASHÂíåBTREEÁ¥¢Âºï</li>
<li>ÊâÄÊúâÂ≠óÊÆµÈÉΩÊòØÂõ∫ÂÆöÈïøÂ∫¶Ôºàvarchar(10) = char(10)Ôºâ</li>
<li>‰∏çÊîØÊåÅBLOGÂíåTEXTÂ§ßÂ≠óÊÆµ</li>
<li>‰ΩøÁî®Ë°®Á∫ßÈîÅ„ÄêÂΩ±ÂìçÂπ∂Âèë„Äë</li>
</ul>
<p><strong>ÈÄÇÁî®Âú∫ÊôØ</strong></p>
<ul>
<li>Áî®‰∫éÊü•ÊâæÊàñËÄÖÊò†Â∞ÑË°®ÔºàÊîØÊåÅHASHÁ¥¢ÂºïÔºâ</li>
<li>Áî®‰∫é‰øùÂ≠òÊï∞ÊçÆÂàÜÊûê‰∏≠‰∫ßÁîüÁöÑ‰∏≠Èó¥Ë°®</li>
<li>Áî®‰∫éÁºìÂ≠òÂë®ÊúüÊÄßËÅöÂêàÊï∞ÊçÆÁöÑÁªìÊûúË°®</li>
</ul>
<h3 id="federatedÂ≠òÂÇ®ÂºïÊìé">FederatedÂ≠òÂÇ®ÂºïÊìé</h3>
<p>‚Äã	FederatedÂ≠òÂÇ®ÂºïÊìéÊèê‰æõ‰∫ÜËÆøÈóÆËøúÁ®ãMySQL ÊúçÂä°Âô®‰∏äË°®ÁöÑÊñπÊ≥ïÔºå‰∏îÂú®Êú¨Âú∞Âπ∂‰∏çÂ≠òÂÇ®Êï∞ÊçÆÔºåÊï∞ÊçÆÂÖ®ÈÉ®Âú®ËøúÁ®ãÊúçÂä°Âô®‰∏äÔºå‰ΩÜÊòØÊú¨Âú∞ÈúÄË¶Å‰øùÂ≠òË°®ÁªìÊûÑ‰ø°ÊÅØÂíåËøúÁ®ãÊúçÂä°Âô®‰ø°ÊÅØÔºà<code>.frm</code>Êñá‰ª∂‰æùÊóßÂ≠òÂú®Ôºâ„ÄÇFederatedÂºïÊìéÊïàÁéáÂπ∂‰∏çÈ´òÔºåÈªòËÆ§Á¶ÅÊ≠¢„ÄÇ</p>
<p><strong>ÂºÄÂêØFederatedÂ≠òÂÇ®ÂºïÊìé</strong></p>
<p>‚Äã	Âú®MySQLÈÖçÁΩÆÊñá‰ª∂[mysqld]‰∏≠Âä†ÂÖ•<code>federated = 1</code></p>
<p><strong>‰ΩøÁî®ÊñπÊ≥ï</strong></p>
<p>1ÔºâËøúÁ®ãÊúçÂä°Âô®ÂàõÂª∫Áî®Êà∑Âπ∂ÊéàÊùÉ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">USER</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[username]&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;[host]&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">IDENTIFIED</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">BY</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[password]&#39;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">GRANT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">PRIVILEGES</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ON</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">delete</span>,<span style="color:#000;font-weight:bold">update</span>,<span style="color:#000;font-weight:bold">insert</span>,<span style="color:#000;font-weight:bold">select</span><span style="color:#bbb"> </span>[<span style="color:#000;font-weight:bold">database</span>].[tablename]<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">TO</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[username]&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;[host]&#39;</span><span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>2 ÔºâÊú¨Âú∞ÊúçÂä°Âô®ÂàõÂª∫Ë°®ÁªìÊûÑË¶Å‰∏éËøúÁ®ãÊúçÂä°Âô®Ë°®ÁªìÊûÑ‰∏ÄËá¥Ôºå‰∏îÂä†ÂÖ•</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">create</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">table</span><span style="color:#bbb"> </span>[tablename]<span style="color:#bbb"> </span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>...<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ENGINE</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span>FEDERATED<span style="color:#bbb"> </span>CONNECTION<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;mysql://username:password@host:port/database/table&#39;</span>;<span style="color:#bbb"> 
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÄÇÁî®Âú∫ÊôØ</strong></p>
<ul>
<li>ÂÅ∂Â∞îÁöÑÁªüËÆ°ÂàÜÊûêÂèäÊâãÂ∑•Êü•ËØ¢</li>
</ul>
<h2 id="ÂõõmysqlÊúçÂä°ÂèÇÊï∞ÈÖçÁΩÆ">Âõõ„ÄÅMySQLÊúçÂä°ÂèÇÊï∞ÈÖçÁΩÆ</h2>
<p>‚Äã	ÂèØ‰ª•‰ΩøÁî®<code>mysqld --help --verbose | grep -A 1 'Default options'</code>Êü•ÁúãMySQLËØªÂèñÈÖçÁΩÆÊñá‰ª∂ÁöÑÈ°∫Â∫èÔºå<strong>ÂêéËØªÂèñÁöÑÈÖçÁΩÆ‰ø°ÊÅØ‰ºöË¶ÜÁõñÂâçÈÖçÁΩÆÁöÑ‰ø°ÊÅØ</strong>„ÄÇ</p>
<p><strong>ÈÖçÁΩÆÂèÇÊï∞ÁöÑ‰ΩúÁî®ÂüüËÆæÁΩÆ</strong></p>
<ul>
<li>ÂÖ®Â±ÄÂèÇÊï∞
<ul>
<li>set global ÂèÇÊï∞Âêç = ÂèÇÊï∞ÂÄº;</li>
<li>set @@global.ÂèÇÊï∞Âêç := ÂèÇÊï∞ÂÄº;</li>
</ul>
</li>
<li>‰ºöËØùÂèÇÊï∞
<ul>
<li>set [session] ÂèÇÊï∞Âêç = ÂèÇÊï∞ÂÄº;</li>
<li>set @@session.ÂèÇÊï∞Âêç := ÂèÇÊï∞ÂÄº;</li>
</ul>
</li>
</ul>
<h3 id="ÂÜÖÂ≠òÁõ∏ÂÖ≥ÂèÇÊï∞">ÂÜÖÂ≠òÁõ∏ÂÖ≥ÂèÇÊï∞</h3>
<p><strong>Á∫øÁ®ãÁ∫ßÂà´</strong></p>
<ul>
<li>
<p>sort_buffer_sizeÔºöÊØè‰∏™Á∫øÁ®ãËøõË°åÊéíÂ∫èÊìç‰ΩúÊó∂ÂàõÂª∫ÔºåÊØèÊ¨°ÂàõÂª∫Ëøô‰∏™Êï∞ÂÄºÁöÑÂÖ®ÈÉ®ÂÜÖÂ≠òÔºåÈªòËÆ§1MÔºå‰∏çÂª∫ËÆÆÊîπÂä®</p>
</li>
<li>
<p>join_buffer_sizeÔºöÊØè‰∏™Êü•ËØ¢ËØ≠Âè•ËøõË°å‰∏ÄÊ¨°joinÂàÜÈÖç‰∏Ä‰∏™ÔºåÂ§öÊ¨°ÂàÜÈÖçÂ§ö‰∏™„ÄÇÂ§ßÈáèjoinÊìç‰ΩúÂèØ‰ª•ÈÄÇÂΩìË∞ÉÂ§ß</p>
</li>
<li>
<p>read_bufer_sizeÔºöMyISAMËøõË°åÂÖ®Ë°®Êâ´ÊèèÊó∂ÂàõÂª∫Ëøô‰∏™Êï∞ÂÄºÁöÑÂÖ®ÈÉ®ÂÜÖÂ≠òÔºåÂ¶ÇÊûú‰øÆÊîπÂ∫îËØ•‰∏∫4kÂÄçÊï∞</p>
</li>
<li>
<p>read_rnd_buffer_sizeÔºöMyISAMÁ¥¢Âºï‰ΩøÁî®ÔºåÊåâÈúÄÂàÜÈÖç‰∏çÊòØ‰∏ÄÊ¨°‰ΩøÁî®ÂÖ®ÈÉ®Êï∞ÂÄºÂÜÖÂ≠ò</p>
</li>
</ul>
<p><strong>ËøõÁ®ãÁ∫ßÂà´</strong></p>
<ul>
<li>Innodb_buffer_pool_sizeÔºöInnoDBÊâÄÁî®ÁºìÂÜ≤Ê±†Â§ßÂ∞èÂåÖÂê´InnoDBÊï∞ÊçÆÈ°µ„ÄÅÁ¥¢ÂºïÊï∞ÊçÆ„ÄÅÁºìÂÜ≤Êï∞ÊçÆ„ÄÅ ÂÜÖÂ≠ò‰∏≠‰øÆÊîπÂ∞öÊú™Âà∑Êñ∞(ÂÜôÂÖ•)Âà∞Á£ÅÁõòÁöÑÊï∞ÊçÆ ‰ª•Âèä Â¶ÇËá™ÈÄÇÂ∫îÂìàÂ∏åÁ¥¢ÂºïÔºåË°åÈîÅÁ≠â„ÄÇ ÈªòËÆ§Â§ßÂ∞è‰∏∫128MÔºåÂ¶ÇÊûúÂè™‰ΩøÁî®InnoDBÂºïÊìéÂª∫ËÆÆËÆæÁΩÆ‰∏∫Á≥ªÁªüÁâ©ÁêÜÂÜÖÂ≠ò70%</li>
<li>key_buffer_sizeÔºöMyISAMÊâÄÁî®ÁºìÂÜ≤Ê±†Â§ßÂ∞èÂè™ÂåÖÂê´Á¥¢ÂºïÊï∞ÊçÆÔºå Â¶ÇÊûúÂæàÂ∞ë‰ΩøÁî®MyISAMË°®Ôºå‰πüË¶Å‰øùÁïô16-32MB ÁöÑ key_buffer_size ‰ª•ÈÄÇÂ∫îÁªô‰∫àÁ£ÅÁõòÁöÑ‰∏¥Êó∂Ë°®Á¥¢ÂºïÊâÄÈúÄ</li>
</ul>
<h3 id="ioÁõ∏ÂÖ≥ÂèÇÊï∞">I/OÁõ∏ÂÖ≥ÂèÇÊï∞</h3>
<p><strong>Redo logÁõ∏ÂÖ≥</strong></p>
<ul>
<li>
<p>Innodb_log_file_size</p>
</li>
<li>
<p>Innodb_log_files_in_group</p>
</li>
</ul>
<p>redoÊó•ÂøóÂÖàÂÜôÂà∞ÁºìÂÜ≤Âå∫ÂÜçÂÜôÂà∞Êó•ÂøóÊñá‰ª∂ÊØèÁßíÂà∑ÁõòÔºåÊâÄ‰ª•Êó•ÂøóÊñá‰ª∂‰∏çÈúÄË¶ÅÂ§™Â§ß„ÄÇInnodb_log_files_in_groupÂÜ≥ÂÆö‰∫ÜÊó•ÂøóÊñá‰ª∂‰∏™Êï∞ÔºåÊó•ÂøóÊó∂ÂÖàÊª°‰∏Ä‰∏™Êâç‰ΩøÁî®‰∏ã‰∏Ä‰∏™Âπ∂ÈùûÂπ∂Ë°å‰ΩøÁî®ÔºåÊâÄ‰ª•Ê≠§ÂÄº‰∏çÈáçË¶Å„ÄÇ</p>
<ul>
<li>
<p>innodb_flush_log_at_trx_commitÔºöÂà∑Êñ∞‰∫ãÂä°Êó•ÂøóÁöÑÈ¢ëÁπÅÁ®ãÂ∫¶</p>
<ul>
<li>
<p>0ÔºöÊØèÁßíËøõË°å‰∏ÄÊ¨°logÂÜôÂÖ•Êìç‰ΩúÁ≥ªÁªücacheÔºåÂπ∂Á´ãÂç≥flush logÂà∞Á£ÅÁõòÔºåÂÆïÊú∫ÊàñMySQLÂ¥©Ê∫ÉÂèØËÉΩ‰∏¢Â§±1s‰∫ãÂä°Êï∞ÊçÆ„ÄÇ</p>
</li>
<li>
<p>1„ÄêÈªòËÆ§„ÄëÔºöÊØèÊ¨°‰∫ãÂä°Êèê‰∫§Êó∂ÊâßË°ålogÂÜôÂÖ•cacheÔºåÂπ∂Á´ãÂç≥flush log Âà∞Á£ÅÁõòÔºå‰∏ç‰ºö‰∏¢Â§±‰ªª‰Ωï‰∫ãÂä°Êï∞ÊçÆ„ÄÇ</p>
</li>
<li>
<p>2ÔºöÊØèÊ¨°‰∫ãÂä°Êèê‰∫§Êó∂ÊâßË°ålogÂÜôÂÖ•cacheÔºåÂπ∂ÊØèÁßíÊâßË°åflush log Âà∞Á£ÅÁõò ÔºåmysqlËøõÁ®ãÂ•îÊ∫É‰∏ç‰ºö‰∏¢Â§±ÔºåÊúçÂä°Âô®ÂÆïÂèØËÉΩ‰ºö‰∫ãÂä°Êï∞ÊçÆ„ÄÇÂ¶ÇÊûúÊúâÈúÄË¶ÅÂèØ‰ª•ÂºÄÂêØÊ≠§ÈÄâÈ°π„ÄÇ</p>
</li>
</ul>
</li>
<li>
<p>innodb_flush_methodÔºöÂª∫ËÆÆËÆæÁΩÆ‰∏∫<code>O_DIRECT</code>Ôºå‰∏çÁºìÂ≠òÔºå‰∏çÈ¢ÑËØªÔºåÈÅøÂÖçÊìç‰ΩúÁ≥ªÁªüÂíåmysqlÂèåÁºìÂ≠ò</p>
</li>
<li>
<p>innodb_file_per_tableÔºöÂª∫ËÆÆËÆæÁΩÆ‰∏∫1ÔºåÁã¨Á´ãË°®Á©∫Èó¥Ôºå‰ΩøÁî®Á≥ªÁªüË°®Á©∫Èó¥„Äê5.6ÂèäÂÖ∂‰ª•ÂêéÈªòËÆ§‰∏∫1„Äë</p>
</li>
<li>
<p>innodb_doublewriteÔºöÂª∫ËÆÆËÆæÁΩÆ‰∏∫1ÔºåÈÅøÂÖçÈ°µÊ≤°ÂÜôÂÆåÊï¥ÂØºËá¥Êï∞ÊçÆÊçüÂùèÔºåÂ¢ûÂä†Êï∞ÊçÆÂÆâÂÖ®„ÄÇÈªòËÆ§‰∏∫1</p>
</li>
<li>
<p>delay_key_writeÔºöÁ±ª‰ººinnodb_flush_log_at_trx_commit</p>
<ul>
<li>OFFÔºöÂÖ≥Èó≠Âª∂ËøüÂÜôÂÖ•ÔºåÁõ¥Êé•Âà∑ÁõòÂà∞Á£ÅÁõò</li>
<li>ONÔºöÂè™ÂØπÂª∫Ë°®Êó∂‰ΩøÁî®ÁöÑ‰∫Üdelay_key_writeÈÄâÈ°πÁöÑË°®ËøõË°åÂª∂ËøüÂÜôÂÖ•</li>
<li>ÂØπÊâÄÊúâMyISAMË°®ÈÉΩ‰ΩøÁî®Âª∂ËøüÂÜôÂÖ•</li>
</ul>
</li>
</ul>
<h3 id="ÂÆâÂÖ®Áõ∏ÂÖ≥ÂèÇÊï∞">ÂÆâÂÖ®Áõ∏ÂÖ≥ÂèÇÊï∞</h3>
<ul>
<li>
<p>expire_log_daysÔºöÊåáÂÆöËá™Âä®Ê∏ÖÁêÜbinlogÁöÑÂ§©Êï∞ÔºåËá≥Â∞ë‰∏§Ê¨°ÂÖ®Â§áÊó∂Èó¥ÔºåÂ¶ÇÊûúÊØèÂ§©ÂÖ®Â§á‰πüÂ∫îËØ•‰øùÂ≠ò7Â§©‰ª•‰∏ä</p>
</li>
<li>
<p>max_allowed_packetÔºöÊéßÂà∂ÂèØ‰ª•Êé•Êî∂ÊúÄÂ§ßÁöÑÂåÖÁöÑÂ§ßÂ∞èÂíåÁî®Êà∑ÂÆö‰πâÂèòÈáèÁöÑÊúÄÂ§ßÂÆπÈáèÔºà‰∏ª‰ªéÊ®°Âºè‰∏ãÂ∫îËØ•‰∏ÄÊ†∑ÔºâÔºåÂª∫ËÆÆ32M</p>
</li>
<li>
<p>skip_name_resolveÔºöÁ¶ÅÁî®DNSÊü•ÊâæÔºåÂ¶ÇÊûúÈúÄË¶ÅÈÄöËøá‰∏ªÊú∫ÂêçËøûÊé•ÔºåÂª∫ËÆÆÈÖçÁΩÆÂú®hostÊñá‰ª∂‰∏≠</p>
<ol>
<li>
<p>ÂΩìÊúâ‰∏Ä‰∏™Êñ∞ÁöÑÂÆ¢Êà∑Á´ØËøûÊé•ËøõÊù•Êó∂ÔºåMySQL Server‰ºö‰∏∫Ëøô‰∏™IPÂú®host cache‰∏≠Âª∫Á´ã‰∏Ä‰∏™Êñ∞ÁöÑËÆ∞ÂΩïÔºåÂåÖÊã¨IPÔºå‰∏ªÊú∫ÂêçÂíåclient lookup validation flagÔºåÂàÜÂà´ÂØπÂ∫îhost_cacheË°®‰∏≠ÁöÑIPÔºåHOSTÂíåHOST_VALIDATEDËøô‰∏âÂàó„ÄÇÁ¨¨‰∏ÄÊ¨°Âª∫Á´ãËøûÊé•Âõ†‰∏∫Âè™ÊúâIPÔºåÊ≤°Êúâ‰∏ªÊú∫ÂêçÔºåÊâÄ‰ª•HOSTÂ∞ÜËÆæÁΩÆ‰∏∫NULLÔºåHOST_VALIDATEDÂ∞ÜËÆæÁΩÆ‰∏∫FALSE„ÄÇ</p>
</li>
<li>
<p>MySQL ServerÊ£ÄÊµãHOST_VALIDATEDÁöÑÂÄºÔºåÂ¶ÇÊûú‰∏∫FALSEÔºåÂÆÉ‰ºöËØïÂõæËøõË°åDNSËß£ÊûêÔºåÂ¶ÇÊûúËß£ÊûêÊàêÂäüÔºåÂÆÉÂ∞ÜÊõ¥Êñ∞HOSTÁöÑÂÄº‰∏∫‰∏ªÊú∫ÂêçÔºåÂπ∂Â∞ÜHOST_VALIDATEDÂÄºËÆæ‰∏∫TRUE„ÄÇÂ¶ÇÊûúÊ≤°ÊúâËß£ÊûêÊàêÂäüÔºåÂà§Êñ≠Â§±Ë¥•ÁöÑÂéüÂõ†ÊòØÊ∞∏‰πÖÁöÑËøòÊòØ‰∏¥Êó∂ÁöÑÔºåÂ¶ÇÊûúÊòØÊ∞∏‰πÖÁöÑÔºåÂàôHOSTÁöÑÂÄº‰æùÊóß‰∏∫NULLÔºå‰∏îÂ∞ÜHOST_VALIDATEDÁöÑÂÄºËÆæÁΩÆ‰∏∫TRUEÔºåÂêéÁª≠ËøûÊé•‰∏çÂÜçËøõË°åËß£ÊûêÔºåÂ¶ÇÊûúËØ•ÂéüÂõ†ÊòØ‰∏¥Êó∂ÁöÑÔºåÂàôHOST_VALIDATED‰æùÊóß‰∏∫FALSEÔºåÂêéÁª≠ËøûÊé•‰ºöÂÜçÊ¨°ËøõË°åDNSËß£Êûê„ÄÇ</p>
</li>
<li>
<p>Ëß£ÊûêÊàêÂäüÁöÑÊ†áÂøóÂπ∂‰∏çÂè™ÊòØÈÄöËøáIPÔºåËé∑ÂèñÂà∞‰∏ªÊú∫ÂêçÂç≥ÂèØÔºåËøôÂè™ÊòØÂÖ∂‰∏≠‰∏ÄÊ≠•ÔºåËøòÊúâ‰∏ÄÊ≠•ÊòØÈÄöËøáËß£ÊûêÂêéÁöÑ‰∏ªÊú∫ÂêçÊù•ÂèçÂêëËß£Êûê‰∏∫IPÔºåÂà§Êñ≠ËØ•IPÊòØÂê¶‰∏éÂéüIPÁõ∏ÂêåÔºåÂ¶ÇÊûúÁõ∏ÂêåÔºåÊâçÂà§Êñ≠‰∏∫Ëß£ÊûêÊàêÂäüÔºåÊâçËÉΩÊõ¥Êñ∞host cache‰∏≠ÁöÑ‰ø°ÊÅØ„ÄÇ</p>
</li>
</ol>
</li>
<li>
<p>sysdata_is_nowÔºöËÆæÁΩÆ‰∏∫1ÔºåÁ°Æ‰øùsysdate()ËøîÂõûÁ°ÆÂÆöÊÄßÊó•Êúü„ÄÇ Â¶ÇÊûú‰∏ª‰ªé‰ΩøÁî®‰∫ÜbinlogÁöÑ<code>statement</code>Ê®°ÂºèÔºåsysdataÁöÑÁªìÊûú‰ºö‰∏ç‰∏ÄÊ†∑ÔºåÊúÄÂêéÂØºËá¥Êï∞ÊçÆ‰∏ç‰∏ÄËá¥</p>
</li>
<li>
<p>read_onlyÔºöÁ¶ÅÊ≠¢ÈùûsuperÊùÉÈôêÁî®Êà∑ÁöÑÂÜôÊùÉÈôêÔºå‰∏ª‰ªéÊ®°Âºè‰∏ãÂª∫ËÆÆ‰ªéÊú∫ÂºÄÂêØ</p>
</li>
<li>
<p>skip_slave_startÔºöÁ¶ÅÁî®slaveËá™Âä®ÊÅ¢Â§çÔºåÂΩì‰ªéÊú∫ÊÅ¢Â§çÂ∑•‰ΩúÊó∂ÔºåÂÖà‰∏çÂêØÂä®‰ªéÂ±ûÊ®°ÂºèÔºåÊ£ÄÊü•ÂÆåÊàêÂêéÔºåÊâãÂä®ÂêØÂä®ËæÉÂ•Ω</p>
</li>
<li>
<p>sql_modelÔºöMYSQLÊâÄ‰ΩøÁî®ÁöÑSQLÊ®°ÂºèÔºåÈªòËÆ§‰∏∫ÂÆΩÊùæÊ®°Âºè</p>
<ul>
<li>strict_trans_tablesÔºö ‰∏•Ê†ºÊ®°ÂºèÔºåÈùûÊ≥ïÊï∞ÊçÆÂÄºË¢´ÊãíÁªù</li>
<li>no_engine_subtitutionÔºö  ‰∏•Ê†ºÊ®°Âºè‰∏ãÂª∫Ë°®ÁöÑÊó∂ÂÄôÊåáÂÆö‰∏çÂèØÁî®Â≠òÂÇ®ÂºïÊìé‰ºöÊä•Èîô</li>
<li>no_zero_dataÔºö ‰∏•Ê†ºÊ®°Âºè‰∏çÊé•Âèó'0000-00-00&rsquo;‰Ωú‰∏∫ÂêàÊ≥ïÊó•Êúü</li>
<li>no_zero_in_dataÔºö ‰∏•Ê†ºÊ®°Âºè‰∏çÊé•ÂèóÊúàÊàñÊó•ÈÉ®ÂàÜ‰∏∫0ÁöÑÊó•Êúü</li>
<li>only_full_group_byÔºö  ‰∏•Ê†ºÊ®°Âºè‰∏ãÊ£ÄÈ™å<code>group by</code>ËØ≠Âè•ÁöÑÂêàÊ≥ïÊÄß</li>
</ul>
</li>
</ul>
<h3 id="ÂÖ∂ÂÆÉÁõ∏ÂÖ≥ÂèÇÊï∞">ÂÖ∂ÂÆÉÁõ∏ÂÖ≥ÂèÇÊï∞</h3>
<ul>
<li>
<p>sync_binlogÔºöÊéßÂà∂MySQLÂ¶Ç‰ΩïÂêëÁ£ÅÁõòÂà∑Êñ∞binlog</p>
<ul>
<li>0ÈªòËÆ§Ôºå ‰∫ãÂä°Êèê‰∫§Áî±Êìç‰ΩúÁ≥ªÁªüÂÜ≥ÂÆöÂà∑ÁõòÊó∂Èó¥ÔºåËøôÊó∂ÂÄôÁöÑÊÄßËÉΩÊòØÊúÄÂ•ΩÁöÑÔºå‰ΩÜÊòØÈ£éÈô©‰πüÊòØÊúÄÂ§ßÁöÑ</li>
<li>Â§ß‰∫é0Ôºå ‰∫ãÂä°Êèê‰∫§‰∏§Ê¨°Âà∑ÁõòÁöÑÈó¥ÈöîÂ§öÂ∞ëÊ¨°ÂÜôÊìç‰ΩúÔºå‰∏ªÊúçÂä°ÊúÄÂ•ΩÂ∫îËØ•ÊòØ1ÔºàÊúÄÂ§öÂèØËÉΩ‰∏¢Â§±1‰∏™‰∫ãÂä°ÁöÑÊï∞ÊçÆÔºâ</li>
</ul>
</li>
<li>
<p>tmp_table_sizeÂíåmax_heap_table_sizeÔºöÊéßÂà∂ÂÜÖÂ≠ò‰∏¥Êó∂Ë°®Â§ßÂ∞èÔºàMemeoryÂºïÊìéÂàõÂª∫ÔºâÔºåË∂ÖËøáÂèò‰∏∫Êñá‰ª∂‰∏¥Êó∂Ë°®ÔºàMyISAMÂºïÊìéÂàõÂª∫Ôºâ</p>
</li>
<li>
<p>max_connectionsÔºöÊéßÂà∂ÂÖÅËÆ∏ÁöÑÊúÄÂ§ßËøûÊé•Êï∞ÔºåÈªòËÆ§100ÔºåÂª∫ËÆÆ2000+</p>
</li>
</ul>
<h2 id="‰∫îmysqlÂü∫ÂáÜÊµãËØï">‰∫î„ÄÅMySQLÂü∫ÂáÜÊµãËØï</h2>
<h3 id="Âü∫ÂáÜÊµãËØïÁöÑÂÆö‰πâ">Âü∫ÂáÜÊµãËØïÁöÑÂÆö‰πâ</h3>
<p>‚Äã	Âü∫ÂáÜÊµãËØïÊòØ‰∏ÄÁßçÊµãÈáèÂíåËØÑ‰º∞ËΩØ‰ª∂ÊÄßËÉΩÊåáÊ†áÁöÑÊ¥ªÂä®Áî®‰∫éÂª∫Á´ãÊüê‰∏™Êó∂ÂàªÁöÑÊÄßËÉΩÂü∫ÂáÜÔºå‰ª•‰æøÂΩìÁ≥ªÁªüÂèëÁîüËΩØÁ°¨‰ª∂ÂèòÂåñÊó∂ÈáçÊñ∞ËøõË°åÂü∫ÂáÜÊµãËØï‰ª•‰æøËØÑ‰º∞ÂèòÂåñÂØπÁ≥ªÁªüÊÄßËÉΩÁöÑÂΩ±Âìç</p>
<h3 id="Â∏∏ËßÅÊµãËØïÊåáÊ†á">Â∏∏ËßÅÊµãËØïÊåáÊ†á</h3>
<ul>
<li>
<p>Âçï‰ΩçÊó∂Èó¥ÂÜÖÊâÄÂ§ÑÁêÜÁöÑ‰∫ãÂä°Êï∞ÔºàTPS)</p>
</li>
<li>
<p>Âçï‰ΩçÊó∂Èó¥ÂÜÖÊâÄÂ§ÑÁêÜÁöÑÊü•ËØ¢Êï∞ÔºàQPS)</p>
</li>
<li>
<p>ÂìçÂ∫îÊó∂Èó¥Ôºà RT Ôºâ</p>
</li>
<li>
<p>Á≥ªÁªüÂêåÊó∂ËÉΩÂ§ÑÁêÜÁöÑËØ∑Ê±ÇÊï∞ÈáèÔºàÂπ∂ÂèëÊï∞Ôºâ</p>
</li>
<li>
<p>Âçï‰ΩçÊó∂Èó¥ÂÜÖÁ≥ªÁªüËÉΩÂ§ÑÁêÜÁöÑËØ∑Ê±ÇÊï∞Èáè ÔºàÂêûÂêêÈáè Ôºâ</p>
</li>
</ul>
<h3 id="sysbenchÂÅöÂü∫ÂáÜÊµãËØï">sysbenchÂÅöÂü∫ÂáÜÊµãËØï</h3>
<p>‚Äã	sysbenchÊòØ‰∏Ä‰∏™Ê®°ÂùóÂåñÁöÑ„ÄÅË∑®Âπ≥Âè∞„ÄÅÂ§öÁ∫øÁ®ãÂü∫ÂáÜÊµãËØïÂ∑•ÂÖ∑Ôºå‰∏ªË¶ÅÁî®‰∫éËØÑ‰º∞ÊµãËØïÂêÑÁßç‰∏çÂêåÁ≥ªÁªüÂèÇÊï∞‰∏ãÁöÑÊï∞ÊçÆÂ∫ìË¥üËΩΩÊÉÖÂÜµ „ÄÇÂÖ∑Êúâ‰ª•‰∏ãÂäüËÉΩÔºö</p>
<p>‚Äã	1„ÄÅcpuÊÄßËÉΩÊµãËØï</p>
<p>‚Äã	2„ÄÅÁ£ÅÁõòioÊÄßËÉΩÊµãËØï</p>
<p>‚Äã	3„ÄÅË∞ÉÂ∫¶Á®ãÂ∫èÊÄßËÉΩÊµãËØï</p>
<p>‚Äã	4„ÄÅÂÜÖÂ≠òÂàÜÈÖçÂèä‰º†ËæìÈÄüÂ∫¶ÊµãËØï</p>
<p>‚Äã	5„ÄÅPOSIXÁ∫øÁ®ãÊÄßËÉΩÊµãËØï</p>
<p>‚Äã	6„ÄÅÊï∞ÊçÆÂ∫ìÊÄßËÉΩ(OLTPÂü∫ÂáÜÊµãËØï)</p>
<p><strong>ÂÆâË£Ösysbench</strong></p>
<ul>
<li>Ê†áÂáÜÁõÆÂΩïÂÆâË£Ö</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>./configure <span style="color:#000;font-weight:bold">&amp;&amp;</span> make <span style="color:#000;font-weight:bold">&amp;&amp;</span> make install
</span></span><span style="display:flex;"><span>strip /usr/local/bin/sysbench
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ÈùûÊ†áÂáÜÁõÆÂΩïÂÆâË£Ö</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÈúÄË¶ÅÂÖàyum install mysql-devel</span>
</span></span><span style="display:flex;"><span>./configure --with-mysql-includes<span style="color:#000;font-weight:bold">=</span>/usr/include/mysql --with-mysql-libs<span style="color:#000;font-weight:bold">=</span>/usr/lib64/mysql <span style="color:#000;font-weight:bold">&amp;&amp;</span> make <span style="color:#000;font-weight:bold">&amp;&amp;</span> make install
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÂºÄÂßãÊµãËØï</strong></p>
<p>0ÔºâÊü•ÁúãÂêÑÈ°πÊµãËØïÂ∏ÆÂä©</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰ΩøÁî® sysbench --test=&lt;name&gt; help</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># testname:fileio„ÄÅcpu„ÄÅmemory„ÄÅthreads„ÄÅmutex„ÄÅoltp</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Â¶ÇÔºösysbench --test=fileio help</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>1ÔºâcpuÊÄßËÉΩÊµãËØï</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏ªË¶ÅÊòØËøõË°åÁ¥†Êï∞ÁöÑÂä†Ê≥ïËøêÁÆó</span>
</span></span><span style="display:flex;"><span>sysbench --test<span style="color:#000;font-weight:bold">=</span>cpu --cpu-max-prime<span style="color:#000;font-weight:bold">=</span><span style="color:#099">20000</span> run
</span></span></code></pre></td></tr></table>
</div>
</div><p>2ÔºâÁ∫øÁ®ãÊµãËØï</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>sysbench --test<span style="color:#000;font-weight:bold">=</span>threads --num-threads<span style="color:#000;font-weight:bold">=</span><span style="color:#099">64</span> --thread-yields<span style="color:#000;font-weight:bold">=</span><span style="color:#099">100</span> --thread-locks<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span> run
</span></span></code></pre></td></tr></table>
</div>
</div><p>3ÔºâÁ£ÅÁõòIOÊÄßËÉΩÊµãËØï</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰ºöÁîüÊàêÊµãËØïÊñá‰ª∂ÔºåÂáÜÂ§áÊµãËØï</span>
</span></span><span style="display:flex;"><span>sysbench --test<span style="color:#000;font-weight:bold">=</span>fileio --file-total-size<span style="color:#000;font-weight:bold">=</span>3G --file-test-mode<span style="color:#000;font-weight:bold">=</span>rndrw prepare
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂºÄÂßãÊµãËØï</span>
</span></span><span style="display:flex;"><span>sysbench --test<span style="color:#000;font-weight:bold">=</span>fileio --num-threads<span style="color:#000;font-weight:bold">=</span><span style="color:#099">16</span> --file-test-mode<span style="color:#000;font-weight:bold">=</span>rndrw run
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âà†Èô§ÊµãËØïÊñá‰ª∂</span>
</span></span><span style="display:flex;"><span>sysbench --test<span style="color:#000;font-weight:bold">=</span>fileio cleanup
</span></span></code></pre></td></tr></table>
</div>
</div><p>4ÔºâÂÜÖÂ≠òÊµãËØï</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂÜÖÂ≠ò‰∏≠‰º†Ëæì200MÁöÑÊï∞ÊçÆÈáèÔºåÊØè‰∏™blockÂ§ßÂ∞è‰∏∫8KÔºåÂçï‰ΩçÊ≥®ÊÑèÂ§ßÂÜô</span>
</span></span><span style="display:flex;"><span>sysbench --test<span style="color:#000;font-weight:bold">=</span>memory --memory-block-size<span style="color:#000;font-weight:bold">=</span>8K --memory-total-size<span style="color:#000;font-weight:bold">=</span>200M run
</span></span></code></pre></td></tr></table>
</div>
</div><p>5ÔºâOLTPÊµãËØï</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂáÜÂ§áÊµãËØïÔºåÊõ¥Â§öÂèÇÊï∞ËøêË°åÂ∏ÆÂä©ÂëΩ‰ª§</span>
</span></span><span style="display:flex;"><span>sysbench --test<span style="color:#000;font-weight:bold">=</span>oltp --mysql-table-engine<span style="color:#000;font-weight:bold">=</span>innodb --thread<span style="color:#000;font-weight:bold">=</span><span style="color:#099">8</span> --oltp-table-size<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span> --oltp-table-size<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1000000</span> --mysql-user<span style="color:#000;font-weight:bold">=</span>root --mysql-password<span style="color:#000;font-weight:bold">=</span><span style="color:#099">123456</span> --mysql-db<span style="color:#000;font-weight:bold">=</span>ttt --mysql-host<span style="color:#000;font-weight:bold">=</span>localhost prepare
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ËøêË°åÊµãËØïÔºåÊõ¥Â§öÂèÇÊï∞ËøêË°åÂ∏ÆÂä©ÂëΩ‰ª§</span>
</span></span><span style="display:flex;"><span>sysbench --test<span style="color:#000;font-weight:bold">=</span>oltp --mysql-table-engine<span style="color:#000;font-weight:bold">=</span>innodb --thread<span style="color:#000;font-weight:bold">=</span><span style="color:#099">8</span> --oltp-table-size<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span> --oltp-table-size<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1000000</span> --mysql-user<span style="color:#000;font-weight:bold">=</span>root --mysql-password<span style="color:#000;font-weight:bold">=</span><span style="color:#099">123456</span> --mysql-db<span style="color:#000;font-weight:bold">=</span>ttt --mysql-host<span style="color:#000;font-weight:bold">=</span>localhost run
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Ê∏ÖÁêÜÊµãËØïÊï∞ÊçÆ</span>
</span></span><span style="display:flex;"><span>sysbench --test<span style="color:#000;font-weight:bold">=</span>oltp --mysql-table-engine<span style="color:#000;font-weight:bold">=</span>innodb --thread<span style="color:#000;font-weight:bold">=</span><span style="color:#099">8</span> --oltp-table-size<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span> --oltp-table-size<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1000000</span> --mysql-user<span style="color:#000;font-weight:bold">=</span>root --mysql-password<span style="color:#000;font-weight:bold">=</span><span style="color:#099">123456</span> --mysql-db<span style="color:#000;font-weight:bold">=</span>ttt --mysql-host<span style="color:#000;font-weight:bold">=</span>localhost cleanup
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂÖ≠mysqlÂéãÂäõÊµãËØï">ÂÖ≠„ÄÅMySQLÂéãÂäõÊµãËØï</h2>
<p>‚Äã	tpcc-mysqlÊòØPerconaÂü∫‰∫étpccËßÑËåÉË°çÁîüÁöÑ‰∫ßÂìÅÔºå‰∏ìÁî®‰∫éMySQLÁöÑÂéãÂäõÊµãËØïÔºåÂØπSQLÁöÑÊâßË°åÊó∂Èó¥Êúâ‰∏•Ê†ºË¶ÅÊ±Ç„ÄÇ</p>
<p><strong>ÂÆâË£Ötpcc-mysql</strong></p>
<p>ÂâçÁΩÆÊù°‰ª∂ÔºöÂÆâË£Ö<code>mysql-devel</code></p>
<p><strong>Á¨¨‰∏ÄÊ≠•Ôºö‰∏ãËΩΩ</strong></p>
<p><a href="https://github.com/Percona-Lab/tpcc-mysql.git">‰∏ãËΩΩÂú∞ÂùÄ</a></p>
<p><strong>Á¨¨‰∫åÊ≠•ÔºöÁºñËØë</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#0086b3">cd</span> src; make
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∏âÊ≠•ÔºöÂèñÂá∫$tpcc-mysqlÁõÆÂΩï‰∏ãÁöÑsql[create_table.sql„ÄÅadd_fkey_idx.sql]Êñá‰ª∂</strong></p>
<p><strong>Á¨¨ÂõõÊ≠•ÔºöÂàõÂª∫‰∏Ä‰∏™Á©∫Êï∞ÊçÆÂ∫ìÔºåÂπ∂ÊâßË°åcreate_table.sql„ÄÅadd_fkey_idx.sql</strong></p>
<p><strong>Á¨¨‰∫îÊ≠•ÔºöÊâßË°åÂàõÂª∫Êï∞ÊçÆÊìç‰Ωú</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#008080">$tpcc</span>-mysql/tpcc_load -h <span style="color:#000;font-weight:bold">[</span>ip<span style="color:#000;font-weight:bold">]</span> -d <span style="color:#000;font-weight:bold">[</span>databaseName<span style="color:#000;font-weight:bold">]</span> -u <span style="color:#000;font-weight:bold">[</span>user<span style="color:#000;font-weight:bold">]</span> -p <span style="color:#000;font-weight:bold">[</span>password<span style="color:#000;font-weight:bold">]</span> -w <span style="color:#000;font-weight:bold">[</span>num<span style="color:#000;font-weight:bold">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>-w ÊåáÁöÑÊòØÊï∞ÊçÆÊ®°Âûã‰∏≠‰ªìÂ∫ìÁöÑÊï∞Èáè</code></p>
<p>Á¨¨ÂÖ≠Ê≠•ÔºöÊâßË°åÂéãÂäõÊµãËØï</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#008080">$tpcc</span>-mysql/tpcc_start -h <span style="color:#000;font-weight:bold">[</span>ip<span style="color:#000;font-weight:bold">]</span> -d <span style="color:#000;font-weight:bold">[</span>databaseName<span style="color:#000;font-weight:bold">]</span> -u <span style="color:#000;font-weight:bold">[</span>user<span style="color:#000;font-weight:bold">]</span> -p <span style="color:#000;font-weight:bold">[</span>password<span style="color:#000;font-weight:bold">]</span> -w  <span style="color:#000;font-weight:bold">[</span>num<span style="color:#000;font-weight:bold">]</span> -c  <span style="color:#000;font-weight:bold">[</span>num<span style="color:#000;font-weight:bold">]</span> -r <span style="color:#000;font-weight:bold">[</span>num<span style="color:#000;font-weight:bold">]</span> -l <span style="color:#000;font-weight:bold">[</span>num<span style="color:#000;font-weight:bold">]</span> &gt; result.log
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>-c ÊåáÁöÑÊòØÂπ∂ÂèëÁ∫øÁ®ãÊï∞</code></p>
<p><code>-r Êï∞ÊçÆÂ∫ìÈ¢ÑÁÉ≠Êó∂Èó¥</code></p>
<p><code>-l ÊµãËØïÊó∂Èó¥</code></p>
<p>‰æãÂ¶ÇÔºö/tpcc_start -h 192.168.1.152 -d tpcc -u root -p 123456 -w 1 -c 5 -r 300 -l 600 &gt; result.log</p>
<blockquote>
<p>pxcÈõÜÁæ§‰ΩøÁî®tpcc-mysqlËøõË°åÂéãÂäõÊµãËØïÈúÄË¶ÅÊõ¥ÊîπÈÖçÁΩÆÊñá‰ª∂<code>pxc_strict_mode=DISABLED</code></p>
</blockquote>
<h2 id="‰∏ÉÊï∞ÊçÆÂ∫ìÁªìÊûÑËÆæËÆ°">‰∏É„ÄÅÊï∞ÊçÆÂ∫ìÁªìÊûÑËÆæËÆ°</h2>
<h3 id="Êï∞ÊçÆÂ∫ìËÆæËÆ°ËåÉÂºè">Êï∞ÊçÆÂ∫ìËÆæËÆ°ËåÉÂºè</h3>
<p>Êï∞ÊçÆÂ∫ìËÆæËÆ°Á¨¨‰∏ÄËåÉÂºè</p>
<ul>
<li>
<p>Êï∞ÊçÆÂ∫ìË°®‰∏≠ÁöÑÊâÄÊúâÂ≠óÊÆµÈÉΩÂè™ÂÖ∑ÊúâÂçï‰∏ÄÂ±ûÊÄß</p>
</li>
<li>
<p>Âçï‰∏ÄÂ±ûÊÄßÁöÑÂàóÊòØÁî±Âü∫Êú¨ÁöÑÊï∞ÊçÆÁ±ªÂûãÊâÄÊûÑÊàêÁöÑ</p>
</li>
<li>
<p>ËÆæËÆ°Âá∫Êù•ÁöÑË°®ÈÉΩÊòØÁÆÄÂçïÁöÑ‰∫åÁª¥Ë°®</p>
</li>
</ul>
<p>Êï∞ÊçÆÂ∫ìÁ¨¨‰∫åËåÉÂºè</p>
<ul>
<li>Ë¶ÅÊ±ÇË°®‰∏≠Âè™ÂÖ∑Êúâ‰∏Ä‰∏™‰∏öÂä°‰∏ªÈîÆÔºå‰πüÂ∞±ÊòØËØ¥Á¨¶ÂêàÁ¨¨‰∫åËåÉÂºèÁöÑË°®‰∏çËÉΩÂ≠òÂú®Èùû‰∏ªÈîÆÂàóÂè™ÂØπÈÉ®ÂàÜ‰∏ªÈîÆÁöÑ‰æùËµñÂÖ≥Á≥ª</li>
</ul>
<p>Êï∞ÊçÆÂ∫ìÁ¨¨‰∏âËåÉÂºè</p>
<ul>
<li>ÊØè‰∏Ä‰∏™Èùû‰∏ªÂ±ûÊÄßÊó¢‰∏çÈÉ®ÂàÜ‰æùËµñ‰πü‰∏ç‰º†ÈÄí‰æùËµñ‰∫é‰∏öÂä°‰∏ªÈîÆ</li>
</ul>
<h3 id="Êï∞ÊçÆÂ∫ìÁâ©ÁêÜËÆæËÆ°">Êï∞ÊçÆÂ∫ìÁâ©ÁêÜËÆæËÆ°</h3>
<p><strong>Ë°®‰∏≠ÁöÑÂàóÈÄâÊã©Êï∞ÊçÆÁ±ªÂûã</strong></p>
<p>‚Äã	ÂΩì‰∏Ä‰∏™ÂàóÂèØ‰ª•ÈÄâÊã©Â§öÁßçÊï∞ÊçÆÁ±ªÂûãÊó∂ÔºåÂ∫îËØ•È¶ñÂÖàËÄÉËôëÊï∞Â≠óÁ±ªÂûãÔºåÂÖ∂Ê¨°ÊòØÊó•ÊúüÊàñ‰∫åËøõÂà∂Á±ªÂûãÔºåÊúÄÂêéÊòØÂ≠óÁ¨¶‰∏≤Á±ªÂûã„ÄÇÂØπ‰∫éÁõ∏ÂêåÁ∫ßÂà´ÁöÑÊï∞ÊçÆÁ±ªÂûãÔºåÂ∫îËØ•‰ºòÂÖàÈÄâÊã©Âç†Áî®Á©∫Èó¥Â∞èÁöÑÊï∞ÊçÆÁ±ªÂûã„ÄÇ</p>
<ul>
<li>Êï¥Êï∞Á±ªÂûã</li>
</ul>
<table>
<thead>
<tr>
<th>ÂàóÁ±ªÂûã</th>
<th>Â≠òÂÇ®Á©∫Èó¥</th>
<th>ËåÉÂõ¥</th>
</tr>
</thead>
<tbody>
<tr>
<td>tinyint</td>
<td>1Â≠óËäÇ</td>
<td>-127 ~ 128</td>
</tr>
<tr>
<td>smallint</td>
<td>2Â≠óËäÇ</td>
<td>-32768 ~ 32767</td>
</tr>
<tr>
<td>mediunmit</td>
<td>3Â≠óËäÇ</td>
<td>-8388608 ~ 8388607</td>
</tr>
<tr>
<td>int</td>
<td>4Â≠óËäÇ</td>
<td>-2147483648 ~ 2147483647</td>
</tr>
<tr>
<td>bigint</td>
<td>8Â≠óËäÇ</td>
<td>-9223372036854775808 ~ 9223372036854775807</td>
</tr>
</tbody>
</table>
<ul>
<li>ÂÆûÊï∞Á±ªÂûã</li>
</ul>
<table>
<thead>
<tr>
<th>ÂàóÁ±ªÂûã</th>
<th>Â≠òÂÇ®Á©∫Èó¥</th>
<th>ÊòØÂê¶Á≤æÁ°Æ</th>
</tr>
</thead>
<tbody>
<tr>
<td>float</td>
<td>4Â≠óËäÇ</td>
<td>Âê¶</td>
</tr>
<tr>
<td>double</td>
<td>8Â≠óËäÇ</td>
<td>Âê¶</td>
</tr>
<tr>
<td>decimal</td>
<td>ÊØè4‰∏™Â≠óËäÇÂ≠ò9‰∏™Êï∞Â≠óÔºåÂ∞èÊï∞ÁÇπÂç†‰∏Ä‰∏™Â≠óËäÇ</td>
<td>ÊòØ</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Ê≥®Ôºö <code>column_name DECIMAL (P,D);</code></p>
<p>1Ôºâ<code>P</code>ÊòØË°®Á§∫ÊúâÊïàÊï∞Â≠óÊï∞ÁöÑÁ≤æÂ∫¶„ÄÇ <code>P</code>ËåÉÂõ¥‰∏∫<code>1„Äú65</code></p>
<p>2Ôºâ<code>D</code>ÊòØË°®Á§∫Â∞èÊï∞ÁÇπÂêéÁöÑ‰ΩçÊï∞„ÄÇ <code>D</code>ÁöÑËåÉÂõ¥ÊòØ<code>0</code>~<code>30</code>„ÄÇMySQLË¶ÅÊ±Ç<code>D</code>Â∞è‰∫éÊàñÁ≠â‰∫é(<code>&lt;=</code>)<code>P</code></p>
<p>Â¶Ç<code>amount DECIMAL(6,2);</code>  <code>amount</code>ÂàóÊúÄÂ§öÂèØ‰ª•Â≠òÂÇ®<code>6</code>‰ΩçÊï∞Â≠óÔºåÂ∞èÊï∞‰ΩçÊï∞‰∏∫<code>2</code>‰Ωç; Âõ†Ê≠§Ôºå<code>amount</code>ÂàóÁöÑËåÉÂõ¥ÊòØ‰ªé<code>-9999.99</code>Âà∞<code>9999.99</code></p>
</blockquote>
<ul>
<li>
<p>varcharÂíåcharÁ±ªÂûã„ÄêÂçï‰ΩçÊòØÂ≠óÁ¨¶„Äë</p>
<ul>
<li>varcharÁöÑÂ≠òÂÇ®
<ul>
<li>varcharÁî®‰∫éÂ≠òÂÇ®ÂèòÈïøÂ≠óÁ¨¶‰∏≤ÔºåÂè™Âç†Áî®ÂøÖË¶ÅÁöÑÂ≠òÂÇ®Á©∫Èó¥</li>
<li>ÂàóÁöÑÊúÄÂ§ßÈïøÂ∫¶Â∞è‰∫é255ÂàôÂè™Âç†Áî®‰∏Ä‰∏™È¢ùÂ§ñÂ≠óËäÇÁî®‰∫éËÆ∞ÂΩïÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶</li>
<li>ÂàóÁöÑÊúÄÂ§ßÈïøÂ∫¶Â§ß‰∫é255ÂàôÂè™Âç†Áî®‰∏§‰∏™È¢ùÂ§ñÂ≠óËäÇÁî®‰∫éËÆ∞ÂΩïÂ≠óÁ¨¶‰∏≤ÁöÑÈïøÂ∫¶</li>
</ul>
</li>
<li>varcharÁöÑÈÄÇÁî®Âú∫ÊôØ
<ul>
<li>ÊúÄÂ§ßÈïøÂ∫¶ÊØîÂπ≥ÂùáÈïøÂ∫¶Â§ßÁöÑÂ§öÁöÑÂ≠óÁ¨¶‰∏≤Âàó</li>
<li>ÂæàÂ∞ëË¢´Êõ¥Êñ∞ÁöÑÂ≠óÁ¨¶‰∏≤Âàó</li>
<li>‰ΩøÁî®‰∫ÜÂ§öÂ≠óËäÇÂ≠óÁ¨¶ÈõÜÂ≠òÂÇ®ÁöÑÂ≠óÁ¨¶‰∏≤</li>
</ul>
</li>
<li>charÁöÑÂ≠òÂÇ®
<ul>
<li>ÂÆöÈïøÂ≠òÂÇ®</li>
<li>Â≠óÁ¨¶‰∏≤Â≠òÂÇ®ÂÜçcharÁ±ªÂûãÁöÑÂàó‰∏≠‰ºöËá™Âä®Âà†Èô§Êú´Â∞æÁöÑÁ©∫Ê†º</li>
<li>ÊúÄÂ§ßÂÆΩÂ∫¶255</li>
</ul>
</li>
<li>charÁöÑÈÄÇÁî®Âú∫ÊôØ
<ul>
<li>Â≠òÂÇ®ÈïøÂ∫¶Ëøë‰ººÁöÑÂ≠óÁ¨¶‰∏≤</li>
<li>ÈïøÂ∫¶ËæÉÁü≠ÁöÑÂ≠óÁ¨¶‰∏≤</li>
<li>ÁªèÂ∏∏Ë¢´Êõ¥Êñ∞ÁöÑÂ≠óÁ¨¶‰∏≤Âàó</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Êó•ÊúüÁ±ªÂûã</p>
<p>datetimeÁ±ªÂûã</p>
<p>‚Äã	‰ª•<code>YYYY-MM-DD HH:MM:SS[.fraction]</code>Ê†ºÂºèÂ≠òÂÇ®Êó•ÊúüÊó∂Èó¥</p>
<ul>
<li>
<p>datetime= <code>YYYY-MM-DD HH:MM:SS</code></p>
</li>
<li>
<p>datetime(6) =  <code>YYYY-MM-DD HH:MM:SS[.fraction]</code></p>
</li>
<li>
<p>datetimeÁ±ªÂûã‰∏éÊó∂Âå∫Êó†ÂÖ≥ÔºåÂç†Áî®8‰∏™Â≠óËäÇÁöÑÂ≠òÂÇ®Á©∫Èó¥</p>
</li>
</ul>
<p>timestampÁ±ªÂûã</p>
<p>‚Äã	Â≠òÂÇ®‰∫ÜÁî±Ê†ºÊûóÂ∞ºÊ≤ªÊó∂Èó¥1970Âπ¥1Êúà1Êó•Âà∞ÂΩìÂâçÊó∂Èó¥ÁöÑÁßíÊï∞Ôºå‰ª•<code>YYYY-MM-DD HH:MM:SS[.fraction]</code>ÊòæÁ§∫</p>
<ul>
<li>Á±ªÂûãÊòæÁ§∫‰æùËµñÊâÄÊåáÂÆöÁöÑÊó∂Âå∫ÔºåÂç†Áî®4‰∏™Â≠óËäÇ</li>
<li>Ë°åÊï∞ÊçÆ‰øÆÊîπÊó∂ÂèØËá™Âä®‰øÆÊîπtimestampÂàóÁöÑÂÄº</li>
</ul>
<p>dateÁ±ªÂûãÂíåtimeÁ±ªÂûã</p>
<ul>
<li>dateÁ±ªÂûãÂè™Âç†Áî®3‰∏™Â≠óËäÇ„ÄÅÂπ∂‰∏îÂèØ‰ª•‰ΩøÁî®Êó•ÊúüÂáΩÊï∞ËøõË°åËÆ°ÁÆó</li>
<li>timeÁ±ªÂûãÁî®‰∫éÂ≠òÂÇ®Êó∂Èó¥Á±ªÂûãÔºåÊ†ºÂºè‰∏∫<code>HH:MM:SS</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>‰∏çË¶Å‰ΩøÁî®Â≠óÁ¨¶‰∏≤Á±ªÂûãÊù•Â≠òÂÇ®Êó•ÊúüÊó∂Èó¥Êï∞ÊçÆ</p>
</blockquote>
<h3 id="ÂàÜÂå∫Ë°®ÁöÑ‰ΩøÁî®">ÂàÜÂå∫Ë°®ÁöÑ‰ΩøÁî®</h3>
<p>‚Äã	 ÂàÜÂå∫ÊòØÂ∞Ü‰∏Ä‰∏™Ë°®ÁöÑÊï∞ÊçÆÊåâÁÖßÊüêÁßçÊñπÂºèÔºåÊØîÂ¶ÇÊåâÁÖßÊó∂Èó¥‰∏äÁöÑÊúà‰ªΩÔºåÂàÜÊàêÂ§ö‰∏™ËæÉÂ∞èÁöÑÔºåÊõ¥ÂÆπÊòìÁÆ°ÁêÜÁöÑÈÉ®ÂàÜÔºå‰ΩÜÊòØÈÄªËæë‰∏ä‰ªçÊòØ‰∏Ä‰∏™Ë°®ÔºàÁâ©ÁêÜÂ∑≤ÁªèË¢´ÊãÜÂàÜÔºâ„ÄÇ</p>
<p><strong>ÂàÜÂå∫Ë°®ÁöÑÈôêÂà∂Âõ†Á¥†</strong></p>
<ul>
<li>
<p>‰∏Ä‰∏™Ë°®ÊúÄÂ§öÂè™ËÉΩÊúâ1024‰∏™ÂàÜÂå∫</p>
</li>
<li>
<p>Â¶ÇÊûúÂàÜÂå∫Â≠óÊÆµ‰∏≠Êúâ‰∏ªÈîÆÊàñËÄÖÂîØ‰∏ÄÁ¥¢ÂºïÁöÑÂàóÔºåÈÇ£‰πà‰∏ªÈîÆÂàóÂíåÂîØ‰∏ÄÁ¥¢ÂºïÂàóÈÉΩÂøÖÈ°ªÂåÖÂê´ÂÆÉ„ÄÇÂç≥ÔºöÂàÜÂå∫Â≠óÊÆµË¶Å‰πà‰∏çÂåÖÂê´‰∏ªÈîÆÊàñËÄÖÂîØ‰∏ÄÁ¥¢ÂºïÂàóÔºåË¶Å‰πàÂåÖÂê´ÂÖ®ÈÉ®‰∏ªÈîÆÂíåÂîØ‰∏ÄÁ¥¢ÂºïÂàó</p>
</li>
<li>
<p>ÂàÜÂå∫Ë°®‰∏≠Êó†Ê≥ï‰ΩøÁî®Â§ñÈîÆÁ∫¶Êùü</p>
</li>
</ul>
<blockquote>
<p>ÂàÜÂå∫Ë°®Áâ©ÁêÜÊòØÂàÜÂå∫ÁöÑÔºå‰ΩÜÈÄªËæë‰∏äÊòØ‰∏Ä‰∏™Ë°®„ÄÇÂ¶ÇÊûúÂàÜÂå∫Ë°®Ê≤°Êúâ‰∏ªÈîÆÂíåÂîØ‰∏ÄÁ¥¢ÂºïÔºåÂàô‰∏çÈúÄË¶ÅÂà§Êñ≠ÈîÆÈáçÂ§ç„ÄÇÂ¶ÇÊûúÂàÜÂå∫Ë°®Â≠òÂú®‰∏ªÈîÆÊàñËÄÖÂîØ‰∏ÄÁ¥¢ÂºïËÄåÂàÜÂå∫Â≠óÊÆµ‰∏çÊòØÂÆÉÔºåÂàôÈúÄË¶ÅÂà§Êñ≠Âà´ÁöÑÂàÜÂå∫ÊòØÂê¶Â≠òÂú®ÈîÆÂÜ≤Á™ÅÔºåMySQL‰∏çÊîØÊåÅ„ÄÇ</p>
</blockquote>
<p><strong>ÂàÜÂå∫Á±ªÂûã</strong></p>
<p>Ôºà1ÔºâRANGEÂàÜÂå∫ÔºöÂü∫‰∫éÂ±û‰∫é‰∏Ä‰∏™ÁªôÂÆöËøûÁª≠Âå∫Èó¥ÁöÑÂàóÂÄºÔºåÊääÂ§öË°åÂàÜÈÖçÁªôÂàÜÂå∫„ÄÇ</p>
<p>Ôºà2ÔºâLISTÂàÜÂå∫ÔºöÁ±ª‰ºº‰∫éÊåâRANGEÂàÜÂå∫ÔºåÂå∫Âà´Âú®‰∫éLISTÂàÜÂå∫ÊòØÂü∫‰∫éÂàóÂÄºÂåπÈÖç‰∏Ä‰∏™Á¶ªÊï£ÂÄºÈõÜÂêà‰∏≠ÁöÑÊüê‰∏™ÂÄºÊù•ËøõË°åÈÄâÊã©„ÄÇ</p>
<p>Ôºà3ÔºâHASHÂàÜÂå∫ÔºöÂü∫‰∫éÁî®Êà∑ÂÆö‰πâÁöÑË°®ËææÂºèÁöÑËøîÂõûÂÄºÊù•ËøõË°åÈÄâÊã©ÁöÑÂàÜÂå∫ÔºåËØ•Ë°®ËææÂºè‰ΩøÁî®Â∞ÜË¶ÅÊèíÂÖ•Âà∞Ë°®‰∏≠ÁöÑËøô‰∫õË°åÁöÑÂàóÂÄºËøõË°åËÆ°ÁÆó„ÄÇËøô‰∏™ÂáΩÊï∞ÂèØ‰ª•ÂåÖÂê´MySQL ‰∏≠ÊúâÊïàÁöÑ„ÄÅ‰∫ßÁîüÈùûË¥üÊï¥Êï∞ÂÄºÁöÑ‰ªª‰ΩïË°®ËææÂºè„ÄÇ</p>
<p>Ôºà4ÔºâKEYÂàÜÂå∫ÔºöÁ±ª‰ºº‰∫éÊåâHASHÂàÜÂå∫ÔºåÂå∫Âà´Âú®‰∫éKEYÂàÜÂå∫Âè™ÊîØÊåÅËÆ°ÁÆó‰∏ÄÂàóÊàñÂ§öÂàóÔºå‰∏îMySQLÊúçÂä°Âô®Êèê‰æõÂÖ∂Ëá™Ë∫´ÁöÑÂìàÂ∏åÂáΩÊï∞„ÄÇÂøÖÈ°ªÊúâ‰∏ÄÂàóÊàñÂ§öÂàóÂåÖÂê´Êï¥Êï∞ÂÄº„ÄÇ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic">-- Êï∞Â≠óËåÉÂõ¥ÂàÜÂå∫
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">create</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">table</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">employees</span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>id<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">int</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">primary</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">key</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>fname<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">varchar</span>(<span style="color:#099">30</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>lname<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">varchar</span>(<span style="color:#099">30</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>hired<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">date</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>entryDate<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">date</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">engine</span><span style="color:#000;font-weight:bold">=</span>innodb<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">charset</span><span style="color:#000;font-weight:bold">=</span>utf8<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>partition<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">range</span>(id)(<span style="color:#bbb">						</span><span style="color:#998;font-style:italic">-- ÂàÜÂå∫Â≠óÊÆµ‰∏∫‰∏ªÈîÆÊ≤°ÈóÆÈ¢ò
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#bbb">    </span>partition<span style="color:#bbb"> </span>p0<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span><span style="color:#bbb"> </span>less<span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">than</span><span style="color:#bbb"> </span>(<span style="color:#099">1000</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>partition<span style="color:#bbb"> </span>p1<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span><span style="color:#bbb"> </span>less<span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">than</span><span style="color:#bbb"> </span>(<span style="color:#099">2000</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>partition<span style="color:#bbb"> </span>p2<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span><span style="color:#bbb"> </span>less<span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">than</span><span style="color:#bbb"> </span>(<span style="color:#099">3000</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>partition<span style="color:#bbb"> </span>p3<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span><span style="color:#bbb"> </span>less<span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">than</span><span style="color:#bbb"> </span>(<span style="color:#099">4000</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>partition<span style="color:#bbb"> </span>p4<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span><span style="color:#bbb"> </span>less<span style="color:#bbb"> </span>than<span style="color:#bbb"> </span>MAXVALUE<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- listÂàÜÂå∫
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">create</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">table</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">employees</span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>id<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">int</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span>,<span style="color:#bbb">					</span><span style="color:#998;font-style:italic">-- Â¶ÇÊûúid‰∏∫‰∏ªÈîÆÂàôÂ≠òÂú®ÈóÆÈ¢ò
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#bbb">    </span>fname<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">varchar</span>(<span style="color:#099">30</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>lname<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">varchar</span>(<span style="color:#099">30</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>hired<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">date</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>entry_date<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">date</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>status<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">SMALLINT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">engine</span><span style="color:#000;font-weight:bold">=</span>innodb<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">charset</span><span style="color:#000;font-weight:bold">=</span>utf8<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>partition<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">list</span><span style="color:#bbb"> </span>(status)(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>partition<span style="color:#bbb"> </span>pNotJob<span style="color:#bbb">  </span><span style="color:#000;font-weight:bold">values</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">in</span><span style="color:#bbb"> </span>(<span style="color:#099">1</span>),<span style="color:#bbb">    </span><span style="color:#998;font-style:italic">-- 1ÔºöÁ¶ªËÅå
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#bbb">    </span>partition<span style="color:#bbb"> </span>pWillJob<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">in</span><span style="color:#bbb"> </span>(<span style="color:#099">2</span>,<span style="color:#099">3</span>),<span style="color:#bbb">	 </span><span style="color:#998;font-style:italic">-- 2ÔºöÈù¢ËØï‰∏≠Ôºå3ÔºöÈù¢ËØïÈÄöËøáÂæÖÂÖ•ËÅå
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#bbb">    </span>partition<span style="color:#bbb"> </span>pOnJob<span style="color:#bbb">   </span><span style="color:#000;font-weight:bold">values</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">in</span><span style="color:#bbb"> </span>(<span style="color:#099">4</span>,<span style="color:#099">5</span>),<span style="color:#bbb">  </span><span style="color:#998;font-style:italic">-- 4ÔºöÂêàÂêåÂ∑•Ôºå5Ôºö‰∏¥Êó∂Â∑•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#bbb">    </span>partition<span style="color:#bbb"> </span>pHelpJob<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">in</span><span style="color:#bbb"> </span>(<span style="color:#099">6</span>)<span style="color:#bbb">	 </span><span style="color:#998;font-style:italic">-- 6ÔºöÂÖºËÅå
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- hashÂàÜÂå∫
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">create</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">table</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">employees</span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>id<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">int</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>fname<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">varchar</span>(<span style="color:#099">30</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>lname<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">varchar</span>(<span style="color:#099">30</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>hired<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">date</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>entry_date<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">date</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>status<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">SMALLINT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">engine</span><span style="color:#000;font-weight:bold">=</span>innodb<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">charset</span><span style="color:#000;font-weight:bold">=</span>utf8<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>partition<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">hash</span>(<span style="color:#458;font-weight:bold">year</span>(entry_date))<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>partitions<span style="color:#bbb"> </span><span style="color:#099">4</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- keyÂàÜÂå∫‰∏çËÉΩÂú®‰ΩøÁî®yearÁ≠âÂáΩÊï∞Ôºå‰ºöÊä•Èîô
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">create</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">table</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">employees</span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>id<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">int</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>fname<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">varchar</span>(<span style="color:#099">30</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>lname<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">varchar</span>(<span style="color:#099">30</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>hired<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">date</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>entry_date<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">date</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>status<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">SMALLINT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#008080">null</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">engine</span><span style="color:#000;font-weight:bold">=</span>innodb<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">charset</span><span style="color:#000;font-weight:bold">=</span>utf8<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>partition<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">key</span>(entry_date)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>partitions<span style="color:#bbb"> </span><span style="color:#099">4</span>;<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂÖ´‰∏ª‰ªéÊ®°Âºè">ÂÖ´„ÄÅ‰∏ª‰ªéÊ®°Âºè</h2>
<h3 id="mysql‰∫åËøõÂà∂Êó•Âøó">MySQL‰∫åËøõÂà∂Êó•Âøó</h3>
<p>‚Äã	ËÆ∞ÂΩï‰∫ÜÊâÄÊúâMySQLÊï∞ÊçÆÂ∫ìÁöÑ‰øÆÊîπÊàêÂäüÁöÑ‰∫ã‰ª∂ÔºàÂåÖÊã¨Â¢ûÂà†Êîπ‰∫ã‰ª∂ÂíåÂØπË°®ÁªìÊûÑÁöÑ‰øÆÊîπÊó∂Èó¥Ôºâ</p>
<p><strong>ÂºÄÂêØ‰∫åËøõÂà∂Êó•Âøó</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[mysqld]</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">server-id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">1					#ÊØèÂè∞Êú∫Âô®server-idÂùáË¶Å‰∏çÂêå</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-bin</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-bin			#‰∫åËøõÂà∂Êó•ÂøóÁöÑÂêçÁß∞ÂâçÁºÄ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Êü•Áúã‰∫åËøõÂà∂Êó•Âøó</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Êü•ÁúãÊÆµÊ†ºÂºèÂ§çÂà∂</span>
</span></span><span style="display:flex;"><span>mysqlbinlog  -vv mysql-bin.000001
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Êü•ÁúãË°åÊ†ºÂºèÂ§çÂà∂</span>
</span></span><span style="display:flex;"><span>mysqlbinlog  mysql-bin.000001
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>‰∫åÁ∫ßÂà∂Êó•ÂøóÊ†ºÂºè</strong></p>
<ul>
<li>
<p>Âü∫‰∫éÊÆµÁöÑÊ†ºÂºèbinlog_format=STATEMENT„Äê5.7‰πãÂâçÈªòËÆ§‰ΩøÁî®„ÄëÂ∞±ÊòØËÆ∞ÂΩïÂ¢ûÂà†ÊîπÁöÑSQLËØ≠Âè•</p>
<p>‰ºòÁÇπÔºöÊó•ÂøóËÆ∞ÂΩïÈáèÁõ∏ÂØπËæÉÂ∞èÔºåËäÇÁ∫¶Á£ÅÁõò/ÁΩëÁªúIO„ÄêÂ¶ÇÊûúÊòØÂè™ÂØπ‰∏ÄÊù°ËÆ∞ÂΩï‰øÆÊîπÊàñÊèíÂÖ•rowÊ†ºÂºèÁöÑÊó•ÂøóÈáèÊõ¥Â∞è„Äë</p>
<p>Áº∫ÁÇπÔºöÂØπ<code>UUID()</code>Á±ª‰ºº‰∏çÁ°ÆÂÆöÁªìÊûúÁöÑÂáΩÊï∞‰ªéÊúçÂä°Âô®Âú®ÊâßË°åÊó∂‰ºöÈÄ†Êàê‰∏ª‰ªéÊï∞ÊçÆ‰∏ç‰∏ÄËá¥</p>
</li>
<li>
<p>Âü∫‰∫éË°åÁöÑÊ†ºÂºèbinlog_format=ROW„Äê5.7‰πãÂêéÈªòËÆ§‰ΩøÁî®„ÄëËÆ∞ÂΩï‰∫ÜÊØè‰∏ÄË°åÁöÑÊï∞ÊçÆ‰øÆÊîπ</p>
<p>‰ºòÁÇπÔºö</p>
<p>‚Äã     ‚ë†Êõ¥Âä†ÂÆâÂÖ®ÁöÑ‰∏ª‰ªéÂ§çÂà∂Ôºå‰∏çÁî®ÂÜçÊ¨°ÊâßË°åSQLÂáèÂ∞ë‰∏çÁ°ÆÂÆöÊÄß„ÄÇ</p>
<p>‚Äã     ‚ë°ÊØèË°åÂ§çÂà∂Êõ¥Âø´„ÄÇ</p>
<p>‚Äã     ‚ë¢ËØØÊìç‰ΩúËÄå<code>‰øÆÊîπ</code>Êï∞ÊçÆÊó∂ÂèØÈÄöËøá‰∫åÁ∫ßÂà∂Êó•ÂøóÂàÜÊûêÈÄÜÂêëËøòÂéü</p>
<p>Áº∫ÁÇπÔºöÂ§ßËßÑÊ®°‰øÆÊîπ‰∫ßÁîüÁöÑÊó•ÂøóÈáèÂ§ßÔºåÁ£ÅÁõòÂíåÁΩëÁªúË¥üËΩΩÂ§ß</p>
<p>ÂèØË∞ÉËäÇÂèÇÊï∞</p>
<ul>
<li>binlog_row_image
<ul>
<li>FULL           ÂÖ®ÈáèËÆ∞ÂΩïÊØèÊù°Êï∞ÊçÆ‰øÆÊîπ„ÄêÈªòËÆ§„Äë</li>
<li>MINIMAL    Âè™ËÆ∞ÂΩï‰øÆÊîπÁöÑÂàó„ÄêÂª∫ËÆÆ„Äë</li>
<li>NOBLOB     Á±ª‰ººÂÖ®ÈáèËÆ∞ÂΩïÔºå‰ΩÜÊòØÂ¶ÇÊûúTEXTÊàñËÄÖBLOBÂ≠óÊÆµÂàóÊú™‰øÆÊîπÂàô‰∏çËÆ∞ÂΩïËøô‰∫õÂ≠óÊÆµ</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Ê∑∑ÂêàÁöÑÊ†ºÂºèbinlog_format=MIXED</p>
<p>ÁâπÁÇπÔºöÊ†πÊçÆÊÉÖÂÜµ‰ΩøÁî®STATEMENTÂíåROWÊ†ºÂºèÔºåROWÂú®STATEMENT‰∏çËÉΩËÆ∞ÂΩïÁöÑÊÉÖÂÜµ‰∏ãËÆ∞ÂΩï</p>
</li>
</ul>
<p><strong>‰∫åËøõÂà∂Êó•ÂøóÂØπÂ§çÂà∂ÁöÑÂΩ±Âìç</strong></p>
<ul>
<li>Âü∫‰∫éSQLËØ≠Âè•ÁöÑÂ§çÂà∂ÔºàSBRÔºâ„Äê‰∫åËøõÂà∂Êó•Âøó‰ΩøÁî®ÁöÑÊòØSTATEMENTÊ†ºÂºèÔºå5.1.4‰πãÂâçÂè™Êúâ‰∏≠„Äë</li>
</ul>
<p>‰ºòÁÇπ</p>
<ul>
<li>ÁîüÊàêÊó•ÂøóÈáèÂ∞ëÔºåËäÇÁ∫¶Á£ÅÁõò/ÁΩëÁªúIO</li>
<li>Âπ∂‰∏çÂº∫Âà∂Ë¶ÅÊ±Ç‰∏ª‰ªéÊï∞ÊçÆÂ∫ìÁöÑË°®ÂÆö‰πâÂÆåÂÖ®Áõ∏Âêå„ÄêÂàóÈ°∫Â∫è‰∏çÂêåÔºåÊàñËÄÖÂ≠óÊÆµÁ±ªÂûãÂÖºÂÆπ„Äë</li>
<li>ÊØîÂü∫‰∫éË°åÁöÑÂ§çÂà∂ÊñπÂºèÊõ¥‰∏∫ÁÅµÊ¥ª</li>
</ul>
<p>Áº∫ÁÇπ</p>
<ul>
<li>
<p>ÈùûÁ°ÆÂÆöÊÄß‰∫ã‰ª∂Êó†Ê≥ï‰øùËØÅ‰∏ª‰ªéÊï∞ÊçÆÂ§çÂà∂ÁöÑ‰∏ÄËá¥„Äê‰æãÂ¶ÇUUID()„ÄëÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÂØºËá¥‰∏ª‰ªéÂ§çÂà∂‰∏≠Êñ≠</p>
</li>
<li>
<p>ÂØπ‰∫éÂ≠òÂÇ®ËøáÁ®ãÔºåËß¶ÂèëÂô®ÔºåËá™ÂÆö‰πâÂáΩÊï∞ËøõË°å‰øÆÊîπ‰πüÂèØËÉΩÈÄ†Êàê‰∏ª‰ªéÊï∞ÊçÆ‰∏ç‰∏ÄËá¥</p>
</li>
<li>
<p>Âü∫‰∫éË°åÁöÑÂ§çÂà∂ÔºàRBRÔºâ„Äê‰∫åËøõÂà∂Êó•Âøó‰ΩøÁî®ÁöÑÊòØROWÊ†ºÂºè„Äë</p>
<p>‰ºòÁÇπ</p>
<ul>
<li>ÂèØ‰ª•Â∫îÁî®‰ªª‰ΩïSQLÁöÑÂ§çÂà∂ÂåÖÊã¨ÈùûÁ°ÆÂÆöÂáΩÊï∞ÔºåÂ≠òÂÇ®ËøáÁ®ãÁ≠â</li>
<li>ÂèØ‰ª•ÂáèÂ∞ë‰ªéÊúçÂä°Âô®‰∏äÈîÅÁöÑ‰ΩøÁî®</li>
</ul>
<p>Áº∫ÁÇπ</p>
<ul>
<li>Ë¶ÅÊ±Ç‰∏ª‰ªéÊï∞ÊçÆÂ∫ìÁöÑË°®ÁªìÊûÑÂÆåÂÖ®Áõ∏ÂêåÔºåÂê¶ÂàôÂèØËÉΩ‰ºö‰∏≠Êñ≠‰∏ª‰ªéÂ§çÂà∂„Äê‰ªéÊú´Â∞æÂä†ÂàóÊ≤°ÈóÆÈ¢ò„Äë</li>
<li>Êó†Ê≥ïÂú®‰ªéÊúçÂä°Âô®‰∏äÂçïÁã¨ÊâßË°åËß¶ÂèëÂô®</li>
</ul>
</li>
<li>
<p>Ê∑∑ÂêàÊ®°Âºè„ÄêÊ†πÊçÆÂÆûÈôÖÂÜÖÂÆπÂú®‰ª•‰∏ä‰∏§ËÄÖ‰πãÈó¥ËΩ¨Êç¢„Äë</p>
</li>
</ul>
<h3 id="mysqlÁöÑÂ§çÂà∂Â∑•‰ΩúÊñπÂºè">MySQLÁöÑÂ§çÂà∂Â∑•‰ΩúÊñπÂºè</h3>
<p><img src="/img/mysql/MySQL-Replication.png" alt="MySQL-Replication"></p>
<p><strong>Â§çÂà∂Â∑•‰ΩúÂéüÁêÜ</strong>
(1) masterÂ∞ÜÊîπÂèòËÆ∞ÂΩïÂà∞‰∫åËøõÂà∂Êó•Âøó(binary log)</p>
<p>(2) slaveÂ∞ÜmasterÁöÑbinary logÊã∑Ë¥ùÂà∞ÂÆÉÁöÑ‰∏≠ÁªßÊó•Âøó(relay log)</p>
<p>‚Äã	‰ªéËØªÂèñ‰∏≠ÁªßÊó•ÂøóÁöÑ‰ΩçÁΩÆ‰∏çÂêåÂèàÂàÜ‰∏∫ÔºöÂü∫‰∫éÊó•ÂøóÁöÑÂ§çÂà∂„ÄÅÂü∫‰∫éGTIDÁöÑÂ§çÂà∂</p>
<p>(3) slaveÈáçÂÅö‰∏≠ÁªßÊó•Âøó‰∏≠ÁöÑ‰∫ã‰ª∂ÔºåÂ∞ÜÊîπÂèòÂèçÊò†ÂÆÉËá™Â∑±ÁöÑÊï∞ÊçÆ</p>
<p>‚Äã	Âü∫‰∫éÊÆµÁöÑÊó•ÂøóÊòØÂú®‰ªéÂ∫ì‰∏äÈáçÊñ∞ÊâßË°åËÆ∞ÂΩïÁöÑSQL</p>
<p>‚Äã	Âü∫‰∫éË°åÁöÑÊó•ÂøóÊòØÂú®‰ªéÂ∫ì‰∏äÁõ¥Êé•Â∫îÁî®ÂØπÊï∞ÊçÆÂ∫ìÁöÑ‰øÆÊîπ</p>
<p>ÂΩì‰∏ª‰ªéÂ§çÂà∂ÈÖçÁΩÆÂÆåÊàêÂêéÔºåÂêÑÂ§çÂà∂Á∫øÁ®ãÂêØÂä®È°∫Â∫è</p>
<p>‚ë† ‰ªéÂ∫ì‰∏äÂêØÂä®Â§çÂà∂ÔºåÂú®‰ªéÂ∫ì‰∏äÂàõÂª∫I/OÁ∫øÁ®ãÔºåI/OÁ∫øÁ®ãËøûÊé•Âà∞‰∏ªÂ∫ì</p>
<p>‚ë° ‰∏ªÂ∫ìÂàõÂª∫binlog dumpÁ∫øÁ®ãËØªÂèñÊï∞ÊçÆÂ∫ì‰∫ã‰ª∂Âπ∂ÂèëÈÄÅÁªôIOÁ∫øÁ®ã</p>
<p>‚ë¢ ‰ªéÂ∫ì‰∏äÁöÑI/OÁ∫øÁ®ãÊé•Êî∂Âà∞‰∫ã‰ª∂Êï∞ÊçÆÔºåÂ∞Ü‰∫ã‰ª∂Êï∞ÊçÆÊõ¥Êñ∞Âà∞‰∏≠ÁªßÊó•Âøó(relay log)‰∏≠</p>
<p>‚ë£ ‰ªéÂ∫ì‰∏äSQLÁ∫øÁ®ãËØªÂèñ‰∏≠ÁªßÊó•Âøó‰∏≠Êõ¥Êñ∞ÁöÑ‰∫ã‰ª∂Êï∞ÊçÆÂπ∂Â∫îÁî®Âà∞‰ªéÂ∫ì‰∏ä„ÄÇ</p>
<h3 id="mysql‰∏ª‰ªéÊê≠Âª∫">MySQL‰∏ª‰ªéÊê≠Âª∫</h3>
<h4 id="Âü∫‰∫éÊó•ÂøóÁÇπÂ§çÂà∂">Âü∫‰∫éÊó•ÂøóÁÇπÂ§çÂà∂</h4>
<ul>
<li>‰∏ªÊú∫ÂàõÂª∫ÊéàÊùÉË¥¶Âè∑</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âú®‰∏ªÊúçÂä°Âô®‰∏äÊâßË°åÔºåÂàõÂª∫Â§çÂà∂Ë¥¶Âè∑ÔºåÂπ∂Êéà‰∫àÊùÉÈôê
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">USER</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[username]&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;[ip]&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">identified</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[password]&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">GRANT</span><span style="color:#bbb"> </span>REPLICATION<span style="color:#bbb"> </span>SLAVE<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ON</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span>.<span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">TO</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[username]&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;[ip]&#39;</span><span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>‰∏ªÊú∫ÊúçÂä°Âô®ÈÖçÁΩÆ</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊØèÂè∞MySQLË¶ÅÊ±Ç‰∏çÂêå</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">server-id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">1</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∫åËøõÂà∂Êó•ÂøóÂºÄÂêØÔºåÂ¶ÇÊûúÊúâÊù°‰ª∂ÁöÑËØùÂª∫ËÆÆÂçïÁã¨ÊåáÂÆöÂ≠òÊîæÂú®Âè¶‰∏Ä‰∏™Á£ÅÁõò‰∏ãÔºå‰∏çÂíåÊï∞ÊçÆÊñá‰ª∂Â≠òÊîæ‰∏ÄËµ∑</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-bin</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-bin</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>‰ªéÊú∫ÈÖçÁΩÆ</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊØèÂè∞MySQLË¶ÅÊ±Ç‰∏çÂêå</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">server-id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">101</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∫åËøõÂà∂Êó•ÂøóÂºÄÂêØÔºåÂ¶ÇÊûúÊúâÊù°‰ª∂ÁöÑËØùÂª∫ËÆÆÂçïÁã¨ÊåáÂÆöÂ≠òÊîæÂú®Âè¶‰∏Ä‰∏™Á£ÅÁõò‰∏ãÔºå‰∏çÂíåÊï∞ÊçÆÊñá‰ª∂Â≠òÊîæ‰∏ÄËµ∑</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-bin</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏≠ÁªßÊó•ÂøóÂºÄÂêØÔºåÈÅøÂÖçÈªòËÆ§Êù°‰ª∂‰∏ã‰ΩøÁî®‰∏ªÊú∫ÂêçÂëΩÂêçÔºåÂ¶ÇÊûú‰øÆÊîπ‰∏ªÊú∫ÂêçÂèØËÉΩ‰ºö‰∫ßÁîüÈîôËØØ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">relay-log</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-relay-bin</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂèØÈÄâÈÖçÁΩÆÔºåÊòØÂê¶Â∞Ü‰∏≠ÁªßÊó•ÂøóÁöÑÂÜÖÂÆπÈáçÊñ∞ËÆ∞ÂΩïÂà∞‰ªéÊú∫‰∫åËøõÂà∂Êó•Âøó‰∏≠</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂΩìËøôÂè∞‰ªéÊú∫ÂÅöÂè¶‰∏Ä‰∏™‰ªéÊú∫ÁöÑ‰∏ªÊú∫ÂΩ¢ÊàêÈìæË∑ØÂ§çÂà∂Êó∂ÔºåÊ≠§ÈÄâÈ°πÂøÖÈ°ªÊâìÂºÄ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-slave-updates</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂèØÈÄâÈÖçÁΩÆÔºåÈô§‰∫ÜsupperÁî®Êà∑‰ª•Â§ñÊ≤°ÊúâÁî®Êà∑ÊúâÂÜôÊùÉÈôêÔºåÂª∫ËÆÆ‰ªéÊúçÂä°ÂêØÁî®</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">read-only</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ÂàùÂßãÂåñ‰ªéÊï∞ÊçÆÂ∫ìÊï∞ÊçÆ</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#################################mysqldumpÂ§á‰ªΩ########################################</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Â§á‰ªΩMyISAMÁöÑÂ≠òÂÇ®ÂºïÊìéÈúÄË¶ÅÂä†ÂÖ•„Äê--lock-all-tables„Äë</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># mysqldumpÂ§á‰ªΩ‰ºöËøõË°åÈîÅË°®Êìç‰Ωú</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># --triggersÂ§á‰ªΩËß¶ÂèëÂô®„ÄÅ--routinesÂ§á‰ªΩÂ≠òÂÇ®ËøáÁ®ã</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># --master-dataÔºö</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#       1[ÈªòËÆ§]:Â∞ÜdumpËµ∑Âßã(change master to)binlogÁÇπÂíåposÂÄºÂÜôÂà∞ÁªìÊûú‰∏≠</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#       2:ÊòØÂ∞Üchange master toÂÜôÂà∞ÁªìÊûú‰∏≠Âπ∂Ê≥®Èáä</span>
</span></span><span style="display:flex;"><span>mysqldump --single-transaction --master-data<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span> --triggers --routines --all-databases -u<span style="color:#000;font-weight:bold">[</span>user<span style="color:#000;font-weight:bold">]</span> -p &gt;all.sql;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Â∞ÜÂ§á‰ªΩSQLÂØºÂÖ•Êú™ÂàùÂßãÂåñÁöÑ‰ªéÊúçÂä°Âô®</span>
</span></span><span style="display:flex;"><span>mysql -uroot -p&lt;all.sql
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#################################xtrabackupÂ§á‰ªΩ#######################################</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂèÇËßÅPXCÈõÜÁæ§ÈÉ®ÂàÜ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ÂêØÂä®Â§çÂà∂ÈìæË∑Ø</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰øÆÊîπmaster‰ø°ÊÅØ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âú®Â§á‰ªΩÊñá‰ª∂‰∏≠Êúâ[mysql-bin-file]Âíå[log_offset]
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">change</span><span style="color:#bbb"> </span>master<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">to</span><span style="color:#bbb"> </span>master_host<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[ip]&#39;</span>,<span style="color:#bbb"> </span>master_user<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[user]&#39;</span>,<span style="color:#bbb"> </span>master_password<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[password]&#39;</span>,<span style="color:#bbb"> </span>master_log_file<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[mysql-bin-file]&#39;</span>,<span style="color:#bbb"> </span>master_log_pos<span style="color:#000;font-weight:bold">=</span>[log_offset];<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># Êü•Áúã‰ªéÊú∫slaveÁä∂ÊÄÅÊòØÂê¶ÊúâËØØ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span>slave<span style="color:#bbb"> </span>status<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># ÂêØÂä®‰ªéÊú∫Â§çÂà∂
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>start<span style="color:#bbb"> </span>slave<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Âü∫‰∫éÊó•ÂøóÁÇπÂ§çÂà∂ÁöÑ‰ºòÁÇπ</strong></p>
<ul>
<li>MySQLÊúÄÊó©ÊîØÊåÅÁöÑÂ§çÂà∂ÊäÄÊúØÔºåBUGËæÉÂ∞ë</li>
<li>ÂØπSQLÊü•ËØ¢Ê≤°Êúâ‰ªª‰ΩïÈôêÂà∂„ÄêrowÊ†ºÂºè‰∏ãÊâÄÊúâSQLÊó†ÈôêÂà∂„Äë</li>
<li>ÊïÖÈöúÂ§ÑÁêÜÂÆπÊòì</li>
</ul>
<p><strong>Âü∫‰∫éÊó•ÂøóÁÇπÂ§çÂà∂ÁöÑÁº∫ÁÇπ</strong></p>
<ul>
<li>ÊïÖÈöúËΩ¨ÁßªÊó∂ÈáçÊñ∞Ëé∑ÂèñÊñ∞‰∏ªÁöÑÊó•ÂøóÁÇπ‰ø°ÊÅØÊØîËæÉÈöæ</li>
</ul>
<h4 id="Âü∫‰∫égtidÁöÑÂ§çÂà∂">Âü∫‰∫éGTIDÁöÑÂ§çÂà∂</h4>
<p>‚Äã	GTIDÊòØ‰ªéMySQL5.6ÁâàÊú¨ÊâçÂºïÂÖ•Ôºå‰ΩøÁî®Âü∫‰∫éÊó•ÂøóÁÇπÁöÑÂ§çÂà∂Ë¶ÅÊåáÂÆö‰ªé‰∫åËøõÂà∂Êó•ÂøóÂì™‰∏™‰ΩçÁΩÆËøõË°åÂ¢ûÈáèÂêåÊ≠•ÔºåÂ¶ÇÊûúÊåáÂÆöÈîôËØØÂ∞Ü‰ºöÈÄ†ÊàêÊï∞ÊçÆÈÅóÊºèÊàñËÄÖÊï∞ÊçÆÈáçÂ§ç„ÄÇÂü∫‰∫éGTIDÁöÑÂ§çÂà∂‰ºöËÆ∞ÂΩï‰ªéÂ∫ìÊâßË°åÁöÑ‰∫ãÂä°GTIDÂÄºÔºåËá™Âä®ÊâßË°å‰ªéÂ∫ìÊú™ÊâßË°åÁöÑGTIDÂÄºÁöÑ‰∫ãÂä°Ôºå‰øùËØÅ‰∫ÜÂêå‰∏Ä‰∏™‰∫ãÂä°Âè™‰ºöÂú®‰ªéÂ∫ì‰∏≠ÊâßË°å‰∏ÄÊ¨°„ÄÇ„ÄêGTIDÔºöÂÖ®Â±Ä‰∫ãÂä°IDÔºå‰øùËØÅÊØè‰∏Ä‰∏™Êèê‰∫§ÁöÑ‰∫ãÂä°Âú®Â§çÂà∂ÈõÜÁæ§‰∏≠ÂèØ‰ª•‰∫ßÁîü‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑID„Äë</p>
<p>‚Äã	GTID=source_id:transaction_id„Äêsource_idÔºöauto.cnf‰∏≠Ôºåtransaction_id‰ªé‰∏ÄËá™Â¢û„Äë</p>
<ul>
<li>‰∏ªÊú∫ÂàõÂª∫ÊéàÊùÉË¥¶Âè∑</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âú®‰∏ªÊúçÂä°Âô®‰∏äÊâßË°åÔºåÂàõÂª∫Â§çÂà∂Ë¥¶Âè∑ÔºåÂπ∂Êéà‰∫àÊùÉÈôê
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">CREATE</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">USER</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[username]&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;[ip]&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">identified</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[password]&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">GRANT</span><span style="color:#bbb"> </span>REPLICATION<span style="color:#bbb"> </span>SLAVE<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ON</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span>.<span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">TO</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[username]&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;[ip]&#39;</span><span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>‰∏ªÊú∫ÊúçÂä°Âô®ÈÖçÁΩÆ</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊØèÂè∞MySQLË¶ÅÊ±Ç‰∏çÂêå</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">server-id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">1</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∫åËøõÂà∂Êó•ÂøóÂºÄÂêØÔºåÂ¶ÇÊûúÊúâÊù°‰ª∂ÁöÑËØùÂª∫ËÆÆÂçïÁã¨ÊåáÂÆöÂ≠òÊîæÂú®Âè¶‰∏Ä‰∏™Á£ÅÁõò‰∏ãÔºå‰∏çÂíåÊï∞ÊçÆÊñá‰ª∂Â≠òÊîæ‰∏ÄËµ∑</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-bin</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂºÄÂêØgtidÊ®°ÂºèÔºå‰ºöËÆ∞ÂΩïgtidÁöÑÊ†áËØÜÁ¨¶</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">gtid-mode</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âº∫Âà∂GTID‰∏ÄËá¥ÊÄßÔºå‰øùËØÅ‰∫ãÂä°ÁöÑÂÆâÂÖ®</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏çËÉΩ‰ΩøÁî®Ôºö</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 1.create table „ÄÇ„ÄÇselect</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 2.Âú®‰∫ãÂä°‰∏≠‰ΩøÁî®create temporary table Âª∫Á´ã‰∏¥Êó∂Ë°®Ôºå‰ΩøÁî®ÂÖ≥ËÅîÊõ¥Êñ∞‰∫ãÂä°Ë°®ÂíåÈùû‰∫ãÂä°Ë°®„ÄÇ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">enforce-gtid-consistency</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># MySQL5.7‰πãÂâçÂøÖÈ°ªÈÖçÁΩÆ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-slave-updates</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>‰ªéÊú∫ÈÖçÁΩÆ</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊØèÂè∞MySQLË¶ÅÊ±Ç‰∏çÂêå</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">server-id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">101</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∫åËøõÂà∂Êó•ÂøóÂºÄÂêØÔºåÂ¶ÇÊûúÊúâÊù°‰ª∂ÁöÑËØùÂª∫ËÆÆÂçïÁã¨ÊåáÂÆöÂ≠òÊîæÂú®Âè¶‰∏Ä‰∏™Á£ÅÁõò‰∏ãÔºå‰∏çÂíåÊï∞ÊçÆÊñá‰ª∂Â≠òÊîæ‰∏ÄËµ∑</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-bin</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏≠ÁªßÊó•ÂøóÂºÄÂêØÔºåÈÅøÂÖçÈªòËÆ§Êù°‰ª∂‰∏ã‰ΩøÁî®‰∏ªÊú∫ÂêçÂëΩÂêçÔºåÂ¶ÇÊûú‰øÆÊîπ‰∏ªÊú∫ÂêçÂèØËÉΩ‰ºö‰∫ßÁîüÈîôËØØ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">relay-log</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-relay-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂºÄÂêØgtidÊ®°ÂºèÔºå‰ºöËÆ∞ÂΩïgtidÁöÑÊ†áËØÜÁ¨¶</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">gtid-mode</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âº∫Âà∂GTID‰∏ÄËá¥ÊÄßÔºå‰øùËØÅ‰∫ãÂä°ÁöÑÂÆâÂÖ®</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏çËÉΩ‰ΩøÁî®Ôºö</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 1.create table „ÄÇ„ÄÇselect</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 2.Âú®‰∫ãÂä°‰∏≠‰ΩøÁî®create temporary table Âª∫Á´ã‰∏¥Êó∂Ë°®Ôºå‰ΩøÁî®ÂÖ≥ËÅîÊõ¥Êñ∞‰∫ãÂä°Ë°®ÂíåÈùû‰∫ãÂä°Ë°®„ÄÇ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">enforce-gtid-consistency</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂèØÈÄâÈÖçÁΩÆÔºåÊòØÂê¶Â∞Ü‰∏≠ÁªßÊó•ÂøóÁöÑÂÜÖÂÆπÈáçÊñ∞ËÆ∞ÂΩïÂà∞‰ªéÊú∫‰∫åËøõÂà∂Êó•Âøó‰∏≠</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂΩìËøôÂè∞‰ªéÊú∫ÂÅöÂè¶‰∏Ä‰∏™‰ªéÊú∫ÁöÑ‰∏ªÊú∫ÂΩ¢ÊàêÈìæË∑ØÂ§çÂà∂Êó∂ÔºåÊ≠§ÈÄâÈ°πÂøÖÈ°ªÊâìÂºÄ</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># MySQL5.7‰πãÂâçÂøÖÈ°ªÈÖçÁΩÆ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-slave-updates</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂèØÈÄâÈÖçÁΩÆÔºåÈô§‰∫ÜsupperÁî®Êà∑‰ª•Â§ñÊ≤°ÊúâÁî®Êà∑ÊúâÂÜôÊùÉÈôêÔºåÂª∫ËÆÆ‰ªéÊúçÂä°ÂêØÁî®</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">read-only</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏ªÊúçÂä°ÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØÔºåÈªòËÆ§Â≠òÂÇ®Âú®Êñá‰ª∂‰∏≠ÔºåÂª∫ËÆÆÂºÄÂêØÔºåÂºÄÂêØÂ≠òÂÇ®Âú®salve_master_infoË°®[innodb]‰∏≠</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">master-info-repository</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">TABLE</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏≠ÁªßÊó•ÂøóÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØÔºåÈªòËÆ§Â≠òÂÇ®Âú®Êñá‰ª∂‰∏≠ÔºåÂª∫ËÆÆÂºÄÂêØÔºåÂºÄÂêØÂ≠òÂÇ®Âú®salve_relay_infoË°®[innodb]‰∏≠</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">relay-log-info-repository</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">TABLE</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ÂàùÂßãÂåñ‰ªéÊï∞ÊçÆÂ∫ìÊï∞ÊçÆ</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#################################mysqldumpÂ§á‰ªΩ########################################</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Â§á‰ªΩMyISAMÁöÑÂ≠òÂÇ®ÂºïÊìéÈúÄË¶ÅÂä†ÂÖ•„Äê--lock-all-tables„Äë</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># mysqldumpÂ§á‰ªΩ‰ºöËøõË°åÈîÅË°®Êìç‰Ωú</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># --triggersÂ§á‰ªΩËß¶ÂèëÂô®„ÄÅ--routinesÂ§á‰ªΩÂ≠òÂÇ®ËøáÁ®ã</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># --master-dataÔºö</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#       1[ÈªòËÆ§]:Â∞ÜdumpËµ∑Âßã(change master to)binlogÁÇπÂíåposÂÄºÂÜôÂà∞ÁªìÊûú‰∏≠</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#       2:ÊòØÂ∞Üchange master toÂÜôÂà∞ÁªìÊûú‰∏≠Âπ∂Ê≥®Èáä</span>
</span></span><span style="display:flex;"><span>mysqldump --single-transaction --master-data<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2</span> --triggers --routines --all-databases -u<span style="color:#000;font-weight:bold">[</span>user<span style="color:#000;font-weight:bold">]</span> -p &gt;all.sql;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Â∞ÜÂ§á‰ªΩSQLÂØºÂÖ•Êú™ÂàùÂßãÂåñÁöÑ‰ªéÊúçÂä°Âô®</span>
</span></span><span style="display:flex;"><span>mysql -uroot -p&lt;all.sql
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#################################xtrabackupÂ§á‰ªΩ#######################################</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂèÇËßÅPXCÈõÜÁæ§ÈÉ®ÂàÜ</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ÂêØÂä®Â§çÂà∂ÈìæË∑Ø</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰øÆÊîπmaster‰ø°ÊÅØ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># master_auto_position=1Ë°®Á§∫ÂºÄÂêØÂü∫‰∫éGTIDÁöÑÂ§çÂà∂ÂçèËÆÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">change</span><span style="color:#bbb"> </span>master<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">to</span><span style="color:#bbb"> </span>master_host<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[ip]&#39;</span>,<span style="color:#bbb"> </span>master_user<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[user]&#39;</span>,<span style="color:#bbb"> </span>master_password<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[password]&#39;</span>,<span style="color:#bbb"> </span>master_auto_position<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># Êü•Áúã‰ªéÊú∫slaveÁä∂ÊÄÅÊòØÂê¶ÊúâËØØ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span>slave<span style="color:#bbb"> </span>status<span style="color:#a61717;background-color:#e3d2d2">\</span>G;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># ÂêØÂä®‰ªéÊú∫Â§çÂà∂
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>start<span style="color:#bbb"> </span>slave;<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Âü∫‰∫éGTIDÂ§çÂà∂ÁöÑ‰ºòÁÇπ</strong></p>
<ul>
<li>ÊïÖÈöúËΩ¨ÁßªÊñπ‰æøÔºåÊ†πÊçÆGTIDÂÄºÂç≥ÂèØÂà§Êñ≠</li>
<li>‰ªéÂ∫ì‰∏ç‰ºö‰∏¢Â§±‰∏ªÂ∫ì‰∏äÁöÑ‰ªª‰ΩïÊõ¥Êîπ</li>
</ul>
<p><strong>Âü∫‰∫éÊó•ÂøóÁÇπÂ§çÂà∂ÁöÑÁº∫ÁÇπ</strong></p>
<ul>
<li>
<p>ÊïÖÈöúÂ§ÑÁêÜÂ§çÊùÇ</p>
</li>
<li>
<p>ÂØπSQLÊü•ËØ¢ÊúâÈôêÂà∂</p>
</li>
</ul>
<blockquote>
<p>ÈÄâÊã©Â§çÂà∂Ê®°ÂºèÊòØÈúÄË¶ÅËÄÉËôëÊâÄ‰ΩøÁî®ÁöÑMySQLÁöÑÁâàÊú¨‰ª•ÂèäÂ§çÂà∂Êû∂ÊûÑÂèä‰∏ª‰ªéÂàáÊç¢ÊñπÂºèÂíåÈ´òÂèØÁî®ÁÆ°ÁêÜÁªÑ‰ª∂ÊòØÂê¶ÊîØÊåÅ</p>
</blockquote>
<h3 id="mysqlÁöÑÂ§çÂà∂ÊãìÊâë">MySQLÁöÑÂ§çÂà∂ÊãìÊâë</h3>
<p>MySQL5.7‰πãÂâç‰∏Ä‰∏™‰ªéÂ∫ìÂè™ËÉΩÊúâ‰∏Ä‰∏™‰∏ªÂ∫ì</p>
<p><strong>‰∏Ä‰∏ªÂ§ö‰ªé&amp;‰∏Ä‰∏ª‰∏Ä‰ªé</strong></p>
<p>ËøôÁßçÊû∂ÊûÑ‰∏ãÈÖçÁΩÆÁÆÄÂçïÔºåÂèØ‰ª•Áî®Â§ö‰∏™‰ªéÂ∫ìÂàÜÊãÖ‰∏ªÂ∫ìËØªË¥üËΩΩ</p>
<p><img src="/img/mysql/master-salve-struct.png" alt="master-salve-struct"></p>
<p><strong>Âèå‰∏ªÂ§çÂà∂</strong></p>
<p>Â¶ÇÊûúÂè™Êúâ‰∏Ä‰∏™‰∏ªÂØπÂ§ñÊèê‰æõÊúçÂä°Êàê‰∏∫‰∏ªÂ§áÂ§çÂà∂Ê®°ÂºèÔºöÂú®Âêå‰∏ÄÊó∂Èó¥Âè™Êúâ‰∏ÄÂè∞ÊúçÂä°Âô®Êèê‰æõÊúçÂä°ÔºåÂè¶‰∏ÄÂè∞‰∏∫read_only„ÄÇÂΩìÊèê‰æõÊúçÂä°ÁöÑMySQLÈúÄË¶Å‰∏ãÁ∫øÔºåÂèØÂ∞Ü‰ªéÊú∫ÂàáÊç¢‰∏∫Êèê‰æõÊúçÂä°ÁöÑÊú∫Âô®„ÄÇ</p>
<p>Â¶ÇÊûú‰∏§‰∏™‰∏ªÈÉΩÂØπÂ§ñÊèê‰æõÊúçÂä°Êàê‰∏∫‰∏ª‰∏ªÂ§çÂà∂Ê®°ÂºèÔºö‰∏çÊòØÂæàÂ•ΩÁöÑÁªìÊûÑÔºåÂÆπÊòì‰∫ßÁîüÂÜ≤Á™Å„ÄÇÁî®‰∫é‰∏§‰∏™Âú∞Âå∫ÈúÄË¶Å‰øùÂ≠òÂêåÊ†∑Êï∞ÊçÆ„ÄÇÂª∫ËÆÆ‰∏§‰∏™‰∏ª‰∏çË¶ÅÊìç‰ΩúÁõ∏ÂêåÁöÑÊï∞ÊçÆÂ∫ìÔºåËÄå‰∏îÈúÄË¶ÅËÆæÁΩÆauto_increment = 2Âíåauto_increment_offset = 1 | 2</p>
<p><img src="/img/mysql/mataer-master-sturct.png" alt="mataer-master-sturct"></p>
<p><strong>Êã•ÊúâÂ§áÂ∫ìÁöÑ‰∏ª‰∏ªÂ§çÂà∂</strong></p>
<p>Â¢ûÂä†‰ªéÂ∫ìÂàÜÊãÖ‰∏ªÂ∫ìÁöÑËØªË¥üËΩΩÔºåÂΩì‰∏ÄÂè∞‰∏ªÂ∫ì‰∏ãÁ∫øÊó∂ÈúÄË¶ÅÂ∞ÜÂÖ∂‰ª•ÂÆÉ‰∏∫masterÁöÑ‰ªéÂ∫ì‰∏ãÁ∫ø</p>
<p><img src="/img/mysql/master-master-salve.png" alt="master-master-salve"></p>
<p><strong>Á∫ßËÅîÂ§çÂà∂</strong></p>
<p><img src="/img/mysql/cascade-struct.png" alt="cascade-struct"></p>
<h3 id="Â§çÂà∂ÊÄßËÉΩ‰ºòÂåñ">Â§çÂà∂ÊÄßËÉΩ‰ºòÂåñ</h3>
<ul>
<li>
<p>‰∏ªÂ∫ìÊâßË°å‰∫ãÂä°ÁöÑÊó∂Èó¥„Äê‰ªéÂ∫ì‰πüÈúÄË¶ÅËæÉÈïøÊó∂Èó¥ÊâßË°åÔºåÂØºËá¥Âª∂Ëøü„Äë</p>
<p>Âª∫ËÆÆÊãÜÂàÜÂ§ß‰∫ãÂä°</p>
</li>
<li>
<p>‰∫åËøõÂà∂Êó•Âøó‰º†ËæìÊó∂Èó¥„ÄêÂºÇÂú∞Êú∫ÊàøÁΩëÁªúÂª∂Ëøü„Äë</p>
<p>Âª∫ËÆÆ‰ΩøÁî®Ê∑∑ÂêàÊó•ÂøóÊ†ºÂºèÔºàMIXEDÔºâÊàñËÆæÁΩÆbinlog_row_image=minimal</p>
</li>
<li>
<p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ã‰ªéÂ∫ìÂè™Êúâ‰∏Ä‰∏™SQLÁ∫øÁ®ãÔºåÂèòÊàê‰∫Ü‰∏≤Ë°åÊâßË°å</p>
<p>Âª∫ËÆÆÂºÄÂêØÂ§öÁ∫øÁ®ãÂ§çÂà∂ÔºàMySQL5.6‰∏≠ÊÄßËÉΩÂπ∂‰∏ç‰ºöÔºå5.7‰∏≠ÂºïÂÖ•‰∫ÜÈÄªËæëÊó∂ÈíüÊù•ÊéßÂà∂Á∫øÁ®ãÊïàÊûúËæÉÂ•ΩÔºâ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰ª•‰∏ãÈÖçÁΩÆÊúÄÂ•ΩÂÜôÂÖ•my.conf
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>stop<span style="color:#bbb"> </span>slave;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#458;font-weight:bold">set</span><span style="color:#bbb"> </span>global<span style="color:#bbb"> </span>slave_parallel_type<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;logical_clock&#39;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#458;font-weight:bold">set</span><span style="color:#bbb"> </span>global<span style="color:#bbb"> </span>slave_parallel_workers<span style="color:#000;font-weight:bold">=</span><span style="color:#099">4</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>start<span style="color:#bbb"> </span>slave;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">####################################ÂÜôÂÖ•ÈÖçÁΩÆÊñá‰ª∂#####################################
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>slave<span style="color:#000;font-weight:bold">-</span>parallel<span style="color:#000;font-weight:bold">-</span>type<span style="color:#000;font-weight:bold">=</span>LOGICAL_CLOCK<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>slave<span style="color:#000;font-weight:bold">-</span>parallel<span style="color:#000;font-weight:bold">-</span>workers<span style="color:#000;font-weight:bold">=</span><span style="color:#099">4</span><span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="ÂçäÂêåÊ≠•Â§çÂà∂">ÂçäÂêåÊ≠•Â§çÂà∂</h3>
<p>‚Äã	MySQL 5.5ÁâàÊú¨‰πãÂâçÔºå‰∏ÄÁõ¥ÈááÁî®ÁöÑÊòØËøôÁßçÂºÇÊ≠•Â§çÂà∂ÁöÑÊñπÂºè„ÄÇ‰∏ªÂ∫ìÁöÑ‰∫ãÂä°ÊâßË°å‰∏ç‰ºöÁÆ°Â§áÂ∫ìÁöÑÂêåÊ≠•ËøõÂ∫¶ÔºåÂ¶ÇÊûúÂ§áÂ∫ìËêΩÂêéÔºå‰∏ªÂ∫ì‰∏çÂπ∏ÂÆïÊú∫ÔºåÈÇ£‰πàÂ∞±‰ºöÂØºËá¥Êï∞ÊçÆ‰∏¢Â§±„ÄÇ‰∫éÊòØÂú®MySQLÂú®5.5‰∏≠Â∞±ÂºïÂÖ•‰∫ÜÂçäÂêåÊ≠•Â§çÂà∂( AFTER_COMMIT )Ôºå‰∏ªÂ∫ìÂú®Â∫îÁ≠îÂÆ¢Êà∑Á´ØÊèê‰∫§ÁöÑ‰∫ãÂä°ÂâçÈúÄË¶Å‰øùËØÅËá≥Â∞ë‰∏Ä‰∏™‰ªéÂ∫ìÊé•Êî∂Âπ∂ÂÜôÂà∞relay log‰∏≠„ÄÇ MySQL5.7ÂØπÂçäÂêåÊ≠•Â§çÂà∂ËøõË°åÊîπËøõÊîØÊåÅÊó†ÊçüÂ§çÂà∂( AFTER_SYNC )„ÄÇ</p>
<p><strong>ÂçäÂêåÊ≠•Â§çÂà∂</strong></p>
<p>‚Äã	ÂçäÂêåÊ≠•Â§çÂà∂‰ªã‰∫éÂºÇÊ≠•Â§çÂà∂ÂíåÂÖ®ÂêåÊ≠•Â§çÂà∂‰πãÈó¥Ôºå‰∏ªÂ∫ìÂú®ÊâßË°åÂÆåÂÆ¢Êà∑Á´ØÊèê‰∫§ÁöÑ‰∫ãÂä°Âêé‰∏çÊòØÁ´ãÂàªËøîÂõûÁªôÂÆ¢Êà∑Á´ØÔºåËÄåÊòØÁ≠âÂæÖËá≥Â∞ë‰∏Ä‰∏™‰ªéÂ∫ìÊé•Êî∂Âà∞Âπ∂ÂÜôÂà∞relay log‰∏≠ÊâçËøîÂõûÁªôÂÆ¢Êà∑Á´Ø„ÄÇ Áî±‰∫émasterÊòØÂú®‰∏âÊÆµÊèê‰∫§ÁöÑÊúÄÂêécommitÈò∂ÊÆµÂÆåÊàêÂêéÊâçÁ≠âÂæÖÔºåÊâÄ‰ª•masterÁöÑÂÖ∂‰ªñsessionÊòØÂèØ‰ª•ÁúãÂà∞Ëøô‰∏™Êèê‰∫§‰∫ãÂä°ÁöÑÔºåÊâÄ‰ª•ËøôÊó∂ÂÄômaster‰∏äÁöÑÊï∞ÊçÆÂíåslave‰∏ç‰∏ÄËá¥ÔºåmasterÂÆïÊú∫ÂêéÔºåslaveÊï∞ÊçÆ‰∏¢Â§±„ÄÇ</p>
<p><img src="/img/mysql/Semisynchronous-replication.png" alt="Semisynchronous-replication"></p>
<p><strong>Êó†ÊçüÂ§çÂà∂ÔºàÂ¢ûÂº∫ÁâàÁöÑÂçäÂêåÊ≠•Â§çÂà∂Ôºâ</strong></p>
<p>‚Äã	Âú®ÂçäÂêåÊ≠•Â§çÂà∂‰∏≠ÔºåmasterÂÜôÊï∞ÊçÆÂà∞binlog‰∏îsyncÔºåÁÑ∂Âêé‰∏ÄÁõ¥Á≠âÂæÖACK„ÄÇÂΩìËá≥Â∞ë‰∏Ä‰∏™slave request bilogÂêéÂÜôÂÖ•Âà∞relay‚ÄêlogÂπ∂flush diskÔºå‰ªéÊú∫ËøîÂõûackÔºå‰∏ªÂ∫ìÊèê‰∫§‰∫ãÂä°„ÄÇ‰ºöÈòªÂ°ûmaster sessionÔºå Áî±‰∫éÊòØÂú®‰∏âÊÆµÊèê‰∫§ÁöÑÁ¨¨‰∫åÈò∂ÊÆµsync binlog ÂÆåÊàêÂêéÊâçÁ≠âÂæÖ, ÊâÄ‰ª•masterÁöÑÂÖ∂‰ªñsessionÊòØÁúã‰∏çËßÅËøô‰∏™Êèê‰∫§‰∫ãÂä°ÁöÑÔºåÊâÄ‰ª•ËøôÊó∂ÂÄômaster‰∏äÁöÑÊï∞ÊçÆÂíåslave ‰∏ÄËá¥ÔºåmasterÂÆïÊú∫ÂêéÔºåslaveÊ≤°Êúâ‰∏¢Â§±Êï∞ÊçÆ„ÄÇ</p>
<p><img src="/img/mysql/lossless-replication.png" alt="lossless-replication"></p>
<p><strong>ÂºÄÂêØÂçäÂêåÊ≠•Â§çÂà∂</strong></p>
<p>‰∏ªÂ∫ì‰ªéÂ∫ìÈÉΩÈúÄË¶ÅËøõË°å‰∏Ä‰∏ãÈÖçÁΩÆ</p>
<p>‚ë†MySQL‰ºöËØù‰∏≠ÊâßË°å<code>install plugin rpl_semi_sync_master soname 'semisync_master.so';</code> ÂÆâË£ÖÂçäÂêåÊ≠•Â§çÂà∂ÁªÑ‰ª∂</p>
<p>‚ë° Áúã‰∏Ä‰∏ãÂçäÂêåÊ≠•Áõ∏ÂÖ≥Áä∂ÊÄÅ‰ø°ÊÅØ<code>show global variables like '%semi%'</code></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂºÄÂêØÂçäÂêåÊ≠•</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">rpl_semi_sync_master_enabled</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">1</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊéßÂà∂Á≠âÂæÖÊù•Ëá™‰ªéÊúçÂä°Âô®ÁöÑÁ°ÆËÆ§Êèê‰∫§Âπ∂ÊÅ¢Â§çÂà∞ÂºÇÊ≠•Â§çÂà∂ÁöÑÊó∂Èó¥ÔºàÊØ´ÁßíÔºâÔºåË∂ÖÊó∂‰πãÂêéÔºåÂ∞±‰ªéÂçäÂêåÊ≠•Â§çÂà∂ÔºåËøîÂõûÂà∞ÂºÇÊ≠•Â§çÂà∂</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">rpl_semi_sync_master_timeout</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">1000</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>‚ë¢ MySQL5.5~5.6Âè™ÊîØÊåÅAFTER_COMMITÔºåMySQL5.7ÈªòËÆ§ÂºÄÂêØÁöÑÂçäÂêåÊ≠•Á≠ñÁï•ÊòØAFTER_SYNC</p>
<h3 id="span-iddelay-repÂª∂ËøüÂ§çÂà∂span"><span id="delay-rep">Âª∂ËøüÂ§çÂà∂</span></h3>
<p>‚Äã	Âª∫Á´ã‰∏ª‰ªé‰πãÂêéÊàñËÄÖÂÖ≥Èó≠salve‰πãÂêéÔºåÂÜçËÆæÁΩÆ<code>chang master to master_delay = [Áßí]</code>ËØ≠Âè•Ôºå‰πãÂêéÂêØÂä®slaveËäÇÁÇπÂç≥ÂèØÔºåÂª∂ËøüÂêåÊ≠•‰∏ªË¶ÅÁî®‰∫éÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÊÅ¢Â§ç„ÄÇ</p>
<p><strong>ÊÅ¢Â§çÊ≠•È™§</strong></p>
<p>Á¨¨‰∏ÄÊ≠•Ôºö‰ªéËäÇÁÇπÊï∞ÊçÆÂáÜÂ§á</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏ªËäÇÁÇπÊâßË°å
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span>master<span style="color:#bbb"> </span>logs;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># Êü•ÊâæÊâßË°åËØØÂà†Èô§ÁöÑSQLÔºålogFileName‰∏∫‰∏äÊù°SQLÊü•ËØ¢Âà∞ÁöÑÊó•ÂøóÔºåÂú®ÁªìÊûú‰∏≠Êü•Êâæ‰∫ãÂä°GTID
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span>binlog<span style="color:#bbb"> </span>events<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">in</span><span style="color:#bbb"> </span><span style="color:#d14">&#34;logFileName&#34;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># ‰ªéËäÇÁÇπÊâßË°å
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>stop<span style="color:#bbb"> </span>slave;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#458;font-weight:bold">set</span><span style="color:#bbb"> </span>gtid_next<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;Êü•ÊâæÂà∞ÁöÑ‰∫ãÂä°GTID&#39;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># Ëøô‰∏™GTID‰∫ãÂä°‰ªÄ‰πàÈÉΩ‰∏çÊâßË°å
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>begin;commit;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># ÂÖ∂‰ΩôËá™Âä®ÊâßË°å
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#458;font-weight:bold">set</span><span style="color:#bbb"> </span>gtid_next<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;automatic&#39;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># ‰∏çÂú®Âª∂Ëøü„ÄÇÁ´ãÂç≥ÂêåÊ≠•‰∏ªËäÇÁÇπÊâÄÊúâÊï∞ÊçÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">change</span><span style="color:#bbb"> </span>master<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">to</span><span style="color:#bbb"> </span>master_delay<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># ÂêØÂä®slave
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>start<span style="color:#bbb"> </span>slave;<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∫åÊ≠•ÔºöÂÅúÊéâÊï∞ÊçÆÂ∫ì‰∏öÂä°Êìç‰ΩúÔºå‰∏çÂÖÅËÆ∏ÂÜçËØªÂÜôÊï∞ÊçÆ</p>
<p>Á¨¨‰∏âÊ≠•ÔºöÂØºÂá∫‰ªéÊï∞ÊçÆÂ∫ìËäÇÁÇπÊï∞ÊçÆÔºåÂú®‰∏ªËäÇÁÇπ‰∏äÂàõÂª∫‰∏¥Êó∂Êï∞ÊçÆÂ∫ìÔºåÂØºÂÖ•Êï∞ÊçÆÂà∞‰∏¥Êó∂Â∫ì</p>
<p>Á¨¨ÂõõÊ≠•ÔºöÂ∞Ü‰∏ªËäÇÁÇπ‰∏äÁöÑ‰∏öÂä°Êï∞ÊçÆË°®ÈáçÂëΩÂêçÔºåÁÑ∂ÂêéÊää‰∏¥Êó∂‰∏öÂä°Â∫ìÁöÑÊï∞ÊçÆË°®ËøÅÁßªÂà∞‰∏öÂä°Â∫ì</p>
<h2 id="‰πùÈ´òÂèØÁî®Êû∂ÊûÑ">‰πù„ÄÅÈ´òÂèØÁî®Êû∂ÊûÑ</h2>
<h3 id="mmmmulti-master-replication-manager">MMM(Multi-Master Replication Manager)</h3>
<p>‚Äã	ÁõëÊéßÂíåÁÆ°ÁêÜMySQLÁöÑ<strong>Âü∫‰∫éÊó•ÂøóÁÇπÁöÑ‰∏ª‰∏ªÂ§çÂà∂ÊãìÊâë</strong>ÔºåÂπ∂Âú®ÂΩìÂâçÁöÑ‰∏ªÊúçÂä°Âô®Â§±ÊïàÊó∂ÔºåËøõË°å‰∏ªÂ§áÊúçÂä°Âô®‰πãÈó¥ÁöÑ‰∏ª‰ªéÂàáÊç¢ÂíåÊïÖÈöúËΩ¨ÁßªÔºåÂΩì‰∏ªÂ∫ìÂá∫Áé∞ÂÆïÊú∫Êó∂ËøõË°åÊïÖÈöúËΩ¨‰πâÂπ∂Ëá™Âä®ÈÖçÁΩÆÂÖ∂ÂÆÉ‰ªéÂ∫ìÂØπÊñ∞‰∏ªÁöÑÂ§çÂà∂„ÄÇÂèØÂèÇËÄÉ<a href="%5Bhttps://mysql-mmm.org%5D(https://mysql-mmm.org/)">ÂÆòÁΩë</a></p>
<p><img src="/img/mysql/MMM.png" alt="MMM"></p>
<p>ÈÉ®ÁΩ≤MMMÊâÄÈúÄËµÑÊ∫ê</p>
<table>
<thead>
<tr>
<th>ËµÑÊ∫êÂêçÁß∞</th>
<th>Êï∞Èáè</th>
<th>ËØ¥Êòé</th>
</tr>
</thead>
<tbody>
<tr>
<td>‰∏ªDBÊúçÂä°Âô®</td>
<td>2</td>
<td>Áî®‰∫é‰∏ª‰∏ªÂ§çÂà∂ÈÖçÁΩÆ</td>
</tr>
<tr>
<td>‰ªéDBÊúçÂä°Âô®</td>
<td>0-n</td>
<td>ÈÖçÁΩÆ‰ªéÊúçÂä°Âô®Áî®‰∫éÂàÜÊãÖËØªÊìç‰Ωú</td>
</tr>
<tr>
<td>ÁõëÊéßÊúçÂä°Âô®</td>
<td>1</td>
<td>Áî®‰∫éÁõëÊéßMySQLÁöÑÂ§çÂà∂</td>
</tr>
<tr>
<td>ÁõëÊéßÁî®Êà∑</td>
<td>1</td>
<td>Áî®‰∫éÁõëÊéßMySQLÁöÑÁä∂ÊÄÅÁöÑMySQLÁî®Êà∑Ôºàreplication clientÔºâ</td>
</tr>
<tr>
<td>‰ª£ÁêÜÁî®Êà∑</td>
<td>1</td>
<td>Áî®‰∫éMMM‰ª£ÁêÜÁöÑMySQLÁî®Êà∑ÔºàsuperÔºåreplication clientÔºåprocessÔºâ</td>
</tr>
<tr>
<td>Â§çÂà∂Áî®Êà∑</td>
<td>1</td>
<td>Áî®‰∫éÈÖçÁΩÆMySQLÂ§çÂà∂ÁöÑMySQLÁî®Êà∑Ôºàreplication slaveÔºâ</td>
</tr>
</tbody>
</table>
<p><strong>Á¨¨‰∏ÄÊ≠•ÔºöMMMÂ∑•ÂÖ∑ÂÆâË£Ö</strong></p>
<ul>
<li>ÂÆâË£Öepel</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># centos 7 ÂÆâË£Öperl</span>
</span></span><span style="display:flex;"><span>yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ÁõëÊéßËäÇÁÇπÂÆâË£ÖÁõëÊéß</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>yum install -y mysql-mmm-monitor.noarch
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>‰∏ªÊúçÂä°Âô®Âíå‰ªéÊúçÂä°Âô®ÂùáÂÆâË£Ö‰ª£ÁêÜ</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> yum install -y mysql-mmm-agent.noarch
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∫åÊ≠•ÔºöMySQL‰∏ª‰∏ªÊê≠Âª∫</strong></p>
<ul>
<li>ÈÖçÁΩÆ</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#998;font-style:italic">###############################‰∏§Âè∞‰∏ªÊúçÂä°Âô®ÈÖçÁΩÆ###############################</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊØèÂè∞MySQLË¶ÅÊ±Ç‰∏çÂêå</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">server-id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">1</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∫åËøõÂà∂Êó•ÂøóÂºÄÂêØÔºåÂ¶ÇÊûúÊúâÊù°‰ª∂ÁöÑËØùÂª∫ËÆÆÂçïÁã¨ÊåáÂÆöÂ≠òÊîæÂú®Âè¶‰∏Ä‰∏™Á£ÅÁõò‰∏ãÔºå‰∏çÂíåÊï∞ÊçÆÊñá‰ª∂Â≠òÊîæ‰∏ÄËµ∑</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-bin</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏≠ÁªßÊó•ÂøóÂºÄÂêØÔºåÈÅøÂÖçÈªòËÆ§Êù°‰ª∂‰∏ã‰ΩøÁî®‰∏ªÊú∫ÂêçÂëΩÂêçÔºåÂ¶ÇÊûú‰øÆÊîπ‰∏ªÊú∫ÂêçÂèØËÉΩ‰ºö‰∫ßÁîüÈîôËØØ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">relay-log</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-relay-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂΩìËøôÂè∞‰ªéÊú∫ÂÅöÂè¶‰∏Ä‰∏™‰ªéÊú∫ÁöÑ‰∏ªÊú∫ÂΩ¢ÊàêÈìæË∑ØÂ§çÂà∂Êó∂ÔºåÊ≠§ÈÄâÈ°πÂøÖÈ°ªÊâìÂºÄ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-slave-updates</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">###############################‰ªéÊú∫ÊúçÂä°Âô®ÈÖçÁΩÆ###############################</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊØèÂè∞MySQLË¶ÅÊ±Ç‰∏çÂêå</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">server-id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">101</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∫åËøõÂà∂Êó•ÂøóÂºÄÂêØÔºåÂ¶ÇÊûúÊúâÊù°‰ª∂ÁöÑËØùÂª∫ËÆÆÂçïÁã¨ÊåáÂÆöÂ≠òÊîæÂú®Âè¶‰∏Ä‰∏™Á£ÅÁõò‰∏ãÔºå‰∏çÂíåÊï∞ÊçÆÊñá‰ª∂Â≠òÊîæ‰∏ÄËµ∑</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-bin</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏≠ÁªßÊó•ÂøóÂºÄÂêØÔºåÈÅøÂÖçÈªòËÆ§Êù°‰ª∂‰∏ã‰ΩøÁî®‰∏ªÊú∫ÂêçÂëΩÂêçÔºåÂ¶ÇÊûú‰øÆÊîπ‰∏ªÊú∫ÂêçÂèØËÉΩ‰ºö‰∫ßÁîüÈîôËØØ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">relay-log</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-relay-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂèØÈÄâÈÖçÁΩÆÔºåÊòØÂê¶Â∞Ü‰∏≠ÁªßÊó•ÂøóÁöÑÂÜÖÂÆπÈáçÊñ∞ËÆ∞ÂΩïÂà∞‰ªéÊú∫‰∫åËøõÂà∂Êó•Âøó‰∏≠</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂΩìËøôÂè∞‰ªéÊú∫ÂÅöÂè¶‰∏Ä‰∏™‰ªéÊú∫ÁöÑ‰∏ªÊú∫ÂΩ¢ÊàêÈìæË∑ØÂ§çÂà∂Êó∂ÔºåÊ≠§ÈÄâÈ°πÂøÖÈ°ªÊâìÂºÄ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-slave-updates</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂèØÈÄâÈÖçÁΩÆÔºåÈô§‰∫ÜsupperÁî®Êà∑‰ª•Â§ñÊ≤°ÊúâÁî®Êà∑ÊúâÂÜôÊùÉÈôêÔºåÂª∫ËÆÆ‰ªéÊúçÂä°ÂêØÁî®</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">read-only</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>Â§á‰ªΩÂÖ∑ÊúâÊï∞ÊçÆÁöÑ‰∏ªÊú∫ÊúçÂä°Âô®ÔºåÂπ∂ÂØºÂÖ•Âà∞ÂÖ∂ÂÆÉÊú∫Âô®</p>
</li>
<li>
<p>Âª∫Á´ã‰∏ª‰ªéÂÖ≥Á≥ª</p>
</li>
</ul>
<p><strong>Á¨¨‰∏âÊ≠•ÔºöÈÖçÁΩÆMMM</strong></p>
<ul>
<li>Âª∫Á´ãË¥¶Âè∑</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic">##########################Âè™ÈúÄÂú®‰∏Ä‰∏™‰∏ªËäÇÁÇπÊâßË°åÔºåÂõ†‰∏∫ÈõÜÁæ§Â∑≤ÁªèÊê≠Âª∫ÂÆåÊàê##########################
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÁõëÊéßÁî®Êà∑Áî®‰∫éÁî®‰∫éÁõëÊéßËäÇÁÇπ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">grant</span><span style="color:#bbb"> </span>replication<span style="color:#bbb"> </span>client<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">on</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span>.<span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">to</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;mmm_monitor&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;192.168.1.%&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">identified</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;123456&#39;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># ‰ª£ÁêÜÁî®Êà∑Áî®‰∫éÊïÖÈöúËΩ¨‰πâÂíå‰∏ª‰ªéÂàáÊç¢
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">grant</span><span style="color:#bbb"> </span>super,<span style="color:#bbb"> </span>replication<span style="color:#bbb"> </span>client,<span style="color:#bbb"> </span>process<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">on</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span>.<span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">to</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;mmm_agent&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;192.168.1.%&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">identified</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">by</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;123456&#39;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># Â§çÂà∂Áî®Êà∑ÔºåÂú®Êê≠Âª∫ÈõÜÁæ§Êó∂‰ª•ÂèäÂª∫Á´ã‰∏çÈúÄÂÜçÊâßË°å
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># CREATE USER &#39;[username]&#39;@&#39;[ip]&#39; identified by &#39;[password]&#39; GRANT REPLICATION SLAVE ON *.* TO &#39;[username]&#39;@&#39;[ip]&#39;
</span></span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ÈÖçÁΩÆmmm_common„ÄêÊØèÂè∞Êú∫Âô®ÈÉΩ‰∏ÄÊ†∑„Äë</li>
</ul>
<pre tabindex="0"><code class="language-conf" data-lang="conf">active_master_role      writer

&lt;host default&gt;
    cluster_interface       eth0        #‰ΩøÁî®ifconfigÊàñËÄÖip addrÊü•ÁúãÁΩëÂç°ÊõøÊç¢Êéâ
    pid_path                /run/mysql-mmm-agent.pid
    bin_path                /usr/libexec/mysql-mmm/
    replication_user        replicant   #Â§çÂà∂Áî®Êà∑ÁöÑË¥¶Âè∑	
    replication_password    slave       #Â§çÂà∂Áî®Êà∑ÁöÑÂØÜÁ†Å
    agent_user              mmm_agent   #‰ª£ÁêÜÁî®Êà∑ÁöÑË¥¶Âè∑
    agent_password          RepAgent    #‰ª£ÁêÜÁî®Êà∑ÁöÑÂØÜÁ†Å
&lt;/host&gt;

&lt;host db1&gt;                      #Á¨¨‰∏Ä‰∏™‰∏ªËäÇÁÇπÁöÑ‰ø°ÊÅØ
    ip      192.168.100.49
    mode    master
    peer    db2                 #Ê†áËØÜÂíåÂÆÉ‰∏∫‰∏ª‰∏ªÊû∂ÊûÑÁöÑÂè¶‰∏ÄÂè∞‰∏ªÊú∫
&lt;/host&gt;

&lt;host db2&gt;
    ip      192.168.100.50      #Á¨¨‰∫å‰∏™‰∏ªËäÇÁÇπÁöÑ‰ø°ÊÅØ
    mode    master
    peer    db1                 #Ê†áËØÜÂíåÂÆÉ‰∏∫‰∏ª‰∏ªÊû∂ÊûÑÁöÑÂè¶‰∏ÄÂè∞‰∏ªÊú∫
&lt;/host&gt;

#&lt;host db3&gt;                     #‰ªéËäÇÁÇπÁöÑ‰ø°ÊÅØÔºåÊúâ‰ªéËäÇÁÇπÈúÄË¶ÅÈÖçÁΩÆ
#    ip      192.168.100.51
#    mode    slave
#&lt;/host&gt;

&lt;role writer&gt;	               #ËÉΩËøõË°åÂÜôÊìç‰ΩúÁöÑËäÇÁÇπÔºà‰∏ªËäÇÁÇπÔºâÔºåËôöip‰∏Ä‰∏™Â∞±Â§ü
    hosts   db1, db2
    ips     192.168.100.250
    mode    exclusive
&lt;/role&gt;

&lt;role reader&gt;                  #ËÉΩËøõË°åËØªÊìç‰ΩúÁöÑËäÇÁÇπÔºåËôöipÁ≠â‰∫éÊàñËÄÖÂ∞ë‰∫éËØªËäÇÁÇπ‰∏™Êï∞
    hosts   db1, db2
    ips     192.168.100.251, 192.168.100.252
    mode    balanced
&lt;/role&gt;
</code></pre><ul>
<li>ÈÖçÁΩÆmmm_agent„ÄêÊØèÂè∞Êú∫Âô®‰∏ç‰∏ÄÊ†∑„Äë</li>
</ul>
<pre tabindex="0"><code class="language-conf" data-lang="conf">include mmm_common.conf

# The &#39;this&#39; variable refers to this server.  Proper operation requires
# that &#39;this&#39; server (db1 by default), as well as all other servers, have the
# proper IP addresses set in mmm_common.conf.
this db1			#ÊîπÊàêmmm_commonÊâÄÂØπÂ∫îÁöÑdb
</code></pre><ul>
<li>ÈÖçÁΩÆÁõëÊéßËäÇÁÇπÁöÑmmm_common.conf</li>
</ul>
<pre tabindex="0"><code class="language-conf" data-lang="conf">include mmm_common.conf

&lt;monitor&gt;
    ip                  127.0.0.1        #ÁõëÊéßÊúçÂä°Âô®ÁöÑipÂú∞ÂùÄ
    pid_path            /run/mysql-mmm-monitor.pid
    bin_path            /usr/libexec/mysql-mmm
    status_path         /var/lib/mysql-mmm/mmm_mond.status
    ping_ips            192.168.100.50   #ÊâÄÊúâÊúçÂä°Âô®ÁöÑipÈÉΩÈÖç‰∏äÔºåÊúÄÂ•ΩÁΩëÂÖ≥‰πüÈÖç‰∏äÔºåÈ¢ÑÈò≤ËÑëË£ÇÁöÑÂèëÁîü			
    auto_set_online     60

    # The kill_host_bin does not exist by default, though the monitor will
    # throw a warning about it missing.  See the section 5.10 &#34;Kill Host
    # Functionality&#34; in the PDF documentation.
    # Â¶ÇÊûúMySQLÊúçÂä°Âô®Âá∫Áé∞ÈóÆÈ¢òÈúÄË¶ÅÂÖ≥Êú∫ÂèØ‰ª•ÊâßË°åËÑöÊú¨
    # kill_host_bin     /usr/libexec/mysql-mmm/monitor/kill_host
    #
&lt;/monitor&gt;

&lt;host default&gt;          #ÁõëÊéßË¥¶Êà∑ÁöÑË¥¶Âè∑ÂØÜÁ†Å
    monitor_user        mmm_monitor
    monitor_password    RepMonitor
&lt;/host&gt;

debug 0
</code></pre><p><strong>Á¨¨ÂõõÊ≠•ÔºöÂêØÂä®MMM</strong></p>
<p>ÊØè‰∏™MySQLËäÇÁÇπÊâßË°å<code> mmm_agentd start</code></p>
<p>ÁõëÊéßËäÇÁÇπÊâßË°å<code>mmm_mond start</code></p>
<p><strong>Á¨¨‰∫îÊ≠•ÔºöÊü•ÁúãÁä∂ÊÄÅ</strong></p>
<p>ÁõëÊéßËäÇÁÇπÊâßË°å<code>mmm_control show</code></p>
<p><strong>MMMÊû∂ÊûÑÁöÑ‰ºòÁÇπ</strong></p>
<ul>
<li>‰ΩøÁî®PerlËÑöÊú¨ËØ≠Ë®ÄÂºÄÂèëÂπ∂‰∏îÂÆåÂÖ®ÂºÄÊ∫ê</li>
<li>Êèê‰æõ‰∫ÜËØªÂÜôËôöÊãüIPÔºå‰ΩøÊúçÂä°Âô®ËßíËâ≤ÁöÑÂèòÊõ¥ÂØπÂâçÁ´ØÂ∫îÁî®Êõ¥Âä†ÈÄèÊòé</li>
<li>Êèê‰æõ‰∫ÜÂª∂ËøüÁõëÊéßÔºåÂú®‰ªéÊúçÂä°Âô®Âá∫Áé∞Âª∂ËøüÊàñÁªàÁ´ØÊÉÖÂÜµ‰∏ãÂèØ‰ª•ÊääËôöÊãüIPÊºÇÁßªÂà∞ÂÖ∂ÂÆÉÊ≠£Â∏∏ÁöÑÊúçÂä°Âô®‰∏ä</li>
<li>‰∏ªÊï∞ÊçÆÂ∫ìÊïÖÈöúËΩ¨ÁßªÂêéÊúçÂä°Âô®ÂØπÊñ∞‰∏ªÁöÑÈáçÊñ∞ÂêåÊ≠•ÂäüËÉΩ</li>
<li>ÂèëÁîüÊïÖÈöúÁöÑ‰∏ªÊúçÂä°Âô®ÂæàÂÆπÊòìÈáçÊñ∞‰∏äÁ∫ø</li>
</ul>
<p><strong>MMMÊû∂ÊûÑÁöÑÁº∫ÁÇπ</strong></p>
<ul>
<li>ÂèëÂ∏ÉÊó∂Èó¥Êó©‰∏çÊîØÊåÅMySQLÁöÑGTIDÂ§çÂà∂</li>
<li>MySQL5.6‰πãÂêéÁöÑÂ§öÁ∫øÁ®ãÂ§çÂà∂‰∏çÊîØÊåÅ</li>
<li>Êèê‰æõ‰∫ÜÂª∂ËøüÁõëÊéßÔºå‰ΩÜÂ§öÁ∫øÁ®ãÂ§çÂà∂‰∏çÊîØÊåÅÔºåÂú®ÂÜôÂπ∂ÂèëÂ§ßÁöÑÊÉÖÂÜµ‰∏ãÂèØËÉΩÂèëÁîüÊâÄÊúâËØªVIPÈÉΩÂÅèÁßªÂà∞‰∏ªÊúçÂä°Âô®‰∏ä</li>
<li>Âú®ËøõË°å‰∏ª‰ªéÂàáÊç¢ÔºåÂÆπÊòìÈÄ†ÊàêÊï∞ÊçÆ‰∏¢Â§±ÔºàÁõ¥Êé•Â∞Ü‰∏ª‰∏ªÊúçÂä°Âô®‰∏≠ÁöÑÂ§áÊú∫ÊèêÂçáÔºå‰ΩÜÂ§áÊú∫Â≠òÂú®Âª∂Ëøü‰∏ç‰∏ÄÂÆöÊó∂ÊúÄÊñ∞ÁöÑÊï∞ÊçÆÔºå‰ªéÊï∞ÊçÆÂ∫ì‰πüÂàáÊç¢Ê≠§Êú∫Âô®‰∏∫‰∏ªÊú∫ÔºåÂÆπÊòì‰∫ãÂä°Â§öÊ¨°ÊâßË°åÔºâ</li>
<li>MMMÁõëÊéßÊúçÂä°Â≠òÂú®ÂçïÁÇπÊïÖÈöú</li>
<li>Ê≤°ÊúâÊèê‰æõÂ§ö‰∏™‰ªéÊúçÂä°Âô®ÁöÑËØªË¥üËΩΩÂùáË°°ÂäüËÉΩ</li>
</ul>
<h3 id="mhamaster-high-availability">MHA(Master High Availability)</h3>
<p>‚Äã	Áé∞È°πÁõÆÂú∞ÂùÄÂú®<a href="https://github.com/yoshinorim/mha4mysql-manager">GitHub‰∏ä</a>ÊòØÁî±PerlËÑöÊú¨ÂºÄÂèëÔºåÊõ¥ÂÖ≥Ê≥®MySQL<strong>‰∏ª‰ªéÊû∂ÊûÑ</strong>‰∏ãÁöÑ‰∏ªDB„ÄêÂè™ÁõëÊéß‰∏ªDB„ÄëÔºåÂΩì‰∏ªDB‰∏çÂèØÁî®Êó∂Ôºå‰ªéÂ§ö‰∏™‰ªéÊúçÂä°Âô®‰∏≠ÈÄâ‰∏æÂá∫Êï∞ÊçÆÊúÄÊñ∞ÁöÑ‰ªéÊï∞ÊçÆÂ∫ì‰Ωú‰∏∫‰∏ªÊúçÂä°Âô®ÔºåÂπ∂Êèê‰æõ‰∫Ü‰∏ª‰ªéÂàáÊç¢ÁöÑÊïÖÈöúËΩ¨Áßª„ÄÇÂπ∂‰∏îMHAÊîØÊåÅ<strong>GTID</strong>Â§çÂà∂Ê®°Âºè</p>
<p><img src="/img/mysql/MHA.png" alt="MHA"></p>
<p><strong>Á¨¨‰∏ÄÊ≠•ÔºöMySQL‰∏ª‰∏ªÊê≠Âª∫</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#####################################‰∏ªÊúçÂä°Âô®ÈÖçÁΩÆ#####################################</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊØèÂè∞MySQLË¶ÅÊ±Ç‰∏çÂêå</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">server-id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">1</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∫åËøõÂà∂Êó•ÂøóÂºÄÂêØÔºåÂ¶ÇÊûúÊúâÊù°‰ª∂ÁöÑËØùÂª∫ËÆÆÂçïÁã¨ÊåáÂÆöÂ≠òÊîæÂú®Âè¶‰∏Ä‰∏™Á£ÅÁõò‰∏ãÔºå‰∏çÂíåÊï∞ÊçÆÊñá‰ª∂Â≠òÊîæ‰∏ÄËµ∑</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-bin</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂºÄÂêØgtidÊ®°ÂºèÔºå‰ºöËÆ∞ÂΩïgtidÁöÑÊ†áËØÜÁ¨¶</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">gtid-mode</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âº∫Âà∂GTID‰∏ÄËá¥ÊÄßÔºå‰øùËØÅ‰∫ãÂä°ÁöÑÂÆâÂÖ®</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏çËÉΩ‰ΩøÁî®Ôºö</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 1.create table „ÄÇ„ÄÇselect</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 2.Âú®‰∫ãÂä°‰∏≠‰ΩøÁî®create temporary table Âª∫Á´ã‰∏¥Êó∂Ë°®Ôºå‰ΩøÁî®ÂÖ≥ËÅîÊõ¥Êñ∞‰∫ãÂä°Ë°®ÂíåÈùû‰∫ãÂä°Ë°®„ÄÇ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">enforce-gtid-consistency</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-slave-updates</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">relay-log</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-relay-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#####################################‰ªéÊúçÂä°Âô®ÈÖçÁΩÆ#####################################</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊØèÂè∞‰ªéMySQLË¶ÅÊ±Ç‰∏çÂêå</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">server-id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">101</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∫åËøõÂà∂Êó•ÂøóÂºÄÂêØÔºåÂ¶ÇÊûúÊúâÊù°‰ª∂ÁöÑËØùÂª∫ËÆÆÂçïÁã¨ÊåáÂÆöÂ≠òÊîæÂú®Âè¶‰∏Ä‰∏™Á£ÅÁõò‰∏ãÔºå‰∏çÂíåÊï∞ÊçÆÊñá‰ª∂Â≠òÊîæ‰∏ÄËµ∑</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-bin</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏≠ÁªßÊó•ÂøóÂºÄÂêØÔºåÈÅøÂÖçÈªòËÆ§Êù°‰ª∂‰∏ã‰ΩøÁî®‰∏ªÊú∫ÂêçÂëΩÂêçÔºåÂ¶ÇÊûú‰øÆÊîπ‰∏ªÊú∫ÂêçÂèØËÉΩ‰ºö‰∫ßÁîüÈîôËØØ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">relay-log</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-relay-bin</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂºÄÂêØgtidÊ®°ÂºèÔºå‰ºöËÆ∞ÂΩïgtidÁöÑÊ†áËØÜÁ¨¶</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">gtid-mode</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âº∫Âà∂GTID‰∏ÄËá¥ÊÄßÔºå‰øùËØÅ‰∫ãÂä°ÁöÑÂÆâÂÖ®</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏çËÉΩ‰ΩøÁî®Ôºö</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 1.create table „ÄÇ„ÄÇselect</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 2.Âú®‰∫ãÂä°‰∏≠‰ΩøÁî®create temporary table Âª∫Á´ã‰∏¥Êó∂Ë°®Ôºå‰ΩøÁî®ÂÖ≥ËÅîÊõ¥Êñ∞‰∫ãÂä°Ë°®ÂíåÈùû‰∫ãÂä°Ë°®„ÄÇ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">enforce-gtid-consistency</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰ªéÊúçÂä°Âô®Â§öÁ∫øÁ®ãÊâßË°åSQL</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">slave-parallel-type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">LOGICAL_CLOCK</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">slave-parallel-workers</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">4</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-slave-updates</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">read-only</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏ªÊúçÂä°ÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØÔºåÈªòËÆ§Â≠òÂÇ®Âú®Êñá‰ª∂‰∏≠ÔºåÂª∫ËÆÆÂºÄÂêØÔºåÂºÄÂêØÂ≠òÂÇ®Âú®salve_master_infoË°®[innodb]‰∏≠</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">master-info-repository</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">TABLE</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏≠ÁªßÊó•ÂøóÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØÔºåÈªòËÆ§Â≠òÂÇ®Âú®Êñá‰ª∂‰∏≠ÔºåÂª∫ËÆÆÂºÄÂêØÔºåÂºÄÂêØÂ≠òÂÇ®Âú®salve_relay_infoË°®[innodb]‰∏≠</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">relay-log-info-repository</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">TABLE</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Â§á‰ªΩÂÖ∑ÊúâÊï∞ÊçÆÁöÑ‰∏ªÊú∫ÊúçÂä°Âô®ÔºåÂπ∂ÂØºÂÖ•Âà∞ÂÖ∂ÂÆÉÊú∫Âô®</li>
<li>Âª∫Á´ã‰∏ª‰ªéÂÖ≥Á≥ª</li>
</ul>
<p><strong>Á¨¨‰∫åÊ≠•ÔºöÂÆâË£Öepel</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># centos 7 ÂÆâË£Öperl</span>
</span></span><span style="display:flex;"><span>yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∏âÊ≠•ÔºöÈÖçÁΩÆÈõÜÁæ§ÂÜÖÊâÄÊúâ‰∏ªÊú∫Áõ∏‰∫íSSHÂÖçËÆ§ËØÅÁôªÈôÜ„ÄêÁî®‰∫é‰øùÂ≠òÂéü‰∏ªÊúçÂä°Âô®ÁöÑ‰∫åËøõÂà∂Êó•ÂøóÔºåËôöÊãüIP„Äë</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰∏ÄÁõ¥ÂõûËΩ¶Â∞±Ë°å</span>
</span></span><span style="display:flex;"><span>ssh-keygen
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Êã∑Ë¥ùsshËØÅ‰π¶</span>
</span></span><span style="display:flex;"><span>ssh-copy-id -i /root/.ssh/id_rsa  Áî®Êà∑Âêç@IPÂú∞ÂùÄ
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊµãËØïÊòØÂê¶ÊàêÂäü</span>
</span></span><span style="display:flex;"><span>ssh Áî®Êà∑Âêç@IPÂú∞ÂùÄ
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨ÂõõÊ≠•ÔºöÂÆâË£ÖMHA</strong>„ÄêcentosÂÆâË£Öel6ÂåÖ„Äë</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#################################ÊâÄÊúâMySQLÊúçÂä°ËäÇÁÇπ#################################</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂÆâË£Ö‰æùËµñ</span>
</span></span><span style="display:flex;"><span>yum install perl-DBD-MySQL
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂÆâË£ÖnodeËäÇÁÇπ</span>
</span></span><span style="display:flex;"><span>rpm -ivh mha4mysql-node-X.Y-N.noarch.rpm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#####################################ÁõëÊéßËäÇÁÇπ#####################################</span>
</span></span><span style="display:flex;"><span>yum install perl-DBD-MySQL
</span></span><span style="display:flex;"><span>yum install perl-Config-Tiny
</span></span><span style="display:flex;"><span>yum install perl-Log-Dispatch
</span></span><span style="display:flex;"><span>yum install perl-Parallel-ForkManager
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÁõëÊéßËäÇÁÇπ‰πüÈúÄË¶ÅÂÆâË£Önode</span>
</span></span><span style="display:flex;"><span>rpm -ivh mha4mysql-node-X.Y-N.noarch.rpm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂÆâË£ÖÁõëÊéß</span>
</span></span><span style="display:flex;"><span>rpm -ivh mha4mysql-manager-X.Y-N.noarch.rpm
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Á¨¨‰∫îÊ≠•ÔºöÈÖçÁΩÆMHA</strong></p>
<ul>
<li>ÂàõÂª∫MHAÁöÑÁõëÊéßËäÇÁÇπÈÖçÁΩÆÊñá‰ª∂„Äê/etc/masterha_default.cnf„ÄëÔºåÈÖçÁΩÆÂÆòÁΩëÊúâÁ§∫‰æã„ÄÇÁõëÊéßËäÇÁÇπ‰∏çËÉΩÂíåMySQLËäÇÁÇπÊîæ‰∏ÄËµ∑</li>
</ul>
<pre tabindex="0"><code class="language-conf" data-lang="conf">[server default]
# ÂÖ∑ÊúâÊâÄÊúâÊùÉÈôêÁöÑÁî®Êà∑ÔºåÊúÄÂ•ΩÊòØÂª∫Á´ã‰∏Ä‰∏™MHA‰∏ìÁî®Áî®Êà∑ÂØπ‰∏ìÂ±ûÁΩëÊÆµÂºÄÊîæ
user=Áî®Êà∑Âêç
password=ÂØÜÁ†Å
# manager„ÄêÁõëÊéß„ÄëËäÇÁÇπÁöÑÂ∑•‰ΩúÁõÆÂΩï
manager_workdir=/home/mysql_mha
# manager„ÄêÁõëÊéß„ÄëËäÇÁÇπÁöÑÊó•ÂøóË∑ØÂæÑ
manager_log=/home/mysql_mha/manager.log
# ËøúÁ®ãnodeËäÇÁÇπÁöÑÂ∑•‰ΩúÁõÆÂΩïÔºåÈúÄË¶ÅÂú®ÊâÄÊúânodeËäÇÁÇπÊâãÂä®ÂàõÂª∫
remote_workdir=/home/mysql_mha

# ÈÖçÁΩÆÁöÑSSHÁî®Êà∑ÔºåmanagerÈúÄË¶ÅÁî®Ê≠§Áî®Êà∑ÂêØÂä®
ssh_user=Áî®Êà∑Âêç
# ‰∏ªÊúçÂä°Âô®ÂÖ∑ÊúâÂ§çÂà∂ÊùÉÈôêÁî®Êà∑
repl_user=Áî®Êà∑Âêç
repl_password=ÂØÜÁ†Å

# master‰∏ªÊú∫pingÁöÑÊ£ÄÊü•Êó∂Èó¥
ping_interval=1
# master‰∏ªÊú∫ÁöÑ‰∫åËøõÂà∂ÁõÆÂΩï„ÄêÊâÄÊúâ‰ªéËäÇÁÇπÁöÑ‰πüÂ∫îËØ•‰∏ÄÊ†∑„Äë
master_binlog_dir=/var/lib/mysql
# masterËäÇÁÇπÂÆïÊú∫ËøõË°åËôöÊãüIPÊºÇÁßªÁöÑËÑöÊú¨„ÄêMHAÊú¨Ë∫´‰∏çÂÖ∑ÊúâËôöÊãüipÊºÇÁßªÂäüËÉΩÔºåËÑöÊú¨ÂèØ‰ª•GithHubÊâæÂà∞Á§∫‰æã„Äë
master_ip_failover_script=/script/masterha/master_ip_failover
# masterÂÆïÊú∫ÁöÑÂ§ÑÁêÜËÑöÊú¨ÔºåËÑöÊú¨ÂèØ‰ª•GithHubÊâæÂà∞Á§∫‰æã
# shutdown_script= /script/masterha/power_manager
# ‰∏ª‰ªéÂàáÊç¢ÁöÑÈÄöÁü•ÁÆ°ÁêÜÂëòËÑöÊú¨ÔºåËÑöÊú¨ÂèØ‰ª•GithHubÊâæÂà∞Á§∫‰æã
# report_script= /script/masterha/send_master_failover_mail
# Áî®‰∫éÊ£ÄÊü•masterÊòØÂê¶ÂèØ‰ª•pingÈÄöÔºåÈÅøÂÖçmanagerËäÇÁÇπËá™Â∑±ping‰∏çÂêåÔºå‰ΩÜ‰ªéËäÇÁÇπÂèØ‰ª•ËÄåÈÄ†Êàêmaster‰∏çÂèØÁî®ÂÅáË±°
secondary_check_script=masterha_secondary_check -s remote_host1 -s remote_host2

# ÊúçÂä°Âô®ÈÖçÁΩÆÔºå‰∏ª‰ªéÂÖ≥Á≥ªMHA‰ºöËá™Âä®ËØÜÂà´Ôºå‰∏çÈúÄË¶ÅÊåáÊòé
# candidate_master=1 ‰ª£Ë°®ÂèØ‰ª•‰Ωú‰∏∫masterÁöÑÂÄôÈÄâÊú∫Âô®
# no_master=1        ‰ª£Ë°®‰∏ç‰Ωú‰∏∫masterÁöÑÂÄôÈÄâÊú∫Âô®
[server1]
hostname=host1
candidate_master=1

[server2]
hostname=host2
candidate_master=1

[server3]
hostname=host3
no_master=1
</code></pre><ul>
<li>master_ip_failoverËÑöÊú¨</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">95
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-perl" data-lang="perl"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#!/usr/bin/env perl</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#  Copyright (C) 2011 DeNA Co.,Ltd.</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#  You should have received a copy of the GNU General Public License</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#   along with this program; if not, write to the Free Software</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#  Foundation, Inc.,</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#  51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">## Note: This is a sample script and is not complete. Modify the script based on your environment.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">use</span> <span style="color:#555">strict</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">use</span> <span style="color:#555">warnings</span> FATAL <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#d14">&#39;all&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">use</span> <span style="color:#555">Getopt::Long</span>;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">use</span> <span style="color:#555">MHA::DBHelper</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">my</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#008080">$command</span>,        <span style="color:#008080">$ssh_user</span>,         <span style="color:#008080">$orig_master_host</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#008080">$orig_master_ip</span>, <span style="color:#008080">$orig_master_port</span>, <span style="color:#008080">$new_master_host</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#008080">$new_master_ip</span>,  <span style="color:#008080">$new_master_port</span>,  <span style="color:#008080">$new_master_user</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#008080">$new_master_password</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÈÖçÁΩÆËôöÊãüVIP</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">my</span> <span style="color:#008080">$vip</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;192.168.152.159/24&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># VIPÁöÑÁΩëÂç°Key</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">my</span> <span style="color:#008080">$key</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;1&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Ê≥®ÊÑè‰øÆÊîπÁΩëÂç°‰∏∫Êú¨Êú∫‰ΩøÁî®ÁöÑÁΩëÂç°</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">my</span> <span style="color:#008080">$ssh_start_vip</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;/sbin/ifconfig ens33:$key $vip&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Ê≥®ÊÑè‰øÆÊîπÁΩëÂç°‰∏∫Êú¨Êú∫‰ΩøÁî®ÁöÑÁΩëÂç°</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">my</span> <span style="color:#008080">$ssh_stop_vip</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;/sbin/ifconfig ens33:$key down&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GetOptions(
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;command=s&#39;</span>             <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">\</span><span style="color:#008080">$command</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;ssh_user=s&#39;</span>            <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">\</span><span style="color:#008080">$ssh_user</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;orig_master_host=s&#39;</span>    <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">\</span><span style="color:#008080">$orig_master_host</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;orig_master_ip=s&#39;</span>      <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">\</span><span style="color:#008080">$orig_master_ip</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;orig_master_port=i&#39;</span>    <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">\</span><span style="color:#008080">$orig_master_port</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;new_master_host=s&#39;</span>     <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">\</span><span style="color:#008080">$new_master_host</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;new_master_ip=s&#39;</span>       <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">\</span><span style="color:#008080">$new_master_ip</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;new_master_port=i&#39;</span>     <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">\</span><span style="color:#008080">$new_master_port</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;new_master_user=s&#39;</span>     <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">\</span><span style="color:#008080">$new_master_user</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#d14">&#39;new_master_password=s&#39;</span> <span style="color:#000;font-weight:bold">=&gt;</span> <span style="color:#000;font-weight:bold">\</span><span style="color:#008080">$new_master_password</span>,
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">exit</span> <span style="color:#000;font-weight:bold">&amp;</span>main();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">sub</span> <span style="color:#900;font-weight:bold">main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">print</span> <span style="color:#d14">&#34;\n\nIN SCRIPT TEST====$ssh_stop_vip==$ssh_start_vip===\n\n&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">if</span> ( <span style="color:#008080">$command</span> <span style="color:#000;font-weight:bold">eq</span> <span style="color:#d14">&#34;stop&#34;</span> <span style="color:#000;font-weight:bold">||</span> <span style="color:#008080">$command</span> <span style="color:#000;font-weight:bold">eq</span> <span style="color:#d14">&#34;stopssh&#34;</span> ) {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">my</span> <span style="color:#008080">$exit_code</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">eval</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">print</span> <span style="color:#d14">&#34;Disabling the VIP on old master: $orig_master_host \n&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">&amp;</span>stop_vip();
</span></span><span style="display:flex;"><span>            <span style="color:#008080">$exit_code</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span> (<span style="color:#008080">$@</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#0086b3">warn</span> <span style="color:#d14">&#34;Got Error: $@\n&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#0086b3">exit</span> <span style="color:#008080">$exit_code</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">exit</span> <span style="color:#008080">$exit_code</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">elsif</span> ( <span style="color:#008080">$command</span> <span style="color:#000;font-weight:bold">eq</span> <span style="color:#d14">&#34;start&#34;</span> ) {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">my</span> <span style="color:#008080">$exit_code</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">10</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">eval</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">print</span> <span style="color:#d14">&#34;Enabling the VIP - $vip on the new master - $new_master_host \n&#34;</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">&amp;</span>start_vip();
</span></span><span style="display:flex;"><span>            <span style="color:#008080">$exit_code</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span> (<span style="color:#008080">$@</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#0086b3">warn</span> <span style="color:#008080">$@</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#0086b3">exit</span> <span style="color:#008080">$exit_code</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">exit</span> <span style="color:#008080">$exit_code</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">elsif</span> ( <span style="color:#008080">$command</span> <span style="color:#000;font-weight:bold">eq</span> <span style="color:#d14">&#34;status&#34;</span> ) {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">print</span> <span style="color:#d14">&#34;Checking the Status of the script.. OK \n&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">exit</span> <span style="color:#099">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">&amp;</span>usage();
</span></span><span style="display:flex;"><span>        <span style="color:#0086b3">exit</span> <span style="color:#099">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">sub</span> <span style="color:#900;font-weight:bold">start_vip</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#d14">`ssh $ssh_user\@$new_master_host \&#34; $ssh_start_vip \&#34;`</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">sub</span> <span style="color:#900;font-weight:bold">stop_vip</span>() {
</span></span><span style="display:flex;"><span>     <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>  <span style="color:#000;font-weight:bold">unless</span>  (<span style="color:#008080">$ssh_user</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#d14">`ssh $ssh_user\@$orig_master_host \&#34; $ssh_stop_vip \&#34;`</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">sub</span> <span style="color:#900;font-weight:bold">usage</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">print</span>
</span></span><span style="display:flex;"><span><span style="color:#d14">&#34;Usage: master_ip_failover --command=start|stop|stopssh|status --orig_master_host=host --orig_master_ip=ip --orig_master_port=port --new_master_host=host --new_master_ip=ip --new_master_port=port\n&#34;</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Ê£ÄÊü•ÈÖçÁΩÆÊòØÂê¶Ê≠£Á°Æ</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Ê£ÄÊü•SSHÈÖçÁΩÆÔºåÂ¶ÇÊûúnodeÂíåmanagerÊòØÂêå‰∏ÄÂè∞ÊúçÂä°Âô®ÂàôÈúÄË¶ÅÂ∞ÜËá™Â∑±ÁöÑserverÊ≥®ÈáäÊéâÂê¶ÂàôÊä•Èîô</span>
</span></span><span style="display:flex;"><span>masterha_check_ssh --conf<span style="color:#000;font-weight:bold">=</span>/etc/masterha_default.cnf
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Ê£ÄÊµã‰∏ª‰ªéÂ§çÂà∂ÁªìÊûÑ</span>
</span></span><span style="display:flex;"><span>masterha_check_repl --conf<span style="color:#000;font-weight:bold">=</span>/etc/masterha_default.cnf
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ÂêØÂä®</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂêØÂä®manager</span>
</span></span><span style="display:flex;"><span>nohup masterha_manager --conf<span style="color:#000;font-weight:bold">=</span>/etc/masterha_default.cnf &amp;
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ÈÖçÁΩÆËôöÊãüIP</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># MHAÂπ∂‰∏ç‰ºö‰∏ªÂä®ÈÖçÁΩÆËôöÊãüIP,ËôöÊãüIPÊºÇÁßªËÑöÊú¨Âè™Âú®masterËäÇÁÇπÊåÇÊéâÊó∂ÂêØÁî®</span>
</span></span><span style="display:flex;"><span>ifconfig ÁΩëÂç°Âêç:key ËôöÊãüIP/Â≠êÁΩëÊé©Á†ÅÊï∞
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>MMMÊû∂ÊûÑÁöÑ‰ºòÁÇπ</strong></p>
<ul>
<li>‰ΩøÁî®PerlËÑöÊú¨ËØ≠Ë®ÄÂºÄÂèëÂπ∂‰∏îÂÆåÂÖ®ÂºÄÊ∫êÔºåÊèê‰æõ‰∫ÜÂêÑÁßçËÑöÊú¨ÂèØ‰ª•ËøõË°åÂµåÂÖ•</li>
<li>ÊîØÊåÅGTIDÁöÑÂ§çÂà∂</li>
<li>MHAÂú®ËøõË°åÊïÖÈöúËΩ¨ÁßªÊó∂Êõ¥‰∏çÊòì‰∫ßÁîüÊï∞ÊçÆ‰∏¢Â§±ÔºåÂèØÈÖçÂêàMySQLÂçäÂêåÊ≠•ÊúÄÂ§ßÁ®ãÂ∫¶ÂáèÂ∞ëÊï∞ÊçÆ‰∏¢Â§±</li>
<li>Âêå‰∏Ä‰∏™ÁõëÊéßËäÇÁÇπÂèØ‰ª•ÁõëÊéßÂ§ö‰∏™ÈõÜÁæ§</li>
</ul>
<p><strong>MMMÊû∂ÊûÑÁöÑÁº∫ÁÇπ</strong></p>
<ul>
<li>MHAÂøÖÈ°ªÁºñÂÜôËÑöÊú¨ÊàñÂà©Áî®Á¨¨‰∏âÊñπÂ∑•ÂÖ∑ÂÆûÁé∞VIPÈÖçÁΩÆ</li>
<li>MHAÂè™ÂØπmasterÊúçÂä°Âô®ÁõëÊéß</li>
<li>Âü∫‰∫éSSHÂÖçËÆ§ËØÅÁôªÈôÜÔºåÂ≠òÂú®‰∏ÄÂÆöÈöêÊÇ£</li>
<li>Ê≤°ÊúâÊèê‰æõÂ§ö‰∏™‰ªéÊúçÂä°Âô®ÁöÑËØªË¥üËΩΩÂùáË°°ÂäüËÉΩ</li>
</ul>
<h3 id="‰ΩøÁî®‰∏≠Èó¥‰ª∂ËØªÂÜôÂàÜÁ¶ªÂíåË¥üËΩΩÂùáË°°">‰ΩøÁî®‰∏≠Èó¥‰ª∂ËØªÂÜôÂàÜÁ¶ªÂíåË¥üËΩΩÂùáË°°</h3>
<p>‚Äã	ÂÜôÊìç‰ΩúÂè™ËÉΩÂú®master‰∏äËøõË°åÔºåËÄåslaveÂèØ‰ª•ÂàÜÊãÖËØªË¥üËΩΩÊâÄ‰ª•Ë¶ÅËøõË°åËØªÂÜôÂàÜÁ¶ª„ÄÅË¥üËΩΩÂùáË°°„ÄÇ‰ΩøÁî®‰∏≠Èó¥‰ª∂ÂÆåÊàêËØªÂÜôÂàÜÁ¶ªË¥üËΩΩÂùáË°°ÊØîÁ®ãÂ∫èÂëòÂÆûÁé∞ÁÆÄÂçïÔºå‰ΩÜÊòØÊÄßËÉΩÊçüËÄóËæÉ‰∏∫‰∏•Èáç„ÄÇ</p>
<ul>
<li>
<p>MySQL Proxy</p>
<p>MySQLÂÆòÊñπÊèê‰æõ‰ΩÜÊòØ‰∏ÄÁõ¥Ê≤°ÊúâÊ≠£ÂºèÁâàÔºåÁé∞Âú®Â∑≤ÁªèÊîπ‰∏∫MySQL RouterÔºå‰∏ÄÁõ¥Â≠òÂú®ÊÄßËÉΩ„ÄÅÁ®≥ÂÆöÊÄßÁº∫Èô∑„ÄÇ</p>
</li>
<li>
<p>MySQL Router</p>
<p>ÂÆòÊñπÁª¥Êä§ÔºåMySQL ProxyÁöÑÊõø‰ª£ÊñπÊ°à</p>
</li>
<li>
<p>MaxScale</p>
<p>MariaDBÂºÄÂèëÁöÑÊèí‰ª∂ÂºèÔºåÂÆöÂà∂ÁÅµÊ¥ªÔºåËá™Âä®Ê£ÄÊµã</p>
</li>
</ul>
<p><strong>MaxScaleÁöÑ‰ªãÁªç</strong><img src="/img/mysql/MaxScale.jpg" alt="MaxScale"></p>
<ul>
<li>Authentication‰∏∫ËÆ§ËØÅÊèí‰ª∂Êèê‰æõ‰∫ÜÊï∞ÊçÆÂ∫ìÁî®Êà∑ÁôªÈôÜËÆ§ËØÅÂäüËÉΩÔºåMaxScale‰ºöËØªÂèñ<code>mysql.user</code>Ë°®‰ø°ÊÅØÂπ∂ÁºìÂ≠ò</li>
<li>Protocol‰∏∫ÂçèËÆÆÊ®°ÂùóÊèê‰æõ‰∫ÜÂÆ¢Êà∑Á´ØÂà∞MaxScaleÂíåMaxScaleÂà∞ÂêéÁ´ØÁöÑÂçèËÆÆ</li>
<li>Routing‰∏∫Ë∑ØÁî±Ê®°ÂùóÊéßÂà∂ËØ∑Ê±ÇÂèëÈÄÅÁªôÂêéÁ´ØÈÇ£‰∏™Êï∞ÊçÆÂ∫ì</li>
<li>Monitor‰∏∫ÁõëÊéßÊ®°ÂùóÁõÆÁöÑÊòØÁõëÊéßÂêéÁ´ØÔºå‰ΩøËØ∑Ê±ÇÂèëÈÄÅÁªôÂêéÂè∞ÊúçÂä°Ê≠£Â∏∏ÁöÑÊï∞ÊçÆÂ∫ì</li>
<li>Filter&amp;Logging‰∏∫Êó•ÂøóÂíåËøáÊª§Ê®°ÂùóÊèê‰æõ‰∫ÜÊï∞ÊçÆÂ∫ìÈò≤ÁÅ´Â¢ôËÉΩÊîπÂÜô‰∏ÄÈÉ®ÂàÜÁÆÄÂçïSQLÂíåSQLÂÆπÈîô‰ª•ÂèäÊó•ÂøóËÆ∞ÂΩï</li>
</ul>
<p><strong>MaxScaleÁöÑÂÆâË£Ö</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span> yum localinstall maxscale-X.Y.Z.centos.R.x86_64.rpm
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>MaxScaleÁöÑMySQL‰ΩøÁî®Ë¥¶Âè∑ÈÖçÁΩÆ</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic">-- ÂàõÂª∫MaxScaleÁî®‰∫éÁõëÊéß‰∏ª‰ªéÁä∂ÊÄÅÁöÑË¥¶Âè∑
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">GRANT</span><span style="color:#bbb"> </span>REPLICATION<span style="color:#bbb"> </span>SLAVE,<span style="color:#bbb"> </span>REPLICATION<span style="color:#bbb"> </span>CLIENT<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ON</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span>.<span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">TO</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;maxscale_monitor&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;%&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">IDENTIFIED</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">BY</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[passowrd]&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">WITH</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">GRANT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">OPTION</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- ÂàõÂª∫MaxScaleÁî®‰∫éË∑ØÁî±Ê®°ÂùóÁöÑË¥¶Âè∑ÔºåÈúÄË¶ÅËØªÂèñMySQLÁöÑË¥¶Âè∑‰ø°ÊÅØ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">GRANT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ALL</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ON</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span>.<span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">TO</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;maxscale&#39;</span><span style="color:#000;font-weight:bold">@</span><span style="color:#d14">&#39;%&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">IDENTIFIED</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">BY</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;[passowrd]&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">WITH</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">GRANT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">OPTION</span>;<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÈÖçÁΩÆMaxScale</strong></p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">[maxscale]
threads=auto

[server1]
type=server
address=IPÂú∞ÂùÄ
port=3306
protocol=MariaDBBackend

[server2]
type=server
address=IPÂú∞ÂùÄ
port=3306
protocol=MariaDBBackend

[server3]
type=server
address=IPÂú∞ÂùÄ
port=3306
protocol=MariaDBBackend

[MariaDB-Monitor]
type=monitor
module=mariadbmon
servers=server1
user=myuser
password=mypwd
monitor_interval=2000

# Â¶ÇÊûúÂè™ÊòØË¥üËΩΩËØªÂùáË°°ÂàôÈÖçÁΩÆÊ≠§Ê®°ÂùóÔºåÂê¶ÂàôÊ≥®ÈáäÊéâÊ≠§Ê®°Âùó
[Read-Only-Service]
type=service
router=readconnroute
servers=server1
user=myuser
password=mypwd
router_options=slave

# ËØªÂÜôÂàÜÁ¶ªÊ®°Âùó
[Read-Write-Service]
type=service
router=readwritesplit
servers=server1
user=myuser
password=mypwd

# Â¶ÇÊûúÂè™ÊòØË¥üËΩΩËØªÂùáË°°ÂàôÈÖçÁΩÆÊ≠§Ê®°ÂùóÔºåÂê¶ÂàôÊ≥®ÈáäÊéâÊ≠§Ê®°Âùó
[Read-Only-Listener]
type=listener
service=Read-Only-Service
protocol=MariaDBClient
port=4008

# ËØªÂÜôÂàÜÁ¶ª‰ΩøÁî®ÁöÑÁôªÈôÜÁ´ØÂè£
[Read-Write-Listener]
type=listener
service=Read-Write-Service
protocol=MariaDBClient
port=4006

#ÁõëÊéßÊ®°ÂùóÈªòËÆ§Á§∫‰æãÊñá‰ª∂‰∏≠Ê≤°Êúâ
[MaxAdmin-Service]
type=service
router=cli

# ÁõëÊéßÊ®°Âùó‰ΩøÁî®ÁöÑÁ´ØÂè£ÔºåÈªòËÆ§Á§∫‰æãÊñá‰ª∂‰∏≠Ê≤°Êúâ
[MaxAdmin-Listener]
type=listener
service=MaxAdmin-Service
protocol=maxscaled
port=6603
</code></pre><p><strong>Ê£ÄÊü•&amp;ÂêØÂä®</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂàõÂª∫maxscaleÁî®Êà∑Áî®‰∫éÂêØÂä®</span>
</span></span><span style="display:flex;"><span>useradd maxscale
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Êü•ÁúãmaxscaleÈÖçÁΩÆÊñá‰ª∂ÊòØÂê¶ËØ≠Ê≥ïÊ≠£Á°ÆÔºå‰ºöÊâìÂç∞ÂêÑ‰∏™Êñá‰ª∂‰ΩçÁΩÆÈªòËÆ§ÔºàÊó•Âøó„ÄÅPIDÁ≠âÔºâ</span>
</span></span><span style="display:flex;"><span>maxscale --config-check<span style="color:#000;font-weight:bold">=</span>/etc/maxscale.cnf -U maxscale
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂêØÂä®maxscaleÔºåÊü•ÁúãÊó•ÂøóÊñá‰ª∂ÊòØÂê¶ÂêØÂä®ÊàêÂäüÔºåÊó•ÂøóÊñá‰ª∂Âú®</span>
</span></span><span style="display:flex;"><span>maxscale --config<span style="color:#000;font-weight:bold">=</span>/etc/maxscale.cnf -U maxscale
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ËøõÂÖ•ÂëΩ‰ª§Âè∞ÁÆ°ÁêÜ</span>
</span></span><span style="display:flex;"><span>maxadmin --user<span style="color:#000;font-weight:bold">=</span>admin --password<span style="color:#000;font-weight:bold">=</span>mariadb
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ‰ª•‰∏ãÂëΩ‰ª§Âú®ËøõÂÖ•ÁÆ°ÁêÜÂè∞‰πãÂêé‰ΩøÁî®</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># list servers  -- Êü•ÁúãÊúçÂä°Âô®Áä∂ÊÄÅÔºåÂ∑≤Áªè‰∏ª‰ªéÂÖ≥Á≥ª</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂçÅÁ¥¢Âºï‰ºòÂåñ">ÂçÅ„ÄÅÁ¥¢Âºï‰ºòÂåñ</h2>
<p>‚Äã	MySQLÁöÑÁ¥¢ÂºïÊòØÁî±Â≠òÂÇ®ÂºïÊìéÂÆûÁé∞ÁöÑÔºåÂç≥‰∏çÂêåÁöÑÂ≠òÂÇ®ÂºïÊìéÂÆûÁé∞ÁöÑÂêå‰∏ÄÁßçÁ¥¢ÂºïÁöÑÊñπÂºè‰πüÊòØÂ≠òÂú®Â∑ÆÂºÇÁöÑ„ÄÇMySQLÂ≠òÂÇ®ÂºïÊìé‰∏ÄËà¨ÊîØÊåÅBTreeÁ¥¢ÂºïÂíåHashÁ¥¢Âºï„ÄÇ</p>
<p>‚Äã	MyISAMÂíåInnoDBÂ≠òÂÇ®ÂºïÊìéÔºöÂè™ÊîØÊåÅBTreeÁ¥¢ÂºïÔºå ‰πüÂ∞±ÊòØËØ¥ÈªòËÆ§‰ΩøÁî®BTREEÔºå‰∏çËÉΩÂ§ü‰∏ªÂä®Êõ¥Êç¢ÔºàInnoDBÂºïÊìéÂèØÊ†πÊçÆÊÉÖÂÜµËá™Âä®ËΩ¨Êç¢Ôºâ</p>
<p>‚Äã	MEMORYÂ≠òÂÇ®ÂºïÊìéÔºöÊîØÊåÅBTreeÁ¥¢ÂºïÂíåHashÁ¥¢Âºï</p>
<p><strong>MyISAM‰∏≠Á¥¢ÂºïÂè∂Â≠êËäÇÁÇπËÆ∞ÂΩïÁöÑÊòØÂ≠òÂÇ®Âú®Êï∞ÊçÆÁ£ÅÁõò‰∏äÁöÑ‰ΩçÁΩÆÊï∞ÊçÆ</strong></p>
<p><img src="/img/mysql/myisam-index.png" alt="myisam-index"></p>
<p><strong>InnoDB‰∏≠Á¥¢ÂºïÔºà‰∏ªÈîÆÔºâÂè∂Â≠êËäÇÁÇπËÆ∞ÂΩïÁöÑÊòØÂ≠òÂÇ®Âú®Êï∞ÊçÆÔºåÂÖ∂ÂÆÉÁ¥¢ÂºïËÆ∞ÂΩïÁöÑÊòØÁõ¥ÂêëÁöÑ‰∏ªÈîÆÁ¥¢Âºï</strong></p>
<p><img src="/img/mysql/innodb-index.png" alt="innodb-index"></p>
<h3 id="btreeÁ¥¢Âºï">BTreeÁ¥¢Âºï</h3>
<p><strong>ÊúÄÂ∑¶ÂâçÁºÄÂéüÂàô</strong></p>
<p>‚Äã	Êü•ËØ¢Êù°‰ª∂Á≤æÁ°ÆÂåπÈÖçÁ¥¢ÂºïÁöÑÂ∑¶ËæπËøûÁª≠‰∏Ä‰∏™ÊàñÂá†‰∏™ÂàóÊó∂ÔºåÈÉ®ÂàÜÁ¥¢Âºï‰ø°ÊÅØÊâÄ‰ª•ÂèØ‰ª•Ë¢´Áî®Âà∞Ôºå‰ΩÜÊòØÂè™ËÉΩÁî®Âà∞‰∏ÄÈÉ®ÂàÜÔºåÂç≥Êù°‰ª∂ÊâÄÁªÑÊàêÁöÑÊúÄÂ∑¶ÂâçÁºÄ„ÄÇÈÄ†ÊàêÁöÑÂéüÂõ†ÊòØBTreeÁöÑÁªìÊûÑÂØºËá¥„ÄÇ</p>
<p><strong>ÂåπÈÖçÂàóÂâçÁºÄÂéüÂàô</strong></p>
<p>‚Äã	‰ΩøÁî®<code>like 'value%'</code>ÊñπÊ≥ï‰ΩøÁî®ÂàóÂâçÁºÄÂåπÈÖç</p>
<p><strong>Á≤æÁ°ÆÂåπÈÖçÂ∑¶ÂâçÂàóÂπ∂ËåÉÂõ¥ÂåπÈÖç‰ª§‰∏ÄÂàó</strong></p>
<p>‚Äã	‰ΩøÁî®<code>a = 1 and b= 2 and c&gt;10 and d = 5</code>ÔºåÂª∫Á´ã‰∫ÜÁ¥¢Âºï(a,b,c,d)ÔºåÂè™‰ºöÁî®Âà∞a„ÄÅb„ÄÅc‰∏âÂàó</p>
<p><strong>ÂâçÁºÄÁ¥¢ÂºïÂª∫Á´ã</strong></p>
<p>‚Äã	Âú®Â≠óÁ¨¶‰∏≤‰∏äÂª∫Á´ãÂâçÁºÄÁ¥¢Âºï<code>create index index_name ON table(col_name(n));</code></p>
<p><strong>BTreeÁöÑÈôêÂà∂</strong></p>
<ul>
<li>
<p>Â¶ÇÊûú‰∏çÊòØÊåâÁÖßÁ¥¢ÂºïÊúÄÂ∑¶ËæπÂàóÂºÄÂßãÊü•ÊâæÔºåÂàôÊó†Ê≥ï‰ΩøÁî®Á¥¢Âºï</p>
</li>
<li>
<p>‰ΩøÁî®Á¥¢ÂºïÊó∂‰∏çËÉΩË∑≥ËøáÁ¥¢Âºï‰∏≠ÁöÑÂàó</p>
</li>
<li>
<p>Êü•ËØ¢Êù°‰ª∂‰∏≠Âê´ÊúâÂáΩÊï∞ÊàñË°®ËææÂºè</p>
<p>Â¶Ç<code>select ... from product where to_day(out_day) - to_day(current_data) &lt;= 30</code>Áî®‰∏ç‰∏äÁ¥¢Âºï</p>
<p>Êîπ‰∏∫<code>select ... from product where out_day &lt;= data_add(current_day, interval 30 day)</code></p>
</li>
</ul>
<p><strong>Ë¶ÜÁõñÁ¥¢Âºï</strong></p>
<p>‚Äã	Ë¶ÜÁõñÁ¥¢ÂºïÊòØselectÁöÑÊï∞ÊçÆÂàóÂè™Áî®‰ªéÁ¥¢Âºï‰∏≠Â∞±ËÉΩÂ§üÂèñÂæóÔºå‰∏çÂøÖËØªÂèñÊï∞ÊçÆË°åÔºåÊç¢Âè•ËØùËØ¥Êü•ËØ¢ÂàóË¶ÅË¢´ÊâÄÂª∫ÁöÑÁ¥¢ÂºïË¶ÜÁõñ</p>
<p>‚Äã	‚ë†‰ºòÂåñÁºìÂ≠ò„ÄÅÂáèÂ∞ëÁ£ÅÁõòIOÊìç‰Ωú</p>
<p>‚Äã	‚ë°ÂáèÂ∞ëÈöèÊú∫IOÔºåÂèòÈöèÊú∫IOÊìç‰Ωú‰∏∫È°∫Â∫èIOÊìç‰Ωú</p>
<p>‚Äã	‚ë¢sanÈÅøÂÖçInnodbÁ¥¢ÂºïÂàóÊü•Êâæ‰∏ªÈîÆÂàóÁöÑIOÊ∂àËÄó</p>
<p>‚Äã	‚ë£ÈÅøÂÖçMyISAMË°®ËøõË°åÁ≥ªÁªüË∞ÉÁî®</p>
<p><strong>‰ΩøÁî®Á¥¢Âºï‰ºòÂåñÊéíÂ∫èÁöÑÈôêÂà∂</strong></p>
<p>‚Äã	‚ë†Á¥¢ÂºïÁöÑÂàóÈ°∫Â∫èÂíåOrder ByÂ≠êÂè•ÁöÑÈ°∫Â∫èÂÆåÂÖ®‰∏ÄËá¥</p>
<p>‚Äã	‚ë°Á¥¢Âºï‰∏≠ÊâÄÊúâÂàóÁöÑÊñπÂêëÔºàÂçáÂ∫è„ÄÅÈôçÂ∫èÔºâÂíåOrder ByÂ≠êÂè•ÂÆåÂÖ®‰∏ÄËá¥</p>
<p>‚Äã	‚ë¢Order By‰∏≠ÁöÑÂ≠óÊÆµÂÖ®ÈÉ®Âú®ÂÖ≥ËÅîË°®‰∏≠ÁöÑÁ¨¨‰∏ÄÂº†Ë°®‰∏≠</p>
<h3 id="hashÁ¥¢Âºï">HashÁ¥¢Âºï</h3>
<p>HashÁ¥¢ÂºïÁöÑÈôêÂà∂</p>
<ul>
<li>
<p>HashÁ¥¢ÂºïÂøÖÈ°ªËøõË°å‰∫åÊ¨°Êü•Êâæ</p>
</li>
<li>
<p>HashÁ¥¢ÂºïÊó†Ê≥ïÁî®‰∫éÊéíÂ∫è</p>
</li>
<li>
<p>HashÁ¥¢Âºï‰∏çÊîØÊåÅÈÉ®ÂàÜÁ¥¢ÂºïÊü•Êâæ‰πü‰∏çÊîØÊåÅËåÉÂõ¥Êü•Êâæ</p>
</li>
<li>
<p>HashÁ¥¢Âºï‰∏≠HashÁ†ÅËÆ°ÁÆóÂèØËÉΩÂ≠òÂú®HashÂÜ≤Á™Å</p>
</li>
</ul>
<h3 id="‰ΩøÁî®Á¥¢ÂºïÁöÑ‰ºòÁÇπ">‰ΩøÁî®Á¥¢ÂºïÁöÑ‰ºòÁÇπ</h3>
<ul>
<li>Â§ßÂ§ßÂáèÂ∞ë‰∫ÜÂ≠òÂÇ®ÂºïÊìéÈúÄË¶ÅÊâ´ÊèèÁöÑÊï∞ÊçÆÈáè</li>
<li>Â∏ÆÂä©ËøõË°åÊéíÂ∫è‰ª•ÈÅøÂÖç‰ΩøÁî®‰∏¥Êó∂Ë°®</li>
<li>ËøõË°å‰∫ãÂä°Êìç‰ΩúÊó∂ÔºåÈÅøÂÖçÂÖ®Ë°®Êâ´ÊèèÈîÅÂÆöÂÖ®Ë°®ÔºàÈó¥ÈöôÈîÅÔºâ</li>
</ul>
<h3 id="Êü•ÊâæÂÜ≤Á™Å‰∏çÂøÖË¶ÅÁöÑÁ¥¢Âºï">Êü•ÊâæÂÜ≤Á™Å‰∏çÂøÖË¶ÅÁöÑÁ¥¢Âºï</h3>
<ul>
<li>
<p>ÂÆâË£Ö<code>percona-toolkit</code></p>
</li>
<li>
<p>‰ΩøÁî®<code>pt-duplicate-key-checker --host='[host ]'--user='[user]' --password='[password]'  --databases='[dataBase]'</code>Êü•ÁúãÈáçÂ§çÂÆö‰πâÁöÑÁ¥¢Âºï</p>
</li>
</ul>
<h3 id="Êü•Áúã‰ªéÊú™‰ΩøÁî®ÁöÑÁ¥¢Âºï">Êü•Áúã‰ªéÊú™‰ΩøÁî®ÁöÑÁ¥¢Âºï</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>OBJECT_SCHEMA,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>OBJECT_NAME,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>INDEX_NAME<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">FROM</span><span style="color:#bbb"> </span>performance_schema.table_io_waits_summary_by_index_usage<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">WHERE</span><span style="color:#bbb"> </span>INDEX_NAME<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">IS</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">NOT</span><span style="color:#bbb"> </span><span style="color:#008080">NULL</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">AND</span><span style="color:#bbb"> </span>COUNT_STAR<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#099">0</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">AND</span><span style="color:#bbb"> </span>OBJECT_SCHEMA<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">&lt;&gt;</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;mysql&#39;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">ORDER</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">BY</span><span style="color:#bbb"> </span>OBJECT_SCHEMA,OBJECT_NAME;<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="Êõ¥Êñ∞Á¥¢ÂºïÁªüËÆ°‰ø°ÊÅØÂáèÂ∞ëÁ¥¢ÂºïÁ¢éÁâáÂåñ">Êõ¥Êñ∞Á¥¢ÂºïÁªüËÆ°‰ø°ÊÅØ&amp;ÂáèÂ∞ëÁ¥¢ÂºïÁ¢éÁâáÂåñ</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#MyISAM‰ºöÂ∞ÜÁªüËÆ°‰ø°ÊÅØËÆ∞ÂΩïÂú®Á£ÅÁõò‰∏≠Ôºå‰ºöÂÖ®Ë°®Êâ´Êèè
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#InnoDB‰∏çÂú®Á£ÅÁõòÂ≠òÂÇ®ÔºåÊõ¥ÂÖ∑ÈöèÊú∫ËÆøÈóÆÂ≠òÂÇ®Âú®ÂÜÖÂ≠ò‰∏≠ÔºåÁªüËÆ°ÁªìÊûúÂπ∂ÈùûÂçÅÂàÜÂáÜÁ°Æ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">analyze</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">table</span><span style="color:#bbb"> </span>tableName;<span style="color:#bbb">		</span><span style="color:#998;font-style:italic">#Êõ¥Êñ∞Á¥¢ÂºïÁªüËÆ°‰ø°ÊÅØ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">#‰∏çËÆ∫‰ªÄ‰πàÂ≠òÂÇ®ÂºïÊìéÂùá‰ºöÈîÅË°®
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">optimize</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">table</span><span style="color:#bbb"> </span>tableName;<span style="color:#bbb">		</span><span style="color:#998;font-style:italic">#‰ºòÂåñÁ¥¢ÂºïÔºåÁª¥Êä§Á¥¢Âºï
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂçÅ‰∏Äsql‰ºòÂåñ">ÂçÅ‰∏Ä„ÄÅSQL‰ºòÂåñ</h2>
<h3 id="Ëé∑ÂèñÂ≠òÂú®ÊÄßËÉΩÈóÆÈ¢òÁöÑsql">Ëé∑ÂèñÂ≠òÂú®ÊÄßËÉΩÈóÆÈ¢òÁöÑSQL</h3>
<h4 id="ÊÖ¢Êü•ËØ¢Êó•Âøó">ÊÖ¢Êü•ËØ¢Êó•Âøó</h4>
<p>‚Äã	MySQLÁöÑÊÖ¢Êü•ËØ¢Êó•ÂøóÊòØ‰∏ÄÁßçÂºÄÈîÄÊØîËæÉ‰ΩéÁöÑËé∑ÂèñÂ≠òÂú®ÊÄßËÉΩÈóÆÈ¢òÁöÑSQLÁöÑ‰∏ÄÁßçÊñπÊ≥ïÔºåÂºÄÈîÄ‰∏ªË¶ÅÂú®Á£ÅÁõòIOÂíåÂ≠òÂÇ®Êó•ÂøóÊñá‰ª∂ÊâÄÈúÄË¶ÅÁöÑÁ£ÅÁõòÁ©∫Èó¥„ÄÇÂª∫ËÆÆÊó•ÂøóÊñá‰ª∂ÔºàÂåÖÊã¨‰∫åËøõÂà∂Êó•ÂøóÊñá‰ª∂Á≠âÔºâÂíåÊï∞ÊçÆÊñá‰ª∂ÁõÆÂΩïÂàÜÂºÄÔºåÊúÄÂ•ΩÂàÜÁõòÂ≠òÊîæ„ÄÇ<strong>ÊÖ¢Êü•ËØ¢Êó•ÂøóËÆ∞ÂΩï‰∫ÜÊâÄÊúâÁ¨¶ÂêàÊù°‰ª∂ÁöÑËØ≠Âè•ÂåÖÂê´Êü•ËØ¢ËØ≠Âè•„ÄÅÊï∞ÊçÆ‰øÆÊîπËØ≠Âè•„ÄÅÂ∑≤ÂõûÊªöÁöÑSQL</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Âú®ËøêË°åÁöÑÁ≥ªÁªü‰∏≠ÂèØ‰ª•‰ΩøÁî® set global slow-query-log=on</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">slow-query-log</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊåáÂÆöÊÖ¢Êü•ËØ¢Êó•ÂøóÁöÑÊñá‰ª∂Âêç/Â≠òÂÇ®Ë∑ØÂæÑ</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">slow-query-log-file</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">mysql-slow.log</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ËÆæÁΩÆÊÖ¢Êü•ËØ¢Êó•ÂøóËÆ∞ÂΩïÁöÑÈòôÂÄºÔºåÂçï‰ΩçÁßíÔºå0.02‰ª£Ë°®20ÊØ´Áßí„ÄÇÈªòËÆ§10</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">long-query-time</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">0.02</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ËÆ∞ÂΩïÊú™‰ΩøÁî®Á¥¢ÂºïÁöÑSQLÔºå‰∏çÁÆ°Ëøô‰∏™Êü•ËØ¢ÊòØÂê¶Ë∂ÖËøáÈòôÂÄº</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">log-queries-not-using-indexes</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">on</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ÊÖ¢Êü•ËØ¢Êó•ÂøóÂéüÂßãÊñá‰ª∂Á§∫‰æãÔºåÊÖ¢Êü•ËØ¢Êñá‰ª∂ÂÜÖÂÆπ‰∏ÄËà¨ËæÉÂ§öÔºåÁõ¥Êé•Êü•ÁúãÊó†Ê≥ïÊü•ÁúãÂá∫ÂÖ∑‰Ωì‰ø°ÊÅØÔºåÊó†Ê≥ïÂΩíÁ±ª„ÄÇ</p>
<p><img src="/img/mysql/slow-query-log.png" alt="slow-query-log"></p>
<p><strong>‰ΩøÁî®MySQLËá™Â∏¶ÁöÑÊÖ¢Êü•ËØ¢Êó•ÂøóÊü•ÁúãÂ∑•ÂÖ∑mysqldumpslowÊü•ÁúãÊÖ¢Êü•ËØ¢Êó•Âøó</strong></p>
<p>Â∏∏Áî®<code>mysqldumpslow -s r -t 10 mysql-slow.log</code>Êü•ÁúãÊü•ËØ¢ÁªìÊûú</p>
<ul>
<li>-s order‰ª£Ë°®ÊéíÂ∫èÊñπÂºè<code>r</code>‰ª£Ë°®Êó∂Èó¥</li>
<li>-t topNum‰ª£Ë°®ÂèñÂá∫ÂâçtopNumÊù°Êï∞ÊçÆ</li>
</ul>
<p><img src="/img/mysql/mysqldumpslow.png" alt="mysqldumpslow"></p>
<p><strong>‰ΩøÁî®Êõ¥Âä†Âº∫Â§ßÁöÑ<code>pt-query-digest</code>ÂàÜÊûêÊÖ¢Êü•ËØ¢Êó•Âøó</strong></p>
<p>Â∏∏Áî®<code>pt-query-digest --explain h=[host], u=[user], p=[password] mysql-slow.log</code>Êü•ÁúãÊü•ËØ¢ÁªìÊûú</p>
<p><img src="/img/mysql/pt-query-diges-overall.png" alt="pt-query-diges-overall"></p>
<p><img src="/img/mysql/pt-query-diges-overall-item.png" alt="pt-query-diges-overall-item"></p>
<h4 id="ÂÆûÊó∂Ëé∑ÂèñÊÄßËÉΩÈóÆÈ¢ò">ÂÆûÊó∂Ëé∑ÂèñÊÄßËÉΩÈóÆÈ¢ò</h4>
<p>Âà©Êúâ<code>infomation_schema</code>Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑ<code>processlist</code>Ë°®Êü•ËØ¢ÂΩìÂâçÊâßË°åÁöÑSQLÁä∂ÊÄÅ‰ø°ÊÅØ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">select</span><span style="color:#bbb"> </span>id,<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">`</span><span style="color:#000;font-weight:bold">user</span><span style="color:#000;font-weight:bold">`</span>,<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">`</span>host<span style="color:#000;font-weight:bold">`</span>,<span style="color:#bbb"> </span>DB,<span style="color:#bbb"> </span>command,<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">`</span><span style="color:#458;font-weight:bold">time</span><span style="color:#000;font-weight:bold">`</span>,<span style="color:#bbb"> </span>state,<span style="color:#bbb"> </span>info<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">from</span><span style="color:#bbb"> </span>information_schema.processlist<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">where</span><span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">time</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">&gt;=</span><span style="color:#bbb"> </span>[<span style="color:#458;font-weight:bold">time</span>]<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="È¢ÑÂ§ÑÁêÜÂèäÁîüÊàêÊâßË°åËÆ°Âàí">È¢ÑÂ§ÑÁêÜÂèäÁîüÊàêÊâßË°åËÆ°Âàí</h3>
<p><strong>Êü•ËØ¢ÁºìÂ≠ò</strong></p>
<p>Ê†πÊçÆ<a href='MySQLÂ§ÑÁêÜSQLËØ∑Ê±ÇÁöÑÂ§ßËá¥ÊµÅÁ®ã'>MySQLÂ§ÑÁêÜSQLËØ∑Ê±ÇÁöÑÂ§ßËá¥ÊµÅÁ®ã</a>Ëß£ÊûêÂèØ‰ª•Áü•ÈÅìÊü•ËØ¢ÁºìÂ≠òÂØπSQLÊÄßËÉΩÊòØÊúâÂΩ±ÂìçÁöÑÔºåÊü•ËØ¢ÁºìÂ≠òÊòØÂØπÊü•ËØ¢ËØ≠Âè•ÂÅöhashÁÆóÊ≥ïÁÑ∂ÂêéÂ≠òÂÇ®ÁöÑÔºåÊâÄ‰ª•ÊÉ≥ÂëΩ‰∏≠ÁºìÂ≠òÁöÑÁ¨¨‰∏Ä‰∏™ÂøÖË¶ÅÊù°‰ª∂ÊòØËØ≠Âè•ÂøÖÈ°ª‰∏ÄÊ†∑„ÄÇ</p>
<ul>
<li>Êü•ËØ¢ÂëΩ‰∏≠‰∏çÂÆπÊòì</li>
<li>Â¶ÇÊûúÁºìÂ≠òÊï∞ÊçÆÁöÑËÆæËÆ°ÁöÑÂéüÂßãË°®ÂèëÁîüÊîπÂèòËøô‰∏™ÁºìÂ≠ò‰πüÈúÄË¶ÅÂà∑Êñ∞</li>
<li>Ê£ÄÊü•ÊòØÂê¶ÂëΩ‰∏≠Êó∂‰ºöÂØπÁºìÂ≠òÂä†ÈîÅ</li>
</ul>
<blockquote>
<p>ÂØπ‰∫é‰∏Ä‰∏™ËØªÂÜôÈ¢ëÁπÅÁöÑÁ≥ªÁªüÂæàÂèØËÉΩ‰ºöÈôç‰ΩéÊü•ËØ¢Â§ÑÁêÜÁöÑÊïàÁéáÔºåÊâÄ‰ª•Âª∫ËÆÆÂÖ≥Èó≠Êü•ËØ¢ÁºìÂ≠ò</p>
</blockquote>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ini" data-lang="ini"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 0Êó∂Ë°®Á§∫ÂÖ≥Èó≠Ôºå1Êó∂Ë°®Á§∫ÊâìÂºÄÔºå2Ë°®Á§∫Âè™Ë¶Åselect ‰∏≠ÊòéÁ°ÆÊåáÂÆöSQL_CACHEÊâçÁºìÂ≠ò</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">query-cache-type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">0</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Áî®‰∫éÊü•ËØ¢ÁºìÂ≠òÁöÑÂÜÖÂ≠òÂ§ßÂ∞èÔºåÂçï‰ΩçÂ≠óËäÇÂøÖÈ°ªÊòØ1024ÁöÑÊï¥Êï∞ÂÄç</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">query-cache-size</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">[size]</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Ë°®Á§∫Âçï‰∏™ÁªìÊûúÈõÜÊâÄË¢´ÂÖÅËÆ∏ÁºìÂ≠òÁöÑÊúÄÂ§ßÂÄº</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">query-cache-limit</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">[size]</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊØè‰∏™Ë¢´ÁºìÂ≠òÁöÑÁªìÊûúÈõÜË¶ÅÂç†Áî®ÁöÑÊúÄÂ∞èÂÜÖÂ≠ò</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">query_cache_min_res_unit</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">[size]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÊâßË°åËÆ°ÂàíÁîüÊàê</strong></p>
<p>ÊâßË°åËÆ°ÂàíÁîüÊàêÈò∂ÊÆµÂåÖÂê´‰∫Ü<code>Ëß£ÊûêSQL</code>„ÄÅ<code>È¢ÑÂ§ÑÁêÜ</code>„ÄÅ<code>‰ºòÂåñÊâßË°åËÆ°Âàí</code></p>
<p>Ëß£ÊûêSQLÔºöÈÄöËøáÂÖ≥ÈîÆÂ≠óÂØπËØ≠Ê≥ïËøõË°åËß£ÊûêÔºåÂπ∂ÁîüÊàê‰∏ÄÈ¢óÂØπÂ∫îÁöÑËØ≠Ê≥ïËß£ÊûêÊ†ë</p>
<p>È¢ÑÂ§ÑÁêÜÔºöÊ£ÄÊü•Ëß£ÊûêÊ†ëÊòØÂê¶ÂêàÊ≥ïÔºåÊØîÂ¶ÇË°®ÂíåÊï∞ÊçÆÂàóÊòØÂê¶Â≠òÂú®ÔºåÂêçÂ≠óÊàñËÄÖÂà´ÂêçÊòØÂê¶Â≠òÂú®Ê≠ß‰πâ</p>
<p>‰ºòÂåñÊâßË°åËÆ°ÂàíÔºöÂà©ÊúâÊü•ËØ¢‰ºòÂåñÂô®‰ºòÂåñÊü•ËØ¢</p>
<p><strong>Êü•ËØ¢‰ºòÂåñÂô®ÂÅöÁöÑÂ∑•‰Ωú</strong></p>
<ul>
<li>
<p>ÈáçÊñ∞ÂÆö‰πâË°®ÁöÑÂÖ≥ËÅîÈ°∫Â∫è</p>
</li>
<li>
<p>Â∞ÜËÉΩËΩ¨Âåñ‰∏∫ÂÜÖËøûÊé•ÁöÑÂ§ñËøûÊé•ËΩ¨Êç¢‰∏∫ÂÜÖËøûÊé•Â¶Ç<code>select * from a left join b on a.id=b.id  where b.id=2;</code></p>
</li>
<li>
<p>‰ºòÂåñcount()„ÄêMyISAM‰øùÂ≠òÁöÑË°åÊï∞„Äë„ÄÅmax()„ÄÅmin()</p>
</li>
<li>
<p>Â∞ùËØïÂ∞Ü‰∏Ä‰∏™Ë°®ËææÂºèËΩ¨Êç¢‰∏∫Â∏∏Êï∞</p>
</li>
<li>
<p>‰ΩøÁî®Á≠â‰ª∑ÂèòÊç¢ÂéüÂàôÔºàÁ¥¢ÂºïË¶ÜÁõñÔºâ</p>
</li>
<li>
<p>Â≠êÊü•ËØ¢‰ºòÂåñÔºàÂ∞ùËØïÂ∞ÜÂ≠êÊü•ËØ¢ËΩ¨‰∏∫ÂÖ≥ËÅîÊü•ËØ¢Ôºâ</p>
</li>
<li>
<p>ÊèêÂâçÁªàÊ≠¢Êü•ËØ¢ÔºàÂèëÁé∞‰∏Ä‰∏™ÂøÖÂÆö‰∏çÊª°Ë∂≥ÁöÑÊù°‰ª∂ÔºåÊØîÂ¶ÇÊó†Á¨¶Âè∑Á±ªÂûãÂ∞è‰∫é0Ôºâ</p>
</li>
<li>
<p>ÂØπin()Êù°‰ª∂‰ºòÂåñÔºàÂØπin‰∏≠Êù°‰ª∂ËøõË°åÊéíÂ∫èÔºåÂÜçÂà©Áî®‰∫åÂàÜÊü•ÊâæÊ≥ïÊü•ËØ¢Ôºâ</p>
</li>
</ul>
<p><strong>Êü•ËØ¢‰ºòÂåñÂô®‰ºòÂåñÈîôËØØÁöÑÂéüÂõ†</strong></p>
<ul>
<li>
<p>ÁªüËÆ°‰ø°ÊÅØ‰∏çÂáÜÁ°ÆÔºàinnodbÊòØÊäΩÊ†∑ÁªüËÆ°Ôºâ</p>
</li>
<li>
<p>ÊâßË°åËÆ°Âàí‰∏≠ÁöÑÊàêÊú¨‰º∞ÁÆóÂπ∂‰∏çÁ≠â‰∫éÂÆûÈôÖÊâßË°åÁöÑÊàêÊú¨</p>
</li>
<li>
<p>MySQL‰∏ç‰ºöËÄÉËôëÂÖ∂ÂÆÉÂπ∂ÂèëÊü•ËØ¢ÔºàÈîÅÔºâ</p>
</li>
<li>
<p>ÊúâÊó∂‰πü‰ºöÂü∫‰∫é‰∏ÄÂÆöËßÑÂàôÊù•ËøõË°å‰ºòÂåñÔºàÂ≠òÂú®ÂÖ®ÊñáÁ¥¢ÂºïÂ∞±È¶ñÂÖàÈááÁî®ÂÖ®ÊñáÁ¥¢ÂºïÔºâ</p>
</li>
<li>
<p>‰∏çËÄÉËôë‰∏çÂèóÂÖ∂ÊéßÂà∂ÁöÑÊàêÊú¨ÔºàÂ≠òÂÇ®ËøáÁ®ã„ÄÅÁî®Êà∑Ëá™ÂÆö‰πâÂáΩÊï∞Á≠âÔºâ</p>
</li>
</ul>
<h3 id="Á°ÆÂÆöÊü•ËØ¢Â§ÑÁêÜÂêÑ‰∏™Èò∂ÊÆµÊ∂àËÄóÁöÑÊó∂Èó¥">Á°ÆÂÆöÊü•ËØ¢Â§ÑÁêÜÂêÑ‰∏™Èò∂ÊÆµÊ∂àËÄóÁöÑÊó∂Èó¥</h3>
<p><strong>‰ΩøÁî®profile</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂêØÂä®profileÔºåËøôÊòØ‰∏Ä‰∏™sessionÁ∫ßÁöÑÈÖçÁΩÆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#458;font-weight:bold">set</span><span style="color:#bbb"> </span>profiling<span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#099">1</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># ÊâßË°åÊü•ËØ¢„ÄÇ„ÄÇ„ÄÇ„ÄÇ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊâßË°åÊü•ËØ¢„ÄÇ„ÄÇ„ÄÇ„ÄÇ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÊâßË°åÊü•ËØ¢„ÄÇ„ÄÇ„ÄÇ„ÄÇ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Êü•ÁúãÊØè‰∏Ä‰∏™Êü•ËØ¢Ê∂àËÄóÁöÑÊÄªÊó∂Èó¥‰ø°ÊÅØ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span>profiles;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># Êü•ÁúãÂêÑ‰∏™Èò∂ÊÆµÊâÄÊ∂àËÄóÁöÑÊó∂Èó¥‰ø°ÊÅØ,N‰∏∫‰∏ä‰∏™ÂëΩ‰ª§ËøîÂõûÁöÑIDÂÄº
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span>profile<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>query<span style="color:#bbb"> </span>N;<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/img/mysql/mysql-profile.png" alt="mysql-profile"></p>
<blockquote>
<p>‰∫ßÁîüË≠¶ÂëäÁöÑÂéüÂõ†ÊòØMySQLÂ∞ÜÂú®‰ª•ÂêéÁâàÊú¨ÁßªÈô§Âá∫profileÔºå‰ΩøÁî®performance_schema</p>
</blockquote>
<p><strong>‰ΩøÁî®performance_schema</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËÆæÁΩÆÂºÄÂêØ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">update</span><span style="color:#bbb"> </span>performance_schema.setup_instruments<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">set</span><span style="color:#bbb"> </span>enabled<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;YES&#39;</span>,<span style="color:#bbb"> </span>timed<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;YES&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">where</span><span style="color:#bbb"> </span>name<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">like</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;stage%&#39;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">update</span><span style="color:#bbb"> </span>performance_schema.setup_consumers<span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">set</span><span style="color:#bbb"> </span>enabled<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;YES&#39;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">where</span><span style="color:#bbb"> </span>name<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">like</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;events%&#39;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">#ËøõË°åÊü•ËØ¢
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>events_statements_history_long.THREAD_ID,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>SQL_TEXT,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>events_stages_history_long.EVENT_NAME,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>(<span style="color:#bbb"> </span>events_stages_history_long.TIMER_END<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">-</span><span style="color:#bbb"> </span>events_stages_history_long.TIMER_START<span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">/</span><span style="color:#bbb"> </span><span style="color:#099">1000000000</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">AS</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;DURATION(ms)&#39;</span><span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">FROM</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>events_statements_history_long<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#000;font-weight:bold">JOIN</span><span style="color:#bbb"> </span>threads<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ON</span><span style="color:#bbb"> </span>events_statements_history_long.THREAD_ID<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>threads.THREAD_ID<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#000;font-weight:bold">JOIN</span><span style="color:#bbb"> </span>events_stages_history_long<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">ON</span><span style="color:#bbb"> </span>events_stages_history_long.THREAD_ID<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>threads.THREAD_ID<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#000;font-weight:bold">AND</span><span style="color:#bbb"> </span>events_stages_history_long.EVENT_ID<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">BETWEEN</span><span style="color:#bbb"> </span>events_statements_history_long.EVENT_ID<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#000;font-weight:bold">AND</span><span style="color:#bbb"> </span>events_statements_history_long.END_EVENT_ID<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">WHERE</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>threads.PROCESSLIST_ID<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">CONNECTION_ID</span>(<span style="color:#bbb"> </span>)<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#000;font-weight:bold">AND</span><span style="color:#bbb"> </span>events_statements_history_long.EVENT_NAME<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#d14">&#39;statement/sql/select&#39;</span><span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">ORDER</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">BY</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>events_statements_history_long.THREAD_ID,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span>events_stages_history_long.EVENT_ID<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="‰øÆÊîπÂ§ßË°®ÁªìÊûÑ">‰øÆÊîπÂ§ßË°®ÁªìÊûÑ</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>pt-online-schema-change --alter<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[MODIFY filed varchar(32) not null ...]&#39;</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--user<span style="color:#000;font-weight:bold">=[</span>user<span style="color:#000;font-weight:bold">]</span> --password<span style="color:#000;font-weight:bold">=[</span>password<span style="color:#000;font-weight:bold">]</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span><span style="color:#008080">D</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[DBName]&#39;</span>,t<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[tableName]&#39;</span> --charset<span style="color:#000;font-weight:bold">=</span>utf8 --execute
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ê≠§Â∑•ÂÖ∑ÁöÑÂ§ÑÁêÜËøáÁ®ã</p>
<ol>
<li>ÂàõÂª∫Ëß¶ÂèëÂô®ÔºàÈÅøÂÖç‰∏¢Â§±Êñ∞Â¢ûÂíå‰øÆÊîπÊï∞ÊçÆÔºâ</li>
<li>ÂàõÂª∫Êñ∞ÁöÑ‰∏¥Êó∂Ë°®</li>
<li>copyÊï∞ÊçÆ</li>
<li>ÊóßË°®Âä†Êéí‰ªñÈîÅ</li>
<li>ÈáçÂëΩÂêçË°®</li>
<li>Êé•Ëß¶ÈîÅ</li>
<li>Âà†Èô§ÊóßË°®</li>
<li>Âà†Èô§Ëß¶ÂèëÂô®</li>
</ol>
<h2 id="ÂçÅ‰∫åÂàÜÂ∫ìÂàÜË°®">ÂçÅ‰∫å„ÄÅÂàÜÂ∫ìÂàÜË°®</h2>
<p>ÂèÇËßÅ<a href="https://mynamelancelot.github.io/database/mycat">MyCatÈÉ®ÂàÜ</a></p>
<blockquote>
<p>MyCatÁî®‰∫éËØªÂÜôÂàÜÁ¶ª„ÄÅÂàÜÂ∫ìÂàÜË°®Á≠âÂäüËÉΩ</p>
</blockquote>
<h2 id="ÂçÅ‰∏âÈÉ®ÂàÜÊ¶ÇÂøµ">ÂçÅ‰∏â„ÄÅÈÉ®ÂàÜÊ¶ÇÂøµ</h2>
<h3 id="ÈîÅÁöÑÊ¶ÇÂøµ">ÈîÅÁöÑÊ¶ÇÂøµ</h3>
<p>‚Äã	Êï∞ÊçÆÂ∫ìÈîÅÂÆöÊú∫Âà∂ÁÆÄÂçïÊù•ËØ¥Â∞±ÊòØÊï∞ÊçÆÂ∫ì‰∏∫‰∫Ü‰øùËØÅÊï∞ÊçÆÁöÑ‰∏ÄËá¥ÊÄßËÄå‰ΩøÂêÑÁßçÂÖ±‰∫´ËµÑÊ∫êÂú®Ë¢´Âπ∂ÂèëËÆøÈóÆËÆøÈóÆÂèòÂæóÊúâÂ∫èÊâÄËÆæËÆ°ÁöÑ‰∏ÄÁßçËßÑÂàô„ÄÇ</p>
<p><strong>ÊåâÁÖßÈîÅÂÆöÁ∫ßÂà´ÂàÜÁ±ªÂèØÂàÜ‰∏∫</strong></p>
<ul>
<li>
<p>Ë°åÁ∫ßÈîÅÔºàrow-levelÔºâ„ÄêMySQLÂ≠òÂÇ®ÂºïÊìéÂÆûÁé∞„Äë</p>
<p>Ë°åÁ∫ßÈîÅÊòØMySQL‰∏≠ÈîÅÂÆöÁ≤íÂ∫¶ÊúÄÁªÜÁöÑ‰∏ÄÁßçÈîÅÔºåË°®Á§∫Âè™ÈíàÂØπÂΩìÂâçÊìç‰ΩúÁöÑË°åËøõË°åÂä†ÈîÅ„ÄÇË°åÁ∫ßÈîÅËÉΩÂ§ßÂ§ßÂáèÂ∞ëÊï∞ÊçÆÂ∫ìÊìç‰ΩúÁöÑÂÜ≤Á™Å„ÄÇÂÖ∂Âä†ÈîÅÁ≤íÂ∫¶ÊúÄÂ∞èÔºå‰ΩÜÂä†ÈîÅÁöÑÂºÄÈîÄ‰πüÊúÄÂ§ß„ÄÇË°åÁ∫ßÈîÅÂàÜ‰∏∫<code>ÂÖ±‰∫´ÈîÅ</code>Âíå<code>Êéí‰ªñÈîÅ</code>„ÄÇ</p>
<p>ÂºÄÈîÄÂ§ßÔºåÂä†ÈîÅÊÖ¢Ôºõ‰ºöÂá∫Áé∞Ê≠ªÈîÅÔºõÈîÅÂÆöÁ≤íÂ∫¶ÊúÄÂ∞èÔºåÂèëÁîüÈîÅÂÜ≤Á™ÅÁöÑÊ¶ÇÁéáÊúÄ‰ΩéÔºåÂπ∂ÂèëÂ∫¶‰πüÊúÄÈ´ò„ÄÇ</p>
</li>
<li>
<p>Ë°®Á∫ßÈîÅÔºàtable-levelÔºâ„ÄêMySQLÊúçÂä°ÂÆûÁé∞„Äë</p>
<p>Ë°®Á∫ßÈîÅÊòØMySQL‰∏≠ÈîÅÂÆöÁ≤íÂ∫¶ÊúÄÂ§ßÁöÑ‰∏ÄÁßçÈîÅÔºåË°®Á§∫ÂØπÂΩìÂâçÊìç‰ΩúÁöÑÊï¥Âº†Ë°®Âä†ÈîÅÔºåÂÆÉÂÆûÁé∞ÁÆÄÂçïÔºåËµÑÊ∫êÊ∂àËÄóËæÉÂ∞ëÔºåË¢´Â§ßÈÉ®ÂàÜMySQLÂºïÊìéÊîØÊåÅ„ÄÇÊúÄÂ∏∏‰ΩøÁî®ÁöÑMyISAM‰∏éMemory‰ª•ÂèäInnoDB„ÄêÈªòËÆ§Ë°åÁ∫ßÈîÅ„ÄëÈÉΩÊîØÊåÅË°®Á∫ßÈîÅ„ÄÇË°®Á∫ßÈîÅÂàÜ‰∏∫<code>Ë°®ÂÖ±‰∫´ËØªÈîÅ</code>‰∏é<code>Ë°®Áã¨Âç†ÂÜôÈîÅ</code>„ÄÇ</p>
<p>ÂºÄÈîÄÂ∞èÔºåÂä†ÈîÅÂø´Ôºõ‰∏ç‰ºöÂá∫Áé∞Ê≠ªÈîÅÔºõÈîÅÂÆöÁ≤íÂ∫¶Â§ßÔºåÂèëÂá∫ÈîÅÂÜ≤Á™ÅÁöÑÊ¶ÇÁéáÊúÄÈ´òÔºåÂπ∂ÂèëÂ∫¶ÊúÄ‰Ωé„ÄÇ</p>
</li>
<li>
<p>È°µÁ∫ßÈîÅÔºàpage-levelÔºâ„ÄêMySQLÂ≠òÂÇ®ÂºïÊìéÂÆûÁé∞„Äë</p>
<p>È°µÁ∫ßÈîÅÊòØMySQL‰∏≠ÈîÅÂÆöÁ≤íÂ∫¶‰ªã‰∫éË°åÁ∫ßÈîÅÂíåË°®Á∫ßÈîÅ‰∏≠Èó¥ÁöÑ‰∏ÄÁßçÈîÅ„ÄÇË°®Á∫ßÈîÅÈÄüÂ∫¶Âø´Ôºå‰ΩÜÂÜ≤Á™ÅÂ§öÔºåË°åÁ∫ßÂÜ≤Á™ÅÂ∞ëÔºå‰ΩÜÈÄüÂ∫¶ÊÖ¢„ÄÇÊâÄ‰ª•Âèñ‰∫ÜÊäòË°∑ÁöÑÈ°µÁ∫ßÔºå‰∏ÄÊ¨°ÈîÅÂÆöÁõ∏ÈÇªÁöÑ‰∏ÄÁªÑËÆ∞ÂΩï„ÄÇBDBÊîØÊåÅÈ°µÁ∫ßÈîÅ„ÄÇ</p>
<p>ÂºÄÈîÄÂíåÂä†ÈîÅÊó∂Èó¥Áïå‰∫éË°®ÈîÅÂíåË°åÈîÅ‰πãÈó¥Ôºõ‰ºöÂá∫Áé∞Ê≠ªÈîÅÔºõÈîÅÂÆöÁ≤íÂ∫¶Áïå‰∫éË°®ÈîÅÂíåË°åÈîÅ‰πãÈó¥ÔºåÂπ∂ÂèëÂ∫¶‰∏ÄËà¨„ÄÇ</p>
</li>
</ul>
<p><strong>ÊâãÂä®ÂÖ±‰∫´Ë°®ËØªÈîÅ&amp;Áã¨Âç†Ë°®ÂÜôÈîÅ</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#998;font-style:italic">-- Âä†ÈîÅ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">lock</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">table</span><span style="color:#bbb"> </span>[<span style="color:#a61717;background-color:#e3d2d2">Ë°®ÂêçÁß∞</span>]<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">read</span><span style="color:#000;font-weight:bold">/</span><span style="color:#000;font-weight:bold">write</span>,[<span style="color:#a61717;background-color:#e3d2d2">Ë°®ÂêçÁß∞</span>]<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">read</span><span style="color:#000;font-weight:bold">/</span><span style="color:#000;font-weight:bold">write</span>,<span style="color:#bbb"> </span>...<span style="color:#bbb"> </span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">-- Ëß£ÈîÅ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">unlock</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">tables</span>;<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>InnoDBÂºïÊìéÁöÑÈîÅÊú∫Âà∂</strong></p>
<p>ÂÖ±‰∫´ÈîÅ(S)ÔºöÂÖÅËÆ∏‰∏Ä‰∏™‰∫ãÂä°ÂéªËØª‰∏ÄË°åÔºåÈòªÊ≠¢ÂÖ∂‰ªñ‰∫ãÂä°Ëé∑ÂæóÁõ∏ÂêåÊï∞ÊçÆÈõÜÁöÑÊéí‰ªñÈîÅ</p>
<p>Êéí‰ªñÈîÅ(X)ÔºöÂÖÅËÆ∏Ëé∑ÂæóÊéí‰ªñÈîÅÁöÑ‰∫ãÂä°Êõ¥Êñ∞Êï∞ÊçÆÔºåÈòªÊ≠¢ÂÖ∂‰ªñ‰∫ãÂä°ÂèñÂæóÁõ∏ÂêåÊï∞ÊçÆÈõÜÁöÑÂÖ±‰∫´ËØªÈîÅÂíåÊéí‰ªñÂÜôÈîÅ</p>
<p>ÊÑèÂêëÂÖ±‰∫´ÈîÅ(IS)Ôºö‰∫ãÂä°ÊâìÁÆóÁªôÊï∞ÊçÆË°åÂä†Ë°åÂÖ±‰∫´ÈîÅÔºå‰∫ãÂä°Âú®Áªô‰∏Ä‰∏™Êï∞ÊçÆË°åÂä†ÂÖ±‰∫´ÈîÅÂâçÂøÖÈ°ªÂÖàÂèñÂæóËØ•Ë°®ÁöÑISÈîÅ</p>
<p>ÊÑèÂêëÊéí‰ªñÈîÅ(IX)Ôºö‰∫ãÂä°ÊâìÁÆóÁªôÊï∞ÊçÆË°åÂä†Ë°åÊéí‰ªñÈîÅÔºå‰∫ãÂä°Âú®Áªô‰∏Ä‰∏™Êï∞ÊçÆË°åÂä†Êéí‰ªñÈîÅÂâçÂøÖÈ°ªÂÖàÂèñÂæóËØ•Ë°®ÁöÑIXÈîÅ</p>
<p>ËØ¥ÊòéÔºö</p>
<p>1ÔºâÂÖ±‰∫´ÈîÅÂíåÊéí‰ªñÈîÅÈÉΩÊòØË°åÈîÅÔºåÊÑèÂêëÈîÅÈÉΩÊòØË°®ÈîÅÔºåÂ∫îÁî®‰∏≠Êàë‰ª¨Âè™‰ºö‰ΩøÁî®Âà∞ÂÖ±‰∫´ÈîÅÂíåÊéí‰ªñÈîÅÔºåÊÑèÂêëÈîÅÊòØmysqlÂÜÖÈÉ®‰ΩøÁî®ÁöÑÔºå‰∏çÈúÄË¶ÅÁî®Êà∑Âπ≤È¢Ñ</p>
<p>2ÔºâÂØπ‰∫éUPDATE„ÄÅDELETEÂíåINSERTËØ≠Âè•ÔºåInnoDB‰ºöËá™Âä®ÁªôÊ∂âÂèäÊï∞ÊçÆÈõÜÂä†Êéí‰ªñÈîÅ(X)</p>
<p>3ÔºâÂØπ‰∫éÊôÆÈÄöSELECTËØ≠Âè•ÔºåInnoDB‰∏ç‰ºöÂä†‰ªª‰ΩïÈîÅ</p>
<p>4ÔºâSELECTÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãËØ≠Âè•ÊòæÁ§∫ÁªôËÆ∞ÂΩïÈõÜÂä†ÂÖ±‰∫´ÈîÅÊàñÊéí‰ªñÈîÅ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">FROM</span><span style="color:#bbb"> </span>table_name<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">WHERE</span><span style="color:#bbb"> </span>...<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">LOCK</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">IN</span><span style="color:#bbb"> </span>SHARE<span style="color:#bbb"> </span>MODE<span style="color:#bbb">       </span><span style="color:#998;font-style:italic">-- ÂÖ±‰∫´ÈîÅÔºàSÔºâ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">SELECT</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">FROM</span><span style="color:#bbb"> </span>table_name<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">WHERE</span><span style="color:#bbb"> </span>...<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">FOR</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">UPDATE</span><span style="color:#bbb">               </span><span style="color:#998;font-style:italic">-- Êéí‰ªñÈîÅÔºàXÔºâ
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>5ÔºâÂΩì‰∏§‰∏™‰∫ãÂä°ËøõË°åÔºå‰∏Ä‰∏™‰∫ãÂä°Êõ¥Êñ∞‰∏ÄÊù°ËÆ∞ÂΩïÔºåÂè¶‰∏Ä‰∫ãÂä°ÂèØËØªÂèñÊ≠§ËÆ∞ÂΩïÔºà‰∏çÂèò-‰ªéUndoÊó•Âøó‰∏≠ËØªÂèñÁöÑÂÄºÔºâ,ÂÜôÂÖ•Êìç‰ΩúÈúÄË¶ÅÁ≠âÊõ¥Êñ∞Êìç‰ΩúÊèê‰∫§‰∫ãÂä°</p>
<p>6ÔºâInnoDB‰∏≠ÁöÑË°åÈîÅÈÉΩÊòØ<code>Èó¥ÈöôÈîÅ</code>ÊòØÂú®Á¥¢ÂºïÂå∫Èó¥Âä†ÈîÅ</p>
<p><img src="/img/mysql/clearancelock.png" alt="clearancelock"></p>
<h3 id="b-Ê†ë--b-Ê†ë">B Ê†ë &amp; B+ Ê†ë</h3>
<p><a href="http://blog.codinglabs.org/articles/theory-of-mysql-index.html">ÂèÇËÄÉÂçöÂÆ¢</a></p>
<h3 id="span-idmysqlÂ§ÑÁêÜsqlËØ∑Ê±ÇÁöÑÂ§ßËá¥ÊµÅÁ®ãmysqlÂ§ÑÁêÜsqlËØ∑Ê±ÇÁöÑÂ§ßËá¥ÊµÅÁ®ãspan"><span id='MySQLÂ§ÑÁêÜSQLËØ∑Ê±ÇÁöÑÂ§ßËá¥ÊµÅÁ®ã'>MySQLÂ§ÑÁêÜSQLËØ∑Ê±ÇÁöÑÂ§ßËá¥ÊµÅÁ®ã</span></h3>
<p><img src="/img/mysql/process-query.jpg" alt="process-query"></p>
<ol>
<li>ÂÆ¢Êà∑Á´ØÂèëÈÄÅSQLËØ∑Ê±ÇÁªôÊúçÂä°Âô®</li>
<li>ÊúçÂä°Âô®Ê£ÄÊü•ÊòØÂê¶ÂèØ‰ª•Âú®Êü•ËØ¢ÁºìÂ≠ò‰∏≠ÂëΩ‰∏≠ÊîπSQL„ÄêÁºìÂ≠ò‰∏≠ÂåÖÂê´ÁöÑÊúâËøôÊù°SQLÁöÑÊùÉÈôêÁ≠â‰ø°ÊÅØÔºåÂ¶ÇÊûúÂëΩ‰∏≠Áõ¥Êé•ËøîÂõû„Äë</li>
<li>ÊúçÂä°Âô®Á´ØËøõË°åSQLËß£Êûê„ÄÅÊùÉÈôêÊ†°È™å„ÄÅÈ¢ÑÂ§ÑÁêÜ„ÄÅÂÜçÁî±‰ºòÂåñÂô®ÁîüÊàêÂØπÂ∫îÁöÑÊâßË°åËÆ°Âàí</li>
<li>Ê†πÊçÆÊâßË°åËÆ°ÂàíÔºåË∞ÉÁî®Â≠òÂÇ®ÂºïÊìéAPIÊù•Êü•ÊâæÊï∞ÊçÆ</li>
<li>ËøîÂõûÁªìÊûúÊï∞ÊçÆÂà∞ÂÆ¢Êà∑Á´Ø</li>
</ol>
<h3 id="mysqlÊó•ÂøóÂàÜÁ±ª">MySQLÊó•ÂøóÂàÜÁ±ª</h3>
<ul>
<li>MySQLÊúçÂä°Â±ÇÔºö‰∫åËøõÂà∂Êó•Âøó„ÄÅÊÖ¢Êü•Êó•Âøó„ÄÅÈÄöÁî®Êó•Âøó</li>
<li>MySQLÂ≠òÂÇ®ÂºïÊìéÂ±ÇInnoDBÊó•ÂøóÔºöÈáçÂÅöÊó•Âøó„ÄÅÂõûÊªöÊó•Âøó</li>
</ul>
<h3 id="sqlÁöÑÊâßË°åÈ°∫Â∫èmysql‰∏∫‰æã">SQLÁöÑÊâßË°åÈ°∫Â∫èÔºàMySQL‰∏∫‰æãÔºâ</h3>
<ol>
<li>
<p>FROMÔºàÂ∞ÜÊúÄËøëÁöÑ‰∏§Âº†Ë°®ÔºåËøõË°åÁ¨õÂç°Â∞îÁßØÔºâ        &ndash;VT1</p>
</li>
<li>
<p>ONÔºàÂ∞ÜVT1ÊåâÁÖßÂÆÉÁöÑÊù°‰ª∂ËøõË°åËøáÊª§Ôºâ                  &ndash;VT2</p>
</li>
<li>
<p>LEFT JOINÔºà‰øùÁïôÂ∑¶Ë°®ÁöÑËÆ∞ÂΩïÔºâ                             &ndash;VT3</p>
</li>
<li>
<p>WHEREÔºàËøáÊª§VT3‰∏≠ÁöÑËÆ∞ÂΩïÔºâ                              &ndash;VT4‚Ä¶VTn</p>
</li>
<li>
<p>GROUP BYÔºàÂØπVT4ÁöÑËÆ∞ÂΩïËøõË°åÂàÜÁªÑÔºâ                 &ndash;VT5</p>
</li>
<li>
<p>HAVINGÔºàÂØπVT5‰∏≠ÁöÑËÆ∞ÂΩïËøõË°åËøáÊª§Ôºâ                  &ndash;VT6</p>
</li>
<li>
<p>SELECTÔºàÂØπVT6‰∏≠ÁöÑËÆ∞ÂΩïÔºåÊäïÂΩ±ÈÄâÂèñÊåáÂÆöÁöÑÂàóÔºâ&ndash;VT7</p>
</li>
<li>
<p>ORDER BYÔºàÂØπVT7ÁöÑËÆ∞ÂΩïËøõË°åÊéíÂ∫èÔºâ                  &ndash;Ê∏∏Ê†á</p>
</li>
<li>
<p>LIMITÔºàÂØπÊéíÂ∫è‰πãÂêéÁöÑÂÄºËøõË°åÂàÜÈ°µÔºâ</p>
</li>
</ol>
<p>WHEREÊù°‰ª∂ÊâßË°åÈ°∫Â∫èÔºàÂΩ±ÂìçÊÄßËÉΩÔºâ</p>
<ul>
<li>
<p>MYSQLÔºö‰ªéÂ∑¶ÂæÄÂè≥ÂéªÊâßË°åWHEREÊù°‰ª∂ÁöÑ„ÄÇ</p>
</li>
<li>
<p>OracleÔºö‰ªéÂè≥ÂæÄÂ∑¶ÂéªÊâßË°åWHEREÊù°‰ª∂ÁöÑ„ÄÇ</p>
</li>
</ul>
<blockquote>
<p>ÁªìËÆ∫ÔºöÂÜôWHEREÊù°‰ª∂ÁöÑÊó∂ÂÄôÔºå‰ºòÂÖàÁ∫ßÈ´òÁöÑÈÉ®ÂàÜË¶ÅÂéªÁºñÂÜôËøáÊª§ÂäõÂ∫¶ÊúÄÂ§ßÁöÑÊù°‰ª∂ËØ≠Âè•</p>
</blockquote>
<h2 id="ÂçÅÂõõÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÊÅ¢Â§ç">ÂçÅÂõõ„ÄÅÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÊÅ¢Â§ç</h2>
<ul>
<li>Êï∞ÊçÆÊÅ¢Â§çÂèØ‰ª•‰ΩøÁî®<a href="https://mynamelancelot.github.io/database/PXC.html#%E4%B8%83%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%86%B7%E7%83%AD%E5%A4%87%E4%BB%BD">Êï∞ÊçÆÂ∫ìÂ§á‰ªΩ</a>ÁöÑÂ§á‰ªΩÊñá‰ª∂ÊÅ¢Â§çÔºå‰ΩÜÊòØÂ§á‰ªΩÁÇπÂà∞ÂΩìÂâçÁöÑÊï∞ÊçÆ‰∏çÂèØÊÅ¢Â§ç</li>
<li>‰ΩøÁî®<a href="#delay-rep">Âª∂ËøüÂ§çÂà∂</a>ÁöÑÊñπÊ≥ïÔºå‰ªéÂª∂ËøüÊï∞ÊçÆÂ∫ìËøõË°åÊÅ¢Â§çÔºåÂ¶ÇÊûúÂª∂ËøüÊï∞ÊçÆÂ∫ì‰πüÂ∑≤ÁªèÊâßË°åÈÇ£Êù°SQL‰πü‰∏çÂèØÊÅ¢Â§ç</li>
<li>‰ΩøÁî®Êó•ÂøóÈó™ÂõûÊñπÂºèÔºàÊó•ÂøóÂøÖÈ°ªrowÊ†ºÂºèÔºâ</li>
</ul>
<h3 id="Êó•ÂøóÈó™Âõû">Êó•ÂøóÈó™Âõû</h3>
<p>‚Äã	binlog2sqlÊó•ÂøóÈó™ÂõûÂ∑•ÂÖ∑ÂèØ‰ª•Ëß£ÊûêÂá∫ÊâßË°åÁöÑSQLÊó†Ê≥ïÁîüÊàêÂèçÂêëSQL „ÄÇÁÑ∂ÂêéÂÜçÊ∏ÖÁ©∫‰∏öÂä°Ë°®ÔºåÈáçÊñ∞ÊâßË°åSQLÂç≥ÂèØÂÆåÊàêÊï∞ÊçÆÊÅ¢Â§ç„ÄÇ</p>
<p>ÂâçÁΩÆÊù°‰ª∂Ôºö</p>
<p>‚ë†ÂÅúÊéâÊï∞ÊçÆÂ∫ìËØªÂÜôÊìç‰Ωú</p>
<p>‚ë°ÁÉ≠Â§á‰ªΩÁé∞Êï∞ÊçÆÂ∫ìÔºàÂ∞ÜÂ§á‰ªΩÊñá‰ª∂Âú®ÂÖ∂ÂÆÉÊú∫Âô®‰∏äÂÆûÈ™åÈÄöËøáÔºâ</p>
<p>‚ë¢Ê∏ÖÁ©∫ÈúÄË¶ÅÊÅ¢Â§çÊï∞ÊçÆÁöÑ‰∏öÂä°Ë°®ÁöÑÂÖ®ÈÉ®ËÆ∞ÂΩïÔºåÈÅøÂÖçÂÜôÂÖ•ÂÜ≤Á™Å</p>
<p>Á¨¨‰∏ÄÊ≠•ÔºöÂÆâË£ÖÔºå<a href="https://github.com/danfengcao/binlog2sql">‰∏ãËΩΩÂú∞ÂùÄ</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ÂÆâË£ÖPIPÂ∑•ÂÖ∑</span>
</span></span><span style="display:flex;"><span>yum install -y python-pip;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">cd</span> binlog2sql-master;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pip install -r requirements.txt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∫åÊ≠•ÔºöÊü•ÊâæÊó•ÂøóÊñá‰ª∂</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">show</span><span style="color:#bbb"> </span>master<span style="color:#bbb"> </span>logs;<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∏âÊ≠•ÔºöËß£ÊûêÂá∫SQL</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#0086b3">cd</span> binlog2sql
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>python binlog2sql.py -u<span style="color:#000;font-weight:bold">[</span>user<span style="color:#000;font-weight:bold">]</span> -p<span style="color:#000;font-weight:bold">[</span>password<span style="color:#000;font-weight:bold">]</span> -d<span style="color:#000;font-weight:bold">[</span>database<span style="color:#000;font-weight:bold">]</span> -t <span style="color:#000;font-weight:bold">[</span>table<span style="color:#000;font-weight:bold">]</span> --start-file<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;[logfileName]&#39;</span> &gt; <span style="color:#000;font-weight:bold">[</span>/path/tableName.sql<span style="color:#000;font-weight:bold">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨ÂõõÊ≠•ÔºöÂà†Èô§Ëß£ÊûêÂá∫ÁöÑSQL‰∏≠‰∏çË¶ÅÁöÑËØ≠Âè•</p>
<p>Á¨¨‰∫îÊ≠•ÔºöÁõ¥Êé•ÊâßË°åSQL</p>
<h2 id="ÂçÅ‰∫î‰ºòÂåñÈô∑Èò±">ÂçÅ‰∫î„ÄÅ‰ºòÂåñÈô∑Èò±</h2>
<h3 id="mysqlÊï∞ÊçÆÂ∫ìËÆæËÆ°Â∏∏ÁäØÁöÑÈîô‰ª•ÂèäÂØπÊÄßËÉΩÁöÑÂΩ±Âìç">MySQLÊï∞ÊçÆÂ∫ìËÆæËÆ°Â∏∏ÁäØÁöÑÈîô‰ª•ÂèäÂØπÊÄßËÉΩÁöÑÂΩ±Âìç</h3>
<p>1ÔºâËøáÂàÜÁöÑÂèçËåÉÂºèÂåñ‰∏∫Ë°®Âª∫Á´ãÂ§™Â§öÁöÑÂàó</p>
<p>‚Äã	MysqlÁöÑÊúçÂä°Âô®Â±ÇÂíåÂ≠òÂÇ®ÂºïÊìéÂ±ÇÊòØÂàÜÁ¶ªÁöÑÔºåMysqlÁöÑÂ≠òÂÇ®ÂºïÊìéAPIÂ∑•‰ΩúÊó∂ÈúÄË¶ÅÊääÊúçÂä°Âô®Â±ÇÂíåÂ≠òÂÇ®ÂºïÊìéÂ±Ç‰πãÈó¥ÈÄöËøáÁºìÂÜ≤Ê†ºÂºèÊù•Êã∑Ë¥ùÊï∞ÊçÆÔºåÁÑ∂ÂêéÂú®ÊúçÂä°Âô®Â±ÇÂ∞ÜÁºìÂÜ≤Â±ÇÁöÑÊï∞ÊçÆËß£ÊûêÊàêÂêÑ‰∏™ÂàóÔºåËøô‰∏™Êìç‰ΩúËøáÁ®ãÊàêÊú¨ÊòØÈùûÂ∏∏È´òÁöÑÔºåÁâπÂà´ÊòØÂØπ‰∫éMyISAMÁöÑÂèòÈïøÁªìÊûÑÔºåÂíåInnodbËøôÁßçË°åÁªìÊûÑÂú®Ëß£ÊûêÊó∂ËøòÂøÖÈ°ªËøõË°åËΩ¨Êç¢ÔºåËøô‰∏™ËΩ¨Êç¢ÁöÑÊàêÊú¨Âë¢Â∞±‰æùËµñ‰∫éÂàóÁöÑÊï∞ÈáèÔºåÊâÄ‰ª•ÔºåÂ¶ÇÊûú‰∏Ä‰∏™Ë°®ÁöÑÂàóËøáÂ§öÔºåÂú®‰ΩøÁî®Ëøô‰∏™Ë°®Êó∂Â∞±‰ºöÂ∏¶Êù•È¢ùÂ§ñËøáÂ§öÁöÑcpuÊ∂àËÄó „ÄÇ</p>
<p>2ÔºâËøáÂàÜÁöÑ‰ΩøÁî®ËåÉÂºèÂåñËÆæËÆ°ÈÄ†Êàê‰∫ÜÂ§™Â§öÁöÑË°®ÂÖ≥ËÅî</p>
<p>‚Äã	 Âú®ËøõË°åÊï∞ÊçÆÂ∫ìËÆæËÆ°Êó∂ÂÄôË¶ÅËøõË°åÈÄÇÂΩìÁöÑÂèçËåÉÂºèÂåñËÆæËÆ°ÔºåÊääÁªèÂ∏∏‰ΩøÁî®ÁöÑ‰∏§‰∏™Â∞èË°®ÂêàÊàê‰∏Ä‰∏™Â§ßË°®ÔºåËøôÊ†∑ÂÅöÂØπÊèêÂçáÊï∞ÊçÆÂ∫ìÁöÑÊÄßËÉΩÂíåsqlÊü•ËØ¢ÁöÑÊÄßËÉΩÈÉΩÊòØ ÊúâÂ∏ÆÂä©ÁöÑ„ÄÇ</p>
<p>3ÔºâÂú®OLTPÁéØÂ¢É‰∏≠‰ΩøÁî®‰∏çÊÅ∞ÂΩìÁöÑÂàÜÂå∫Ë°®</p>
<p>‚Äã	 ÂàÜÂå∫Ë°®ÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨Êää‰∏Ä‰∏™Â§ßË°®Âú®Áâ©ÁêÜÂ≠òÂÇ®‰∏äÊåâÁÖßÂàÜÂå∫ÈîÆÂàÜÊàêÂ§ö‰∏™Â∞èË°®Ôºå‰ΩÜÊòØÂú®‰ΩøÁî®ÂàÜÂå∫Ë°®Êó∂ÔºåÂàÜÂå∫ÈîÆÁöÑÈÄâÊã©ÈùûÂ∏∏ÂÖ≥ÈîÆÔºåÂ¶ÇÊûúÂàÜÂå∫ÈîÆÁöÑÈÄâÊã©‰∏çÊÅ∞ÂΩìÔºåÂ∞±‰ºöÈÄ†ÊàêÊü•ËØ¢Êó∂Ë∑®Â§ö‰∏™ÂàÜÂå∫Êü•ËØ¢ÔºåËøôÊ†∑‰∏ç‰ªÖ‰∏ç‰ºöÊèêÂçáÊï∞ÊçÆÂ∫ìÁöÑÊÄßËÉΩÔºåËÄå‰∏îËøò‰ºöÈôç‰ΩéÊï∞ÊçÆÂ∫ìÁöÑÊü•ËØ¢ÊÄßËÉΩ„ÄÇ</p>
<p>4Ôºâ‰ΩøÁî®Â§ñÈîÆÁ∫¶Êùü‰øùËØÅ‰∫ãÂä°ÁöÑÂÆåÊï¥ÊÄß</p>
<p>‚Äã	 Â§ñÈîÆÁ∫¶ÊùüÊù•‰øùËØÅÊï∞ÊçÆÁöÑÂÆåÊï¥ÊÄßÔºå‰ΩÜÊòØËøôÊ†∑ÁöÑÊïàÁéáÊòØÈùûÂ∏∏‰ΩéÁöÑ„ÄÇ</p>

    </div>

    

    <div class="container-comment-giscus">
        <script src="https://giscus.app/client.js"
        data-repo="loveminimal/comment"
        data-repo-id="R_kgDOJNJQ8g"
        data-category="General"
        data-category-id="DIC_kwDOJNJQ8s4CYl0m"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="noborder_light"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
        </script>
</div>
</div>

        </div>
        <div id="footer"><div class="container-footer">
    

    <div class="beian">
        
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41092802000242">
            

        </a>

        
        <a href="//beian.miit.gov.cn" target="_blank">
            
            <span class="some">icp...<span>
            
        </a>
    </div>

    
    <div class="info">
        
        <a href="https://github.com/loveminimal/hugo-theme-virgo">üïäÔ∏è</a> 2016 - <span id="info-date"></span>
    </div>

</div></div>
        <div class="cool-after" style="
            
                background-color: rgba(255, 255, 255, 0.49); 
                backdrop-filter: saturate(100%) blur(6px);
            
            "></div>
    </body>
</html>
