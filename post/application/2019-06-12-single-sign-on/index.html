<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="å•ç‚¹ç™»é™† - https://hobocat.github.io/post/application/2019-06-12-single-sign-on/">
    <meta name="author" content="Jack - https://hobocat.github.io/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>å•ç‚¹ç™»é™†</title>
    
    <base target="_blank">
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    
    
    
    
    <link rel="stylesheet" href="https://hobocat.github.io/style.min.94e7ed14b48117025ebd1148adc11f7268f1ebf50d97297ac663edf1aa6f52dc.css">
    
    <script>const DARK =  false ;</script>
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div class="container-floating-box">
	<div class="box box1"></div>
	<div class="box box11"></div>
	<div class="box box12"></div>
	<div class="box box2"></div>
	<div class="box box3"></div>
	<div class="box box4"></div>
	<div class="box box5"></div>
	<div class="box box6"></div>
	<div class="box box7"></div>
	<div class="box box8"></div>
	<div class="box box9"></div>
</div>
        <div class="cool-before" style="background: url('/imgs/bg/wallhaven-6qr21l.jpg') left top/100% no-repeat fixed;"></div>
        <div id="header" class=""><div class="container-header">

    
    
    
    <div class="right">
        
        <h1 class="title">å•ç‚¹ç™»é™†</h1>
    
        
        
            <div id="toc">ğŸ“œ</div>
        
    </div>
</div>
</div>
        <div id="content">










<div class="container-main container-page ">

    

    
    
    
    

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="7409" width="12" height="12">
                <path
                    d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z"
                    p-id="7410" fill="#adb5bd"></path>
            </svg>
            2019-06-12&nbsp;&nbsp;&nbsp;
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="23838" width="11" height="11">
                <path
                    d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z"
                    p-id="23839" fill="#adb5bd"></path>
            </svg>
            2024-05-15&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="33866" width="12" height="12">
                <path
                    d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z"
                    fill="#adb5bd" p-id="33867"></path>
                <path
                    d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z"
                    fill="#adb5bd" p-id="33868"></path>
            </svg>
            5407 å­—</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="32892" width="12" height="12">
                <path
                    d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z"
                    p-id="32893" fill="#adb5bd"></path>
                <path
                    d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z"
                    p-id="32894" fill="#adb5bd"></path>
            </svg>
            11 åˆ†é’Ÿ</span>
        <div class="container-ctgtag">
	<div class="taxonomy">
		<div class="tag">
			
			
		</div>
	</div>
</div>
        
    </div>

    <div class="toc">
        <div class="container-page-operation">
	<div class="page-operation">
		<div><a href="/"><img src="/imgs/icons/home-2.svg" alt=""></a></div>
		<div><a href="/nav"><img src="/imgs/icons/iov-navigate-1.svg" alt=""></a></div>
		<div><a href="/wiki"><img src="/imgs/icons/wiki.svg" alt=""></a></div>
		<div><a href="/tags"><img src="/imgs/icons/treetags.svg" alt=""></a></div>
		<div id="light-dark"><a><img src="/imgs/icons/moon2.svg" alt=""></a></div>
		<div><a href="#"><img src="/imgs/icons/up2.svg" alt=""></a></div>
	</div>
</div>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#ä¸€ç®€ä»‹">ä¸€ã€ç®€ä»‹</a></li>
    <li><a href="#äºŒè·¨åŸŸè§£å†³æ–¹æ¡ˆ">äºŒã€è·¨åŸŸè§£å†³æ–¹æ¡ˆ</a>
      <ul>
        <li><a href="#åŸŸçš„æ¦‚å¿µ">åŸŸçš„æ¦‚å¿µ</a></li>
        <li><a href="#è·¨åŸŸæ¦‚å¿µ">è·¨åŸŸæ¦‚å¿µ</a></li>
        <li><a href="#sessionè·¨åŸŸ">Sessionè·¨åŸŸ</a></li>
        <li><a href="#å…·ä½“é€»è¾‘">å…·ä½“é€»è¾‘</a></li>
      </ul>
    </li>
    <li><a href="#ä¸‰ä¿¡æ¯å…±äº«è§£å†³æ–¹æ¡ˆ">ä¸‰ã€ä¿¡æ¯å…±äº«è§£å†³æ–¹æ¡ˆ</a>
      <ul>
        <li><a href="#spring-session">Spring-session</a></li>
        <li><a href="#nginx-sessionå…±äº«">Nginx Sessionå…±äº«</a></li>
      </ul>
    </li>
    <li><a href="#å››tokenå•ç‚¹ç™»é™†æœºåˆ¶">å››ã€Tokenå•ç‚¹ç™»é™†æœºåˆ¶</a>
      <ul>
        <li><a href="#ä¼ ç»Ÿèº«ä»½è®¤è¯åŸºäºcookie">ä¼ ç»Ÿèº«ä»½è®¤è¯ã€åŸºäºcookieã€‘</a></li>
        <li><a href="#tokenèº«ä»½è®¤è¯">Tokenèº«ä»½è®¤è¯</a></li>
      </ul>
    </li>
    <li><a href="#äº”json-web-tokenjwtæœºåˆ¶">äº”ã€JSON Web Tokenï¼ˆJWTï¼‰æœºåˆ¶</a>
      <ul>
        <li><a href="#jwtæ•°æ®ç»“æ„">JWTæ•°æ®ç»“æ„</a></li>
        <li><a href="#tokenä¿å­˜ä½ç½®">tokenä¿å­˜ä½ç½®</a></li>
        <li><a href="#jwtæ‰§è¡Œæµç¨‹">JWTæ‰§è¡Œæµç¨‹</a></li>
        <li><a href="#jwtåº”ç”¨ç¤ºä¾‹">JWTåº”ç”¨ç¤ºä¾‹</a></li>
        <li><a href="#jwtå•ç‚¹ç™»é™†ä½¿ç”¨æ³¨æ„ç‚¹">JWTå•ç‚¹ç™»é™†ä½¿ç”¨æ³¨æ„ç‚¹</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div class='content  '>
        <h2 id="ä¸€ç®€ä»‹">ä¸€ã€ç®€ä»‹</h2>
<p><strong>å•ç‚¹ç™»é™†</strong>ï¼šåœ¨å¤šç³»ç»Ÿä¸­å•ä¸€ä½ç½®ç™»å½•å¯ä»¥å®ç°å¤šç³»ç»ŸåŒæ—¶ç™»å½•çš„ä¸€ç§æŠ€æœ¯ã€‚å¸¸åœ¨äº’è”ç½‘åº”ç”¨å’Œä¼ä¸šçº§å¹³å°ä¸­ä½¿ç”¨ã€‚</p>
<p><strong>ç¬¬ä¸‰æ–¹ç™»é™†</strong>ï¼šåœ¨æŸç³»ç»Ÿä¸­ä½¿ç”¨å…¶ä»–ç³»ç»Ÿçš„ç”¨æˆ·å®ç°æœ¬ç³»ç»Ÿç™»å½•çš„æ–¹å¼ã€‚å¦‚ï¼Œåœ¨äº¬ä¸œä¸­ä½¿ç”¨å¾®ä¿¡ç™»å½•ã€‚è§£å†³ä¿¡æ¯å­¤å²›å’Œç”¨æˆ·ä¸å¯¹ç­‰çš„å®ç°æ–¹æ¡ˆã€‚</p>
<p><strong>å•ç‚¹ç™»é™†éœ€è¦è§£å†³çš„é—®é¢˜</strong>ï¼šæ•°æ®è·¨åŸŸã€ä¿¡æ¯å…±äº«å’Œå®‰å…¨ã€‚</p>
<h2 id="äºŒè·¨åŸŸè§£å†³æ–¹æ¡ˆ">äºŒã€è·¨åŸŸè§£å†³æ–¹æ¡ˆ</h2>
<h3 id="åŸŸçš„æ¦‚å¿µ">åŸŸçš„æ¦‚å¿µ</h3>
<p>â€‹	åœ¨åº”ç”¨æ¨¡å‹ä¸­ä¸€ä¸ªå®Œæ•´çš„ï¼Œæœ‰ç‹¬ç«‹è®¿é—®è·¯å¾„çš„åŠŸèƒ½é›†åˆç§°ä¸ºä¸€ä¸ªåŸŸã€‚å¦‚ï¼šç™¾åº¦ç§°ä¸ºä¸€ä¸ªåº”ç”¨æˆ–ç³»ç»Ÿã€‚ç™¾åº¦æœ‰è‹¥å¹²çš„åŸŸï¼Œå¦‚ï¼šæœç´¢å¼•æ“ã€www.baidu.comã€‘ï¼Œç™¾åº¦è´´å§ã€tie.baidu.comã€‘ï¼Œç™¾åº¦çŸ¥é“ã€zhidao.baidu.comã€‘ï¼Œç™¾åº¦åœ°å›¾ã€map.baidu.comã€‘ç­‰ã€‚åŸŸä¿¡æ¯ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸ºå¤šçº§åŸŸåã€‚åŸŸçš„åˆ’åˆ†ï¼šä»¥IPï¼Œç«¯å£ï¼ŒåŸŸåï¼Œä¸»æœºåä¸ºæ ‡å‡†ï¼Œå®ç°åˆ’åˆ†ã€‚</p>
<h3 id="è·¨åŸŸæ¦‚å¿µ">è·¨åŸŸæ¦‚å¿µ</h3>
<p>å®¢æˆ·ç«¯è¯·æ±‚çš„æ—¶å€™ï¼Œè¯·æ±‚çš„æœåŠ¡å™¨ï¼Œä¸æ˜¯åŒä¸€ä¸ªIPï¼Œç«¯å£ï¼ŒåŸŸåï¼Œä¸»æœºåçš„æ—¶å€™ï¼Œéƒ½ç§°ä¸ºè·¨åŸŸã€‚</p>
<p>å¦‚ï¼šlocalhostå’Œ127.0.0.1ä¹Ÿå±äºè·¨åŸŸ</p>
<h3 id="sessionè·¨åŸŸ">Sessionè·¨åŸŸ</h3>
<p>â€‹	æ‰€è°“Sessionè·¨åŸŸå°±æ˜¯æ‘’å¼ƒäº†ç³»ç»Ÿï¼ˆwebå®¹å™¨ï¼‰æä¾›çš„Sessionï¼Œè€Œä½¿ç”¨è‡ªå®šä¹‰çš„ç±»ä¼¼Sessionçš„æœºåˆ¶æ¥ä¿å­˜å®¢æˆ·ç«¯æ•°æ®çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚å¦‚ï¼šé€šè¿‡è®¾ç½®cookieçš„domainæ¥å®ç°cookieçš„è·¨åŸŸä¼ é€’ã€‚åœ¨cookieä¸­ä¼ é€’ä¸€ä¸ªè‡ªå®šä¹‰çš„session_idã€‚è¿™ä¸ªsession_idæ˜¯å®¢æˆ·ç«¯çš„å”¯ä¸€æ ‡è®°ã€‚å°†è¿™ä¸ªæ ‡è®°ä½œä¸ºkeyï¼Œå°†å®¢æˆ·ç«¯éœ€è¦ä¿å­˜çš„æ•°æ®ä½œä¸ºvalueï¼Œåœ¨æœåŠ¡ç«¯è¿›è¡Œä¿å­˜ã€‚è¿™ç§æœºåˆ¶å°±æ˜¯Sessionçš„è·¨åŸŸè§£å†³ã€‚</p>
<h3 id="å…·ä½“é€»è¾‘">å…·ä½“é€»è¾‘</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- é…ç½®è·¨åŸŸè¯·æ±‚ --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;filter&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;filter-name&gt;</span>corsFilter<span style="color:#000080">&lt;/filter-name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;filter-class&gt;</span>com.thetransactioncompany.cors.CORSFilter<span style="color:#000080">&lt;/filter-class&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;init-param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-name&gt;</span>cors.allowOrigin<span style="color:#000080">&lt;/param-name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-value&gt;</span>*<span style="color:#000080">&lt;/param-value&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/init-param&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;init-param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-name&gt;</span>cors.supportedMethods<span style="color:#000080">&lt;/param-name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-value&gt;</span>GET, POST, HEAD, PUT, DELETE<span style="color:#000080">&lt;/param-value&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/init-param&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;init-param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-name&gt;</span>cors.supportedHeaders<span style="color:#000080">&lt;/param-name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-value&gt;</span>Accept, Origin, X-Requested-With, Content-Type, Last-Modified<span style="color:#000080">&lt;/param-value&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/init-param&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;init-param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-name&gt;</span>cors.exposedHeaders<span style="color:#000080">&lt;/param-name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-value&gt;</span>Set-Cookie<span style="color:#000080">&lt;/param-value&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/init-param&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;init-param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-name&gt;</span>cors.supportsCredentials<span style="color:#000080">&lt;/param-name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-value&gt;</span>true<span style="color:#000080">&lt;/param-value&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/init-param&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;filter-mapping&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;filter-name&gt;</span>corsFilter<span style="color:#000080">&lt;/filter-name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;url-pattern&gt;</span>/*<span style="color:#000080">&lt;/url-pattern&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/filter-mapping&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- è®¾ç½®tokençš„Servlet --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;servlet&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;servlet-name&gt;</span>corssServlet<span style="color:#000080">&lt;/servlet-name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;servlet-class&gt;</span>com.kun.CorssServlet<span style="color:#000080">&lt;/servlet-class&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/servlet&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;servlet-mapping&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;servlet-name&gt;</span>corssServlet<span style="color:#000080">&lt;/servlet-name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;url-pattern&gt;</span>/corss<span style="color:#000080">&lt;/url-pattern&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">CorssServlet</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">extends</span><span style="color:#bbb"> </span>HttpServlet<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#3c5d5d;font-weight:bold">@Override</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000;font-weight:bold">protected</span><span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">void</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">doGet</span>(HttpServletRequest<span style="color:#bbb"> </span>req,<span style="color:#bbb"> </span>HttpServletResponse<span style="color:#bbb"> </span>resp)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">throws</span><span style="color:#bbb"> </span>ServletException,<span style="color:#bbb"> </span>IOException<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Cookie<span style="color:#000;font-weight:bold">[]</span><span style="color:#bbb"> </span>cookies<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>req.<span style="color:#008080">getCookies</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>PrintWriter<span style="color:#bbb"> </span>writer<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>resp.<span style="color:#008080">getWriter</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">//å¦‚æœå·²ç»å­˜åœ¨Cookieåˆ™æŸ¥çœ‹Cookieå€¼</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#458;font-weight:bold">boolean</span><span style="color:#bbb"> </span>findAuth<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">false</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000;font-weight:bold">if</span>(cookies<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">!=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">null</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>(Cookie<span style="color:#bbb"> </span>cookie<span style="color:#bbb"> </span>:<span style="color:#bbb"> </span>cookies)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000;font-weight:bold">if</span>(cookie.<span style="color:#008080">getName</span>().<span style="color:#008080">equals</span>(<span style="color:#d14">&#34;Auth&#34;</span>)){<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span>findAuth<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">true</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span>writer.<span style="color:#008080">println</span>(cookie.<span style="color:#008080">getName</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span>writer.<span style="color:#008080">println</span>(cookie.<span style="color:#008080">getValue</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span>writer.<span style="color:#008080">println</span>(cookie.<span style="color:#008080">getMaxAge</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">//ç”Ÿæˆcookieï¼Œæ³¨æ„domainçš„åŸŸï¼Œåº”è¯¥ç”¨ä»£ç æ™ºèƒ½åˆ‡åˆ†</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">//å¦‚www.baidu.com,tie.baidu.comå‡è®¾ç½®ä¸º.baidu.com</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000;font-weight:bold">if</span>(<span style="color:#000;font-weight:bold">!</span>findAuth)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>String<span style="color:#bbb"> </span>token<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>UUID.<span style="color:#008080">randomUUID</span>().<span style="color:#008080">toString</span>().<span style="color:#008080">replace</span>(<span style="color:#d14">&#34;-&#34;</span>,<span style="color:#bbb"> </span><span style="color:#d14">&#34;&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>Cookie<span style="color:#bbb"> </span>authCookie<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>Cookie(<span style="color:#d14">&#34;Auth&#34;</span>,<span style="color:#bbb"> </span>token);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>authCookie.<span style="color:#008080">setPath</span>(<span style="color:#d14">&#34;/&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>authCookie.<span style="color:#008080">setDomain</span>(<span style="color:#d14">&#34;.kun.com&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>resp.<span style="color:#008080">addCookie</span>(authCookie);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ä¸‰ä¿¡æ¯å…±äº«è§£å†³æ–¹æ¡ˆ">ä¸‰ã€ä¿¡æ¯å…±äº«è§£å†³æ–¹æ¡ˆ</h2>
<h3 id="spring-session">Spring-session</h3>
<p>â€‹	spring-sessionæŠ€æœ¯æ˜¯springæä¾›çš„ç”¨äºå¤„ç†é›†ç¾¤ä¼šè¯å…±äº«çš„è§£å†³æ–¹æ¡ˆã€‚spring-sessionæŠ€æœ¯æ˜¯å°†ç”¨æˆ·sessionæ•°æ®ä¿å­˜åˆ°ä¸‰æ–¹å­˜å‚¨å®¹å™¨ä¸­ï¼Œå¦‚ï¼šmysqlï¼Œredisç­‰</p>
<p>â€‹	spring-sessionæŠ€æœ¯æ˜¯è§£å†³åŒåŸŸåä¸‹çš„å¤šæœåŠ¡å™¨é›†ç¾¤sessionå…±äº«é—®é¢˜çš„ã€‚ä¸èƒ½ç›´æ¥è§£å†³è·¨åŸŸsessionå…±äº«é—®é¢˜ã€‚</p>
<p>éœ€è¦è®¾ç½®å…¶å®ƒé€‰é¡¹ã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå¯¼å…¥ä¾èµ–</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;groupId&gt;</span>redis.clients<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;artifactId&gt;</span>jedis<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;version&gt;</span>ç‰ˆæœ¬å·<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;groupId&gt;</span>javax.servlet<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;artifactId&gt;</span>javax.servlet-api<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;version&gt;</span>ç‰ˆæœ¬å·<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;scope&gt;</span>provided<span style="color:#000080">&lt;/scope&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;groupId&gt;</span>org.springframework.session<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;artifactId&gt;</span>spring-session-data-redis<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;version&gt;</span>ç‰ˆæœ¬å·<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;groupId&gt;</span>org.springframework.session<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;artifactId&gt;</span>spring-session<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;version&gt;</span>ç‰ˆæœ¬å·<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;groupId&gt;</span>org.springframework<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;artifactId&gt;</span>spring-webmvc<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;version&gt;</span>ç‰ˆæœ¬å·<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬äºŒæ­¥ï¼šweb.xmlé…ç½®</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- Sessionè®¾ç½®ä»£ç†è¿‡æ»¤å™¨ --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;filter&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span style="color:#000080">&lt;/filter-name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span style="color:#000080">&lt;/filter-class&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/filter&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;filter-mapping&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;filter-name&gt;</span>springSessionRepositoryFilter<span style="color:#000080">&lt;/filter-name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;url-pattern&gt;</span>/*<span style="color:#000080">&lt;/url-pattern&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/filter-mapping&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;listener&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span style="color:#000080">&lt;/listener-class&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/listener&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;context-param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-name&gt;</span>contextConfigLocation<span style="color:#000080">&lt;/param-name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;param-value&gt;</span>classpath*:/spring-redis.xml<span style="color:#000080">&lt;/param-value&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/context-param&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;servlet&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;servlet-name&gt;</span>Dispatcher<span style="color:#000080">&lt;/servlet-name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span style="color:#000080">&lt;/servlet-class&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;init-param&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;param-name&gt;</span>contextConfigLocation<span style="color:#000080">&lt;/param-name&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;param-value&gt;</span>classpath*:/spring-mvc.xml<span style="color:#000080">&lt;/param-value&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/init-param&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;load-on-startup&gt;</span>1<span style="color:#000080">&lt;/load-on-startup&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/servlet&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;servlet-mapping&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;servlet-name&gt;</span>Dispatcher<span style="color:#000080">&lt;/servlet-name&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;url-pattern&gt;</span>/<span style="color:#000080">&lt;/url-pattern&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/servlet-mapping&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ç¬¬ä¸‰æ­¥ï¼šspring-mvcï¼Œspring-redisé…ç½®</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- spring-mvcé…ç½® --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;context:component-scan</span> <span style="color:#008080">base-package=</span><span style="color:#d14">&#34;com.kun.controller&#34;</span> <span style="color:#008080">use-default-filters=</span><span style="color:#d14">&#34;false&#34;</span> <span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;context:include-filter</span> <span style="color:#008080">type=</span><span style="color:#d14">&#34;annotation&#34;</span> <span style="color:#008080">expression=</span><span style="color:#d14">&#34;org.springframework.stereotype.Controller&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/context:component-scan&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;mvc:annotation-driven/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;mvc:default-servlet-handler/&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- spring-redisé…ç½® --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;context:component-scan</span> <span style="color:#008080">base-package=</span><span style="color:#d14">&#34;com.kun&#34;</span> <span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;context:exclude-filter</span> <span style="color:#008080">type=</span><span style="color:#d14">&#34;annotation&#34;</span> <span style="color:#008080">expression=</span><span style="color:#d14">&#34;org.springframework.stereotype.Controller&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/context:component-scan&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;bean</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;poolConfig&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;redis.clients.jedis.JedisPoolConfig&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;maxIdle&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;300&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;maxWaitMillis&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;1000&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;testOnBorrow&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;true&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/bean&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;context:component-scan</span> <span style="color:#008080">base-package=</span><span style="color:#d14">&#34;org.springframework.web.filter&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- æ·»åŠ RedisHttpSessionConfigurationç”¨äºsessionå…±äº« --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;bean</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;redisHttpSessionConfiguration&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;org.springframework.session.data.redis.config.annotation.web.http.RedisHttpSessionConfiguration&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;maxInactiveIntervalInSeconds&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;18000&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;cookieSerializer&#34;</span> <span style="color:#008080">ref=</span><span style="color:#d14">&#34;defaultCookieSerializer&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/bean&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- è®¾ç½®Cookie domainçš„åç§°ï¼Œå¦‚æœä¸è®¾ç½®å°†æ— æ³•è·¨åŸŸ --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;bean</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;defaultCookieSerializer&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;org.springframework.session.web.http.DefaultCookieSerializer&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;domainName&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;.kun.com&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;cookieName&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;SESSION&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;cookiePath&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;/&#34;</span> <span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/bean&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;bean</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;jedisConnectionFactory&#34;</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;org.springframework.data.redis.connection.jedis.JedisConnectionFactory&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;hostName&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;192.168.1.158&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;port&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;6379&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;poolConfig&#34;</span> <span style="color:#008080">ref=</span><span style="color:#d14">&#34;poolConfig&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;usePool&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;true&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;timeout&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;3000&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Spring-sessionè§£å†³è·¨åŸŸä¿®æ”¹webå®¹å™¨æ–¹æ¡ˆ</strong></p>
<p>â€‹	é»˜è®¤sessionå­˜æ”¾åœ¨å½“å‰åŸŸä¸‹ï¼Œå¦‚è®¿é—®www.kun.comçš„sessionçš„domainä¸ºwww.kun.comï¼Œè®¿é—®pps.kun.comçš„sessionçš„domainä¸ºpps.kun.comã€‚sessionå› ä¸ºdomainä¸åŒæ‰€ä»¥sessionå¹¶ä¸èƒ½è·¨åŸŸã€‚</p>
<p>â€‹	è§£å†³æ–¹æ¡ˆï¼šåœ¨webç›®å½•ä¸‹ï¼Œåˆ›å»ºå’ŒWEB-INFåŒçº§çš„META-INFç›®å½•ï¼Œå¹¶åˆ›å»º<code>context.xml</code>æ–‡ä»¶ï¼Œå°†ä»¥ä¸‹å†…å®¹å†™å…¥å³å¯æ”¹å˜sessionçš„domainå®ç°è·¨åŸŸè®¿é—®ã€‚</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- è®¾ç½®ä¸»åŸŸåä¸å­åŸŸåsessionidä¸€è‡´ --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;Context</span>  <span style="color:#008080">sessionCookiePath=</span><span style="color:#d14">&#34;/&#34;</span> <span style="color:#008080">sessionCookieDomain=</span><span style="color:#d14">&#34;.kun.com&#34;</span><span style="color:#000080">/&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="nginx-sessionå…±äº«">Nginx Sessionå…±äº«</h3>
<p>â€‹	nginxä¸­çš„ip_hashæŠ€æœ¯èƒ½å¤Ÿå°†æŸä¸ªipçš„è¯·æ±‚å®šå‘åˆ°åŒä¸€å°åç«¯ï¼Œè¿™æ ·ä¸€æ¥è¿™ä¸ªipä¸‹çš„æŸä¸ªå®¢æˆ·ç«¯å’ŒæŸä¸ªåç«¯å°±èƒ½å»ºç«‹èµ·ç¨³å›ºçš„sessionï¼Œip_hashæ˜¯åœ¨upstreamé…ç½®ä¸­å®šä¹‰çš„ï¼Œå¦‚ä¸‹ç¤ºä¾‹</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nginx" data-lang="nginx"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># è®¾ç½®ä¸ºip_hashç­–ç•¥ï¼Œæˆ–è€…è‡ªå®šä¹‰hashç­–ç•¥ã€ç»è¿‡ä»£ç†çš„ä¸å¯è®¾ä¸ºip_hashç­–ç•¥ã€‘
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">upstream</span> <span style="color:#d14">nginx.app.com</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server</span> www.kun.com:<span style="color:#099">8080</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">server</span> pps.kun.com:<span style="color:#099">8080</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">ip_hash</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic"># hash $remote_add; ä½¿ç”¨è‡ªå®šä¹‰hashç­–ç•¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">server</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">listen</span> <span style="color:#099">80</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">location</span> <span style="color:#d14">/</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_pass</span> <span style="color:#d14">http://nginx.app.com</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_set_header</span> <span style="color:#d14">Host</span>  <span style="color:#008080">$http_host</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_set_header</span> <span style="color:#d14">Cookie</span> <span style="color:#008080">$http_cookie</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_set_header</span> <span style="color:#d14">X-Real-IP</span> <span style="color:#008080">$remote_addr</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">proxy_set_header</span> <span style="color:#d14">X-Forwarded-For</span> <span style="color:#008080">$proxy_add_x_forwarded_for</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">client_max_body_size</span>  <span style="color:#099">100m</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å››tokenå•ç‚¹ç™»é™†æœºåˆ¶">å››ã€Tokenå•ç‚¹ç™»é™†æœºåˆ¶</h2>
<h3 id="ä¼ ç»Ÿèº«ä»½è®¤è¯åŸºäºcookie">ä¼ ç»Ÿèº«ä»½è®¤è¯ã€åŸºäºcookieã€‘</h3>
<p>å®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·åè¿˜æœ‰å¯†ç é€šè¿‡äº†èº«ä»½éªŒè¯ï¼Œä¸è¿‡ä¸‹å›è¿™ä¸ªå®¢æˆ·ç«¯å†å‘é€è¯·æ±‚æ—¶å€™å› ä¸ºHTTP æ˜¯ä¸€ç§æ²¡æœ‰çŠ¶æ€çš„åè®®ï¼Œè¿˜å¾—å†éªŒè¯ä¸€ä¸‹ã€‚</p>
<p>è§£å†³çš„æ–¹æ³•æ˜¯ï¼Œå½“ç”¨æˆ·è¯·æ±‚ç™»å½•çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨æœåŠ¡ç«¯ç”Ÿæˆä¸€æ¡è®°å½•ï¼Œè¿™ä¸ªè®°å½•é‡Œå­˜å‚¨äº†ç™»å½•çš„ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åæŠŠè¿™æ¡è®°å½•çš„IDå·è¿”ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯æ”¶åˆ°ä»¥åæŠŠè¿™ä¸ª ID å·å­˜å‚¨åœ¨ Cookie é‡Œï¼Œä¸‹æ¬¡è¿™ä¸ªç”¨æˆ·å†å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œå¯ä»¥å¸¦ç€è¿™ä¸ª Cookie ï¼Œè¿™æ ·æœåŠ¡ç«¯ä¼šéªŒè¯ä¸€ä¸ªè¿™ä¸ª Cookie é‡Œçš„ä¿¡æ¯ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½åœ¨æœåŠ¡ç«¯è¿™é‡Œæ‰¾åˆ°å¯¹åº”çš„è®°å½•ï¼Œå¦‚æœå¯ä»¥ï¼Œè¯´æ˜ç”¨æˆ·å·²ç»é€šè¿‡äº†èº«ä»½éªŒè¯ï¼Œå°±æŠŠç”¨æˆ·è¯·æ±‚çš„æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>
<p><strong>è¿™ç§è®¤è¯ä¸­å‡ºç°çš„é—®é¢˜æ˜¯</strong>ï¼š</p>
<ul>
<li>
<p>ä¼šè¯å­˜å‚¨ï¼šæ¯æ¬¡è®¤è¯ç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨éœ€è¦å»åˆ›å»ºä¸€ä¸ªè®°å½•æ¥å­˜å‚¨ä¿¡æ¯ã€‚å½“è¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·å‘è¯·æ±‚æ—¶ï¼Œå†…å­˜çš„å¼€é”€ä¹Ÿä¼šä¸æ–­å¢åŠ ã€‚</p>
</li>
<li>
<p>å¯æ‰©å±•æ€§ï¼šå¦‚æœåœ¨æœåŠ¡ç«¯çš„å†…å­˜ã€ä¸å€ŸåŠ©redisç­‰ã€‘ä¸­å­˜å‚¨ç™»å½•ä¿¡æ¯ï¼Œä¼´éšè€Œæ¥çš„æ˜¯å¯æ‰©å±•æ€§é—®é¢˜ã€‚å¦‚Tokenéœ€è¦åŒæ­¥ã€‚</p>
</li>
<li>
<p>CORS(è·¨åŸŸèµ„æºå…±äº«)ï¼šå¦‚æœè®©æ•°æ®è·¨å¤šå°ç§»åŠ¨è®¾å¤‡ä¸Šä½¿ç”¨æ—¶ï¼Œè·¨åŸŸèµ„æºçš„å…±äº«æ˜¯ä¸ªé—®é¢˜ã€‚åœ¨ä½¿ç”¨AjaxæŠ“å–å¦ä¸€ä¸ªåŸŸçš„èµ„æºï¼Œå°±å¯ä»¥ä¼šå‡ºç°ç¦æ­¢è¯·æ±‚çš„æƒ…å†µã€‚</p>
</li>
<li>
<p>CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )ï¼šç”¨æˆ·åœ¨è®¿é—®é“¶è¡Œç½‘ç«™æ—¶ï¼Œå¯èƒ½è¢«åˆ©ç”¨å…¶è®¿é—®å…¶ä»–çš„ç½‘ç«™ã€‚</p>
</li>
</ul>
<h3 id="tokenèº«ä»½è®¤è¯">Tokenèº«ä»½è®¤è¯</h3>
<p>ä½¿ç”¨åŸºäº Token çš„èº«ä»½éªŒè¯æ–¹æ³•ï¼Œåœ¨æœåŠ¡ç«¯éœ€è¦å­˜å‚¨ç”¨æˆ·çš„ç™»å½•è®°å½•ã€‚å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>å®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·åã€å¯†ç è¯·æ±‚ç™»å½•</li>
<li>æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚ï¼ŒéªŒè¯ç”¨æˆ·åã€å¯†ç </li>
<li>éªŒè¯æˆåŠŸåï¼ŒæœåŠ¡ç«¯ä¼šç­¾å‘ä¸€ä¸ªTokenï¼Œå†æŠŠè¿™ä¸ªTokenå‘é€ç»™å®¢æˆ·ç«¯</li>
<li>å®¢æˆ·ç«¯æ”¶åˆ° Token ä»¥åå¯ä»¥æŠŠå®ƒå­˜å‚¨èµ·æ¥ï¼Œæ¯”å¦‚æ”¾åœ¨Cookieé‡Œæˆ–è€…Local Storageæˆ–Session Storageé‡Œ</li>
<li>å®¢æˆ·ç«¯æ¯æ¬¡å‘æœåŠ¡ç«¯è¯·æ±‚èµ„æºæ—¶è¯·æ±‚å¤´éœ€è¦å¸¦ç€æœåŠ¡ç«¯ç­¾å‘çš„Token</li>
<li>æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åéªŒè¯å®¢æˆ·ç«¯è¯·æ±‚é‡Œé¢å¸¦ç€çš„Tokenï¼Œå¦‚æœéªŒè¯æˆåŠŸï¼Œå°±å‘å®¢æˆ·ç«¯è¿”å›è¯·æ±‚çš„æ•°æ®</li>
</ol>
<p>ä½¿ç”¨TokenéªŒè¯çš„ä¼˜åŠ¿ï¼š</p>
<p>æ— çŠ¶æ€ã€å¯æ‰©å±•ã€‚åœ¨å®¢æˆ·ç«¯å­˜å‚¨çš„Tokensæ˜¯æ— çŠ¶æ€çš„ï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«æ‰©å±•ã€‚åŸºäºè¿™ç§æ— çŠ¶æ€å’ŒæœåŠ¡ç«¯ä¸å­˜å‚¨Sessionä¿¡æ¯ï¼Œè´Ÿè½½è´Ÿè½½å‡è¡¡å™¨èƒ½å¤Ÿå°†ç”¨æˆ·ä¿¡æ¯ä»ä¸€ä¸ªæœåŠ¡ä¼ åˆ°å…¶ä»–æœåŠ¡å™¨ä¸Šã€‚</p>
<p>å®‰å…¨æ€§ã€‚è¯·æ±‚ä¸­å‘é€tokenè€Œä¸å†æ˜¯å‘é€cookieèƒ½å¤Ÿé˜²æ­¢CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )ã€‚å³ä½¿åœ¨å®¢æˆ·ç«¯ä½¿ç”¨cookieå­˜å‚¨tokenï¼Œcookieä¹Ÿä»…ä»…æ˜¯ä¸€ä¸ªå­˜å‚¨æœºåˆ¶è€Œä¸æ˜¯ç”¨äºè®¤è¯ã€‚ä¸å°†ä¿¡æ¯å­˜å‚¨åœ¨Sessionä¸­ï¼Œè®©æˆ‘ä»¬å°‘äº†å¯¹sessionæ“ä½œã€‚</p>
<h2 id="äº”json-web-tokenjwtæœºåˆ¶">äº”ã€JSON Web Tokenï¼ˆJWTï¼‰æœºåˆ¶</h2>
<p>â€‹	JWTæ˜¯ä¸€ç§ç´§å‡‘ä¸”è‡ªåŒ…å«çš„ï¼Œç”¨äºåœ¨å¤šæ–¹ä¼ é€’JSONå¯¹è±¡çš„æŠ€æœ¯ã€‚ä¼ é€’çš„æ•°æ®å¯ä»¥ä½¿ç”¨æ•°å­—ç­¾åå¢åŠ å…¶å®‰å…¨è¡Œã€‚å¯ä»¥ä½¿ç”¨HMACåŠ å¯†ç®—æ³•æˆ–RSAå…¬é’¥/ç§é’¥åŠ å¯†æ–¹å¼ã€‚</p>
<p><strong>ç´§å‡‘</strong>ï¼šæ•°æ®å°ï¼Œå¯ä»¥é€šè¿‡URLï¼ŒPOSTå‚æ•°ï¼Œè¯·æ±‚å¤´å‘é€ã€‚ä¸”æ•°æ®å°ä»£è¡¨ä¼ è¾“é€Ÿåº¦å¿«ã€‚</p>
<p><strong>è‡ªåŒ…å«</strong>ï¼šä½¿ç”¨payloadæ•°æ®å—è®°å½•ç”¨æˆ·å¿…è¦ä¸”ä¸éšç§çš„æ•°æ®ï¼Œå¯ä»¥æœ‰æ•ˆçš„å‡å°‘æ•°æ®åº“è®¿é—®æ¬¡æ•°ï¼Œæé«˜ä»£ç æ€§èƒ½ã€‚</p>
<hr>
<p>JWTä¸€èˆ¬ç”¨äºå¤„ç†ç”¨æˆ·èº«ä»½éªŒè¯æˆ–æ•°æ®ä¿¡æ¯äº¤æ¢ã€‚</p>
<p><strong>ç”¨æˆ·èº«ä»½éªŒè¯</strong>ï¼šä¸€æ—¦ç”¨æˆ·ç™»å½•ï¼Œæ¯ä¸ªåç»­è¯·æ±‚éƒ½å°†åŒ…å«JWTï¼Œå…è®¸ç”¨æˆ·è®¿é—®è¯¥ä»¤ç‰Œå…è®¸çš„è·¯ç”±ï¼ŒæœåŠ¡å’Œèµ„æºã€‚å•ç‚¹ç™»å½•æ˜¯å½“ä»Šå¹¿æ³›ä½¿ç”¨JWTçš„ä¸€é¡¹åŠŸèƒ½ï¼Œå› ä¸ºå®ƒçš„å¼€é”€å¾ˆå°ï¼Œå¹¶ä¸”èƒ½å¤Ÿè½»æ¾åœ°è·¨ä¸åŒåŸŸä½¿ç”¨ã€‚</p>
<p><strong>æ•°æ®ä¿¡æ¯äº¤æ¢</strong>ï¼šJWTæ˜¯ä¸€ç§éå¸¸æ–¹ä¾¿çš„å¤šæ–¹ä¼ é€’æ•°æ®çš„è½½ä½“ï¼Œå› ä¸ºå¯ä»¥ä¿è¯æ•°æ®çš„æœ‰æ•ˆæ€§å’Œå®‰å…¨æ€§ã€‚</p>
<h3 id="jwtæ•°æ®ç»“æ„">JWTæ•°æ®ç»“æ„</h3>
<p>JSON Web Tokenç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå®ƒä»¬ä¹‹é—´ç”¨åœ†ç‚¹(.)è¿æ¥ã€‚è¿™ä¸‰éƒ¨åˆ†åˆ†åˆ«æ˜¯ï¼š</p>
<ul>
<li>
<p>Header</p>
<p>headerç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼štokençš„ç±»å‹ï¼ˆâ€œJWTâ€ï¼‰å’Œç®—æ³•åç§°ï¼ˆæ¯”å¦‚ï¼šHMAC SHA256æˆ–è€…RSAç­‰ç­‰ï¼‰ï¼Œå¦‚</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;alg&#34;</span>: <span style="color:#d14">&#34;HS256&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&#34;type&#34;</span>: <span style="color:#d14">&#34;JWT&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Payload</p>
<p>åŒ…å«å£°æ˜ï¼Œå£°æ˜æœ‰ä¸‰ç§ç±»å‹: registered, public å’Œ privateã€‚</p>
<ul>
<li>Registered claims : è¿™é‡Œæœ‰ä¸€ç»„é¢„å®šä¹‰çš„å£°æ˜ï¼Œå®ƒä»¬ä¸æ˜¯å¼ºåˆ¶çš„ã€‚å¦‚ï¼šiss (å‘è¡Œè€…), exp (è¿‡æœŸæ—¶é—´), sub (ä¸»é¢˜), aud (å—ä¼—)ç­‰ã€‚</li>
<li>Public claims : å¯ä»¥éšæ„å®šä¹‰ã€‚ä¸€èˆ¬éƒ½ä¼šåœ¨JWTæ³¨å†Œè¡¨ä¸­å¢åŠ å®šä¹‰ã€‚é¿å…å’Œå·²æ³¨å†Œä¿¡æ¯å†²çªã€‚</li>
<li>Private claims : ç”¨äºåœ¨åŒæ„ä½¿ç”¨å®ƒä»¬çš„å„æ–¹ä¹‹é—´å…±äº«ä¿¡æ¯ï¼Œå¹¶ä¸”ä¸æ˜¯æ³¨å†Œçš„æˆ–å…¬å¼€çš„å£°æ˜ã€‚</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	<span style="color:#000080">&#34;sub&#34;</span>: <span style="color:#d14">&#34;user Login&#34;</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#000080">&#34;name&#34;</span>: <span style="color:#d14">&#34;kun&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#d14">&#34;admin&#34;</span>: <span style="color:#000;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Signature</p>
<p>ç­¾åç®—æ³•æ˜¯headerä¸­æŒ‡å®šçš„ï¼Œç”¨äºå°†Headerå’ŒPayloadåŠ å¯†åˆ¤æ–­æ˜¯å¦æ›´æ”¹ï¼Œå…·ä½“æ“ä½œæ­¥éª¤ä¸ºï¼š</p>
<p>åŠ å¯†ç®—æ³•(base64URLEncoder(header) + &ldquo;.&rdquo; + base64URLEncoder(payload), secret)</p>
<p>ç­¾åæ˜¯ç”¨äºéªŒè¯æ¶ˆæ¯åœ¨ä¼ é€’è¿‡ç¨‹ä¸­æœ‰æ²¡æœ‰è¢«æ›´æ”¹ï¼Œå¹¶ä¸”ï¼Œå¯¹äºä½¿ç”¨ç§é’¥ç­¾åçš„tokenï¼Œå®ƒè¿˜å¯ä»¥éªŒè¯JWTçš„å‘é€æ–¹æ˜¯å¦ä¸ºå®ƒæ‰€ç§°çš„å‘é€æ–¹ã€‚</p>
</li>
</ul>
<h3 id="tokenä¿å­˜ä½ç½®">tokenä¿å­˜ä½ç½®</h3>
<ul>
<li>
<p>webstorage</p>
<p>webstorageå¯ä¿å­˜çš„æ•°æ®å®¹é‡ä¸º5Måˆ†ä¸ºlocalStorageå’ŒsessionStorageã€‚ä¸”åªèƒ½å­˜å‚¨å­—ç¬¦ä¸²æ•°æ®ã€‚</p>
<ul>
<li>
<p><strong>localStorage</strong>çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æ°¸ä¹…çš„ï¼Œå…³é—­é¡µé¢æˆ–æµè§ˆå™¨ä¹‹ålocalStorageä¸­çš„æ•°æ®ä¹Ÿä¸ä¼šæ¶ˆå¤±ã€‚localStorageé™¤éä¸»åŠ¨åˆ é™¤æ•°æ®ï¼Œå¦åˆ™æ•°æ®æ°¸è¿œä¸ä¼šæ¶ˆå¤±ã€‚</p>
</li>
<li>
<p><strong>sessionStorage</strong>æ˜¯ä¼šè¯ç›¸å…³çš„æœ¬åœ°å­˜å‚¨å•å…ƒï¼Œç”Ÿå‘½å‘¨æœŸæ˜¯åœ¨ä»…åœ¨å½“å‰ä¼šè¯ä¸‹æœ‰æ•ˆã€‚sessionStorageå¼•å…¥äº†ä¸€ä¸ªâ€œæµè§ˆå™¨çª—å£â€çš„æ¦‚å¿µï¼ŒsessionStorageæ˜¯åœ¨åŒæºçš„çª—å£ä¸­å§‹ç»ˆå­˜åœ¨çš„æ•°æ®ã€‚åªè¦è¿™ä¸ªæµè§ˆå™¨çª—å£æ²¡æœ‰å…³é—­ï¼Œå³ä½¿åˆ·æ–°é¡µé¢æˆ–è€…è¿›å…¥åŒæºå¦ä¸€ä¸ªé¡µé¢ï¼Œæ•°æ®ä¾ç„¶å­˜åœ¨ã€‚ä½†æ˜¯sessionStorageåœ¨å…³é—­äº†æµè§ˆå™¨çª—å£åå°±ä¼šè¢«é”€æ¯ã€‚åŒæ—¶ç‹¬ç«‹çš„æ‰“å¼€åŒä¸€ä¸ªçª—å£åŒä¸€ä¸ªé¡µé¢ï¼ŒsessionStorageä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
</li>
</ul>
</li>
<li>
<p>Cookie</p>
<p>ä½¿ç”¨Cookieå­˜å‚¨ï¼Œä½¿ç”¨è¯·æ±‚å¤´å‘é€å¯ä»¥é¿å…CSRF(è·¨ç«™è¯·æ±‚ä¼ªé€ )ï¼Œä¸”æ–¹ä¾¿è·¨åŸŸè¯·æ±‚ã€‚</p>
</li>
</ul>
<h3 id="jwtæ‰§è¡Œæµç¨‹">JWTæ‰§è¡Œæµç¨‹</h3>
<p><img src="/img/sso/JWT-process.png" alt="JWT-process"></p>
<h3 id="jwtåº”ç”¨ç¤ºä¾‹">JWTåº”ç”¨ç¤ºä¾‹</h3>
<p>JWTå·¥å…·ç±»ï¼Œç”¨äºç”ŸæˆJWTå’Œè§£æJWT</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">JwtUtil</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic">// ç”Ÿæˆç­¾åçš„æ—¶å€™ä½¿ç”¨çš„ç§˜é’¥secret,è¿™ä¸ªæ–¹æ³•æœ¬åœ°å°è£…äº†çš„ï¼Œä¸€èˆ¬å¯ä»¥ä»æœ¬åœ°é…ç½®æ–‡ä»¶ä¸­è¯»å–</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic">// åˆ‡è®°è¿™ä¸ªç§˜é’¥ä¸èƒ½å¤–éœ²å“¦ã€‚å®ƒå°±æ˜¯ä½ æœåŠ¡ç«¯çš„ç§é’¥ï¼Œåœ¨ä»»ä½•åœºæ™¯éƒ½ä¸åº”è¯¥æµéœ²å‡ºå»ã€‚</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic">// ä¸€æ—¦å®¢æˆ·ç«¯å¾—çŸ¥è¿™ä¸ªsecret, é‚£å°±æ„å‘³ç€å®¢æˆ·ç«¯æ˜¯å¯ä»¥è‡ªæˆ‘ç­¾å‘jwtäº†ã€‚</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000;font-weight:bold">private</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">static</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">final</span><span style="color:#bbb"> </span>String<span style="color:#bbb"> </span>secret<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#d14">&#34;com.kun.secret&#34;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    * ç”¨æˆ·ç™»å½•æˆåŠŸåç”ŸæˆJwt
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    * ä½¿ç”¨HS256ç®—æ³•  ç§åŒ™ä½¿ç”¨ç”¨æˆ·å¯†ç 
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    */</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">static</span><span style="color:#bbb"> </span>String<span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">createJWT</span>(<span style="color:#458;font-weight:bold">long</span><span style="color:#bbb"> </span>ttlMillis,<span style="color:#bbb"> </span>User<span style="color:#bbb"> </span>user)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">// æŒ‡å®šç­¾åçš„æ—¶å€™ä½¿ç”¨çš„ç­¾åç®—æ³•ï¼Œä¹Ÿå°±æ˜¯headeré‚£éƒ¨åˆ†ï¼Œjjwtå·²ç»å°†è¿™éƒ¨åˆ†å†…å®¹å°è£…å¥½äº†ã€‚</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>SignatureAlgorithm<span style="color:#bbb"> </span>signatureAlgorithm<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>SignatureAlgorithm.<span style="color:#008080">HS256</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">// ç”ŸæˆJWTçš„æ—¶é—´</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#458;font-weight:bold">long</span><span style="color:#bbb"> </span>nowMillis<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>System.<span style="color:#008080">currentTimeMillis</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">// åˆ›å»ºpayloadçš„ç§æœ‰å£°æ˜ï¼ˆæ ¹æ®ç‰¹å®šçš„ä¸šåŠ¡éœ€è¦æ·»åŠ ï¼Œå¦‚æœè¦æ‹¿è¿™ä¸ªåšéªŒè¯ï¼Œä¸€èˆ¬æ˜¯éœ€è¦å’Œjwtçš„æ¥æ”¶æ–¹æå‰æ²Ÿé€šå¥½éªŒè¯æ–¹å¼çš„ï¼‰</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Map<span style="color:#000;font-weight:bold">&lt;</span>String,<span style="color:#bbb"> </span>Object<span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb"> </span>claims<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>HashMap<span style="color:#000;font-weight:bold">&lt;</span>String,<span style="color:#bbb"> </span>Object<span style="color:#000;font-weight:bold">&gt;</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>claims.<span style="color:#008080">put</span>(<span style="color:#d14">&#34;userId&#34;</span>,<span style="color:#bbb"> </span>user.<span style="color:#008080">getId</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>claims.<span style="color:#008080">put</span>(<span style="color:#d14">&#34;userName&#34;</span>,<span style="color:#bbb"> </span>user.<span style="color:#008080">getUserName</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>claims.<span style="color:#008080">put</span>(<span style="color:#d14">&#34;userAge&#34;</span>,<span style="color:#bbb"> </span>user.<span style="color:#008080">getUserAge</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">// ç”Ÿæˆç­¾å‘äºº</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>String<span style="color:#bbb"> </span>subject<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>user.<span style="color:#008080">getUserName</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">// ä¸‹é¢å°±æ˜¯åœ¨ä¸ºpayloadæ·»åŠ å„ç§æ ‡å‡†å£°æ˜å’Œç§æœ‰å£°æ˜äº†</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">// è¿™é‡Œå…¶å®å°±æ˜¯newä¸€ä¸ªJwtBuilderï¼Œè®¾ç½®jwtçš„body</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>JwtBuilder<span style="color:#bbb"> </span>builder<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>Jwts.<span style="color:#008080">builder</span>()<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">// å¦‚æœæœ‰ç§æœ‰å£°æ˜ï¼Œä¸€å®šè¦å…ˆè®¾ç½®è¿™ä¸ªè‡ªå·±åˆ›å»ºçš„ç§æœ‰çš„å£°æ˜ï¼Œè¿™ä¸ªæ˜¯ç»™builderçš„claimèµ‹å€¼</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">// ä¸€æ—¦å†™åœ¨æ ‡å‡†çš„å£°æ˜èµ‹å€¼ä¹‹åï¼Œå°±æ˜¯è¦†ç›–äº†é‚£äº›æ ‡å‡†çš„å£°æ˜çš„</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>.<span style="color:#008080">setClaims</span>(claims)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">// è®¾ç½®jti(JWT ID)ï¼šæ˜¯JWTçš„å”¯ä¸€æ ‡è¯†ï¼Œæ ¹æ®ä¸šåŠ¡éœ€è¦ï¼Œè¿™ä¸ªå¯ä»¥è®¾ç½®ä¸ºä¸€ä¸ªä¸é‡å¤çš„å€¼</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">// ä¸»è¦ç”¨æ¥ä½œä¸ºä¸€æ¬¡æ€§token,ä»è€Œå›é¿é‡æ”¾æ”»å‡»ã€‚</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>.<span style="color:#008080">setId</span>(UUID.<span style="color:#008080">randomUUID</span>().<span style="color:#008080">toString</span>())<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">// iat: jwtçš„ç­¾å‘æ—¶é—´</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>.<span style="color:#008080">setIssuedAt</span>(<span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>Date(nowMillis))<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">// ä»£è¡¨è¿™ä¸ªJWTçš„ä¸»ä½“ï¼Œå³å®ƒçš„æ‰€æœ‰äºº</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">// è¿™ä¸ªæ˜¯ä¸€ä¸ªjsonæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥å­˜æ”¾ä»€ä¹ˆuseridï¼Œroldidä¹‹ç±»çš„ï¼Œä½œä¸ºä»€ä¹ˆç”¨æˆ·çš„å”¯ä¸€æ ‡å¿—ã€‚</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>.<span style="color:#008080">setSubject</span>(subject)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">// è®¾ç½®è¿‡æœŸæ—¶é—´</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>.<span style="color:#008080">setExpiration</span>(<span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>Date(nowMillis<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">+</span><span style="color:#bbb"> </span>ttlMillis))<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">// è®¾ç½®ç­¾åä½¿ç”¨çš„ç­¾åç®—æ³•å’Œç­¾åä½¿ç”¨çš„ç§˜é’¥</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>.<span style="color:#008080">signWith</span>(signatureAlgorithm,<span style="color:#bbb"> </span>secret);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000;font-weight:bold">return</span><span style="color:#bbb"> </span>builder.<span style="color:#008080">compact</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    * Tokençš„è§£å¯†, parseClaimsJwsæ­¥éª¤ä¼šæ ¡éªŒ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    */</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">static</span><span style="color:#bbb"> </span>Claims<span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">parseJWT</span>(String<span style="color:#bbb"> </span>token)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">// ç­¾åç§˜é’¥ï¼Œå’Œç”Ÿæˆçš„ç­¾åçš„ç§˜é’¥ä¸€æ¨¡ä¸€æ ·</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">// å¾—åˆ°DefaultJwtParser</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Claims<span style="color:#bbb"> </span>claims<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>Jwts.<span style="color:#008080">parser</span>()<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">//è®¾ç½®ç­¾åçš„ç§˜é’¥</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>.<span style="color:#008080">setSigningKey</span>(secret)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#998;font-style:italic">//è®¾ç½®éœ€è¦è§£æçš„jwt</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>.<span style="color:#008080">parseClaimsJws</span>(token).<span style="color:#008080">getBody</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000;font-weight:bold">return</span><span style="color:#bbb"> </span>claims;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>JWTæµ‹è¯•</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">JWTTest</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000;font-weight:bold">private</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">static</span><span style="color:#bbb"> </span>User<span style="color:#bbb"> </span>user<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>User(1001,<span style="color:#bbb"> </span><span style="color:#d14">&#34;kun&#34;</span>,<span style="color:#bbb"> </span><span style="color:#d14">&#34;123456&#34;</span>,<span style="color:#bbb"> </span>19);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic">// åˆ›å»º</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#3c5d5d;font-weight:bold">@Test</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">void</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">create</span>()<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>String<span style="color:#bbb"> </span>token<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>JwtUtil.<span style="color:#008080">createJWT</span>(60000,<span style="color:#bbb"> </span>user);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>System.<span style="color:#008080">out</span>.<span style="color:#008080">println</span>(token);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic">// è§£æ&amp;æ ¡éªŒ</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#3c5d5d;font-weight:bold">@Test</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">void</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">parse</span>()<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>String<span style="color:#bbb"> </span>token<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#d14">&#34;eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJrdW4iLCJ1c2VyTmFtZSI6Imt1biIsImV4cCI6MTU2MDMyNzcxOSwidXNlcklkIjoxMDAxLCJpYXQiOjE1NjAzMjc2NTksInVzZXJBZ2UiOjE5LCJqdGkiOiIwNGE1MDQxMi1jY2Q5LTRhYzQtODYwZC02NzcyYTAzMWVjMmEifQ.T1Q7JF6HyJrA1R0XJd5QFpFBAGpepJwPNNOeuFFEbux&#34;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Claims<span style="color:#bbb"> </span>claims<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>JwtUtil.<span style="color:#008080">parseJWT</span>(token);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>System.<span style="color:#008080">out</span>.<span style="color:#008080">println</span>(claims.<span style="color:#008080">get</span>(<span style="color:#d14">&#34;userId&#34;</span>));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>System.<span style="color:#008080">out</span>.<span style="color:#008080">println</span>(claims.<span style="color:#008080">get</span>(<span style="color:#d14">&#34;userName&#34;</span>));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>System.<span style="color:#008080">out</span>.<span style="color:#008080">println</span>(claims.<span style="color:#008080">get</span>(<span style="color:#d14">&#34;userAge&#34;</span>));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="jwtå•ç‚¹ç™»é™†ä½¿ç”¨æ³¨æ„ç‚¹">JWTå•ç‚¹ç™»é™†ä½¿ç”¨æ³¨æ„ç‚¹</h3>
<ul>
<li>ä½¿ç”¨Cookieæ—¶éœ€è¦è§£å†³è·¨åŸŸé—®é¢˜ï¼ˆè®¾ç½®domainï¼‰ï¼ŒCookieåªæ˜¯å­˜å‚¨æ‰‹æ®µï¼Œéœ€è¦ä½¿ç”¨Httpè¯·æ±‚å¤´å‘é€</li>
<li>æœåŠ¡å™¨éœ€è¦å¼€å¯å…è®¸è·¨åŸŸè¯·æ±‚ï¼Œå¦åˆ™æ— æ³•å‘èµ·è·¨åŸŸè¯·æ±‚</li>
<li>JWTçš„è¿‡æœŸæ—¶é—´éœ€è¦åœ¨æ¯æ¬¡è¯·æ±‚ä¹‹åè¿›è¡Œä¿®æ”¹</li>
</ul>

    </div>

    

    <div class="container-comment-giscus">
        <script src="https://giscus.app/client.js"
        data-repo="loveminimal/comment"
        data-repo-id="R_kgDOJNJQ8g"
        data-category="General"
        data-category-id="DIC_kwDOJNJQ8s4CYl0m"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="noborder_light"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
        </script>
</div>
</div>

        </div>
        <div id="footer"><div class="container-footer">
    

    <div class="beian">
        
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41092802000242">
            

        </a>

        
        <a href="//beian.miit.gov.cn" target="_blank">
            
            <span class="some">icp...<span>
            
        </a>
    </div>

    
    <div class="info">
        
        <a href="https://github.com/loveminimal/hugo-theme-virgo">ğŸ•Šï¸</a> 2016 - <span id="info-date"></span>
    </div>

</div></div>
        <div class="cool-after" style="
            
                background-color: rgba(255, 255, 255, 0.49); 
                backdrop-filter: saturate(100%) blur(6px);
            
            "></div>
    </body>
</html>
