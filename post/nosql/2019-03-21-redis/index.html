<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="Redis‰ΩøÁî®ËØ¶Ëß£ - https://hobocat.github.io/post/nosql/2019-03-21-redis/">
    <meta name="author" content="Jack - https://hobocat.github.io/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>Redis‰ΩøÁî®ËØ¶Ëß£</title>
    
    <base target="_blank">
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    
    
    
    
    <link rel="stylesheet" href="https://hobocat.github.io/style.min.94e7ed14b48117025ebd1148adc11f7268f1ebf50d97297ac663edf1aa6f52dc.css">
    
    <script>const DARK =  false ;</script>
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div class="container-floating-box">
	<div class="box box1"></div>
	<div class="box box11"></div>
	<div class="box box12"></div>
	<div class="box box2"></div>
	<div class="box box3"></div>
	<div class="box box4"></div>
	<div class="box box5"></div>
	<div class="box box6"></div>
	<div class="box box7"></div>
	<div class="box box8"></div>
	<div class="box box9"></div>
</div>
        <div class="cool-before" style="background: url('/imgs/bg/wallhaven-6qr21l.jpg') left top/100% no-repeat fixed;"></div>
        <div id="header" class=""><div class="container-header">

    
    
    
    <div class="right">
        
        <h1 class="title">Redis‰ΩøÁî®ËØ¶Ëß£</h1>
    
        
        
            <div id="toc">üìú</div>
        
    </div>
</div>
</div>
        <div id="content">










<div class="container-main container-page ">

    

    
    
    
    <div class="rel">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <div class="curtag-desc">
            <a href="https://hobocat.github.io/tags/nosql/"><img src="/imgs/icons/tag.svg" width="16" /> Áõ∏ÂÖ≥ÊñáÁ´†ÔºöNoSQL <sup>3</sup></a>
        </div>

        <div class="curtag-post">
            
            
            
                <div class="curtag-post-item ">
                    <a href="https://hobocat.github.io/post/nosql/2021-01-29-mongodb/">MongoDB‰ΩøÁî®ËØ¶Ëß£</a>
                </div>
                
                
            
            
                <div class="curtag-post-item curtag-post-item--active">
                    <a href="https://hobocat.github.io/post/nosql/2019-03-21-redis/">Redis‰ΩøÁî®ËØ¶Ëß£</a>
                </div>
                
                
            
            
                <div class="curtag-post-item ">
                    <a href="https://hobocat.github.io/post/nosql/2022-09-05-redisstruct/">redisÂ∫ïÂ±ÇÊï∞ÊçÆÁªìÊûÑ</a>
                </div>
                
                
        </div>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    </div>
    
    

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="7409" width="12" height="12">
                <path
                    d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z"
                    p-id="7410" fill="#adb5bd"></path>
            </svg>
            2019-03-21&nbsp;&nbsp;&nbsp;
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="23838" width="11" height="11">
                <path
                    d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z"
                    p-id="23839" fill="#adb5bd"></path>
            </svg>
            2024-05-15&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="33866" width="12" height="12">
                <path
                    d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z"
                    fill="#adb5bd" p-id="33867"></path>
                <path
                    d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z"
                    fill="#adb5bd" p-id="33868"></path>
            </svg>
            15695 Â≠ó</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
                p-id="32892" width="12" height="12">
                <path
                    d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z"
                    p-id="32893" fill="#adb5bd"></path>
                <path
                    d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z"
                    p-id="32894" fill="#adb5bd"></path>
            </svg>
            32 ÂàÜÈíü</span>
        <div class="container-ctgtag">
	<div class="taxonomy">
		<div class="tag">
			
			
			<a href="/tags/nosql">NoSQL</a>
			
		</div>
	</div>
</div>
        
    </div>

    <div class="toc">
        <div class="container-page-operation">
	<div class="page-operation">
		<div><a href="/"><img src="/imgs/icons/home-2.svg" alt=""></a></div>
		<div><a href="/nav"><img src="/imgs/icons/iov-navigate-1.svg" alt=""></a></div>
		<div><a href="/wiki"><img src="/imgs/icons/wiki.svg" alt=""></a></div>
		<div><a href="/tags"><img src="/imgs/icons/treetags.svg" alt=""></a></div>
		<div id="light-dark"><a><img src="/imgs/icons/moon2.svg" alt=""></a></div>
		<div><a href="#"><img src="/imgs/icons/up2.svg" alt=""></a></div>
	</div>
</div>
        <nav id="TableOfContents">
  <ul>
    <li><a href="#‰∏ÄnosqlÁÆÄ‰ªã">‰∏Ä„ÄÅNoSQLÁÆÄ‰ªã</a>
      <ul>
        <li><a href="#nosqlÂàÜÁ±ª">NoSQLÂàÜÁ±ª</a></li>
        <li><a href="#ÈùûÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÁâπÁÇπ">ÈùûÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÁâπÁÇπ</a></li>
      </ul>
    </li>
    <li><a href="#‰∫åredisÁÆÄ‰ªã">‰∫å„ÄÅRedisÁÆÄ‰ªã</a></li>
    <li><a href="#‰∏âredisÁöÑÂÆâË£Ö">‰∏â„ÄÅRedisÁöÑÂÆâË£Ö</a></li>
    <li><a href="#ÂõõredisÂü∫Êú¨ÈÄöÁî®ÂëΩ‰ª§">Âõõ„ÄÅRedisÂü∫Êú¨ÈÄöÁî®ÂëΩ‰ª§</a></li>
    <li><a href="#‰∫îredisÊï∞ÊçÆÁ±ªÂûãÂèäÂÖ∂‰ΩøÁî®">‰∫î„ÄÅRedisÊï∞ÊçÆÁ±ªÂûãÂèäÂÖ∂‰ΩøÁî®</a>
      <ul>
        <li><a href="#Â≠óÁ¨¶‰∏≤string">Â≠óÁ¨¶‰∏≤„ÄêString„Äë</a></li>
        <li><a href="#ÂìàÂ∏åhash">ÂìàÂ∏å„ÄêHash„Äë</a></li>
        <li><a href="#ÂàóË°®list">ÂàóË°®„ÄêList„Äë</a></li>
        <li><a href="#ÈõÜÂêàset">ÈõÜÂêà„ÄêSet„Äë</a></li>
        <li><a href="#ÊúâÂ∫èÈõÜÂêàzset">ÊúâÂ∫èÈõÜÂêà„ÄêZSet„Äë</a></li>
      </ul>
    </li>
    <li><a href="#ÂÖ≠redisÈ´òÁ∫ßÂäüËÉΩ">ÂÖ≠„ÄÅRedisÈ´òÁ∫ßÂäüËÉΩ</a>
      <ul>
        <li><a href="#ÊÖ¢Êü•ËØ¢Êó•Âøó">ÊÖ¢Êü•ËØ¢Êó•Âøó</a></li>
        <li><a href="#pipeline">Pipeline</a></li>
        <li><a href="#ÂèëÂ∏ÉËÆ¢ÈòÖ">ÂèëÂ∏ÉËÆ¢ÈòÖ</a></li>
        <li><a href="#bitmap">Bitmap</a></li>
        <li><a href="#hyperloglog">HyperLogLog</a></li>
        <li><a href="#geo">Geo</a></li>
      </ul>
    </li>
    <li><a href="#‰∏ÉredisÊåÅ‰πÖÂåñ">‰∏É„ÄÅRedisÊåÅ‰πÖÂåñ</a>
      <ul>
        <li><a href="#rdbredis-database">RDB„ÄêRedis Database„Äë</a></li>
        <li><a href="#aofappend-only-file">AOF„ÄêAppend-Only File„Äë</a></li>
        <li><a href="#rdb‰∏éaofÊØîËæÉ">RDB‰∏éAOFÊØîËæÉ</a></li>
        <li><a href="#Ê∑∑ÂêàÊåÅ‰πÖÂåñ">Ê∑∑ÂêàÊåÅ‰πÖÂåñ</a></li>
        <li><a href="#ÊåÅ‰πÖÂåñÁõ∏ÂÖ≥‰ºòÂåñ">ÊåÅ‰πÖÂåñÁõ∏ÂÖ≥‰ºòÂåñ</a></li>
      </ul>
    </li>
    <li><a href="#ÂÖ´redis‰∏ª‰ªéÂ§çÂà∂ÂéüÁêÜÂíå‰ºòÂåñ">ÂÖ´„ÄÅRedis‰∏ª‰ªéÂ§çÂà∂ÂéüÁêÜÂíå‰ºòÂåñ</a>
      <ul>
        <li><a href="#‰∏ª‰ªéÂÆûÁé∞‰∏§ÁßçÊñπÂºè">‰∏ª‰ªéÂÆûÁé∞‰∏§ÁßçÊñπÂºè</a></li>
        <li><a href="#ÂÖ®ÈáèÂ§çÂà∂ÂíåÈÉ®ÂàÜÂ§çÂà∂">ÂÖ®ÈáèÂ§çÂà∂ÂíåÈÉ®ÂàÜÂ§çÂà∂</a></li>
        <li><a href="#ÂÖ®ÈáèÂ§çÂà∂ÂºÄÈîÄ">ÂÖ®ÈáèÂ§çÂà∂ÂºÄÈîÄ</a></li>
        <li><a href="#‰∏ª‰ªéÁõ∏ÂÖ≥ÂèÇÊï∞ÈÖçÁΩÆ">‰∏ª‰ªéÁõ∏ÂÖ≥ÂèÇÊï∞ÈÖçÁΩÆ</a></li>
      </ul>
    </li>
    <li><a href="#‰πùredis-sentinel">‰πù„ÄÅRedis Sentinel</a>
      <ul>
        <li><a href="#ÂÆâË£Ösentinel">ÂÆâË£ÖSentinel</a></li>
        <li><a href="#sentinel‰∏â‰∏™ÂÆöÊó∂‰ªªÂä°">Sentinel‰∏â‰∏™ÂÆöÊó∂‰ªªÂä°</a></li>
        <li><a href="#masterÈÄâ‰∏æËøáÁ®ã">MasterÈÄâ‰∏æËøáÁ®ã</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅredis-cluster">ÂçÅ„ÄÅRedis Cluster</a>
      <ul>
        <li><a href="#Êï∞ÊçÆÂàÜÂ∏ÉÊ¶ÇËÆ∫">Êï∞ÊçÆÂàÜÂ∏ÉÊ¶ÇËÆ∫</a></li>
        <li><a href="#ÂìàÂ∏åÂàÜÂ∏ÉÊñπÂºè">ÂìàÂ∏åÂàÜÂ∏ÉÊñπÂºè</a></li>
        <li><a href="#Âü∫Êú¨Êû∂ÊûÑ">Âü∫Êú¨Êû∂ÊûÑ</a></li>
        <li><a href="#ÂÆâË£Öcluster">ÂÆâË£ÖCluster</a></li>
        <li><a href="#ÈõÜÁæ§‰º∏Áº©">ÈõÜÁæ§‰º∏Áº©</a></li>
        <li><a href="#ÂÆ¢Êà∑Á´ØË∑ØÁî±">ÂÆ¢Êà∑Á´ØË∑ØÁî±</a></li>
        <li><a href="#span-idmulti-operatorÊâπÈáèÊìç‰Ωúspan"><span id="Multi-Operator">ÊâπÈáèÊìç‰Ωú</span></a></li>
        <li><a href="#ÊïÖÈöúËΩ¨Áßª">ÊïÖÈöúËΩ¨Áßª</a></li>
        <li><a href="#ÈõÜÁæ§ËøêÁª¥ÈóÆÈ¢ò">ÈõÜÁæ§ËøêÁª¥ÈóÆÈ¢ò</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅ‰∏ÄÁºìÂ≠òËÆæËÆ°‰∏é‰ºòÂåñ">ÂçÅ‰∏Ä„ÄÅÁºìÂ≠òËÆæËÆ°‰∏é‰ºòÂåñ</a>
      <ul>
        <li><a href="#ÁºìÂ≠ò‰ΩøÁî®ÁöÑÊàêÊú¨">ÁºìÂ≠ò‰ΩøÁî®ÁöÑÊàêÊú¨</a></li>
        <li><a href="#span-idcache_updateÁºìÂ≠òÊõ¥Êñ∞Á≠ñÁï•span"><span id="cache_update">ÁºìÂ≠òÊõ¥Êñ∞Á≠ñÁï•</span></a></li>
        <li><a href="#ÁºìÂ≠òÁ©øÈÄèÁºìÂ≠òÈõ™Â¥©Êó†Â∫ïÊ¥û">ÁºìÂ≠òÁ©øÈÄè&amp;ÁºìÂ≠òÈõ™Â¥©&amp;Êó†Â∫ïÊ¥û</a></li>
        <li><a href="#ÁÉ≠ÁÇπkeyÁöÑÈáçÂª∫‰ºòÂåñ">ÁÉ≠ÁÇπkeyÁöÑÈáçÂª∫‰ºòÂåñ</a></li>
        <li><a href="#Â∏ÉÈöÜËøáÊª§Âô®ÁöÑÂéüÁêÜ">Â∏ÉÈöÜËøáÊª§Âô®ÁöÑÂéüÁêÜ</a></li>
        <li><a href="#redisÂ∏ÉÈöÜËøáÊª§Âô®">RedisÂ∏ÉÈöÜËøáÊª§Âô®</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅ‰∏âredisÂºÄÂèëËßÑËåÉ">ÂçÅ‰∏â„ÄÅRedisÂºÄÂèëËßÑËåÉ</a>
      <ul>
        <li><a href="#bigkeyÂ§ÑÁêÜ">BigKeyÂ§ÑÁêÜ</a></li>
        <li><a href="#ÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜ">ÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜ</a></li>
        <li><a href="#ÂëΩ‰ª§‰ºòÂåñ">ÂëΩ‰ª§‰ºòÂåñ</a></li>
        <li><a href="#javaÂÆ¢Êà∑Á´Ø‰ºòÂåñ">JavaÂÆ¢Êà∑Á´Ø‰ºòÂåñ</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅÂõõÂÜÖÂ≠òÁÆ°ÁêÜ">ÂçÅÂõõ„ÄÅÂÜÖÂ≠òÁÆ°ÁêÜ</a>
      <ul>
        <li><a href="#ÂÜÖÂ≠òÊ∂àËÄó">ÂÜÖÂ≠òÊ∂àËÄó</a></li>
        <li><a href="#ÂÜÖÂ≠òÂõûÊî∂Á≠ñÁï•">ÂÜÖÂ≠òÂõûÊî∂Á≠ñÁï•</a></li>
      </ul>
    </li>
    <li><a href="#ÂçÅ‰∫îÂºÄÂèëËøêÁª¥‰∫ãÈ°π">ÂçÅ‰∫î„ÄÅÂºÄÂèëËøêÁª¥‰∫ãÈ°π</a>
      <ul>
        <li><a href="#linuxÂÜÖÊ†∏‰ºòÂåñ">LinuxÂÜÖÊ†∏‰ºòÂåñ</a></li>
        <li><a href="#redisÂÆâÂÖ®ÈóÆÈ¢ò">RedisÂÆâÂÖ®ÈóÆÈ¢ò</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div class='content  '>
        <h2 id="‰∏ÄnosqlÁÆÄ‰ªã">‰∏Ä„ÄÅNoSQLÁÆÄ‰ªã</h2>
<h3 id="nosqlÂàÜÁ±ª">NoSQLÂàÜÁ±ª</h3>
<ul>
<li>ÈîÆÂÄºÔºàKey-ValueÔºâÂ≠òÂÇ®Êï∞ÊçÆÂ∫ìÔºöËøô‰∏ÄÁ±ªÊï∞ÊçÆÂ∫ì‰∏ªË¶Å‰ºö‰ΩøÁî®Âà∞‰∏Ä‰∏™hashË°®ÔºåÂ¶ÇRedis„ÄÅOracle BDB</li>
<li>ÂàóÂ≠òÂÇ®Êï∞ÊçÆÂ∫ìÔºöÈÄöÂ∏∏ÊòØÁî®Êù•Â∫îÂØπÂàÜÂ∏ÉÂºèÂ≠òÂÇ®ÁöÑÊµ∑ÈáèÊï∞ÊçÆÔºåÈîÆ‰ªçÁÑ∂Â≠òÂú®‰ΩÜÊòØ‰ªñ‰ª¨ÊåáÂêë‰∫ÜÂ§ö‰∏™ÂàóÔºåÂ¶ÇHBase„ÄÅRiak</li>
<li>ÊñáÊ°£ÂûãÊï∞ÊçÆÂ∫ìÔºöËØ•Á±ªÂûãÁöÑÊï∞ÊçÆÊ®°ÂûãÊòØÁâàÊú¨ÂåñÁöÑÊñáÊ°£ÔºåÊØîÂ¶ÇJSON,ÂÖÅËÆ∏‰πãÈó¥ËøõË°åÂµåÂ•óÔºåÂ¶ÇMongoDB</li>
</ul>
<h3 id="ÈùûÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÁâπÁÇπ">ÈùûÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÁâπÁÇπ</h3>
<ul>
<li>
<p>Êï∞ÊçÆÊ®°ÂûãÊØîËæÉÁÆÄÂçï</p>
</li>
<li>
<p>ÂØπ‰∫éÊï∞ÊçÆÂ∫ìÊÄßËÉΩË¶ÅÊ±ÇËæÉÈ´ò</p>
</li>
<li>
<p>‰∏çÈúÄË¶ÅÈ´òÂ∫¶ÁöÑÊï∞ÊçÆ‰∏ÄËá¥ÊÄß</p>
</li>
</ul>
<h2 id="‰∫åredisÁÆÄ‰ªã">‰∫å„ÄÅRedisÁÆÄ‰ªã</h2>
<p>‰ª•key-valueÂΩ¢ÂºèÂ≠òÂÇ®Ôºå‰∏ç‰∏ÄÂÆöÈÅµÂæ™‰º†ÁªüÊï∞ÊçÆÂ∫ìÁöÑ‰∏Ä‰∫õÂü∫Êú¨Ë¶ÅÊ±ÇÔºàÈùûÂÖ≥Á≥ªÁöÑ„ÄÅÂàÜÂ∏ÉÂºèÁöÑ„ÄÅÂºÄÊ∫êÁöÑ„ÄÅÊ∞¥Âπ≥ÂèØÊâ©Â±ïÁöÑÔºâ</p>
<p><strong>‰ºòÁÇπ</strong>ÔºöÂØπÊï∞ÊçÆÈ´òÂπ∂ÂèëËØªÂÜô</p>
<p>‚Äã            ÂØπÊµ∑ÈáèÊï∞ÊçÆÁöÑÈ´òÊïàÁéáÂ≠òÂÇ®ÂíåËÆøÈóÆ</p>
<p>‚Äã            ÂØπÊï∞ÊçÆÁöÑÂèØÊâ©Â±ïÊÄßÂíåÈ´òÂèØÁî®ÊÄß</p>
<p><strong>Áº∫ÁÇπ</strong>ÔºöÊó†Ê≥ïÂÅöÂ§™Â§çÊùÇÁöÑÂÖ≥Á≥ªÊ®°Âûã</p>
<p><strong>RedisÂçïÁ∫øÁ®ã</strong>ÔºöÊåáÂ§ÑÁêÜÊàë‰ª¨ÁöÑÁΩëÁªúËØ∑Ê±ÇÁöÑÊó∂ÂÄôÂè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãÊù•Â§ÑÁêÜ„ÄêÊñá‰ª∂Âà∑ÁõòÁ≠âÁî®ÁöÑÊòØÂ§öÁ∫øÁ®ã„Äë</p>
<p><strong>RedisÂçïÁ∫øÁ®ãÁöÑÂ•ΩÂ§Ñ</strong>Ôºö</p>
<ul>
<li>
<p>RedisÊòØÂü∫‰∫éÂÜÖÂ≠òÁöÑÊìç‰ΩúÔºåCPU‰∏çÊòØRedisÁöÑÁì∂È¢àÔºåRedisÁöÑÁì∂È¢àÊúÄÊúâÂèØËÉΩÊòØÊú∫Âô®ÂÜÖÂ≠òÁöÑÂ§ßÂ∞èÊàñËÄÖÁΩëÁªúÂ∏¶ÂÆΩÔºåÂçïÁ∫øÁ®ãÂÆûÁé∞ÊØîËæÉÁÆÄÂçï</p>
</li>
<li>
<p>ÂçïÁ∫øÁ®ãÈÅøÂÖç‰∫Ü‰∏çÂøÖË¶ÅÁöÑ‰∏ä‰∏ãÊñáÂàáÊç¢ÂíåÁ´û‰∫âÊù°‰ª∂‰ª•ÂèäÂä†ÈîÅÈáäÊîæÈîÅÊìç‰Ωú</p>
</li>
<li>
<p>‰ΩøÁî®Â§öË∑ØI/OÂ§çÁî®Ê®°ÂûãÔºåÈùûÈòªÂ°ûIO</p>
</li>
</ul>
<h2 id="‰∏âredisÁöÑÂÆâË£Ö">‰∏â„ÄÅRedisÁöÑÂÆâË£Ö</h2>
<p>Á¨¨‰∏ÄÊ≠•ÔºöÂáÜÂ§áÂ∑•‰Ωú„ÄêËß£ÂéãtarÂåÖÔºåÂàõÂª∫RedisÁõ∏ÂÖ≥ÁõÆÂΩï„Äë</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>tar -zxvf redis-5.0.2.tar.gz 
</span></span><span style="display:flex;"><span>mkdir /opt/redis
</span></span><span style="display:flex;"><span>mkdir /opt/redis/conf
</span></span><span style="display:flex;"><span>mkdir /opt/redis/data
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∫åÊ≠•ÔºöÁºñËØëredis</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ËøõÂÖ•Ëß£ÂéãÂêéÁöÑtarÂåÖÊâßË°å</span>
</span></span><span style="display:flex;"><span>make 
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#ÊâßË°åÁªìÊùü‰πãÂêéËøõÂÖ•srcÁõÆÂΩï</span>
</span></span><span style="display:flex;"><span><span style="color:#0086b3">cd</span> src
</span></span><span style="display:flex;"><span>make install <span style="color:#008080">PREFIX</span><span style="color:#000;font-weight:bold">=</span>/opt/redis
</span></span></code></pre></td></tr></table>
</div>
</div><p>Á¨¨‰∏âÊ≠•ÔºöÁßªÂä®ÈÖçÁΩÆÊñá‰ª∂Âà∞confÁõÆÂΩï</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cp redis.conf /opt/redis/conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>È¢ùÂ§ñÈÖçÁΩÆÔºö</p>
<ul>
<li>redisÂºÄÊú∫Ëá™ÂêØ</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>vim /etc/rc.local
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#Âä†ÂÖ•</span>
</span></span><span style="display:flex;"><span>/opt/redis/bin/redis-server /opt/redis/conf/redis.conf
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ÈÖçÁΩÆÊï∞ÊçÆ‰øùÂ≠òÁõÆÂΩï</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>vim /opt/redis/conf/redis.conf
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#‰øÆÊîπ</span>
</span></span><span style="display:flex;"><span>dir ./    ---&gt;    dir /opt/redis/data/
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂõõredisÂü∫Êú¨ÈÄöÁî®ÂëΩ‰ª§">Âõõ„ÄÅRedisÂü∫Êú¨ÈÄöÁî®ÂëΩ‰ª§</h2>
<table>
<thead>
<tr>
<th>ÂëΩ‰ª§</th>
<th>ËØ¥Êòé</th>
</tr>
</thead>
<tbody>
<tr>
<td>KEYS [pattern]</td>
<td><span style="color:red">Êü•ÊâæÂá∫ÂåπÈÖçÁöÑkey„ÄêÁîüÊàêÁéØÂ¢ÉÁ¶ÅÊ≠¢‰ΩøÁî®ÔºåÊï∞ÊçÆÈáèÂ§™Â§ßÈòªÂ°ûÁîüÊàêÁéØÂ¢É„Äë</span></td>
</tr>
<tr>
<td>DBSIZE</td>
<td>ÁªüËÆ°keyÊÄªÊï∞„Äê‰ΩøÁî®ÁöÑÊòØredisÁöÑÂÜÖÈÉ®ËÆ°Êï∞ÔºåÂπ∂‰∏çÊòØÂÖ®ÈÉ®Êâ´ÊèèÔºåÁîü‰∫ßÂèØÁî®„Äë</td>
</tr>
<tr>
<td>EXISTS key [key &hellip;]</td>
<td>Ê£ÄÊü•keyÊòØÂê¶Â≠òÂú®„ÄêÂ≠òÂú®ËøîÂõû1Ôºå‰∏çÂ≠òÂú®ËøîÂõû0„Äë</td>
</tr>
<tr>
<td>DEL key [key&hellip;]</td>
<td>Âà†Èô§key„ÄêÊàêÂäüÂà†Èô§ËøîÂõû1Ôºå‰∏çÂ≠òÂú®Ê≠§keyËøîÂõû0„Äë</td>
</tr>
<tr>
<td>EXPIRE key seconds</td>
<td>ËÆæÁΩÆËøáÊúüÊó∂Èó¥</td>
</tr>
<tr>
<td>TTL key</td>
<td>Êü•ÁúãÂâ©‰ΩôÁöÑËøáÊúüÊó∂Èó¥„Äê-2‰ª£Ë°®Â∑≤‰∏çÂ≠òÂú®Ôºå-1‰ª£Ë°®Ê∞∏‰∏çËøáÊúü„Äë</td>
</tr>
<tr>
<td>PERSIST key</td>
<td>ÂèñÊ∂àkeyÁöÑËøáÊúüËÆæÁΩÆ</td>
</tr>
<tr>
<td>TYPE key</td>
<td>Êü•ËØ¢keyÁöÑÁ±ªÂûã</td>
</tr>
</tbody>
</table>
<h2 id="‰∫îredisÊï∞ÊçÆÁ±ªÂûãÂèäÂÖ∂‰ΩøÁî®">‰∫î„ÄÅRedisÊï∞ÊçÆÁ±ªÂûãÂèäÂÖ∂‰ΩøÁî®</h2>
<blockquote>
<p>Ê≥®ÊÑèÔºöredisÊìç‰Ωú‰∏ãÊ†áÈÉΩÊòØÈó≠Âå∫Èó¥ÁöÑ</p>
</blockquote>
<h3 id="Â≠óÁ¨¶‰∏≤string">Â≠óÁ¨¶‰∏≤„ÄêString„Äë</h3>
<p>StringÁöÑÂÄºÁ±ªÂûãÂèØ‰ª•‰∏∫<span style="color:red">Â≠óÁ¨¶Á±ªÂûã„ÄÅÊï∞Â≠óÁ±ªÂûã„ÄÅbitÁ±ªÂûã</span></p>
<p>StringÁ±ªÂûãÊòØÂåÖÂê´ÂæàÂ§ö‰∏≠Á±ªÂûãÁöÑÁâπÊÆäÁ±ªÂûãÔºåÂπ∂‰∏îÊòØ‰∫åËøõÂà∂ÂÆâÂÖ®ÁöÑ„ÄÇÊØîÂ¶ÇÂ∫èÂàóÂåñÁöÑÂØπË±°ËøõË°åÂ≠òÂÇ®ÔºåÊØîÂ¶Ç‰∏ÄÂº†ÂõæÁâáËøõË°å‰∫åËøõÂà∂Â≠òÂÇ®ÔºåÊØîÂ¶Ç‰∏Ä‰∏™ÁÆÄÂçïÂú∞Â≠óÁ¨¶‰∏≤ÔºåÊï∞ÂÄºÁ≠âÁ≠â„ÄÇ</p>
<p>‰ΩøÁî®Âú∫ÊôØÔºöÁºìÂ≠ò„ÄÅËÆ°Êï∞Âô®„ÄÅÂàÜÂ∏ÉÂºèÈîÅÁ≠â</p>
<table>
<thead>
<tr>
<th>Â∏∏Áî®ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td>{ <strong>GET</strong> key }Ôºå{ <strong>MGET</strong> key [key &hellip;] }</td>
<td>ÂæóÂà∞String</td>
</tr>
<tr>
<td>{ <strong>SET</strong> key value }Ôºå{ <strong>MSET</strong> key value [key value &hellip;] }</td>
<td>ËÆæÁΩÆString</td>
</tr>
<tr>
<td>{ <strong>SETNX</strong> key value }Ôºå{ <strong>MSETNX</strong> key value [key value &hellip;] }</td>
<td>Â¶ÇÊûú‰∏çÂ≠òÂú®ÂàôËÆæÁΩÆ</td>
</tr>
<tr>
<td><strong>SET</strong> key value XX</td>
<td>Â¶ÇÊûúÂ≠òÂú®ÂàôËÆæÁΩÆ</td>
</tr>
<tr>
<td><strong>SETEX</strong> key second value</td>
<td>ËÆæÁΩÆËøáÊúüÊó∂Èó¥</td>
</tr>
<tr>
<td>{ <strong>INCR</strong> key }Ôºå{ <strong>INCRBY</strong> key increment }</td>
<td>Ëá™Â¢ûÊìç‰Ωú</td>
</tr>
<tr>
<td>{ <strong>DECR</strong> key }Ôºå{ <strong>DECRBY</strong> key decrement }</td>
<td>Ëá™ÂáèÊìç‰Ωú</td>
</tr>
<tr>
<td><strong>GETSET</strong> key value</td>
<td>ÂæóÂà∞Â∞±ÂÄºËÆæÁΩÆÊñ∞ÂÄº</td>
</tr>
<tr>
<td><strong>APPEND</strong> key value</td>
<td>ËøΩÂä†Â≠óÁ¨¶‰∏≤</td>
</tr>
<tr>
<td><strong>STRLEN</strong> key</td>
<td>ÂæóÂà∞Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶ÔºåÂÜÖÈÉ®Â≠òÊúâËÆ°Êï∞</td>
</tr>
<tr>
<td><strong>GETRANGE</strong> key start end</td>
<td>ÂæóÂà∞ÊåáÂÆöÈïøÂ∫¶ÁöÑvalue</td>
</tr>
<tr>
<td><strong>SETRANGE</strong> key offset value</td>
<td>ËÆæÁΩÆÊåáÂÆöÂÅèÁßªÈáèÂ≠óÁ¨¶‰∏≤ÂÜÖÂÆπ</td>
</tr>
</tbody>
</table>
<h3 id="ÂìàÂ∏åhash">ÂìàÂ∏å„ÄêHash„Äë</h3>
<p>‰ΩøÁî®Âú∫ÊôØÔºöÂ≠òÂÇ®ÂÖ∑Êúâ‰∏ÄÂÆöÁªìÊûÑÂåñÁöÑÊï∞ÊçÆ</p>
<table>
<thead>
<tr>
<th>Â∏∏Áî®ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>HGET</strong> key field</td>
<td>ÂæóÂà∞keyÂØπÂ∫îfieldÁöÑvalue</td>
</tr>
<tr>
<td><strong>HSET</strong> key field value</td>
<td>ËÆæÁΩÆkeyÂØπÂ∫îfieldÁöÑvalue</td>
</tr>
<tr>
<td><strong>HDEL</strong> key field</td>
<td>Âà†Èô§keyÂØπÂ∫îfieldÁöÑvalue</td>
</tr>
<tr>
<td><strong>HEXISTS</strong> key field</td>
<td>Âà§Êñ≠keyÁöÑfieldÊòØÂê¶Â≠òÂú®</td>
</tr>
<tr>
<td><strong>HLEN</strong> key</td>
<td>Ëé∑ÂèñÊåáÂÆökeyÁöÑfiledÊï∞Èáè„ÄêÂÜÖÈÉ®ËÆ°Êï∞ÔºåÁîüÊàêÁéØÂ¢ÉÂèØÁî®„Äë</td>
</tr>
<tr>
<td><strong>HMGET</strong> key field [field &hellip;]</td>
<td>ÊâπÈáèËé∑ÂæóhashÁöÑfieldÂØπÂ∫îÁöÑvalue</td>
</tr>
<tr>
<td><strong>HMSET</strong> key field value [field value &hellip;]</td>
<td>ÊâπÈáèËÆæÁΩÆhashÁöÑfieldÂíåvalue</td>
</tr>
<tr>
<td><strong>HINCRBY</strong> key field increment</td>
<td>Â¢ûÂä†ÊåáÂÆöincrementÁöÑÂØπÂ∫îkeyÁöÑfield</td>
</tr>
<tr>
<td><strong>HGETALL</strong>  key</td>
<td>Ëé∑ÂèñkeyÂØπÂ∫îÊâÄÊúâfieldÂíåvalue„ÄêÁîüÊàêÁéØÂ¢ÉÊÖéÁî®„Äë</td>
</tr>
<tr>
<td><strong>HVALS</strong> key</td>
<td>ËøîÂõûkeyÂØπÂ∫îÁöÑÊâÄÊúâvalue„ÄêÁîüÊàêÁéØÂ¢ÉÊÖéÁî®„Äë</td>
</tr>
<tr>
<td><strong>HKEYS</strong> key</td>
<td>ËøîÂõûkeyÂØπÂ∫îÁöÑÊâÄÊúâfield„ÄêÁîüÊàêÁéØÂ¢ÉÊÖéÁî®„Äë</td>
</tr>
<tr>
<td><strong>HSETNX</strong> key field value</td>
<td>‰∏çÂ≠òÂú®Ê≠§keyÂØπÂ∫îÁöÑfieldÂàôËÆæÁΩÆ</td>
</tr>
</tbody>
</table>
<h3 id="ÂàóË°®list">ÂàóË°®„ÄêList„Äë</h3>
<p>ÂàóË°®‰∏∫ÊúâÂ∫è„ÄÅÂèØÈáçÂ§çÁªìÊûÑ„ÄÇÂèØÊåáÂÆö‰ΩçÁΩÆÊèíÂÖ•ÂíåÂà†Èô§„ÄÅ‰πüÂèØ‰ªéÂ∑¶Âè≥ÊèíÂÖ•ÂíåÂºπÂá∫ÔºàÊ®°ÊãüÊ†àÁªìÊûÑÔºâ</p>
<table>
<thead>
<tr>
<th>Â∏∏Áî®ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>LPUSH|RPUSH</strong> key value [value &hellip;]</td>
<td>‰ªéÂàóË°®ÁöÑÂ∑¶|Âè≥ÊèíÂÖ•ÂÖÉÁ¥†</td>
</tr>
<tr>
<td><strong>LINSERT</strong> key BEFORE|AFTER value newValue</td>
<td>Âú®listÊåáÂÆöÁöÑÂÄºÂâç|ÂêéÊèíÂÖ•Êñ∞ÂÖÉÁ¥†„ÄêÊó∂Èó¥Â§çÊùÇÂ∫¶O(N)„Äë</td>
</tr>
<tr>
<td><strong>LPOP|RPOP</strong> key</td>
<td>‰ªéÂàóË°®Â∑¶‰æß|Âè≥‰æßÂºπÂá∫‰∏Ä‰∏™ÂÖÉÁ¥†</td>
</tr>
<tr>
<td><strong>LREM</strong> key count value</td>
<td>Ê†πÊçÆcountÂÄºÔºå‰ªéÂàóË°®Âà†Èô§ÊâÄÊúâÁ≠â‰∫évalueÁöÑÂÄº„ÄêÊó∂Èó¥Â§çÊùÇÂ∫¶O(N)„Äë<br />„Äêcount&gt;0Ôºå‰ªéÂ∑¶Âà∞Âè≥Âà†Èô§count‰∏™„Äë<br />„Äêcount&lt;0Ôºå‰ªéÂè≥Âà∞ÂùêÂà†Èô§count‰∏™„Äë<br />„Äêcount=0ÔºåÂà†Èô§ÊâÄÊúâvalueÁõ∏Á≠âÁöÑÂÄº„Äë</td>
</tr>
<tr>
<td><strong>LTRIM</strong> key start end</td>
<td>ÊåâÁÖßÁ¥¢ÂºïËåÉÂõ¥‰øùÁïôlistÔºåÂà†Èô§Â§ßÈìæË°®ÊúâÁî®„ÄêÊó∂Èó¥Â§çÊùÇÂ∫¶O(N)„Äë</td>
</tr>
<tr>
<td><strong>LRANGR</strong> key start end</td>
<td>Ëé∑ÂèñÂàóË°®ÊåáÂÆöÁ¥¢ÂºïËåÉÂõ¥ÂÜÖÁöÑÂÄºÔºåÊï∞ÂÄº‰∏∫Ë¥üÂàô‰ªéÂè≥ÂæÄÂ∑¶ÂèñÂÄº„ÄêÊó∂Èó¥Â§çÊùÇÂ∫¶O(N)„Äë</td>
</tr>
<tr>
<td><strong>LINDEX</strong> key index</td>
<td>Ëé∑ÂèñÂàóË°®ÊåáÂÆöÁ¥¢ÂºïÁöÑÂÄºÔºåÊï∞ÂÄº‰∏∫Ë¥üÂàô‰ªéÂè≥ÂèñÂÄº„ÄêÊó∂Èó¥Â§çÊùÇÂ∫¶O(N)„Äë</td>
</tr>
<tr>
<td><strong>LLEN</strong> key</td>
<td>Ëé∑ÂèñlistÈïøÂ∫¶„ÄêÂÜÖÈÉ®ËÆ°Êï∞ÔºåÁîüÊàêÁéØÂ¢ÉÂèØÁî®„Äë</td>
</tr>
<tr>
<td><strong>LSET</strong> key index newValue</td>
<td>ËÆæÁΩÆÊåáÂÆö‰ΩçÁΩÆÁöÑÂÄº„ÄêÊó∂Èó¥Â§çÊùÇÂ∫¶O(N)„Äë</td>
</tr>
<tr>
<td><strong>BLPOP|RLPOP</strong> key timeout</td>
<td>LPOP/RPOPÁöÑÈòªÂ°ûÁâàÔºåtimeout‰∏∫0ÂàôË°®Á§∫Ê∞∏‰∏çÈòªÂ°û</td>
</tr>
</tbody>
</table>
<p>‰ΩøÁî®ÊäÄÂ∑ßÔºö</p>
<ul>
<li>LPUSH + LPOP   = Stack</li>
<li>LPUSH + RPOP   = Queue</li>
<li>LPUSH + LTRIM  = Capped Collection„ÄêÂõ∫ÂÆöÂÆπÈáèÈõÜÂêà„Äë</li>
<li>LPUSH + BRPOP = Block Queue</li>
</ul>
<h3 id="ÈõÜÂêàset">ÈõÜÂêà„ÄêSet„Äë</h3>
<p>SetÊó†Â∫è„ÄÅÊó†ÈáçÂ§ç„ÄÅÊúâÈõÜÂêàÈó¥Êìç‰Ωú„ÄÇ</p>
<table>
<thead>
<tr>
<th>Â∏∏Áî®ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SADD</strong> key element [member ‚Ä¶]</td>
<td>ÂêëÈõÜÂêàkeyÊ∑ªÂä†ÂÖÉÁ¥†</td>
</tr>
<tr>
<td><strong>SREM</strong> key element</td>
<td>Âà†Èô§ÈõÜÂêàkey‰∏≠ÁöÑelementÂÖÉÁ¥†</td>
</tr>
<tr>
<td><strong>SCARD</strong> key</td>
<td>Êü•ËØ¢ÈõÜÂêàÂÖÉÁ¥†ÁöÑ‰∏™Êï∞„ÄêÂÜÖÈÉ®ËÆ°Êï∞ÔºåÁîüÊàêÁéØÂ¢ÉÂèØÁî®„Äë</td>
</tr>
<tr>
<td><strong>SISMEMBER</strong> key element</td>
<td>ÈõÜÂêà‰∏≠ÊòØÂê¶Â≠òÂú®elementÂÖÉÁ¥†</td>
</tr>
<tr>
<td><strong>SRANDMEMBER</strong> key</td>
<td>ÈöèÊú∫ÂæóÂà∞‰∏Ä‰∏™ÂÖÉÁ¥†</td>
</tr>
<tr>
<td><strong>SMEMBERS</strong> key</td>
<td>Ëé∑ÂèñÈõÜÂêàÊâÄÊúâÂÖÉÁ¥†„ÄêÊÖéÁî®„Äë</td>
</tr>
<tr>
<td><strong>SPOP</strong> key</td>
<td>ÈöèÊú∫ÂºπÂá∫‰∏Ä‰∏™ÂÖÉÁ¥†</td>
</tr>
<tr>
<td>{ <strong>SDIFF</strong> key [key ‚Ä¶] }„ÄÅ{ <strong>SDIFFSTORE</strong> destination key [key ‚Ä¶] }</td>
<td>ËøîÂõû/Â≠òÂÇ®‰∏Ä‰∏™ÈõÜÂêàÁöÑÂÖ®ÈÉ®ÊàêÂëòÔºåËØ•ÈõÜÂêàÊòØÊâÄÊúâÁªôÂÆöÈõÜÂêà‰πãÈó¥ÁöÑÂ∑ÆÈõÜ</td>
</tr>
<tr>
<td>{ <strong>SINTER</strong> key [key ‚Ä¶] }„ÄÅ{ <strong>SINTERSTORE</strong> destination key [key ‚Ä¶] }</td>
<td>ËøîÂõû/Â≠òÂÇ®‰∏Ä‰∏™ÈõÜÂêàÁöÑÂÖ®ÈÉ®ÊàêÂëòÔºåËØ•ÈõÜÂêàÊòØÊâÄÊúâÁªôÂÆöÈõÜÂêàÁöÑ‰∫§ÈõÜ</td>
</tr>
<tr>
<td>{ <strong>SUNION</strong> key [key ‚Ä¶] }„ÄÅ{ <strong>SUNIONSTORE</strong> destination key [key ‚Ä¶] }</td>
<td>ËøîÂõû/Â≠òÂÇ®‰∏Ä‰∏™ÈõÜÂêàÁöÑÂÖ®ÈÉ®ÊàêÂëòÔºåËØ•ÈõÜÂêàÊòØÊâÄÊúâÁªôÂÆöÈõÜÂêàÁöÑÂπ∂ÈõÜ</td>
</tr>
</tbody>
</table>
<p>‰ΩøÁî®ÊäÄÂ∑ß</p>
<ul>
<li>
<p>SADD = Tagging</p>
</li>
<li>
<p>SPOP/SRANDMEMBER = Random Item</p>
</li>
<li>
<p>SADD + SINTER = Social Graph„ÄêÂÖ±ÂêåÂÖ≥Ê≥®„ÄÅÊúâÁùÄÁõ∏ÂêåÂÖ¥Ë∂£Á≠â„Äë</p>
</li>
</ul>
<h3 id="ÊúâÂ∫èÈõÜÂêàzset">ÊúâÂ∫èÈõÜÂêà„ÄêZSet„Äë</h3>
<p>ZSetÊúâÂ∫è„ÄÅÊó†ÈáçÂ§ç„ÄÅÂåÖÂê´ÂàÜÂÄº‰∏éÂÖÉÁ¥†ÔºåÊúâÈõÜÂêàÈó¥Êìç‰Ωú„ÄÇ</p>
<p>‰ΩøÁî®Âú∫ÊôØÔºöÊéíË°åÊ¶ú</p>
<table>
<thead>
<tr>
<th>Â∏∏Áî®ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ZADD</strong> key score member [score member &hellip;]</td>
<td>ÂêëÈõÜÂêàÊ∑ªÂä†ÂÖÉÁ¥†</td>
</tr>
<tr>
<td><strong>ZREM</strong> key member [member ‚Ä¶]</td>
<td>ÁßªÈô§ÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†</td>
</tr>
<tr>
<td><strong>ZSCORE</strong> key member</td>
<td>ÂæóÂà∞ÂÖÉÁ¥†ÁöÑÂàÜÊï∞</td>
</tr>
<tr>
<td><strong>ZINCRBY</strong> key increment member</td>
<td>Â¢ûÈïøÂÖÉÁ¥†ÁöÑÂàÜÊï∞</td>
</tr>
<tr>
<td><strong>ZCARD</strong> key</td>
<td>Ëé∑ÂæóÈõÜÂêà‰∏≠ÂÖÉÁ¥†ÁöÑ‰∏™Êï∞</td>
</tr>
<tr>
<td><strong>ZRANK</strong> key member</td>
<td>ÊàêÂëòÊåâÂàÜÂÄºÈÄíÂáè(‰ªéÂ∞èÂà∞Â§ß)ÊéíÂàóÁöÑÊéíÂêç</td>
</tr>
<tr>
<td><strong>ZRANGE</strong> key start stop [WITHSCORES]</td>
<td>ÊåâscoreÂÄºÈÄíÂ¢û(‰ªéÂ∞èÂà∞Â§ß)ÊéíÂ∫èÔºåWITHSCORESËøîÂõûÂàÜÊï∞</td>
</tr>
<tr>
<td><strong>ZRANGEBYSCORE</strong> key max min [WITHSCORES]</td>
<td>ËøîÂõûÂàÜÊï∞ËåÉÂõ¥ÂÜÖÊï∞ÊçÆÔºåÊåâscoreÂÄºÈÄíÂ¢û(‰ªéÂ∞èÂà∞Â§ß)ÊéíÂ∫èÔºåWITHSCORESËøîÂõûÂàÜÊï∞</td>
</tr>
<tr>
<td><strong>ZCOUNT</strong> key min max</td>
<td>ÁªüËÆ°ÂæóÂà∞ÂàÜÊï∞Âú®minÂíåmax‰πãÈó¥ÁöÑÂÖÉÁ¥†‰∏™Êï∞</td>
</tr>
<tr>
<td>{ <strong>ZREMRANGEBYRANK</strong> key start stop }„ÄÅ{ <strong>ZREMRANGEBYSCORE</strong> key min max}</td>
<td>ÊåâÁÖßÊéíÂêç/ÂàÜÊï∞ËåÉÂõ¥Âà†Èô§ÂÖÉÁ¥†</td>
</tr>
<tr>
<td><strong>ZREVRANK</strong> key member</td>
<td>ÊàêÂëòÊåâÂàÜÂÄºÈÄíÂáè(‰ªéÂ§ßÂà∞Â∞è)ÊéíÂàóÁöÑÊéíÂêç</td>
</tr>
<tr>
<td><strong>ZREVRANGE</strong> key start stop [WITHSCORES]</td>
<td>ÊåâscoreÂÄºÈÄíÂ¢û(‰ªéÂ§ßÂà∞Â∞è)ÊéíÂ∫èÔºåWITHSCORESËøîÂõûÂàÜÊï∞</td>
</tr>
<tr>
<td><strong>ZREVRANGEBYSCORE</strong> key max min [WITHSCORES]</td>
<td>ËøîÂõûÂàÜÊï∞ËåÉÂõ¥ÂÜÖÊï∞ÊçÆÔºåÊåâscoreÂÄºÈÄíÂ¢û(‰ªéÂ§ßÂà∞Â∞è)ÊéíÂ∫èÔºåWITHSCORESËøîÂõûÂàÜÊï∞</td>
</tr>
</tbody>
</table>
<h2 id="ÂÖ≠redisÈ´òÁ∫ßÂäüËÉΩ">ÂÖ≠„ÄÅRedisÈ´òÁ∫ßÂäüËÉΩ</h2>
<h3 id="ÊÖ¢Êü•ËØ¢Êó•Âøó">ÊÖ¢Êü•ËØ¢Êó•Âøó</h3>
<p><img src="/img/redis/Redis-Life-Cycle.png" alt="Redis-Life-Cycle"></p>
<ul>
<li>ÊÖ¢Êü•ËØ¢ÂèëÁîüÂú®Á¨¨‰∏âÈò∂ÊÆµ</li>
<li>ÂÆ¢Êà∑Á´ØË∂ÖÊó∂‰∏ç‰∏ÄÂÆöÊòØÊÖ¢Êü•ËØ¢ÂØºËá¥Ôºå‰ΩÜÊÖ¢Êü•ËØ¢ÂèØÂØºËá¥ÂÆ¢Êà∑Á´ØË∂ÖÊó∂</li>
</ul>
<p><strong>ÊÖ¢Êü•ËØ¢ÈòüÂàóÁÆÄ‰ªã</strong></p>
<ul>
<li>ÂÖàËøõÂÖàÂá∫ÁöÑÈòüÂàó</li>
<li>Âõ∫ÂÆöÈïøÂ∫¶</li>
<li>ÈïøÂ∫¶‰∏çÂ§üÊó∂Ôºå‰∏¢ÂºÉÊúÄÊó©ËÆ∞ÂΩï</li>
<li>‰øùÂ≠òÂú®ÂÜÖÂ≠ò‰∏≠</li>
</ul>
<p><strong>ÊÖ¢Êü•ËØ¢ËÆæÁΩÆ</strong></p>
<ul>
<li>
<p>slow-max-len„ÄêÊÖ¢Êü•ËØ¢ÈòüÂàóÈïøÂ∫¶ÔºåÈªòËÆ§128„Äë</p>
</li>
<li>
<p>slowlog-log-slower-than„ÄêÊÖ¢Êü•ËØ¢ÁöÑÈòôÂÄºÔºàÂæÆÁßíÔºå1000000 ÂæÆÁßí=1 ÁßíÔºâÔºåÈªòËÆ§10000Ôºà10ÊØ´ÁßíÔºâÔºåÂª∫ËÆÆ‰∏∫1000Ôºà1ÊØ´ÁßíÔºâ„Äë</p>
</li>
</ul>
<blockquote>
<p>Êõ¥ÊîπÊÖ¢Êü•ËØ¢ÂèÇÊï∞Âª∫ËÆÆ‰ΩøÁî®<code>CONFIG SET parameter value</code>ÊñπÂºèÔºåËÄå‰∏çÊòØÊõ¥Êîπredis.confÊñá‰ª∂ÈáçÂêØredis</p>
</blockquote>
<p><strong>ÊÖ¢Êü•ËØ¢ÂëΩ‰ª§</strong></p>
<table>
<thead>
<tr>
<th>Â∏∏Áî®ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td>slowlog get n</td>
<td>Ëé∑ÂèñÊÖ¢Êü•ËØ¢ÈòüÂàó‰∏ÄÊù°ËÆ∞ÂΩï</td>
</tr>
<tr>
<td>slowlog len</td>
<td>Ëé∑ÂèñÊÖ¢Êü•ËØ¢ÈòüÂàóÈïøÂ∫¶</td>
</tr>
<tr>
<td>slowlog reset</td>
<td>Ê∏ÖÁ©∫ÊÖ¢Êü•ËØ¢ÈòüÂàó</td>
</tr>
</tbody>
</table>
<p><strong>Êü•ËØ¢ÁªìÊûúÁ§∫‰æã</strong></p>
<p><img src="/img/redis/Redis-Slow-Examples.png" alt="Redis-Slow-Examples"></p>
<h3 id="pipeline">Pipeline</h3>
<p><img src="/img/redis/Redis-Process.png" alt="Redis-Process"></p>
<p>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÂÆ¢Êà∑Á´ØÂèëÈÄÅ‰∏ÄÊù°ÂëΩ‰ª§Âà∞RedisÔºåRedisÂ§ÑÁêÜÁªìÊùüËøîÂõûÁªìÊûúÔºåÂç≥ NÊù°ÂëΩ‰ª§ = NÊ¨°ÁΩëÁªúÊó∂Èó¥ + NÊ¨°ËÆ°ÁÆóÊó∂Èó¥</p>
<p>PipeLineÂ∞ÜÂëΩ‰ª§ÊâìÂåÖÂèëÈÄÅÁªôÂÆ¢Êà∑Á´ØÔºåRedisÂ§ÑÁêÜÂÆåËøîÂõûÁªìÊûúÔºåPipLineÊòØ‰∏Ä‰∏™ÂºÇÊ≠•Â§ÑÁêÜÊñπÂºèÔºåÂπ∂‰∏çÁ≠âÂæÖRedisËøîÂõû„ÄÇ</p>
<p>Pipeline(NÊù°ÂëΩ‰ª§) = 1Ê¨°ÁΩëÁªúÊó∂Èó¥ + NÊ¨°ËÆ°ÁÆóÊó∂Èó¥</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/*
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> * JestÊâßË°åÂèÇËÄÉ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> */</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#458;font-weight:bold">long</span><span style="color:#bbb"> </span>oldPipeline<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>Instant.<span style="color:#008080">now</span>().<span style="color:#008080">toEpochMilli</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#458;font-weight:bold">int</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#bbb"> </span>100;<span style="color:#bbb"> </span>i<span style="color:#000;font-weight:bold">++</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Pipeline<span style="color:#bbb"> </span>pipeline<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>jedis.<span style="color:#008080">pipelined</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#458;font-weight:bold">int</span><span style="color:#bbb"> </span>j<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>j<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#bbb"> </span>100;<span style="color:#bbb"> </span>j<span style="color:#000;font-weight:bold">++</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>pipeline.<span style="color:#008080">sadd</span>(<span style="color:#d14">&#34;S&#34;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">+</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span>100<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">+</span><span style="color:#bbb"> </span>j,<span style="color:#bbb"> </span>j<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">+</span><span style="color:#bbb"> </span><span style="color:#d14">&#34;&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">//pipeline.sync();ÂºÇÊ≠•‰∏çÊé•ÂèóËøîÂõûÁªìÊûú</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>pipeline.<span style="color:#008080">syncAndReturnAll</span>();<span style="color:#bbb"> </span><span style="color:#998;font-style:italic">//ÂºÇÊ≠•Êé•ÂèóËøîÂõûÁªìÊûú</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#458;font-weight:bold">long</span><span style="color:#bbb"> </span>nowPipeline<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>Instant.<span style="color:#008080">now</span>().<span style="color:#008080">toEpochMilli</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>System.<span style="color:#008080">out</span>.<span style="color:#008080">println</span>(nowPipeline<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">-</span><span style="color:#bbb"> </span>oldPipeline);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  * Spring Data RedisÂèÇËÄÉ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">  */</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">// ÊâπÈáèÊèíÂÖ•</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>redisTemplate.<span style="color:#008080">executePipelined</span>(<span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>RedisCallback<span style="color:#000;font-weight:bold">&lt;</span>Void<span style="color:#000;font-weight:bold">&gt;</span>()<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#3c5d5d;font-weight:bold">@Override</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span>Void<span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">doInRedis</span>(RedisConnection<span style="color:#bbb"> </span>connection)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">throws</span><span style="color:#bbb"> </span>DataAccessException<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>String<span style="color:#bbb"> </span>keyPrefix<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#d14">&#34;pipeline-&#34;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#458;font-weight:bold">int</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#bbb"> </span>10000;<span style="color:#bbb"> </span>i<span style="color:#000;font-weight:bold">++</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>String<span style="color:#bbb"> </span>key<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>keyPrefix<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">+</span><span style="color:#bbb"> </span>i;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>connection.<span style="color:#008080">set</span>(key.<span style="color:#008080">getBytes</span>(),<span style="color:#bbb"> </span>String.<span style="color:#008080">valueOf</span>(i).<span style="color:#008080">getBytes</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>});<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">// ÊâπÈáèËé∑Âèñ</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>List<span style="color:#000;font-weight:bold">&lt;</span>Object<span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb"> </span>data<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>redisTemplate.<span style="color:#008080">executePipelined</span>(<span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>RedisCallback<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;</span>()<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#3c5d5d;font-weight:bold">@Override</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span>String<span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">doInRedis</span>(RedisConnection<span style="color:#bbb"> </span>connection)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">throws</span><span style="color:#bbb"> </span>DataAccessException<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>String<span style="color:#bbb"> </span>keyPrefix<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#d14">&#34;pipeline-&#34;</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#458;font-weight:bold">int</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#bbb"> </span>10000;<span style="color:#bbb"> </span>i<span style="color:#000;font-weight:bold">++</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>String<span style="color:#bbb"> </span>key<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>keyPrefix<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">+</span><span style="color:#bbb"> </span>i;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>connection.<span style="color:#008080">get</span>(key.<span style="color:#008080">getBytes</span>());<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>});<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>data.<span style="color:#008080">stream</span>().<span style="color:#008080">forEach</span>(System.<span style="color:#008080">out</span>::println);<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÂèëÂ∏ÉËÆ¢ÈòÖ">ÂèëÂ∏ÉËÆ¢ÈòÖ</h3>
<table>
<thead>
<tr>
<th>Â∏∏Áî®ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>PUBLISH</strong> channel message</td>
<td>Â∞Ü‰ø°ÊÅØ <code>message</code> ÂèëÈÄÅÂà∞ÊåáÂÆöÁöÑÈ¢ëÈÅì <code>channel</code></td>
</tr>
<tr>
<td><strong>SUBSCRIBE</strong> channel [channel ‚Ä¶]</td>
<td>ËÆ¢ÈòÖÁªôÂÆöÁöÑ‰∏Ä‰∏™ÊàñÂ§ö‰∏™È¢ëÈÅìÁöÑ‰ø°ÊÅØ</td>
</tr>
<tr>
<td><strong>PSUBSCRIBE</strong> pattern [pattern ‚Ä¶]</td>
<td>ËÆ¢ÈòÖ‰∏Ä‰∏™ÊàñÂ§ö‰∏™Á¨¶ÂêàÁªôÂÆöpatternÁöÑÈ¢ëÈÅì</td>
</tr>
<tr>
<td><strong>UNSUBSCRIBE</strong> [channel [channel ‚Ä¶]]</td>
<td>ÂèñÊ∂àËÆ¢ÈòÖ</td>
</tr>
</tbody>
</table>
<h3 id="bitmap">Bitmap</h3>
<table>
<thead>
<tr>
<th>Â∏∏Áî®ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SETBIT</strong> key offset value</td>
<td>ÂØπ keyÊâÄÂÇ®Â≠òÁöÑÂ≠óÁ¨¶‰∏≤ÂÄºÔºåËÆæÁΩÆÊàñÊ∏ÖÈô§ÊåáÂÆöÂÅèÁßªÈáè‰∏äÁöÑ‰Ωç(bit)</td>
</tr>
<tr>
<td><strong>GETBIT</strong> key offset</td>
<td>ÂØπ keyÊâÄÂÇ®Â≠òÁöÑÂ≠óÁ¨¶‰∏≤ÂÄºÔºåËé∑ÂèñÊåáÂÆöÂÅèÁßªÈáè‰∏äÁöÑ‰Ωç(bit)</td>
</tr>
<tr>
<td><strong>BITCOUNT</strong> key [start] [end]</td>
<td>ËÆ°ÁÆóÁªôÂÆöÂ≠óÁ¨¶‰∏≤‰∏≠ÔºåË¢´ËÆæÁΩÆ‰∏∫ 1ÁöÑÊØîÁâπ‰ΩçÁöÑÊï∞Èáè</td>
</tr>
<tr>
<td><strong>BITOP</strong> operation destkey key [key ‚Ä¶]</td>
<td>ÂØπ‰∏Ä‰∏™ÊàñÂ§ö‰∏™‰øùÂ≠ò‰∫åËøõÂà∂‰ΩçÁöÑÂ≠óÁ¨¶‰∏≤ keyËøõË°å‰ΩçÂÖÉÊìç‰ΩúÔºåÂπ∂Â∞ÜÁªìÊûú‰øùÂ≠òÂà∞ destkey‰∏ä<br /><code>operation</code> ÂèØ‰ª•ÊòØ <code>AND</code> „ÄÅ <code>OR</code> „ÄÅ <code>NOT</code> „ÄÅ <code>XOR</code> ËøôÂõõÁßçÊìç‰Ωú‰∏≠ÁöÑ‰ªªÊÑè‰∏ÄÁßç</td>
</tr>
<tr>
<td><strong>BITPOS</strong> key bit [start] [end]</td>
<td>ËøîÂõû‰ΩçÂõæ‰∏≠Á¨¨‰∏Ä‰∏™ÂÄº‰∏∫ <code>bit</code>ÁöÑ‰∫åËøõÂà∂‰ΩçÁöÑ‰ΩçÁΩÆ</td>
</tr>
</tbody>
</table>
<h3 id="hyperloglog">HyperLogLog</h3>
<p>ÂÆûË¥®ÔºöÁî®StringÁ±ªÂûãÂÆûÁé∞Ôºå‰∏çËÉΩÂèñÂá∫ÂÖ∑‰ΩìÂÄºÔºåÊúâÈîôËØØÁéá</p>
<p>‰ΩúÁî®ÔºöÊûÅÂ∞èÁöÑÁ©∫Èó¥ÂÆûÁé∞Áã¨Á´ãÊï∞ÈáèÁªüËÆ°</p>
<table>
<thead>
<tr>
<th>Â∏∏Áî®ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>PFADD</strong> key element [element ‚Ä¶]</td>
<td>Â∞Ü‰ªªÊÑèÊï∞ÈáèÁöÑÂÖÉÁ¥†Ê∑ªÂä†Âà∞ÊåáÂÆöÁöÑHyperLogLog</td>
</tr>
<tr>
<td><strong>PFCOUNT</strong> key [key ‚Ä¶]</td>
<td>ËÆ°ÁÆóHyperLogLogÊúâÂ§öÂ∞ëÂÄº</td>
</tr>
<tr>
<td><strong>PFMERGE</strong> destkey sourcekey [sourcekey ‚Ä¶]</td>
<td>Â∞ÜÂ§ö‰∏™HyperLogLogÂêàÂπ∂‰∏∫‰∏Ä‰∏™HyperLogLog</td>
</tr>
</tbody>
</table>
<h3 id="geo">Geo</h3>
<p>Geo(Âú∞ÁêÜ‰ø°ÊÅØÂÆö‰Ωç)ÔºöÂ≠òÂÇ®ÁªèÁ∫¨Â∫¶ÔºåËÆ°ÁÆó‰∏§Âú∞Ë∑ùÁ¶ªÔºåËåÉÂõ¥ËÆ°ÁÆóÁ≠â</p>
<p>GeoÊòØ‰ΩøÁî®ZSetÂÆûÁé∞</p>
<table>
<thead>
<tr>
<th>Â∏∏Áî®ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>GEOADD</strong> key longitude latitude member [longitude latitude member ‚Ä¶]</td>
<td>longitudeÔºöÁªèÂ∫¶ÔºålatitudeÔºöÁª¥Â∫¶ÔºåmemberÔºöÊ†áËØÜ</td>
</tr>
<tr>
<td><strong>GEOPOS</strong> key member [member ‚Ä¶]</td>
<td>ËøîÂõûÁªèÁ∫¨Â∫¶</td>
</tr>
<tr>
<td><strong>GEODIST</strong> key member1 member2 [unit]</td>
<td>ËøîÂõû‰∏§‰∏™ÁªôÂÆö‰ΩçÁΩÆ‰πãÈó¥ÁöÑË∑ùÁ¶ª</td>
</tr>
<tr>
<td><strong>GEORADIUS</strong> key longitude latitude radius m|km|ft|mi [WITHCOORD] [WITHDIST] [WITHHASH] [ASC|DESC] [COUNT count]</td>
<td>ËøîÂõûÊåáÂÆöËåÉÂõ¥ÂÜÖÁöÑÊï∞ÊçÆ</td>
</tr>
<tr>
<td><strong>ZREM</strong> key member</td>
<td>Âà†Èô§ÊàêÂëò</td>
</tr>
</tbody>
</table>
<h2 id="‰∏ÉredisÊåÅ‰πÖÂåñ">‰∏É„ÄÅRedisÊåÅ‰πÖÂåñ</h2>
<h3 id="rdbredis-database">RDB„ÄêRedis Database„Äë</h3>
<p>‚Äã	RDBÊòØRedisÁî®Êù•ËøõË°åÊåÅ‰πÖÂåñÁöÑ‰∏ÄÁßçÊñπÂºèÔºåÊòØÊääÂΩìÂâçÂÜÖÂ≠ò‰∏≠ÁöÑÊï∞ÊçÆÈõÜÂø´ÁÖßÂÜôÂÖ•Á£ÅÁõòÔºå‰πüÂ∞±ÊòØ Snapshot Âø´ÁÖßÔºàÊï∞ÊçÆÂ∫ì‰∏≠ÊâÄÊúâÈîÆÂÄºÂØπÊï∞ÊçÆÔºâ„ÄÇÊÅ¢Â§çÊó∂ÊòØÂ∞ÜÂø´ÁÖßÊñá‰ª∂Áõ¥Êé•ËØªÂà∞ÂÜÖÂ≠òÈáå„ÄÇ</p>
<p><strong>Ëß¶ÂèëÊú∫Âà∂</strong></p>
<ul>
<li>
<p>save</p>
<p>ÊâãÂä®Ëß¶ÂèëÔºåÂêåÊ≠•ÂëΩ‰ª§Ôºå‰ºöÈòªÂ°ûÁ∫øÁ®ã</p>
</li>
<li>
<p>bgsave</p>
<p>ÊâãÂä®Ëß¶ÂèëÔºåforkÂá∫‰∏Ä‰∏™Â≠êËøõÁ®ãÔºåÂºÇÊ≠•ÂëΩ‰ª§Ôºå‰∏ç‰ºöÈòªÂ°ûÁ∫øÁ®ã„ÄêÈòªÂ°û‰ªÖ‰ªÖ‰ºöÂèëÁîüÂú®forkÂá∫Â≠êËøõÁ®ãÁöÑÈò∂ÊÆµ„Äë</p>
</li>
<li>
<p>Ëá™Âä®</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>save 900 1            #900ÁßíÊîπÂèò1‰∏™Â∞±ÁîüÊàêrdbÊñá‰ª∂
</span></span><span style="display:flex;"><span>save 300 10           #300ÁßíÊîπÂèò10‰∏™Â∞±ÁîüÊàêrdbÊñá‰ª∂
</span></span><span style="display:flex;"><span>save 60  10000        #60ÁßíÊîπÂèò10000‰∏™Â∞±ÁîüÊàêrdbÊñá‰ª∂
</span></span></code></pre></td></tr></table>
</div>
</div><p>‰∏ÄËà¨ÊÉÖÂÜµ‰∏ãÂª∫ËÆÆÂÖ≥Èó≠Ëá™Âä®Á≠ñÁï•</p>
</li>
<li>
<p>ÂÖ®ÈáèÂ§çÂà∂</p>
<p>‰ªéËäÇÁÇπÊâßË°åÂÖ®ÈáèÂ§çÂà∂Êìç‰ΩúÁöÑÊó∂ÂÄôÔºå‰∏ªËäÇÁÇπ‰ºöËá™Âä®Ëß¶ÂèëbgsaveÂëΩ‰ª§ÁîüÂ≠òrdbÊñá‰ª∂Âπ∂ÂèëÈÄÅÁªô‰ªéËäÇÁÇπ</p>
</li>
<li>
<p>debug reload</p>
<p>Âú®ÊâßË°ådebug reloadÈáçÊñ∞Âä†ËΩΩredisÁöÑÊó∂ÂÄôÔºå‰πü‰ºöËá™Âä®Ëß¶Âèëbgsave</p>
</li>
<li>
<p>shutdown</p>
<p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÊâßË°åshutdownÂëΩ‰ª§ÔºåÂ¶ÇÊûúÊ≤°ÊúâÂºÄÂêØAOFÊåÅ‰πÖÂåñÂäüËÉΩÔºåÂ∞±‰ºöËá™Âä®ÊâßË°åbgsave</p>
</li>
</ul>
<p><strong>RDBÈÖçÁΩÆÂèÇÊï∞</strong></p>
<table>
<thead>
<tr>
<th>ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td>rdbcompression</td>
<td>ÂéãÁº©RDBÊñá‰ª∂ÔºåÈªòËÆ§yes</td>
</tr>
<tr>
<td>rdbchecksum</td>
<td>RDBÊñá‰ª∂ÊòØÂê¶ËøõË°åÊ†°È™åÔºåÈªòËÆ§yes</td>
</tr>
<tr>
<td>dbfilename dump.rdb</td>
<td>RDBÊñá‰ª∂Âêç„ÄêÂèØ‰ΩøÁî®dump-Á´ØÂè£Âè∑.rdbÂå∫ÂàÜ‰∏çÂêåÁöÑredisÂÆû‰æã„Äë</td>
</tr>
<tr>
<td>dir ./</td>
<td>RDBÊñá‰ª∂Â≠òÂÇ®ÁöÑÁõÆÂΩï</td>
</tr>
<tr>
<td>stop-writes-on-bgsave-error</td>
<td>bgsaveÂá∫Áé∞ÈîôËØØÊó∂ÊòØÂê¶ÂÅúÊ≠¢ÂÜôÂÖ•ÔºåÈªòËÆ§yes</td>
</tr>
</tbody>
</table>
<h3 id="aofappend-only-file">AOF„ÄêAppend-Only File„Äë</h3>
<p>‚Äã	AOFÊòØ‰∏Ä‰∏™ËøΩÂä†ÂÜôÂÖ•ÁöÑÊó•ÂøóÊñá‰ª∂‰ªéËÄåÂÆûÁé∞ÊåÅ‰πÖÂåñÁöÑÊñπÂºèÔºåÁîüÊàêÁöÑAOFÊñá‰ª∂ÊòØÂèØËØÜÂà´ÁöÑÁ∫ØÊñáÊú¨Êñá‰ª∂„ÄÇRedisÈªòËÆ§‰ΩøÁî®RDBÊåÅ‰πÖÔºåÂºÄÂêØAOFÊåÅ‰πÖÂåñÈúÄË¶ÅËÆæÁΩÆ<code>appendonly</code>‰∏∫<code>yes</code></p>
<p><strong>AOFÊñá‰ª∂ÁîüÊàêÁ≠ñÁï•</strong></p>
<ul>
<li>
<p>always 		‰∏ç‰∏¢Â§±Êï∞ÊçÆÔºåÊØèÊ¨°Êõ¥Êñ∞ËÆ∞ÂΩïÊï∞ÊçÆÂ∞±ËøõË°åioÊìç‰Ωú</p>
</li>
<li>
<p>everysec	ÂèØËÉΩ‰ºö‰∏¢Â§±1sÊï∞ÊçÆÔºå‰ΩÜioÂ∞è</p>
</li>
<li>
<p>no			‰∏çÂêØÁî®AOF</p>
</li>
</ul>
<p><strong>AOFÈáçÂÜô</strong></p>
<p>‚Äã	AOFÊîØÊåÅAOFÊñá‰ª∂ÈáçÂÜôÔºà‰ªéÂÜÖÂ≠ò‰∏≠ËØªÂèñÁöÑÊï∞ÊçÆÔºåÂπ∂ÈùûËØªÂèñ‰∏äÊ¨°ÁöÑAOFÊñá‰ª∂ËøõË°åÈáçÂÜôÔºâ„ÄÇAOFÈáçÂÜôÂèØ‰ª•ÂáèÂ∞ëÁ°¨ÁõòÂç†Áî®„ÄÅÂä†ÈÄüÊÅ¢Â§çÈÄüÂ∫¶„ÄÇ</p>
<p><img src="/img/redis/Aof-Rewrite.png" alt="Aof-Rewrite"></p>
<p><strong>AOFÈÖçÁΩÆÂèÇÊï∞</strong></p>
<table>
<thead>
<tr>
<th>ÂëΩ‰ª§Ê†ºÂºè</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td>appendonly</td>
<td>ÊòØÂê¶ÂºÄÂêØAOFÔºåÈªòËÆ§no</td>
</tr>
<tr>
<td>appendfilename</td>
<td>ÁîüÊàêAOFÊñá‰ª∂Êòé„ÄêÂèØ‰ΩøÁî®appendonly-Á´ØÂè£Âè∑.aofÂå∫ÂàÜ‰∏çÂêåÁöÑredisÂÆû‰æã„Äë</td>
</tr>
<tr>
<td>appendfsync</td>
<td>Âà∑ÁõòÁ≠ñÁï•ÔºåÈªòËÆ§everysecond</td>
</tr>
<tr>
<td>dir</td>
<td>‰øùÂ≠òÊñá‰ª∂ÁöÑÁõÆÂΩïÔºåÈªòËÆ§./</td>
</tr>
<tr>
<td>no-appendfsync-on-rewrite</td>
<td>AOFÈáçÂÜôËøáÁ®ã‰∏≠ÊòØÂê¶Á¶ÅÊ≠¢appendÊìç‰ΩúÔºåÈªòËÆ§noÂÖÅËÆ∏append</td>
</tr>
<tr>
<td>auto-aof-rewrite-min-size</td>
<td>ËøõË°åAOFÊó∂Êñá‰ª∂ÊúÄÂ∞èÂ∞∫ÂØ∏ÔºåÈªòËÆ§64mb</td>
</tr>
<tr>
<td>auto-aof-rewrite-percentage</td>
<td>‰∏ãÊ¨°ËøõË°åAOFÊìç‰ΩúÊó∂ÁöÑÂ¢ûÈáèÔºåÈªòËÆ§100</td>
</tr>
<tr>
<td>aof-load-truncated</td>
<td>AOFÊñá‰ª∂ÁªìÂ∞æ‰∏çÂÆåÊï¥ÔºåRedisÈáçÂêØÂøΩÁï•‰∏çÂÆåÊï¥ËÆ∞ÂΩïÔºåÈªòËÆ§yes</td>
</tr>
</tbody>
</table>
<p>ÂëΩ‰ª§</p>
<ul>
<li>bgrewriteaof                   ÊâãÂä®ËøõË°åAOFÈáçÂÜôÊìç‰Ωú</li>
<li>aof_current_size             Êü•ÁúãAOFÂΩìÂâçÂ∞∫ÂØ∏</li>
</ul>
<p><code>redis-cli info Persistence</code>ÂèØ‰ª•Êü•ÁúãÁªüËÆ°‰ø°ÊÅØ<code>aof_current_size</code>„ÄêÂΩìÂâçAOFÊñá‰ª∂Â§ßÂ∞è„ÄëÂíå<code>aof_base_size</code>„Äê‰∏äÊ¨°ÈáçÂÜôAOFÊñá‰ª∂Â§ßÂ∞è„Äë</p>
<h3 id="rdb‰∏éaofÊØîËæÉ">RDB‰∏éAOFÊØîËæÉ</h3>
<table>
<thead>
<tr>
<th>ÂëΩ‰ª§</th>
<th>RDB</th>
<th>AOF</th>
</tr>
</thead>
<tbody>
<tr>
<td>ÂêØÂä®‰ºòÂÖàÁ∫ß</td>
<td>‰Ωé</td>
<td>È´ò</td>
</tr>
<tr>
<td>‰ΩìÁßØ</td>
<td>Â∞è</td>
<td>Â§ß</td>
</tr>
<tr>
<td>ÊÅ¢Â§ç</td>
<td>Âø´</td>
<td>ÊÖ¢</td>
</tr>
<tr>
<td>Êï∞ÊçÆÂÆâÂÖ®ÊÄß</td>
<td>‰∏¢Êï∞ÊçÆ</td>
<td>Ê†πÊçÆÁ≠ñÁï•ÂÜ≥ÂÆö</td>
</tr>
<tr>
<td>ËΩªÈáç</td>
<td>Èáç</td>
<td>ËΩª</td>
</tr>
</tbody>
</table>
<h3 id="Ê∑∑ÂêàÊåÅ‰πÖÂåñ">Ê∑∑ÂêàÊåÅ‰πÖÂåñ</h3>
<p>Redis 4.0 ÂºÄÂßãÊîØÊåÅ rdb Âíå aof ÁöÑÊ∑∑ÂêàÊåÅ‰πÖÂåñ(ÈªòËÆ§ÂºÄÂêØ)ÔºåËøôÊ†∑ÂÅöÁöÑÂ•ΩÂ§ÑÊòØÂèØ‰ª•ÁªìÂêà rdb Âíå aof ÁöÑ‰ºòÁÇπ, Âø´ÈÄüÂä†ËΩΩÂêåÊó∂ÈÅøÂÖç‰∏¢Â§±ËøáÂ§öÁöÑÊï∞ÊçÆ„ÄÇÁº∫ÁÇπ aof ÈáåÈù¢ÁöÑ rdb ÈÉ®ÂàÜÂ∞±ÊòØÂéãÁº©Ê†ºÂºè‰∏çÂÜçÊòØ aof Ê†ºÂºèÔºåÂèØËØªÊÄßÂ∑Æ„ÄÇ</p>
<ul>
<li>
<p>ÈÖçÁΩÆÂºÄÂêØÊ∑∑ÂêàÊåÅ‰πÖÂåñ<code>aof-use-rdb-preamble yes</code></p>
</li>
<li>
<p>ÂëΩ‰ª§ÂºÄÂêØÊ∑∑ÂêàÊåÅ‰πÖÂåñ<code>config set aof-use-rdb-preamble yes</code></p>
</li>
</ul>
<p>ÂºÄÂêØÊ∑∑ÂêàÊåÅ‰πÖÂåñÊó∂Ôºåaof rewrite ÁöÑÊó∂ÂÄôÂ∞±Áõ¥Êé•Êää rdb ÁöÑÂÜÖÂÆπÂÜôÂà∞ aof Êñá‰ª∂ÂºÄÂ§¥„ÄÇaof Êñá‰ª∂ÂÜÖÂÆπ‰ºöÂèòÊàêÂ¶Ç‰∏ã</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>+------------------------+
</span></span><span style="display:flex;"><span>|                        |   
</span></span><span style="display:flex;"><span>|                        |   
</span></span><span style="display:flex;"><span>|          RDB           |   
</span></span><span style="display:flex;"><span>|         FORMAT         |   
</span></span><span style="display:flex;"><span>|                        |   
</span></span><span style="display:flex;"><span>|                        |   
</span></span><span style="display:flex;"><span>|                        |   
</span></span><span style="display:flex;"><span>+------------------------+
</span></span><span style="display:flex;"><span>|                        |   
</span></span><span style="display:flex;"><span>|        AOF             |   
</span></span><span style="display:flex;"><span>|       FORMAT           |   
</span></span><span style="display:flex;"><span>+------------------------+
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÊåÅ‰πÖÂåñÁõ∏ÂÖ≥‰ºòÂåñ">ÊåÅ‰πÖÂåñÁõ∏ÂÖ≥‰ºòÂåñ</h3>
<p><strong>forkÊìç‰Ωú‰ºòÂåñ</strong></p>
<ul>
<li>
<p>ÊéßÂà∂redisÂÆû‰æãÊúÄÂ§ßÂèØÁî®ÂÜÖÂ≠òÔºömaxmemory</p>
</li>
<li>
<p>ÂêàÁêÜÈÖçÁΩÆLinuxÂÜÖÂ≠òÂàÜÈÖçÁ≠ñÁï•Ôºövm.overcommit_momory=1(ÈªòËÆ§0ÔºåÂΩìÂÜÖÂ≠òÂ∞ëÊó∂forkÈòªÂ°û‰∏çËøõË°å)</p>
</li>
<li>
<p>Èôç‰ΩéforkÈ¢ëÁéáÔºö‰æãÂ¶ÇÊîæÂÆΩAOFÈáçÂÜôËá™Âä®Ëß¶ÂèëÊó∂Êú∫Ôºå‰∏çÂøÖË¶ÅÁöÑÂÖ®ÈáèÂ§çÂà∂</p>
</li>
</ul>
<p><strong>Â≠êËøõÁ®ã</strong></p>
<ul>
<li>
<p>cpu</p>
<p>ÂºÄÈîÄÔºöRDBÂíåAOFÊñá‰ª∂ÁîüÊàêÔºåÂ±û‰∫éCPUÂØÜÈõÜÂûã</p>
<p>‰ºòÂåñÔºö‰∏çÂÅöCPUÁªëÂÆöÔºå‰∏çÂíåCPUÂØÜÈõÜÂûãÊúçÂä°ÈÉ®ÁΩ≤</p>
</li>
<li>
<p>ÂÜÖÂ≠ò</p>
<p>ÂºÄÈîÄÔºöforkÂÜÖÂ≠òÂºÄÈîÄÔºå‰ΩøÁî®‰∫ÜlinuxÁöÑcopy-on-write„ÄêÁà∂ËøõÁ®ãÊú™ÂèëÁîüÊîπÂèòÁöÑÂÜÖÂ≠òÈ°µÔºå‰∏çËøõË°åcopy-write„Äë</p>
<p>‰ºòÂåñÔºöecho never &gt; /sys/kernel/mm/transparent_hugepage/enabled„Äê‰∏çÂàÜÈÖçÂ§ßÂÜÖÂ≠òÈ°µ„Äë</p>
</li>
<li>
<p>Á°¨Áõò</p>
<p>ÂºÄÈîÄÔºöAOFÂíåRDBÊñá‰ª∂ÂÜôÂÖ•ÔºåÂèØ‰ª•ÁªìÂêàiostatÔºåiotopÂàÜÊûê</p>
<p>‰ºòÂåñÔºö‰∏çÂíåÈ´òÁ°¨ÁõòË¥üËΩΩÊúçÂä°ÈÉ®ÁΩ≤‰∏ÄËµ∑Ôºå<code>no-appendfsync-on-rewrite</code>ËÆæÁΩÆ‰∏∫yes</p>
</li>
</ul>
<h2 id="ÂÖ´redis‰∏ª‰ªéÂ§çÂà∂ÂéüÁêÜÂíå‰ºòÂåñ">ÂÖ´„ÄÅRedis‰∏ª‰ªéÂ§çÂà∂ÂéüÁêÜÂíå‰ºòÂåñ</h2>
<ul>
<li>‰∏Ä‰∏™masterÂèØ‰ª•ÊúâÂ§ö‰∏™slave</li>
<li>‰∏Ä‰∏™slaveÂè™ËÉΩÊúâ‰∏Ä‰∏™master</li>
<li>Êï∞ÊçÆÊµÅÂêëÊòØÂçïÂêëÁöÑÔºåmasterÂà∞slave</li>
</ul>
<h3 id="‰∏ª‰ªéÂÆûÁé∞‰∏§ÁßçÊñπÂºè">‰∏ª‰ªéÂÆûÁé∞‰∏§ÁßçÊñπÂºè</h3>
<ul>
<li>
<p>Âú®‰ªéÊú∫‰∏äÊâßË°å<code>slaveof masterIp masterPort</code>ÔºåÊ≠§ÂëΩ‰ª§ÊòØÂºÇÊ≠•„ÄÇ<code>slaveof no one</code>ÁªìÊùü‰ªéÂ±ûÂÖ≥Á≥ª„ÄÇ</p>
</li>
<li>
<p>‰øÆÊîπredisÈÖçÁΩÆÊñá‰ª∂</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>slaveof masterIp masterPort               #ÈÖçÁΩÆ‰∏ª‰ªé
</span></span><span style="display:flex;"><span>slave-read-only  yes                      #‰ªéËäÇÁÇπÂè™ËØª
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<blockquote>
<p>‰∏ª‰ªéÁä∂ÊÄÅÊü•Áúã<code>info replication</code></p>
</blockquote>
<h3 id="ÂÖ®ÈáèÂ§çÂà∂ÂíåÈÉ®ÂàÜÂ§çÂà∂">ÂÖ®ÈáèÂ§çÂà∂ÂíåÈÉ®ÂàÜÂ§çÂà∂</h3>
<p>redis4Âêé‰ΩøÁî®psync2ÂÆûÁé∞Â§çÂà∂‰ΩøredisÈáçÂêØ‰πüÂèØ‰ΩøÁî®ÈÉ®ÂàÜÂêåÊ≠•ÔºåËøò‰∏∫Ëß£ÂÜ≥Âú®‰∏ªÂ∫ìÊïÖÈöúÊó∂ÂÄô‰ªéÂ∫ìÂàáÊç¢‰∏∫‰∏ªÂ∫ìÊó∂ÂÄô‰ΩøÁî®ÈÉ®ÂàÜÂêåÊ≠•Êú∫Âà∂„ÄÇredis‰ªéÂ∫ìÈªòËÆ§ÂºÄÂêØÂ§çÂà∂ÁßØÂéãÁºìÂÜ≤Âå∫ÂäüËÉΩÔºå‰ª•‰æø‰ªéÂ∫ìÊïÖÈöúÂàáÊç¢ÂèòÂåñmasterÂêéÔºåÂÖ∂‰ªñËêΩÂêéËØ•‰ªéÂ∫ìÂèØ‰ª•‰ªéÁºìÂÜ≤Âå∫‰∏≠Ëé∑ÂèñÁº∫Â∞ëÁöÑÂëΩ‰ª§„ÄÇËØ•ËøáÁ®ãÁöÑÂÆûÁé∞ÈÄöËøá‰∏§ÁªÑreplid„ÄÅoffsetÊõøÊç¢ÂéüÊù•ÁöÑmaster runidÂíåoffsetÂèòÈáèÂÆûÁé∞Ôºö</p>
<ul>
<li>
<p>Á¨¨‰∏ÄÁªÑÔºömaster_replidÂíåmaster_repl_offset</p>
<p>Â¶ÇÊûúredisÊòØ‰∏ªÂÆû‰æãÔºåÂàôË°®Á§∫‰∏∫Ëá™Â∑±ÁöÑreplidÂíåÂ§çÂà∂ÂÅèÁßªÈáèÔºõ Â¶ÇÊûúredisÊòØ‰ªéÂÆû‰æãÔºåÂàôË°®Á§∫‰∏∫Ëá™Â∑±‰∏ªÂÆû‰æãÁöÑreplid1ÂíåÂêåÊ≠•‰∏ªÂÆû‰æãÁöÑÂ§çÂà∂ÂÅèÁßªÈáè„ÄÇ</p>
</li>
<li>
<p>Á¨¨‰∫åÁªÑÔºömaster_replid2Âíåsecond_repl_offset</p>
<p>Êó†ËÆ∫‰∏ª‰ªéÔºåÈÉΩË°®Á§∫Ëá™Â∑±‰∏äÊ¨°‰∏ªÂÆû‰æãrepid1ÂíåÂ§çÂà∂ÂÅèÁßªÈáèÔºõÁî®‰∫éÂÖÑÂºüÂÆû‰æãÊàñÁ∫ßËÅîÂ§çÂà∂Ôºå‰∏ªÂ∫ìÊïÖÈöúÂàáÊç¢psync</p>
</li>
</ul>
<p>Âà§Êñ≠ÊòØÂê¶‰ΩøÁî®ÈÉ®ÂàÜÂ§çÂà∂Êù°‰ª∂ÔºöÂ¶ÇÊûú‰ªéÂ∫ìÊèê‰æõÁöÑmaster_replid‰∏émasterÁöÑreplid‰∏çÂêåÔºå‰∏î‰∏émasterÁöÑreplid2‰∏çÂêåÔºåÊàñÂêåÊ≠•ÈÄüÂ∫¶Âø´‰∫émasterÔºõ Â∞±ÂøÖÈ°ªËøõË°åÂÖ®ÈáèÂ§çÂà∂ÔºåÂê¶ÂàôÊâßË°åÈÉ®ÂàÜÂ§çÂà∂„ÄÇ</p>
<p>‰ª•‰∏ãÂ∏∏ËßÅÁöÑ‰∏ª‰ªéÂàáÊç¢ÈÉΩÂèØ‰ª•‰ΩøÁî®ÈÉ®ÂàÜÂ§çÂà∂Ôºö</p>
<ul>
<li>‰∏Ä‰∏ª‰∏Ä‰ªéÂèëÁîüÂàáÊç¢ÔºåA-&gt;B ÂàáÊç¢ÂèòÊàê B-&gt;A</li>
<li>‰∏Ä‰∏ªÂ§ö‰ªéÂèëÁîüÂàáÊç¢ÔºåÂÖÑÂºüËäÇÁÇπÂèòÊàêÁà∂Â≠êËäÇÁÇπÊó∂</li>
<li>Á∫ßÂà´Â§çÂà∂ÂèëÁîüÂàáÊç¢Ôºå A-&gt;B-&gt;C ÂàáÊç¢ÂèòÊàê B-&gt;C-&gt;A</li>
</ul>
<h3 id="ÂÖ®ÈáèÂ§çÂà∂ÂºÄÈîÄ">ÂÖ®ÈáèÂ§çÂà∂ÂºÄÈîÄ</h3>
<ul>
<li>bgsaveÊó∂Èó¥</li>
<li>RDBÊñá‰ª∂ÁΩëÁªúÊó∂Èó¥</li>
<li>‰ªéËäÇÁÇπÊ∏ÖÁ©∫Êï∞ÊçÆÊó∂Èó¥</li>
<li>‰ªéËäÇÁÇπÂä†ËΩΩRDBÊó∂Èó¥</li>
<li>ÂèØËÉΩÁöÑAOFÈáçÂÜôÊó∂Èó¥</li>
</ul>
<p>ÂΩì‰ªéÂ∫ì‰∏é‰∏ªÂ∫ìÊñ≠ÂºÄÊó∂Èó¥ËøáÈïøÂØºËá¥Ëá™Â∑±ÁöÑÂÅèÁßªÈáè‰∏çÂú®<code>master_repl_offset</code>ÂÖÅËÆ∏ÁöÑËåÉÂõ¥‰πãÂÜÖÔºå‰ºöËß¶ÂèëÂÖ®ÈáèÂ§çÂà∂</p>
<h3 id="‰∏ª‰ªéÁõ∏ÂÖ≥ÂèÇÊï∞ÈÖçÁΩÆ">‰∏ª‰ªéÁõ∏ÂÖ≥ÂèÇÊï∞ÈÖçÁΩÆ</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>##############‰ªéÂ∫ì##############
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>slaveof &lt;masterip&gt; &lt;masterport&gt; 
</span></span><span style="display:flex;"><span>#ËÆæÁΩÆËØ•Êï∞ÊçÆÂ∫ì‰∏∫ÂÖ∂‰ªñÊï∞ÊçÆÂ∫ìÁöÑ‰ªéÊï∞ÊçÆÂ∫ì
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>masterauth &lt;master-password&gt;
</span></span><span style="display:flex;"><span>#‰∏ª‰ªéÂ§çÂà∂‰∏≠ÔºåËÆæÁΩÆËøûÊé•masterÊúçÂä°Âô®ÁöÑÂØÜÁ†ÅÔºàÂâçÊèêmasterÂêØÁî®‰∫ÜËÆ§ËØÅÔºâ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>slave-serve-stale-data yes
</span></span><span style="display:flex;"><span># ÂΩì‰ªéÂ∫ìÂêå‰∏ªÂ∫ìÂ§±ÂéªËøûÊé•ÊàñËÄÖÂ§çÂà∂Ê≠£Âú®ËøõË°åÔºå‰ªéÂ∫ìÊúâ‰∏§ÁßçËøêË°åÊñπÂºèÔºö
</span></span><span style="display:flex;"><span># 1) Â¶ÇÊûúslave-serve-stale-dataËÆæÁΩÆ‰∏∫yes(ÈªòËÆ§ËÆæÁΩÆ)Ôºå‰ªéÂ∫ì‰ºöÁªßÁª≠Áõ∏Â∫îÂÆ¢Êà∑Á´ØÁöÑËØ∑Ê±Ç
</span></span><span style="display:flex;"><span># 2) Â¶ÇÊûúslave-serve-stale-dataËÆæÁΩÆ‰∏∫noÔºåÈô§‰∫ÜINFOÂíåSLAVOFÂëΩ‰ª§‰πãÂ§ñÁöÑ‰ªª‰ΩïËØ∑Ê±ÇÈÉΩ‰ºöËøîÂõû‰∏Ä‰∏™ÈîôËØØ&#34;SYNC with master in progress&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>slave-priority 100
</span></span><span style="display:flex;"><span>#ÂΩì‰∏ªÂ∫ìÂèëÁîüÂÆïÊú∫Êó∂ÂÄôÔºåÂì®ÂÖµ‰ºöÈÄâÊã©‰ºòÂÖàÁ∫ßÊúÄÈ´òÁöÑ‰∏Ä‰∏™Áß∞‰∏∫‰∏ªÂ∫ìÔºå‰ªéÂ∫ì‰ºòÂÖàÁ∫ßÈÖçÁΩÆÈªòËÆ§100ÔºåÊï∞ÂÄºË∂äÂ∞è‰ºòÂÖàÁ∫ßË∂äÈ´ò
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>slave-read-only yes
</span></span><span style="display:flex;"><span>#‰ªéËäÇÁÇπÊòØÂê¶Âè™ËØªÔºõÈªòËÆ§yesÂè™ËØªÔºå‰∏∫‰∫Ü‰øùÊåÅÊï∞ÊçÆ‰∏ÄËá¥ÊÄßÔºåÂ∫î‰øùÊåÅÈªòËÆ§
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>##############‰∏ªÂ∫ì##############
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>repl-disable-tcp-nodelay no
</span></span><span style="display:flex;"><span>#Âú®slaveÂíåmasterÂêåÊ≠•ÂêéÔºàÂèëÈÄÅpsync/syncÔºâÔºåÂêéÁª≠ÁöÑÂêåÊ≠•ÊòØÂê¶ËÆæÁΩÆÊàêTCP_NODELAYÂÅáÂ¶ÇËÆæÁΩÆÊàêyesÔºåÂàôredis‰ºöÂêàÂπ∂Â∞èÁöÑTCPÂåÖ‰ªéËÄåËäÇÁúÅÂ∏¶ÂÆΩÔºå‰ΩÜ‰ºöÂ¢ûÂä†ÂêåÊ≠•Âª∂ËøüÔºà40msÔºâÔºåÈÄ†Êàêmaster‰∏éslaveÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÂÅáÂ¶ÇËÆæÁΩÆÊàênoÔºåÂàôredis master‰ºöÁ´ãÂç≥ÂèëÈÄÅÂêåÊ≠•Êï∞ÊçÆÔºåÊ≤°ÊúâÂª∂Ëøü
</span></span><span style="display:flex;"><span>#ÂâçËÄÖÂÖ≥Ê≥®ÊÄßËÉΩÔºåÂêéËÄÖÂÖ≥Ê≥®‰∏ÄËá¥ÊÄß
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>repl-ping-slave-period 10
</span></span><span style="display:flex;"><span>#‰ªéÂ∫ì‰ºöÊåâÁÖß‰∏Ä‰∏™Êó∂Èó¥Èó¥ÈöîÂêë‰∏ªÂ∫ìÂèëÈÄÅPINGÂëΩ‰ª§Êù•Âà§Êñ≠‰∏ªÊúçÂä°Âô®ÊòØÂê¶Âú®Á∫øÔºåÈªòËÆ§ÊòØ10Áßí
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>repl-backlog-size 1mb
</span></span><span style="display:flex;"><span>#Â§çÂà∂ÁßØÂéãÁºìÂÜ≤Âå∫Â§ßÂ∞èËÆæÁΩÆ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>repl-backlog-ttl 3600
</span></span><span style="display:flex;"><span>#masterÊ≤°Êúâslave‰∏ÄÊÆµÊó∂Èó¥‰ºöÈáäÊîæÂ§çÂà∂ÁºìÂÜ≤Âå∫ÁöÑÂÜÖÂ≠òÔºårepl-backlog-ttlÁî®Êù•ËÆæÁΩÆËØ•Êó∂Èó¥ÈïøÂ∫¶„ÄÇÂçï‰Ωç‰∏∫Áßí„ÄÇ
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>min-slaves-to-write 3
</span></span><span style="display:flex;"><span>min-slaves-max-lag 10
</span></span><span style="display:flex;"><span>#ËÆæÁΩÆÊüê‰∏™Êó∂Èó¥Êñ≠ÂÜÖÔºåÂ¶ÇÊûú‰ªéÂ∫ìÊï∞ÈáèÂ∞è‰∫éËØ•Êüê‰∏™ÂÄºÂàô‰∏çÂÖÅËÆ∏‰∏ªÊú∫ËøõË°åÂÜôÊìç‰ΩúÔºå‰ª•‰∏äÂèÇÊï∞Ë°®Á§∫10ÁßíÂÜÖÂ¶ÇÊûú‰∏ªÂ∫ìÁöÑ‰ªéËäÇÁÇπÂ∞è‰∫é3‰∏™ÔºåÂàô‰∏ªÂ∫ì‰∏çÊé•ÂèóÂÜôËØ∑Ê±ÇÔºåmin-slaves-to-write 0‰ª£Ë°®ÂÖ≥Èó≠Ê≠§ÂäüËÉΩ„ÄÇ
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>‰∏ª‰ªéÈÖçÁΩÆÈóÆÈ¢ò</strong></p>
<p>maxmomory‰∏ç‰∏ÄËá¥ÂØºËá¥‰∏¢Â§±Êï∞ÊçÆ</p>
<p>Êï∞ÊçÆÁªìÊûÑÂèÇÊï∞‰ºòÂåñÂè™Êúâ‰ºòÂåñ‰∫Ü‰∏ªÊú∫Ôºå‰ªéÊú∫Êú™ÈÖçÁΩÆÂØºËá¥ÂÜÖÂ≠ò‰∏ç‰∏ÄËá¥ÔºåÊï∞ÊçÆÈîôËØØÊàñ‰∏¢Â§±</p>
<h2 id="‰πùredis-sentinel">‰πù„ÄÅRedis Sentinel</h2>
<ul>
<li>‰∏ªËßÇ‰∏ãÁ∫øÔºöSentinelÊ†πÊçÆÈÖçÁΩÆÊù°‰ª∂ÔºåÂèëÁé∞redisËäÇÁÇπËææÂà∞ÊïÖÈöúÊ†áÂáÜÔºåÂàôÊ≠§SentinelËÆ§‰∏∫Ê≠§redisËäÇÁÇπ‰∏ãÁ∫ø</li>
<li>ÂÆ¢ËßÇ‰∏ãÁ∫øÔºöÂΩìSentinel‰∏≠ËÆ§‰∏∫Ê≠§redisÂÆ¢ËßÇ‰∏ãÁ∫øÁöÑÊÄªÊï∞ËææÂà∞ÈÖçÁΩÆÈòôÂÄºÔºåÂàôËÆ§‰∏∫Ê≠§ËäÇÁÇπÂÆ¢ËßÇ‰∏ãÁ∫ø</li>
</ul>
<h3 id="ÂÆâË£Ösentinel">ÂÆâË£ÖSentinel</h3>
<p>ÈÖçÁΩÆsentinel.confÊñá‰ª∂</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>#Ê≤°ÊúâÂºÄÂêØbindÂíåÂØÜÁ†ÅÁöÑÊÉÖÂÜµ‰∏ãÔºå‰øùÊä§Ê®°ÂºèÈªòËÆ§Ë¢´ÂºÄÂêØ„ÄÇÂè™Êé•ÂèóÊù•Ëá™ÁéØÂõûIPv4ÂíåIPv6Âú∞ÂùÄÁöÑËøûÊé•„ÄÇÊãíÁªùÂ§ñÈÉ®ËøûÊé•
</span></span><span style="display:flex;"><span>bind 127.0.0.1 192.168.1.1
</span></span><span style="display:flex;"><span>protected-mode no
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Á´ØÂè£
</span></span><span style="display:flex;"><span>port 26379
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#ÊòØÂê¶ÂÆàÊä§ËøõÁ®ãÊ®°ÂºèËøêË°å
</span></span><span style="display:flex;"><span>daemonize no
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#pid‰ª•ÂèäÊó•ÂøóÊñá‰ª∂‰ΩçÁΩÆ
</span></span><span style="display:flex;"><span>pidfile /var/run/redis-sentinel.pid
</span></span><span style="display:flex;"><span>logfile &#34;&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#Â∑•‰ΩúÁõÆÂΩï
</span></span><span style="display:flex;"><span>dir /tmp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#ÁõëÊéßÁöÑmaster
</span></span><span style="display:flex;"><span>#mymasterÊåáÊ≠§‰∏ª‰ªéÁªÑÁöÑÂêçÁß∞„ÄêSentinelÂèØ‰ª•ÁõëÊéßÂ§ö‰∏™‰∏ª‰ªéÁªÑ„Äë
</span></span><span style="display:flex;"><span>#ÊúÄÂêé‰∏Ä‰∏™Êï∞Â≠ó‰ª£Á†ÅÂ§öÂ∞ë‰∏™sentinel‰∏ªËßÇËÆ§‰∏∫Ê≠§masterÂÆïÊú∫‰∏∫ÂÆ¢ËßÇÂÆïÊú∫‰∫ãÂÆû
</span></span><span style="display:flex;"><span>sentinel monitor mymaster 127.0.0.1 6379 2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#ÂΩìÂ§öÂ∞ëÊØ´Áßímaster‰∏çËøîÂõûpingÁªìÊûúÂç≥ËÆ§‰∏∫‰∏ªËßÇÂÆïÊú∫
</span></span><span style="display:flex;"><span>sentinel down-after-milliseconds mymaster 30000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#masterÈáçÊñ∞ÈÄâ‰∏æ‰πãÂêéslaveÂπ∂ÂèëÂ§çÂà∂masterÊï∞ÊçÆÁöÑÂπ∂ÂèëÈáè
</span></span><span style="display:flex;"><span>sentinel parallel-syncs mymaster 1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#ÊïÖÈöúËΩ¨ÁßªË∂ÖÊó∂Êó∂Èó¥ÔºåÈªòËÆ§‰∏∫3ÂàÜÈíü
</span></span><span style="display:flex;"><span>sentinel failover-timeout mymaster 180000
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#ÂΩìsentinelÊúâ‰ªª‰ΩïË≠¶ÂëäÁ∫ßÂà´ÁöÑ‰∫ã‰ª∂ÂèëÁîüÊó∂ÔºàÊØîÂ¶ÇËØ¥redisÂÆû‰æãÁöÑ‰∏ªËßÇÂ§±ÊïàÂíåÂÆ¢ËßÇÂ§±ÊïàÁ≠âÁ≠âÔºâÔºåÂ∞Ü‰ºöË∞ÉÁî®Ëøô‰∏™ËÑöÊú¨
</span></span><span style="display:flex;"><span>#Â¶ÇÊûúËÑöÊú¨‰ª•‚Äú1‚ÄùÈÄÄÂá∫ÔºåÂàôÁ®çÂêéÈáçËØïÊâßË°åÔºàÊúÄÂ§öÂèØÊâßË°å10Ê¨°ÔºâÔºåËÑöÊú¨ÁöÑÊúÄÈïøËøêË°åÊó∂Èó¥‰∏∫60Áßí
</span></span><span style="display:flex;"><span>#sentinel notification-script mymaster /var/redis/notify.sh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#ÂΩìmasterÂõ†failoverËÄåÂèëÁîüÊîπÂèòÔºåËøô‰∏™ËÑöÊú¨Â∞ÜË¢´Ë∞ÉÁî®ÔºåÈÄöÁü•Áõ∏ÂÖ≥ÁöÑÂÆ¢Êà∑Á´ØÂÖ≥‰∫émasterÂú∞ÂùÄÂ∑≤ÁªèÂèëÁîüÊîπÂèòÁöÑ‰ø°ÊÅØ
</span></span><span style="display:flex;"><span>#sentinel client-reconfig-script mymaster /var/redis/reconfig.sh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#‰∏çÂÖÅËÆ∏‰ΩøÁî®SENTINEL SETËÆæÁΩÆnotification-scriptÂíåclient-reconfig-script
</span></span><span style="display:flex;"><span>sentinel deny-scripts-reconfig yes
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="sentinel‰∏â‰∏™ÂÆöÊó∂‰ªªÂä°">Sentinel‰∏â‰∏™ÂÆöÊó∂‰ªªÂä°</h3>
<ul>
<li>ÊØè10ÁßíÊØè‰∏™sentinelÂØπmasterÂíåslaveÊâßË°åinfo
<ul>
<li>ÂèëÁé∞slave</li>
<li>Á°ÆËÆ§‰∏ª‰ªéÂÖ≥Á≥ª</li>
</ul>
</li>
<li>ÊØè2ÁßíÊØè‰∏™sentinelÈÄöËøámasterËäÇÁÇπÁöÑchannel‰∫§Êç¢‰ø°ÊÅØÔºàpub/subÊ®°ÂºèÔºâ
<ul>
<li>ÈÄöËøá<code>__sentinel__:hello</code>È¢ëÈÅì‰∫§‰∫í</li>
<li>‰∫§‰∫íÂêÑËäÇÁÇπÁöÑ‚ÄúÁúãÊ≥ï‚ÄùÂèäËá™Ë∫´‰ø°ÊÅØ</li>
</ul>
</li>
<li>ÊØè1ÁßíÊØè‰∏™sentinelÂØπÂÖ∂‰ªñsentinelÂíåredisËäÇÁÇπÊâßË°åping
<ul>
<li>ÂøÉË∑≥Ê£ÄÊü•„ÄÅÂ§±Ë¥•‰æùÊçÆ</li>
</ul>
</li>
</ul>
<h3 id="masterÈÄâ‰∏æËøáÁ®ã">MasterÈÄâ‰∏æËøáÁ®ã</h3>
<p><strong>Á¨¨‰∏ÄÊ≠•ÔºöSentinelÈÄâ‰∏æÂá∫leader</strong></p>
<p>ÂéüÂõ†ÔºöÂè™ÈúÄË¶Å‰∏Ä‰∏™SentinelÂÆåÊàêÊïÖÈöúËΩ¨Áßª</p>
<p>ÈÄâ‰∏æÔºöÈÄöËøá<code>sentinel is-master-down-by-addr</code>ÂëΩ‰ª§ÈÉΩÂ∏åÊúõËá™Â∑±Êàê‰∏∫È¢ÜÂØºËÄÖ</p>
<ul>
<li>ÊØè‰∏™ÂÅö‰∏ªËßÇ‰∏ãÁ∫øÁöÑSentinelËäÇÁÇπÂêëÂÖ∂ÂÆÉSentinelËäÇÁÇπÂèëÈÄÅÂëΩ‰ª§ÔºåË¶ÅÊ±ÇÂÆÉÁªôËá™Â∑±ÊäïÁ•®</li>
<li>Êî∂Âà∞ÂëΩ‰ª§ÁöÑSentinelËäÇÁÇπÂ¶ÇÊûúÊ≤°ÊúâÂêåÊÑèÂÖ∂ÂÆÉSentinelËäÇÁÇπÂèëÈÄÅÁöÑÂëΩ‰ª§ÔºåÂàôÂêåÊÑèÊäïÁ•®Âê¶ÂàôÊãíÁªù</li>
<li>Â¶ÇÊûúËØ•SentinelËäÇÁÇπÂèëÁé∞Ëá™Â∑±ÁöÑÁ•®Êï∞Â∑≤ÁªèË∂ÖËøáSentinelÂçäÊï∞ÔºåÈÇ£‰πàÂÆÉÂ∞ÜÊàê‰∏∫leader</li>
<li>Â¶ÇÊûúÊ≠§ËøáÁ®ãÊú™ÈÄâÂá∫leaderÂàôÁ≠âÂæÖ‰∏ÄÊÆµÊó∂Èó¥ÁªßÁª≠ÈÄâ‰∏æ</li>
</ul>
<p><strong>Á¨¨‰∫åÊ≠•ÔºöÊïÖÈöúËΩ¨ÁßªÈÄâ‰∏æMaster</strong></p>
<ul>
<li>
<p>‰ªéslaveËäÇÁÇπ‰∏≠ÈÄâÂá∫‰∏Ä‰∏™‚ÄúÂêàÈÄÇ‚ÄùÁöÑËäÇÁÇπ‰Ωú‰∏∫Êñ∞ÁöÑmasterËäÇÁÇπ</p>
<ul>
<li>ÈÄâÊã©<code>slave-prority</code>ÊúÄÈ´òÁöÑslaveËäÇÁÇπÔºåÂ¶ÇÊûúÂ≠òÂú®ÂàôËøîÂõû„Äê‰∏ÄËà¨‰∏ç‰øÆÊîπ„Äë</li>
<li>ÈÄâÊã©Â§çÂà∂ÂÅèÁßªÈáèÊúÄÂ§ßÁöÑslaveËäÇÁÇπÔºåÂ¶ÇÊûúÂ≠òÂú®ÂàôËøîÂõû</li>
<li>ÈÄâÊã©runIdÊúÄÂ∞èÁöÑslaveËäÇÁÇπ</li>
</ul>
</li>
<li>
<p>ÂØπ‰∏äÈù¢ÁöÑslaveËäÇÁÇπÊâßË°å<code>slaveof no one</code>ÂëΩ‰ª§ËÆ©ÂÖ∂Êàê‰∏∫masterËäÇÁÇπ</p>
</li>
<li>
<p>ÂêëÂâ©‰ΩôÁöÑslaveËäÇÁÇπÂèëÈÄÅ<code>slaveof</code>ÂëΩ‰ª§ÔºåËÆ©ÂÆÉ‰ª¨Êàê‰∏∫masterËäÇÁÇπÁöÑslaveËäÇÁÇπÔºåÂ§çÂà∂ËßÑÂàôÂíå<code>paraller-sync</code>ÂèÇÊï∞ÊúâÂÖ≥</p>
</li>
<li>
<p>Êõ¥Êñ∞ÂØπÂéüÊù•masterËäÇÁÇπÈÖçÁΩÆ‰∏∫slaveÔºåÂπ∂‰øùÂ≠òÂØπÂÖ∂‚ÄúÂÖ≥Ê≥®‚ÄùÔºåÂΩìÂÖ∂ÊÅ¢Â§çÂêéÂëΩ‰ª§ÂÆÉÂéªÂ§çÂà∂Êñ∞ÁöÑmasterËäÇÁÇπ</p>
</li>
</ul>
<blockquote>
<p>ÊâãÂä®‰∏ãÁ∫ømasterÊú∫Âô®<code>sentinel failover &lt;masterName&gt;</code></p>
</blockquote>
<h2 id="ÂçÅredis-cluster">ÂçÅ„ÄÅRedis Cluster</h2>
<h3 id="Êï∞ÊçÆÂàÜÂ∏ÉÊ¶ÇËÆ∫">Êï∞ÊçÆÂàÜÂ∏ÉÊ¶ÇËÆ∫</h3>
<p><img src="/img/redis/Data-Distribution.png" alt="Data-Distribution"></p>
<table>
  <tr>
    <th>ÂàÜÂ∏ÉÊñπÂºè</th>
    <th>ÁâπÁÇπ</th>
    <th>ÂÖ∏Âûã‰∫ßÂìÅ</th>
  </tr>
  <tr>
    <td rowspan="4">ÂìàÂ∏åÂàÜÂ∏É</td>    
    <td >Êï∞ÊçÆÂàÜÊï£Â∫¶È´ò</td>
    <td rowspan="4">
      <div>Memcache</div>
      <div>Redis Cluster</div>
    </td>    
  </tr>
  <tr> 
    <td>ÈîÆÂÄºÂàÜÂ∏É‰∏öÂä°Êó†ÂÖ≥</td>
  </tr>
  <tr> 
    <td>Êó†Ê≥ïÈ°∫Â∫èËÆøÈóÆ</td>
  </tr>
  <tr> 
    <td>ÊîØÊåÅÊâπÈáèÊìç‰Ωú</td>
  </tr>
  <tr>
    <td rowspan="4">È°∫Â∫èÂàÜÂ∏É</td>    
    <td >Êï∞ÊçÆÂàÜÊï£Â∫¶ÊòìÂÄæÊñú</td>
    <td rowspan="4">
      <div>BigTable</div>
      <div>HBase</div>
    </td>    
  </tr>
  <tr> 
    <td>ÈîÆÂÄºÂàÜÂ∏É‰∏öÂä°Áõ∏ÂÖ≥</td>
  </tr>
  <tr> 
    <td>ÂèØÈ°∫Â∫èËÆøÈóÆ</td>
  </tr>
  <tr>
    <td>ÊîØÊåÅÊâπÈáèÊìç‰Ωú</td>
  </tr>
</table>
<h3 id="ÂìàÂ∏åÂàÜÂ∏ÉÊñπÂºè">ÂìàÂ∏åÂàÜÂ∏ÉÊñπÂºè</h3>
<p><strong>ËäÇÁÇπÂèñ‰ΩôÂàÜÂå∫</strong></p>
<p><img src="/img/redis/Delivery-Partition.png" alt="Delivery-Partition"></p>
<p>ËøõË°åÂèñÊ®°ËøêÁÆóÔºåÂ∞Ü‰ΩôÊï∞Áõ∏Á≠âÁöÑÊîæÂÖ•Âêå‰∏ÄËäÇÁÇπÔºåÁÆÄÂçïÊòìÊìç‰ΩúÔºåÂ¢ûÂä†ËäÇÁÇπÊó∂Êï∞ÊçÆÂÅèÁßª,ÂØºËá¥Êï∞ÊçÆÁöÑÂâçÁßªËææÂà∞80%ÔºåÁøªÂÄçÊâ©ÂÆπÂèØ‰ª•‰ΩøÊï∞ÊçÆËøÅÁßª‰ªé80%ÈôçÂà∞50%</p>
<p><strong>‰∏ÄËá¥ÊÄßhashÂàÜÂå∫</strong></p>
<p><img src="/img/redis/Consistency-Hash.png" alt="Consistency-Hash"></p>
<p>‰∏∫Á≥ªÁªü‰∏≠ÊØè‰∏™ËäÇÁÇπÂàÜÈÖç‰∏Ä‰∏™tokenÔºåËåÉÂõ¥‰∏ÄËà¨Âú®0~2ÁöÑ32Ê¨°ÊñπÔºåËøô‰∫õtokenÊûÑÊàêÂìàÂ∏åÁéØ„ÄÇÊï∞ÊçÆËØªÂÜôÊâßË°åËäÇÁÇπÊü•ÊâæÊìç‰ΩúÊó∂ÔºåÂÖàÊ†πÊçÆkeyËÆ°ÁÆóhashÂÄºÔºåÁÑ∂ÂêéÈ°∫Êó∂ÈíàÊâæÂà∞Á¨¨‰∏Ä‰∏™Â§ß‰∫éÁ≠â‰∫éËØ•ÂìàÂ∏åÂÄºÁöÑtokenËäÇÁÇπÔºåÂæÄÂæÄ‰∏Ä‰∏™ËäÇÁÇπ‰ºöÂØπÂ∫îÂ§ö‰∏™token„ÄÇÂä†ÂáèËäÇÁÇπ‰ºöÈÄ†ÊàêÂìàÂ∏åÁéØ‰∏≠ÈÉ®ÂàÜÊï∞ÊçÆÊó†Ê≥ïÂëΩ‰∏≠ÔºåÈúÄË¶ÅÊâãÂä®Â§ÑÁêÜÊàñËÄÖÂøΩÁï•Ëøô‰∫õÊï∞ÊçÆÔºåÂ∏∏Áî®‰∫éÁºìÂ≠òÂú∫ÊôØ</p>
<p><strong>ËôöÊãüÂìàÂ∏åÂàÜÂå∫</strong></p>
<p><img src="/img/redis/Slot-Partition.png" alt="Slot-Partition"></p>
<p>ËôöÊãüÂàÜÊßΩ‰ΩøÁî®ÂìàÂ∏åÂáΩÊï∞ÊääÊâÄÊúâÊï∞ÊçÆÊò†Â∞ÑÂà∞‰∏Ä‰∏™Âõ∫ÂÆöËåÉÂõ¥ÁöÑÊï¥Êï∞ÈõÜÂêà‰∏≠ÔºåÊï¥Êï∞ÂÆö‰πâ‰∏∫ÊßΩÔºàslotÔºâ„ÄÇÊßΩÊï∞ËåÉÂõ¥ËøúËøúÂ§ß‰∫éËäÇÁÇπÊï∞ÔºàredisClusterÊßΩÁöÑËåÉÂõ¥ÊòØ0~16383ÔºâÔºåÊØè‰∏Ä‰∏™ËäÇÁÇπË¥üË¥£Áª¥Êä§‰∏ÄÈÉ®ÂàÜÊßΩ‰ª•ÂèäÊâÄÊò†Â∞ÑÁöÑÈîÆÂÄºÊï∞ÊçÆ</p>
<h3 id="Âü∫Êú¨Êû∂ÊûÑ">Âü∫Êú¨Êû∂ÊûÑ</h3>
<p><img src="/img/redis/cluster-architecture.jpg" alt="cluster-architecture"></p>
<ul>
<li>
<p>ÊâÄÊúâÁöÑredisËäÇÁÇπÂΩºÊ≠§‰∫íËÅî(PING-PONGÊú∫Âà∂),ÂÜÖÈÉ®‰ΩøÁî®‰∫åËøõÂà∂ÂçèËÆÆ‰ºòÂåñ‰º†ËæìÈÄüÂ∫¶ÂíåÂ∏¶ÂÆΩ</p>
</li>
<li>
<p>ËäÇÁÇπÁöÑfailÊòØÈÄöËøáÈõÜÁæ§‰∏≠Ë∂ÖËøáÂçäÊï∞ÁöÑmasterËäÇÁÇπÊ£ÄÊµãÂ§±ÊïàÊó∂ÊâçÁîüÊïà</p>
</li>
<li>
<p>ÂÆ¢Êà∑Á´Ø‰∏éredisËäÇÁÇπÁõ¥Ëøû,‰∏çÈúÄË¶Å‰∏≠Èó¥proxyÂ±Ç.ÂÆ¢Êà∑Á´ØËøûÊé•ÈõÜÁæ§‰∏≠‰ªª‰Ωï‰∏Ä‰∏™ÂèØÁî®ËäÇÁÇπÂç≥ÂèØ</p>
</li>
<li>
<p>redis-clusterÊääÊâÄÊúâÁöÑÁâ©ÁêÜËäÇÁÇπÊò†Â∞ÑÂà∞[0-16383]slot‰∏ä,cluster Ë¥üË¥£Áª¥Êä§node&lt;-&gt;slot&lt;-&gt;key</p>
</li>
</ul>
<h3 id="ÂÆâË£Öcluster">ÂÆâË£ÖCluster</h3>
<p>‰øÆÊîπredisÈÖçÁΩÆÊñá‰ª∂</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>cluster-enable yes
</span></span><span style="display:flex;"><span>cluster-config-file nodes-${port}.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ÂéüÁîüÂÆâË£Ö</strong></p>
<ul>
<li>
<p>ÂêØÂä®ÊâÄÊúâËäÇÁÇπ</p>
</li>
<li>
<p>ÊâßË°å<code>redis-cli -p ${port} cluster meet ${ip} ${port}</code>‰ΩøËäÇÁÇπÁõ∏ÈÅá</p>
</li>
<li>
<p>ÊâßË°å<code>cluster addslots slot [slot...]</code>ÂàÜÈÖçÊßΩ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#008080">start</span><span style="color:#000;font-weight:bold">=</span><span style="color:#008080">$1</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">end</span><span style="color:#000;font-weight:bold">=</span><span style="color:#008080">$2</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">port</span><span style="color:#000;font-weight:bold">=</span><span style="color:#008080">$3</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">for</span> slot in <span style="color:#d14">`</span>seq <span style="color:#d14">${</span><span style="color:#008080">start</span><span style="color:#d14">}</span> <span style="color:#d14">${</span><span style="color:#008080">end</span><span style="color:#d14">}</span><span style="color:#d14">`</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>  <span style="color:#0086b3">echo</span> <span style="color:#d14">&#34;slot:</span><span style="color:#d14">${</span><span style="color:#008080">slot</span><span style="color:#d14">}</span><span style="color:#d14">&#34;</span>
</span></span><span style="display:flex;"><span>  /opt/redis/bin/redis-cli -p <span style="color:#d14">${</span><span style="color:#008080">port</span><span style="color:#d14">}</span> cluster addslots <span style="color:#d14">${</span><span style="color:#008080">slot</span><span style="color:#d14">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ÊâßË°å<code>redis-cli -p ${port} cluster replicate ${nodeId}</code>ÊâßË°å‰∏ª‰ªéÂàÜÈÖç</p>
</li>
</ul>
<p><strong>ÈõÜÁæ§ÂëΩ‰ª§ÂÆâË£Ö</strong></p>
<ul>
<li>
<p><code>redis-cli --cluster create --cluster-replicas 1 127.0.0.1:7000 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005</code></p>
<p>&ndash;cluster-replicas‰ª£Ë°®ÈõÜÁæ§ÁöÑÊØè‰∏™‰∏ªËäÇÁÇπÁöÑ‰ªéËäÇÁÇπ‰∏™Êï∞</p>
<blockquote>
<p>rubyÂÆâË£ÖÂ∑≤Â∫üÂºÉ</p>
</blockquote>
</li>
</ul>
<p><strong>clusterÈÖçÁΩÆÂèÇÊï∞</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>cluster-enable yes
</span></span><span style="display:flex;"><span>cluster-config-file nodes-${port}.conf
</span></span><span style="display:flex;"><span>cluster-node-timeout 15000
</span></span><span style="display:flex;"><span>cluster-require-full-coverage yes 		#ÂøÖÈ°ªÈõÜÁæ§ÊâÄÊúâËäÇÁÇπËÉΩÊèê‰æõÊúçÂä°ÊâçÊèê‰æõÊúçÂä°
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÈõÜÁæ§‰º∏Áº©">ÈõÜÁæ§‰º∏Áº©</h3>
<p><strong>Êâ©Â±ïÈõÜÁæ§</strong></p>
<p>Êâ©Â±ïÊ≠•È™§ÂéüÁêÜ</p>
<ol>
<li>ÂØπÁõÆÊ†áËäÇÁÇπÂèëÈÄÅcluster setslot {slot} importing {targetNodeId}ÂëΩ‰ª§ÔºåËÆ©ÁõÆÊ†áËäÇÁÇπÂáÜÂ§áÂØºÂÖ•ÊßΩÁöÑÊï∞ÊçÆ</li>
<li>ÂØπÊ∫êËäÇÁÇπÂèëÈÄÅcluster setslot {slot} migrating {sourceNodeId}ÂëΩ‰ª§ÔºåËÆ©Ê∫êËäÇÁÇπÂáÜÂ§áÊßΩÊï∞ÊçÆÁöÑÂØºÂá∫</li>
<li>Ê∫êËäÇÁÇπ‰∏äÂæ™ÁéØÊâßË°åcluster getkeyinslot {slot} count ÂëΩ‰ª§ÔºåÊØèÊ¨°Ëé∑ÂèñÂ±û‰∫éËøô‰∏™ÊßΩ‰∏≠ÈîÆÁöÑ‰∏™Êï∞</li>
<li>Âú®Ê∫êËäÇÁÇπ‰∏äÊâßË°åmigrate {sourceIp} {sourcePort} key 0 {timeout}ÂëΩ‰ª§ÔºåËøÅÁßªÊåáÂÆöÁöÑkey</li>
<li>ÈáçÂ§çÊâßË°åÊ≠•È™§3~4Áõ¥Âà∞ÊßΩ‰∏ãÊâÄÊúâÊï∞ÊçÆÂÆåÊàêËøÅÁßª</li>
<li>ÂêëÈõÜÁæ§ÂÜÖÊâÄÊúâ‰∏ªËäÇÁÇπÂèëÈÄÅcluster setslot {slot} node {targetNodeId}ÂëΩ‰ª§ÔºåÈÄöÁü•ÊßΩÂàÜÈÖçÁªôÁõÆÊ†áËäÇÁÇπ</li>
</ol>
<p><img src="/img/redis/Cluster-Expend.png" alt="Cluster-Expend"></p>
<p>Êâ©Â±ïÊâßË°åÊ≠•È™§</p>
<ul>
<li>
<p>Âä†ÂÖ•ÈõÜÁæ§</p>
<p>ÊâßË°å<code>redis-cli -p ${port} cluster meet ${ip} ${port}</code>Â∞ÜËäÇÁÇπÂä†ÂÖ•ÈõÜÁæ§</p>
</li>
<li>
<p>ËÆæÁΩÆ‰∏ª‰ªéÂÖ≥Á≥ª</p>
<p><code>redis-cli -p ${port} cluster replicate ${nodeId}</code>ËÆæÁΩÆ‰∏ª‰ªéÂÖ≥Á≥ª</p>
</li>
<li>
<p>‰ªªÊÑèËäÇÁÇπÊâßË°åËøÅÁßªÊßΩÂëΩ‰ª§ÔºåÂêéÁª≠ËøáÁ®ãÊ†πÊçÆÊèêÁ§∫ËøõË°å</p>
<p><code>redis-cli --cluster reshard {ip}:{port}</code></p>
</li>
<li>
<p>Êü•ÁúãËäÇÁÇπÂàÜÈÖçÊÉÖÂÜµ</p>
<p><code>redis-cli -p {prot} cluster nodes | grep master</code></p>
</li>
</ul>
<p><strong>ÈõÜÁæ§Áº©ÂÆπ</strong></p>
<p><img src="/img/redis/Cluster-Shrink.png" alt="Cluster-Shrink"></p>
<p>ËøÅÁßªÊßΩÂëΩ‰ª§ÂíåÊâ©Â±ïÈõÜÁæ§ÁöÑËøÅÁßªÂëΩ‰ª§Áõ∏ÂêåÔºåËøÅÁßªÂÆåÊàê‰πãÂêé‰ΩøÁî®<code>redis-cli cluster forget {downNodeId}</code>‰∏ãÁ∫øËäÇÁÇπ</p>
<ul>
<li>
<p>ËøÅÁßªÊï∞ÊçÆ</p>
<p><code>redis-cli --cluster reshard {ip}:{port} --cluster-from {sourceNodeId} --cluster-to {targetNodeId} --cluster-slots {slotsNum}</code></p>
</li>
<li>
<p>‰∏ãÁ∫øËäÇÁÇπ</p>
<p><code>redis-cli --cluster  del-node {ip}:{port}  {shutdownNodeId}</code></p>
</li>
</ul>
<h3 id="ÂÆ¢Êà∑Á´ØË∑ØÁî±">ÂÆ¢Êà∑Á´ØË∑ØÁî±</h3>
<blockquote>
<p>‰ΩøÁî®cluster keyslot ${key}ÂèØÊü•ÁúãkeyÂØπÂ∫îÁöÑhashÂÄº</p>
</blockquote>
<p><strong>movedÈáçÂÆöÂêë</strong></p>
<p><img src="/img/redis/Cluster-Move.png" alt="Cluster-Move"></p>
<p><strong>askÈáçÂÆöÂêë</strong></p>
<p><img src="/img/redis/Cluster-Ask.png" alt="Cluster-Ask"></p>
<p><strong>smartÂÆ¢Êà∑Á´Ø</strong></p>
<p>ÂÆûÁé∞ÂéüÁêÜÔºöËøΩÊ±ÇÊÄßËÉΩ</p>
<ol>
<li>‰ªéÈõÜÁæ§‰∏≠ÈÄâ‰∏Ä‰∏™ÂèØËøêË°åËäÇÁÇπÔºå‰ΩøÁî®<code>cluster slots</code>ÂàùÂßãÂåñÊßΩÂíåËäÇÁÇπÊò†Â∞Ñ</li>
<li>Â∞Ücluster slotsÁöÑÁªìÊûúÊò†Â∞ÑÂà∞Êú¨Âú∞ÁºìÂ≠òÔºå‰∏∫ÊØè‰∏™ËäÇÁÇπÂàõÂª∫JedisPool</li>
<li>ÂáÜÂ§áÊâßË°åÂëΩ‰ª§(‰ΩøÁî®CRC16ËÆ°ÁÆókeyÂØπÂ∫îÁöÑÊßΩÔºåÊâæÂà∞Êò†Â∞ÑËäÇÁÇπÊâßË°å)</li>
</ol>
<p><img src="/img/redis/Smart-Client.png" alt="Smart-Client"></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">static</span><span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">void</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">main</span>(String<span style="color:#000;font-weight:bold">[]</span><span style="color:#bbb"> </span>args)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Set<span style="color:#000;font-weight:bold">&lt;</span>HostAndPort<span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb"> </span>nodes<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>HashSet<span style="color:#000;font-weight:bold">&lt;</span>HostAndPort<span style="color:#000;font-weight:bold">&gt;</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>nodes.<span style="color:#008080">add</span>(<span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>HostAndPort(<span style="color:#d14">&#34;192.168.1.158&#34;</span>,<span style="color:#bbb"> </span>7000));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>nodes.<span style="color:#008080">add</span>(<span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>HostAndPort(<span style="color:#d14">&#34;192.168.1.158&#34;</span>,<span style="color:#bbb"> </span>7001));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>nodes.<span style="color:#008080">add</span>(<span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>HostAndPort(<span style="color:#d14">&#34;192.168.1.158&#34;</span>,<span style="color:#bbb"> </span>7002));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>nodes.<span style="color:#008080">add</span>(<span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>HostAndPort(<span style="color:#d14">&#34;192.168.1.158&#34;</span>,<span style="color:#bbb"> </span>7003));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>nodes.<span style="color:#008080">add</span>(<span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>HostAndPort(<span style="color:#d14">&#34;192.168.1.158&#34;</span>,<span style="color:#bbb"> </span>7004));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>nodes.<span style="color:#008080">add</span>(<span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>HostAndPort(<span style="color:#d14">&#34;192.168.1.158&#34;</span>,<span style="color:#bbb"> </span>7005));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>JedisCluster<span style="color:#bbb"> </span>jedisCluster<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>JedisCluster(nodes);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>jedisCluster.<span style="color:#008080">set</span>(<span style="color:#d14">&#34;hello&#34;</span>,<span style="color:#bbb"> </span><span style="color:#d14">&#34;cluster&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>System.<span style="color:#008080">out</span>.<span style="color:#008080">println</span>(jedisCluster.<span style="color:#008080">get</span>(<span style="color:#d14">&#34;hello&#34;</span>));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>jedisCluster.<span style="color:#008080">close</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="span-idmulti-operatorÊâπÈáèÊìç‰Ωúspan"><span id="Multi-Operator">ÊâπÈáèÊìç‰Ωú</span></h3>
<p>Redis‰∏ªË¶ÅÊèê‰æõ‰∫Ü‰ª•‰∏ãÂá†ÁßçÊâπÈáèÊìç‰ΩúÊñπÂºèÔºö</p>
<ul>
<li>ÊâπÈáèget/set(multi get/set)</li>
<li>ÁÆ°ÈÅì(pipelining)</li>
<li>‰∫ãÂä°(transaction)</li>
<li>Âü∫‰∫é‰∫ãÂä°ÁöÑÁÆ°ÈÅì(transaction in pipelining)</li>
</ul>
<p><span style="color:red">ÊâπÈáèÊìç‰ΩúÂøÖÈ°ªkeyÂú®Âêå‰∏Ä‰∏™ÊßΩÔºåÂØºËá¥‰ª•‰∏äÁî®Ê≥ïÂºÇÂ∏∏ËãõÂàª</span></p>
<p><strong>ÊñπÊ°à‰∏ÄÔºö‰º†ÁªüÁöÑ‰∏≤Ë°åIOÊìç‰ΩúÔºå‰πüÂ∞±ËØ¥n‰∏™keyÔºåÂàÜnÊ¨°‰∏≤Ë°åÊìç‰ΩúÊù•Ëé∑ÂèñkeyÔºåÂ§çÊùÇÂ∫¶ÊòØo(n)</strong></p>
<p><strong>ÊñπÊ°à‰∫åÔºöÂ∞ÜmgetÊìç‰Ωú(n‰∏™key)ÔºåÂà©Áî®Â∑≤Áü•ÁöÑhashÂáΩÊï∞ÁÆóÂá∫keyÂØπÂ∫îÁöÑËäÇÁÇπÔºåËøôÊ†∑Â∞±ÂèØ‰ª•ÂæóÂà∞‰∏Ä‰∏™ËøôÊ†∑ÁöÑÂÖ≥Á≥ªÔºöMap&lt;node, somekeys&gt;Ôºå‰πüÂ∞±ÊòØÊØè‰∏™ËäÇÁÇπÂØπÂ∫îÁöÑ‰∏Ä‰∫õkeysÔºåËøôÊ†∑Â∞Ü‰πãÂâçÁöÑo(n)ÁöÑÊïàÁéáÈôç‰ΩéÂà∞o(node.size())</strong></p>
<p><img src="/img/redis/MuliCmd-Serial-Io.webp" alt="MuliCmd-Serial-Io"></p>
<p><strong>ÊñπÊ°à‰∏âÔºöÂú®ÊñπÊ°à‰∫åÁöÑÂü∫Á°Ä‰∏äÂ∞Ü‰∏≤Ë°åÂèñÊï∞ÊçÆÊîπ‰∏∫Âπ∂Ë°åÂèñÊï∞ÊçÆÔºåËøõ‰∏ÄÊ≠•ÊèêÈ´òÊïàÁéá</strong></p>
<p><img src="/img/redis/MuliCmd-parell-Io.webp" alt="MuliCmd-parell-Io"></p>
<p><strong>ÊñπÊ°àÂõõÔºöÈÄöËøáredisËá™Â∏¶ÁöÑhashtagÂäüËÉΩÔºåÂº∫Âà∂‰∏ÄÊâπkeyÂàÜÈÖçÂà∞ÊüêÂè∞Êú∫Âô®‰∏ä„Äê‰∏çÂª∫ËÆÆÔºåÂ§ßÈáèÊï∞ÊçÆ‰ºöÈÄ†ÊàêÊï∞ÊçÆÂÄæÊñú„Äë</strong></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">//‰ΩøÁî®{user}‰Ωú‰∏∫keyÔºå‰ΩøkeyÁªü‰∏Ä</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>jedisCluster.<span style="color:#008080">mset</span>(<span style="color:#d14">&#34;{user}1001&#34;</span>,<span style="color:#d14">&#34;zhangsan&#34;</span>,<span style="color:#d14">&#34;{user}1002&#34;</span>,<span style="color:#d14">&#34;lisi&#34;</span>,<span style="color:#d14">&#34;{user}1003&#34;</span>,<span style="color:#d14">&#34;wangwu&#34;</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>List<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb"> </span>users<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>jedisCluster.<span style="color:#008080">mget</span>(<span style="color:#d14">&#34;{user}1001&#34;</span>,<span style="color:#d14">&#34;{user}1002&#34;</span>,<span style="color:#d14">&#34;{user}1003&#34;</span>);<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ÊïÖÈöúËΩ¨Áßª">ÊïÖÈöúËΩ¨Áßª</h3>
<p><strong>ÊïÖÈöúÂèëÁé∞</strong></p>
<ul>
<li>ÈÄöËøáping/pong‰ø°ÊÅØÂÆûÁé∞ÊïÖÈöúÂèëÁé∞ÔºåÂΩìÂçäÊï∞‰ª•‰∏äÊåÅÊúâÊßΩÁöÑ‰∏ªËäÇÁÇπÈÉΩÊ†áËÆ∞ÊüêËäÇÁÇπ‰∏ªËßÇ‰∏ãÁ∫øÂàô‰∏∫ÂÆ¢ËßÇ‰∏ãÁ∫ø„ÄêÂêëÈõÜÁæ§ÂπøÊí≠‰∏ãÁ∫øËäÇÁÇπÁöÑfailÊ∂àÊÅØ„Äë</li>
<li>ÂÆ¢ËßÇ‰∏ãÁ∫øÂèëÈÄÅÈÄöÁü•ÊïÖÈöúËäÇÁÇπÁöÑ‰ªéËäÇÁÇπËß¶ÂèëÊïÖÈöúËΩ¨‰πâÊµÅÁ®ã</li>
</ul>
<p><strong>ÊïÖÈöúÊÅ¢Â§ç</strong></p>
<ul>
<li>ËµÑÊ†ºÂÆ°Êü•
<ul>
<li>ÊØè‰∏™‰ªéËäÇÁÇπÊ£ÄÊü•‰∏éÊïÖÈöú‰∏ªËäÇÁÇπÁöÑÊñ≠Á∫øÊó∂Èó¥</li>
<li>Ë∂ÖËøá<code>cluster-node-timeout * cluster-slave-validity-factor</code>ÂèñÊ∂àËµÑÊ†º</li>
<li><code>cluster-slave-validity-factor</code>ÈªòËÆ§ÊòØ10</li>
</ul>
</li>
<li>ÂáÜÂ§áÈÄâ‰∏æÊó∂Èó¥
<ul>
<li>ÊúÄÊé•Ëøë‰∏ªËäÇÁÇπÁöÑÂÅèÁßªÈáèÁöÑ‰ªéËäÇÁÇπÁéáÂÖàÂèëËµ∑ÈÄâ‰∏æÔºåÁ®çÂêéÂÖ∂‰ªñ‰ªéËäÇÁÇπÂèëËµ∑ÈÄâ‰∏æ</li>
</ul>
</li>
<li>ÈÄâ‰∏æÊäïÁ•®
<ul>
<li>Êî∂ÈõÜÁ•®Êï∞Â§ß‰∫éN/2+1Âç≥‰∏∫ÈÄâ‰∏æÊàêÂäü</li>
</ul>
</li>
<li>ÊõøÊç¢‰∏ªËäÇÁÇπ
<ul>
<li>ÂΩìÂâç‰ªéËäÇÁÇπÂèñÊ∂àÂ§çÂà∂Âèò‰∏∫‰∏ªËäÇÁÇπÔºàslave no oneÔºâ</li>
<li>ÊâßË°åclusterDelSlotÊí§ÈîÄÊïÖÈöú‰∏ªËäÇÁÇπË¥üË¥£ÁöÑÊßΩÔºåÂπ∂ÊâßË°åclusterAddSlotÊääËøô‰∫õÊßΩÂàÜÈÖçÁªôËá™Â∑±</li>
<li>ÂêëÈõÜÁæ§ÂπøÊí≠Ëá™Â∑±ÁöÑpongÊ∂àÊÅØÔºåË°®ÊòéÂ∑≤ÁªèÊõøÊç¢‰∫ÜÊïÖÈöú‰ªéËäÇÁÇπ</li>
</ul>
</li>
</ul>
<h3 id="ÈõÜÁæ§ËøêÁª¥ÈóÆÈ¢ò">ÈõÜÁæ§ËøêÁª¥ÈóÆÈ¢ò</h3>
<p><strong>ÈõÜÁæ§ÂÆåÊï¥ÊÄß</strong></p>
<p><code>cluster-require-full-coverage yes</code>ÈªòËÆ§‰∏∫yes</p>
<ul>
<li>ÈõÜÁæ§‰∏≠16384‰∏™ÊßΩÂÖ®ÈÉ®ÂèØÁî®Ôºö‰øùËØÅÈõÜÁæ§ÂÆåÊï¥ÊÄß</li>
<li>ËäÇÁÇπÊïÖÈöúÊàñËÄÖÊ≠£Âú®ÊïÖÈöúËΩ¨ÁßªÔºåÈõÜÁæ§‰∏çÂèØ‰ΩøÁî®</li>
</ul>
<p>Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ã‰∏öÂä°Êó†Ê≥ïÂÆπÂøçÔºåÂª∫ËÆÆ<code>cluster-require-full-coverage</code>ËÆæÁΩÆ‰∏∫no</p>
<p><strong>PubSubÂπøÊí≠</strong></p>
<p>‰ªªÊÑèËäÇÁÇπÂèëÂ∏ÉÊ∂àÊÅØÊâÄÊúâËäÇÁÇπÈÉΩ‰ºöËÆ¢ÈòÖÂà∞Ê∂àÊÅØÔºåÊ∂àËÄóÂ∏¶ÂÆΩËæÉÂ§ö„ÄÇJedisClusterÂè™‰ºöËÆ¢ÈòÖ‰ªªÊÑè‰∏Ä‰∏™ËäÇÁÇπ</p>
<p><strong>Êï∞ÊçÆÂÄæÊñú</strong></p>
<p>ÈÄ†ÊàêÁöÑÂéüÂõ†Ôºö</p>
<ul>
<li>ËäÇÁÇπÊßΩÂàÜÈÖç‰∏çÂùá</li>
<li>‰∏çÂêåÊßΩÂØπÂ∫îÁöÑÈîÆÂÄºÊï∞ÈáèÂ∑ÆÂºÇËæÉÂ§ß„ÄêÂèØËÉΩÂ≠òÂú®hashTag„Äë</li>
<li>ÂåÖÂê´bigkey</li>
<li>ÂÜÖÂ≠òÁõ∏ÂÖ≥ÈÖçÁΩÆ‰∏ç‰∏ÄËá¥</li>
</ul>
<blockquote>
<p>‰ΩøÁî®<code>redis-cli --cluster info {ip}:{port}</code>ÂèØ‰ª•Êü•Áúãkey„ÄÅslotÂàÜÂ∏ÉÊÉÖÂÜµ</p>
<p>‰ΩøÁî®<code>redis-cli --cluster rebalance {ip}:{port}</code>ËøõË°åÊï∞ÊçÆÂπ≥Ë°°„ÄêÊÖéÁî®„Äë</p>
</blockquote>
<p><strong>‰ªéÊú∫ËØªÂÜôÈóÆÈ¢ò</strong></p>
<p>Âú®ÈõÜÁæ§Ê®°Âºè‰∏ã‰ªéËäÇÁÇπ‰∏çÊé•Âèó‰ªª‰ΩïËØªÂÜôËØ∑Ê±Ç</p>
<ul>
<li>ÂëΩ‰ª§‰ºöÈáçÂÆöÂêëÂà∞Ë¥üË¥£ÊßΩÁöÑ‰∏ªËäÇÁÇπ</li>
<li>readonlyÂëΩ‰ª§ÂèØ‰ª•ËØªÂèñ„ÄêËøûÊé•Á∫ßÂà´„Äë</li>
</ul>
<p><strong>Êï∞ÊçÆËøÅÁßª</strong></p>
<p>ÂÆòÊñπÂ∑•ÂÖ∑‰∏çÂè™ËÉΩ‰ªéÂçïÊú∫ÂêëÈõÜÁæ§ËøÅÁßªÔºå‰∏çÊîØÊåÅÊñ≠ÁÇπÁª≠‰º†Ôºå‰∏çÊîØÊåÅÂú®Á∫øËøÅÁßªÔºåÂçïÁ∫øÁ®ãÂΩ±ÂìçÈÄüÂ∫¶Ôºå‰∏çÂª∫ËÆÆ‰ΩøÁî®ÂÆòÊñπÂ∑•ÂÖ∑</p>
<h2 id="ÂçÅ‰∏ÄÁºìÂ≠òËÆæËÆ°‰∏é‰ºòÂåñ">ÂçÅ‰∏Ä„ÄÅÁºìÂ≠òËÆæËÆ°‰∏é‰ºòÂåñ</h2>
<h3 id="ÁºìÂ≠ò‰ΩøÁî®ÁöÑÊàêÊú¨">ÁºìÂ≠ò‰ΩøÁî®ÁöÑÊàêÊú¨</h3>
<ul>
<li>Êï∞ÊçÆ‰∏ç‰∏ÄËá¥ÔºöÁºìÂ≠òÂ±ÇÂíåÊï∞ÊçÆÂ±ÇÊúâÊó∂Èó¥Á™óÂè£‰∏ç‰∏ÄËá¥ÔºåÂíåÊõ¥Êñ∞Á≠ñÁï•ÊúâÂÖ≥</li>
<li>‰ª£Á†ÅÁª¥Êä§ÊàêÊú¨ÔºöÂ§ö‰∫Ü‰∏ÄÂ±ÇÁºìÂ≠òÈÄªËæë</li>
<li>ËøêÁª¥ÊàêÊú¨Ôºö‰æãÂ¶ÇRedis Cluster</li>
</ul>
<h3 id="span-idcache_updateÁºìÂ≠òÊõ¥Êñ∞Á≠ñÁï•span"><span id="cache_update">ÁºìÂ≠òÊõ¥Êñ∞Á≠ñÁï•</span></h3>
<p><span style="color:blue">redisÈáåÈù¢Â≠òÂÇ®ÁöÑËøáÊúüÊó∂Èó¥ÔºåÈÉΩÊòØÁªùÂØπÊó∂Èó¥ÁÇπÔºåÊâÄ‰ª•Â¶ÇÊûú‰∏§Âè∞Êú∫Âô®Êó∂Èíü‰∏çÂêåÊ≠•ÔºåÈÇ£‰πàË∂ÖËøáÁöÑÊï∞ÊçÆ‰ºöÂÖ®ÈÉ®Âà†Èô§„ÄÇ</span></p>
<ul>
<li>slaves‰∏ç‰ºöÁã¨Á´ãÂà†Èô§Êï∞ÊçÆÔºåËÄåÊòØÁ≠âÂæÖmasterÁªôÂÆÉÂèëÈÄÅÂà†Èô§Êåá‰ª§ÁöÑÊó∂ÂÄôÔºåÂÜçÂà†Èô§Êï∞ÊçÆ</li>
<li>Â¶ÇÊûúslaveÂΩìÈÄâ‰∏∫masterÁöÑÊó∂ÂÄôÔºå‰ºöÂÖàÊ∑òÊ±∞keysÔºåÁÑ∂ÂêéÂÜçÊàê‰∏∫master</li>
</ul>
<hr>
<ul>
<li>
<p>ËÆæÁΩÆ<code>maxmemory-policy</code>ÂÄºÊåáÂÆöÁÆóÊ≥ï</p>
<table>
<thead>
<tr>
<th>Êõ¥Êñ∞Á≠ñÁï•</th>
<th>Ëß£Èáä</th>
</tr>
</thead>
<tbody>
<tr>
<td>volatile-lru</td>
<td>ËøáÊúüÁöÑÈîÆ‰ΩøÁî®LRUÁ≠ñÁï•ÂâîÈô§ÔºåÊ≤°ÊúâÂèØÂà†Èô§ÂØπË±°ÂàôÈÄÄÂõûÂà∞noeviction</td>
</tr>
<tr>
<td>allkeys-lru</td>
<td>ÊâÄÊúâÈîÆÂùá‰ΩøÁî®LRUÁ≠ñÁï•ÂâîÈô§ÔºåÁõ¥Âà∞ËÖæÂá∫Ë∂≥Â§üÁ©∫Èó¥</td>
</tr>
<tr>
<td>volatile-lfu</td>
<td>ËøáÊúüÁöÑÈîÆ‰ΩøÁî®LFUÁ≠ñÁï•ÂâîÈô§ÔºåÊ≤°ÊúâÂèØÂà†Èô§ÂØπË±°ÂàôÈÄÄÂõûÂà∞noeviction</td>
</tr>
<tr>
<td>allkeys-lfu</td>
<td>ÊâÄÊúâÈîÆÂùá‰ΩøÁî®LFUÁ≠ñÁï•ÂâîÈô§ÔºåÁõ¥Âà∞ËÖæÂá∫Ë∂≥Â§üÁ©∫Èó¥</td>
</tr>
<tr>
<td>volatile-random</td>
<td>ËøáÊúüÁöÑÈîÆ‰ΩøÁî®ÈöèÊú∫Á≠ñÁï•ÂâîÈô§ÔºåÊ≤°ÊúâÂèØÂà†Èô§ÂØπË±°ÂàôÈÄÄÂõûÂà∞noeviction</td>
</tr>
<tr>
<td>allkeys-random</td>
<td>ÊâÄÊúâÈîÆÂùá‰ΩøÁî®ÈöèÊú∫Á≠ñÁï•ÂâîÈô§ÔºåÁõ¥Âà∞ËÖæÂá∫Ë∂≥Â§üÁ©∫Èó¥</td>
</tr>
<tr>
<td>volatile-ttl</td>
<td>ÂâîÈô§TTLÊúÄÂ∞èÁöÑÈîÆÔºåÊ≤°ÊúâÂèØÂà†Èô§ÂØπË±°ÂàôÈÄÄÂõûÂà∞noeviction</td>
</tr>
<tr>
<td>noeviction</td>
<td>ÈªòËÆ§Á≠ñÁï•Ôºå‰∏çÂÅö‰ªª‰Ωï‰∫ãÔºåËøîÂõûÂÜôÈîôËØØ</td>
</tr>
</tbody>
</table>
<blockquote>
<p>LRU„ÄêLeast Recently Used„ÄëÊúÄËøëÊúÄÂ∞ëË¢´‰ΩøÁî®</p>
<p>LFU„ÄêLeast Frequently Used„ÄëÊúÄ‰∏çÂ∏∏Áî®</p>
</blockquote>
</li>
<li>
<p>Ë¢´Âä®Êõ¥Êñ∞</p>
<p>ÂΩìÂÆ¢Êà∑Á´ØÊñπ‰ΩçkeyÁöÑÊó∂ÂÄôÔºå‰∏ªÂä®Ê£ÄÊµãËøô‰∫õkeyÊòØÂê¶ËøáÊúüÔºåËøáÊúüÂ∞±Âà†Èô§</p>
</li>
<li>
<p>‰∏ªÂä®Êõ¥Êñ∞</p>
<p>ÊØèÁßíÊ£ÄÊµã10Ê¨°‰ª•‰∏ãÊìç‰ΩúÔºåÊµãËØïÈöèÊú∫ÁöÑ20‰∏™keysËøõË°åÁõ∏ÂÖ≥ËøáÊúüÊ£ÄÊµãÔºåÂà†Èô§ÊâÄÊúâÁöÑËøáÊúüÁöÑkeysÔºåÂ¶ÇÊûúÊúâÂ§ö‰∫é25%ÁöÑkeysËøáÊúüÔºåÈáçÂ§çÊ≠§Êìç‰Ωú</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Á≠ñÁï•</th>
<th>‰∏ÄËá¥ÊÄß</th>
<th>Áª¥Êä§ÊàêÊú¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>ÁÆóÊ≥ïÂâîÈô§</td>
<td>ÊúÄÂ∑Æ</td>
<td>‰Ωé</td>
</tr>
<tr>
<td>Ë¢´Âä®Êõ¥Êñ∞</td>
<td>ËæÉÂ∑Æ</td>
<td>‰Ωé</td>
</tr>
<tr>
<td>‰∏ªÂä®Êõ¥Êñ∞</td>
<td>Âº∫</td>
<td>È´ò</td>
</tr>
</tbody>
</table>
<blockquote>
<p>‰Ωé‰∏ÄËá¥ÊÄßÔºöÊúÄÂ§ßÂÜÖÂ≠òÂíåÊ∑òÊ±∞Á≠ñÁï•</p>
<p>È´ò‰∏ÄËá¥ÊÄßÔºöË∂ÖÊó∂ÂâîÈô§Âíå‰∏ªÂä®Êõ¥Êñ∞ÁªìÂêàÔºåÊúÄÂ§ßÂÜÖÂ≠òÂíåÊ∑òÊ±∞Á≠ñÁï•ÂÖúÂ∫ï</p>
</blockquote>
<h3 id="ÁºìÂ≠òÁ©øÈÄèÁºìÂ≠òÈõ™Â¥©Êó†Â∫ïÊ¥û">ÁºìÂ≠òÁ©øÈÄè&amp;ÁºìÂ≠òÈõ™Â¥©&amp;Êó†Â∫ïÊ¥û</h3>
<p><strong>ÁºìÂ≠òÁ©øÈÄè</strong></p>
<p><img src="/img/redis/Cache-Miss.png" alt="Cache-Miss"></p>
<p>ÁâπÁÇπÔºö</p>
<p>ÂΩìÁºìÂ≠òÂíåÊï∞ÊçÆÂ∫ì‰∏≠ÈÉΩÊ≤°ÊúâÊï∞ÊçÆÁöÑÊó∂ÂÄôÔºåÂΩìÊü•ËØ¢RedisÊ≤°ÊúâÊï∞ÊçÆÁöÑÊó∂ÂÄôÔºå‰ºöÁªßÁª≠Êü•ËØ¢Êï∞ÊçÆÂ∫ìÔºåÊï∞ÊçÆÂ∫ì‰πüÊ≤°ÊúâÊï∞ÊçÆÔºåÂΩìÂ§ßÈáèÊü•ËØ¢ËØ∑Ê±ÇÂèëÁîüÊàñÈÅ≠Âà∞ÊÅ∂ÊÑèÊîªÂáªÊó∂ÔºåËøô‰∫õËÆøÈóÆÂÖ®ÈÉ®ÈÄèËøáRedisÔºåÂπ∂‰∏îÊï∞ÊçÆÂ∫ì‰πüÊ≤°ÊúâÊï∞ÊçÆÔºåËøôÁßçÁé∞Ë±°Áß∞‰∏∫‚ÄúÁºìÂ≠òÁ©øÈÄè‚Äù„ÄÇ</p>
<p>Ëß£ÂÜ≥ÊñπÊ°àÔºö</p>
<ol>
<li>ÁºìÂ≠òÁ©∫ÂØπË±°ÔºåstorageËøîÂõû‰∏Ä‰∏™Á©∫ÂØπË±°ÔºåÂ∞ÜÈîÆÂ≠òÂÇ®Âú®ÁºìÂ≠òÂ±ÇÔºå‰∏ãÊ¨°ËØ∑Ê±ÇÊ≠§ÈîÆ‰πãÈó¥ËøîÂõûÁ©∫ÂØπË±°
<ul>
<li>ÈúÄË¶ÅÊõ¥Â§öÁöÑÈîÆÔºåÂª∫ËÆÆËÆæÁΩÆËøáÊúüÊó∂Èó¥</li>
<li>ÁºìÂ≠òÂ±ÇÂíåÂ≠òÂÇ®Â±ÇÊï∞ÊçÆ‚ÄúÁü≠Êúü‚Äù‰∏ç‰∏ÄËá¥</li>
</ul>
</li>
<li><a href="#bloomFilter">Â∏ÉÈöÜËøáÊª§Âô®</a></li>
</ol>
<p><strong>ÁºìÂ≠òÂáªÁ©ø</strong></p>
<p>ÁâπÁÇπÔºö</p>
<p>ÂΩìRedisÁöÑÁÉ≠ÁÇπÊï∞ÊçÆkeyÂ§±ÊïàÊó∂ÔºåÂ§ßÈáèÂπ∂ÂèëÊü•ËØ¢Áõ¥Êé•ÊâìÂà∞Êï∞ÊçÆÂ∫ìÔºåÊ≠§Êó∂Êï∞ÊçÆÂ∫ìË¥üËΩΩÂéãÂäõÈ™§Â¢ûÔºåËøôÁßçÁé∞Ë±°Áß∞‰∏∫‚ÄúÁºìÂ≠òÂáªÁ©ø‚Äù</p>
<img src="/img/redis/hotkey-expir.png" alt="hotkey-expir" style="zoom:67%;" />
<p>Ëß£ÂÜ≥ÊñπÊ°àÔºö</p>
<p>1.ËÆæÁΩÆkeyÂÄºÊ∞∏‰∏çËøáÊúü</p>
<p>2.‰ΩøÁî®‰∫íÊñ•ÈîÅÔºåÊü•Âà∞ÂêéÂ∞±ÂõûÂ°´ÁºìÂ≠ò</p>
<p><strong>ÁºìÂ≠òÈõ™Â¥©</strong></p>
<p>ÁâπÁÇπÔºö</p>
<p>ÁºìÂ≠òÈõ™Â¥©ÊòØÊåáÂú®Áü≠Êó∂Èó¥ÂÜÖÔºåÊúâÂ§ßÈáèÁºìÂ≠òÂêåÊó∂ËøáÊúüÔºåÂØºËá¥Â§ßÈáèÁöÑËØ∑Ê±ÇÁõ¥Êé•Êü•ËØ¢Êï∞ÊçÆÂ∫ìÔºå‰ªéËÄåÂØπÊï∞ÊçÆÂ∫ìÈÄ†Êàê‰∫ÜÂ∑®Â§ßÁöÑÂéãÂäõÔºå‰∏•ÈáçÊÉÖÂÜµ‰∏ãÂèØËÉΩ‰ºöÂØºËá¥Êï∞ÊçÆÂ∫ìÂÆïÊú∫ÁöÑÊÉÖÂÜµÂè´ÂÅöÁºìÂ≠òÈõ™Â¥©„ÄÇ</p>
<img src="/img/redis/crash.png" alt="crash" style="zoom:67%;" />
<p>Ëß£ÂÜ≥ÊñπÊ°àÔºö</p>
<ul>
<li>ÈöèÊú∫ËÆæÁΩÆkeyËøáÊúüÊó∂Èó¥</li>
<li>ÈöèÊú∫Âª∂Êó∂ÔºåËÆ©‰∏ÄÈÉ®ÂàÜÊü•ËØ¢ÂÖàÂ∞ÜÊï∞ÊçÆÁºìÂ≠òËµ∑Êù•</li>
<li>ËÆæÁΩÆkeyÂÄºÊ∞∏‰∏çËøáÊúü</li>
</ul>
<p><strong>Êó†Â∫ïÊ¥ûÈóÆÈ¢ò</strong></p>
<p>Áé∞Ë±°ÔºöÂ¢ûÂä†ËäÇÁÇπÊú∫Âô®ÊÄßËÉΩÊ≤°ÊèêÂçáÂèçËÄå‰∏ãÈôç</p>
<p><img src="/img/redis/Cache-Node-Add.png" alt="Cache-Node-Add"></p>
<p>Ëß£ÂÜ≥ÊñπÊ°àÂèÇËÄÉ<a href="#Multi-Operator">ÊâπÈáèÊìç‰Ωú</a></p>
<h3 id="ÁÉ≠ÁÇπkeyÁöÑÈáçÂª∫‰ºòÂåñ">ÁÉ≠ÁÇπkeyÁöÑÈáçÂª∫‰ºòÂåñ</h3>
<p><img src="/img/redis/Hot-Key.png" alt="Hot-Key"></p>
<p>Áé∞Ë±°ÔºöÁÉ≠ÁÇπkeyÁºìÂ≠òÈáçÂª∫ËøáÁ®ãËøáÈïøÂØºËá¥Êµ™Ë¥π‰∫Ü‰∏çÂøÖË¶ÅÁöÑËµÑÊ∫ê</p>
<p>Ëß£ÂÜ≥ÊñπÊ°àÔºö</p>
<ol>
<li>
<p>‰∫íÊñ•ÈîÅ„Äê‰ΩøÁî®redisÊûÑÂª∫ÈîÅÊú∫Âà∂„Äë</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>String<span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">get</span>(String<span style="color:#bbb"> </span>key)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>String<span style="color:#bbb"> </span>value<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>redis.<span style="color:#008080">get</span>(key);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000;font-weight:bold">if</span>(value<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">==</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">null</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>String<span style="color:#bbb"> </span>mutexKey<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#d14">&#34;mutex:key:&#34;</span><span style="color:#000;font-weight:bold">+</span>key;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000;font-weight:bold">if</span>(redis.<span style="color:#008080">SetParams</span>.<span style="color:#008080">setParams</span>().<span style="color:#008080">ex</span>(180).<span style="color:#008080">nx</span>())<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>value<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>db.<span style="color:#008080">get</span>(key);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>redis.<span style="color:#008080">set</span>(key,value);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>redis.<span style="color:#008080">delete</span>(mutexKey);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#000;font-weight:bold">else</span><span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>Thread.<span style="color:#008080">sleep</span>(1000);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>get(key);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000;font-weight:bold">return</span><span style="color:#bbb"> </span>value;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Ê∞∏‰∏çËøáÊúü</p>
<ul>
<li>ÁºìÂ≠òÂ±ÇÈù¢ÔºöÊ≤°ÊúâËÆæÁΩÆËøáÊúüÊó∂Èó¥</li>
<li>ÂäüËÉΩÂ±ÇÈù¢Ôºö‰∏∫ÊØè‰∏™valueÊ∑ªÂä†ÈÄªËæëËøáÊúüÊó∂Èó¥Ôºå‰ΩÜÂèëÁé∞Ë∂ÖËøáÈÄªËæëËøáÊúüÊó∂Èó¥ÂêéÔºå‰ºö‰ΩøÁî®ÂçïÁã¨ÁöÑÁ∫øÁ®ãÂèñÊûÑÂª∫ÁºìÂ≠ò</li>
</ul>
</li>
</ol>
<table>
    <tr>
        <th>ÊñπÊ°à</th>
        <th>‰ºòÁÇπ</th>
        <th>Áº∫ÁÇπ</th>
    </tr>
    <tr>
    	<td rowspan="2">‰∫íÊñ•ÈîÅ</td>
        <td>ÊÄùË∑ØÁÆÄÂçï</td>
        <td>‰ª£Á†ÅÂ§çÊùÇÂ∫¶Â¢ûÂä†</td>
    </tr>
    <tr>
        <td>‰øùËØÅ‰∏ÄËá¥ÊÄß</td>
        <td>Â≠òÂú®Ê≠ªÈîÅÁöÑÈ£éÈô©</td>
    </tr>
        <tr>
    	<td rowspan="2">Ê∞∏‰∏çËøáÊúü</td>
        <td rowspan="2">Âü∫Êú¨ÊùúÁªùÁÉ≠ÁÇπkeyÈáçÂª∫ÈóÆÈ¢ò</td>
        <td>‰∏ç‰øùËØÅ‰∏ÄËá¥ÊÄß</td>
    </tr>
    <tr>
        <td>ÈÄªËæëËøáÊúüÊó∂Èó¥Â¢ûÂä†Áª¥Êä§ÊàêÊú¨ÂíåÂÜÖÂ≠òÊàêÊú¨</td>
    </tr>
</table>
## ÂçÅ‰∫å„ÄÅ<span id="bloomFilter">RedisÂ∏ÉÈöÜËøáÊª§Âô®</span>
<h3 id="Â∏ÉÈöÜËøáÊª§Âô®ÁöÑÂéüÁêÜ">Â∏ÉÈöÜËøáÊª§Âô®ÁöÑÂéüÁêÜ</h3>
<p><img src="/img/redis/Bloom-Filter.jpg" alt="Bloom-Filter"></p>
<ol>
<li>È¶ñÂÖàÈúÄË¶Åk‰∏™hashÂáΩÊï∞ÔºåÊØè‰∏™ÂáΩÊï∞ÂèØ‰ª•ÊääkeyÊï£ÂàóÊàê‰∏∫1‰∏™Êï¥Êï∞</li>
<li>ÂàùÂßãÂåñÊó∂ÔºåÈúÄË¶Å‰∏Ä‰∏™ÈïøÂ∫¶‰∏∫nÊØîÁâπÁöÑÊï∞ÁªÑÔºåÊØè‰∏™ÊØîÁâπ‰ΩçÂàùÂßãÂåñ‰∏∫0</li>
<li>Êüê‰∏™keyÂä†ÂÖ•ÈõÜÂêàÊó∂ÔºåÁî®k‰∏™hashÂáΩÊï∞ËÆ°ÁÆóÂá∫k‰∏™Êï£ÂàóÂÄºÔºåÂπ∂ÊääÊï∞ÁªÑ‰∏≠ÂØπÂ∫îÁöÑÊØîÁâπ‰ΩçÁΩÆ‰∏∫1</li>
<li>Âà§Êñ≠Êüê‰∏™keyÊòØÂê¶Âú®ÈõÜÂêàÊó∂ÔºåÁî®k‰∏™hashÂáΩÊï∞ËÆ°ÁÆóÂá∫k‰∏™Êï£ÂàóÂÄºÔºåÂπ∂Êü•ËØ¢Êï∞ÁªÑ‰∏≠ÂØπÂ∫îÁöÑÊØîÁâπ‰ΩçÔºåÂ¶ÇÊûúÊâÄÊúâÁöÑÊØîÁâπ‰ΩçÈÉΩÊòØ1ÔºåËÆ§‰∏∫Âú®ÈõÜÂêà‰∏≠</li>
</ol>
<p>‰ºòÁÇπÔºö‰∏çÈúÄË¶ÅÂ≠òÂÇ®keyÔºåËäÇÁúÅÁ©∫Èó¥</p>
<p>Áº∫ÁÇπÔºöÁÆóÊ≥ïÂà§Êñ≠keyÂú®ÈõÜÂêà‰∏≠Êó∂ÔºåÊúâ‰∏ÄÂÆöÁöÑÊ¶ÇÁéákeyÂÖ∂ÂÆû‰∏çÂú®ÈõÜÂêà‰∏≠Ôºå‰∏îÊó†Ê≥ïÂà†Èô§</p>
<blockquote>
<p>google-guavaÂ∫ìÂÆûÁé∞‰∫ÜjavaÁâàÁöÑÂ∏ÉÈöÜËøáÊª§Âô®</p>
</blockquote>
<h3 id="redisÂ∏ÉÈöÜËøáÊª§Âô®">RedisÂ∏ÉÈöÜËøáÊª§Âô®</h3>
<p><strong>‰ΩøÁî®Êèí‰ª∂ÁöÑÊñπÂºèÈÉ®ÁΩ≤</strong></p>
<p>redis4.0‰πãÂêéÊîØÊåÅ‰ΩøÁî®Êèí‰ª∂ÁöÑÊñπÂºè‰ΩøÁî®Bloom filtersÂíåcuckoo filtersÔºåredis4.0‰πãÂâçÈúÄÊâãÂä®‰ΩøÁî®‰ª£Á†ÅÁöÑÊñπÂºèÁºñÂÜôÂ∏ÉÈöÜËøáÊª§Âô®ÔºåÂÆâË£ÖÊ≠•È™§ÂèÇËÄÉ‰∏ãÂàóÈìæÊé•</p>
<p><a href="https://github.com/RedisLabsModules/redisbloom">GitHubÂú∞ÂùÄ</a>  <a href="http://redisbloom.io">‰ΩøÁî®ÊñáÊ°£</a></p>
<p>Âª∫ËÆÆÂú®confÈÖçÁΩÆÊñá‰ª∂‰∏≠ÈÖçÁΩÆÔºå‰∏ç‰ΩøÁî®<code>redis-server --loadmodule /path/to/rebloom.so</code>ÂêØÂä®</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>loadmodule /path/to/rebloom.so
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Â∏ÉÈöÜËøáÊª§Âô®ÂëΩ‰ª§</strong></p>
<table>
<thead>
<tr>
<th>ÂëΩ‰ª§</th>
<th>ËØ¥Êòé</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>BF.RESERVE</strong> {key} {error_rate} {size}</td>
<td>ÂàõÂª∫Â∏ÉÈöÜËøáÊª§Âô®Ôºåerror_rate‰∏∫ÈîôËØØÁéáÔºåsize‰∏∫È¢ÑÊúüÊï∞ÊçÆÂ§ßÂ∞è</td>
</tr>
<tr>
<td><strong>BF.ADD</strong> {key} {item}</td>
<td>Ê∑ªÂä†itemÂà∞ÊåáÂÆöÂ∏ÉÈöÜËøáÊª§Âô®</td>
</tr>
<tr>
<td><strong>BF.MADD</strong> {key} {item} [item &hellip;]</td>
<td>ÊâπÈáèÊ∑ªÂä†itemÂà∞ÊåáÂÆöÂ∏ÉÈöÜËøáÊª§Âô®</td>
</tr>
<tr>
<td><strong>BF.EXISTS</strong> {key} {item}</td>
<td>Âà§Êñ≠itemÊòØÂê¶Â≠òÂú®‰∏éÊåáÂÆöÂ∏ÉÈöÜËøáÊª§Âô®</td>
</tr>
<tr>
<td><strong>BF.MEXISTS</strong> {key} {item} [item &hellip;]</td>
<td>ÊâπÈáèÂà§Êñ≠itemÊòØÂê¶Â≠òÂú®‰∏éÊåáÂÆöÂ∏ÉÈöÜËøáÊª§Âô®</td>
</tr>
</tbody>
</table>
<p><strong>JavaAPI</strong></p>
<p>ÂØºÂÖ•maven‰æùËµñ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;groupId&gt;</span>com.redislabs<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;artifactId&gt;</span>jrebloom<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;version&gt;</span>1.1.0<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Api‰ΩøÁî®</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">static</span><span style="color:#bbb"> </span><span style="color:#458;font-weight:bold">void</span><span style="color:#bbb"> </span><span style="color:#900;font-weight:bold">main</span>(String<span style="color:#000;font-weight:bold">[]</span><span style="color:#bbb"> </span>args)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>JedisPool<span style="color:#bbb"> </span>jedisPool<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>JedisPool(<span style="color:#d14">&#34;192.168.1.158&#34;</span>,<span style="color:#bbb"> </span>6379);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>Client<span style="color:#bbb"> </span>client<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>Client(jedisPool);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>client.<span style="color:#008080">createFilter</span>(<span style="color:#d14">&#34;main6&#34;</span>,<span style="color:#bbb"> </span>10000,<span style="color:#bbb"> </span>0.<span style="color:#008080">000001</span>);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#998;font-style:italic">//ÊâπÈáèÊèíÂÖ•Êï∞ÊçÆ</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#458;font-weight:bold">int</span><span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>i<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">&lt;</span>100;<span style="color:#bbb"> </span>i<span style="color:#000;font-weight:bold">++</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>String<span style="color:#bbb"> </span>values<span style="color:#000;font-weight:bold">[]</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">new</span><span style="color:#bbb"> </span>String<span style="color:#000;font-weight:bold">[</span>100<span style="color:#000;font-weight:bold">]</span>;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000;font-weight:bold">for</span><span style="color:#bbb"> </span>(<span style="color:#458;font-weight:bold">int</span><span style="color:#bbb"> </span>j<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>0;<span style="color:#bbb"> </span>j<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#bbb"> </span>100;<span style="color:#bbb"> </span>j<span style="color:#000;font-weight:bold">++</span>)<span style="color:#bbb"> </span>{<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>String<span style="color:#bbb"> </span>value<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span><span style="color:#d14">&#34;item&#34;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">+</span><span style="color:#bbb"> </span>(i<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">*</span><span style="color:#bbb"> </span>100<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">+</span>j);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>values<span style="color:#000;font-weight:bold">[</span>j<span style="color:#000;font-weight:bold">]</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">=</span><span style="color:#bbb"> </span>value;<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>client.<span style="color:#008080">addMulti</span>(<span style="color:#d14">&#34;main6&#34;</span>,<span style="color:#bbb"> </span>values);<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">	</span><span style="color:#998;font-style:italic">//Âà§Êñ≠ÊòØÂê¶Â≠òÂú®</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>System.<span style="color:#008080">out</span>.<span style="color:#008080">println</span>(client.<span style="color:#008080">exists</span>(<span style="color:#d14">&#34;main6&#34;</span>,<span style="color:#bbb"> </span><span style="color:#d14">&#34;item1&#34;</span>));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>System.<span style="color:#008080">out</span>.<span style="color:#008080">println</span>(client.<span style="color:#008080">exists</span>(<span style="color:#d14">&#34;main6&#34;</span>,<span style="color:#bbb"> </span><span style="color:#d14">&#34;a&#34;</span>));<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>jedisPool.<span style="color:#008080">close</span>();<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>}<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ÂçÅ‰∏âredisÂºÄÂèëËßÑËåÉ">ÂçÅ‰∏â„ÄÅRedisÂºÄÂèëËßÑËåÉ</h2>
<h3 id="bigkeyÂ§ÑÁêÜ">BigKeyÂ§ÑÁêÜ</h3>
<p><strong>ÂèëÁé∞BigKey</strong></p>
<ul>
<li><code>debug object {key}</code> Êü•ÁúãÊåáÂÆökeyÁöÑËØ¶ÁªÜ‰ø°ÊÅØ</li>
<li><code>redis-cli --bigkeys</code> Êâ´ÊèèÂá∫BigKey„ÄêÂÖ®Ë°®Êâ´ÊèèÔºåÈòªÂ°ûÔºåÂª∫ËÆÆ‰ªéËäÇÁÇπÊú¨Âú∞ÊâßË°å„Äë</li>
</ul>
<p><strong>BigKeyÂà†Èô§</strong></p>
<p>Âú∫ÊôØÔºöÂΩìkeyÈùûÂ∏∏Â§ßÊó∂ÔºådeleteÂëΩ‰ª§ÊâßË°åÂçÅÂàÜÁºìÊÖ¢Ôºå‰ºöÂèëÁîüÈòªÂ°û„ÄêËøáÊúübigkey‰πüÊòØËøõË°åÂà†Èô§Êìç‰Ωú‰πü‰ºöÈòªÂ°û„Äë</p>
<p>redis4.0‰πãÂêéÔºöÂèØ‰ª•‰ΩøÁî®<code>unlink</code>ÂëΩ‰ª§ËøõË°åÂêéÂè∞Âà†Èô§Ôºå‰∏çÈòªÂ°ûÂâçÂè∞</p>
<h3 id="ÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜ">ÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜ</h3>
<ul>
<li>
<p>‰ΩøÁî®<code>OBJECT IDLETIME {key}</code>Êü•ÁúãkeyÁöÑÈó≤ÁΩÆÊó∂Èó¥</p>
</li>
<li>
<p>ËøáÊúüÊó∂Èó¥‰∏çÊòìÈõÜ‰∏≠</p>
</li>
</ul>
<h3 id="ÂëΩ‰ª§‰ºòÂåñ">ÂëΩ‰ª§‰ºòÂåñ</h3>
<p>ÊúâÈÅçÂéÜÈúÄÊ±ÇÂèØ‰ª•‰ΩøÁî®<code>hscan</code>„ÄÅ<code>sscan</code>„ÄÅ<code>zscan</code>‰ª£Êõø„Äê<strong>Ëøô‰∫õÊâ´ÊèèÂëΩ‰ª§Âú®fieldËæÉÂ∞ëÊó∂COUNTÂèÇÊï∞‰∏ç‰ºöÁîüÊïà</strong>„Äë</p>
<p>ÂøÖË¶ÅÊÉÖÂÜµ‰∏ã‰ΩøÁî®<code>monitor</code>ÂëΩ‰ª§ÁõëÊéßÔºåÊ≥®ÊÑèÊó∂Èó¥‰∏çË¶ÅËøáÈïø</p>
<h3 id="javaÂÆ¢Êà∑Á´Ø‰ºòÂåñ">JavaÂÆ¢Êà∑Á´Ø‰ºòÂåñ</h3>
<table>
<thead>
<tr>
<th>ÂèÇÊï∞Âêç</th>
<th>Âê´‰πâ</th>
<th>ÈªòËÆ§ÂÄº</th>
<th>Âª∫ËÆÆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>testWhileIdle</td>
<td>ÊòØÂê¶ÂºÄÂêØÁ©∫Èó≤ËµÑÊ∫êÊ£ÄÊµã</td>
<td>false</td>
<td>true</td>
</tr>
<tr>
<td>timeBetweenEvictionRunsMillis</td>
<td>Á©∫Èó≤ËµÑÊ∫êÊ£ÄÊµãÂë®Êúü</td>
<td>-1</td>
<td>Ëá™ÈÄâÔºå‰πüÂèØ‰ΩøÁî®JedisPoolConfig‰∏≠ÁöÑÈªòËÆ§ÂÄº</td>
</tr>
<tr>
<td>minEvictiableIdleTimeMillis</td>
<td>ËµÑÊ∫êÊ±†‰∏≠ËµÑÊ∫êÊúÄÂ∞èÁ©∫Èó≤Êó∂Èó¥</td>
<td>30ÂàÜÈíü</td>
<td>Ëá™ÈÄâÔºå‰πüÂèØ‰ΩøÁî®JedisPoolConfig‰∏≠ÁöÑÈªòËÆ§ÂÄº</td>
</tr>
<tr>
<td>numTestsPerEvictionRun</td>
<td>ÂÅöÁ©∫Èó≤ËµÑÊ∫êÊ£ÄÊµãÊØèÊ¨°ÁöÑÈááÊ†∑Êï∞</td>
<td>3</td>
<td>Ëá™ÈÄâÔºåÂ¶ÇÊûúËÆæÁΩÆ‰∏∫-1Âàô‰∏∫ÂÖ®ÈÉ®ÂÅöÁ©∫Èó≤Ê£ÄÊµã</td>
</tr>
</tbody>
</table>
<p>maxIdleÈúÄË¶ÅËÆæÁΩÆ‰∏∫Êé•ËøëmaxTotal</p>
<blockquote>
<p>È¢Ñ‰º∞maxTotalÊñπÊ≥ïÁöÑ‰æãÂ≠êÔºö</p>
<p>‰∏ÄÊ¨°ÂëΩ‰ª§Êó∂Èó¥Âπ≥ÂùáËÄóÊó∂1msÔºå‰∏Ä‰∏™ËøûÊé•QPSÂ§ßÁ∫¶1000Ôºå‰∏öÂä°ÊúüÂøòÁöÑQPSÊó∂50000ÔºåÁêÜËÆ∫‰∏ämaxTotal=50000/1000=50</p>
</blockquote>
<h2 id="ÂçÅÂõõÂÜÖÂ≠òÁÆ°ÁêÜ">ÂçÅÂõõ„ÄÅÂÜÖÂ≠òÁÆ°ÁêÜ</h2>
<h3 id="ÂÜÖÂ≠òÊ∂àËÄó">ÂÜÖÂ≠òÊ∂àËÄó</h3>
<p><strong>ÂÜÖÂ≠òÁªüËÆ°</strong></p>
<p>ÊâßË°å<code>info memory</code>ÂëΩ‰ª§ÂèØ‰ª•Êü•ÁúãÂÜÖÂ≠ò‰ø°ÊÅØ</p>
<table>
<thead>
<tr>
<th>‰∏ªË¶ÅÂ±ûÊÄßÂêç</th>
<th>Â±ûÊÄßËØ¥Êòé</th>
</tr>
</thead>
<tbody>
<tr>
<td>used_memory</td>
<td>ÂÆûÈôÖÂ≠òÂÇ®Êï∞ÊçÆÁöÑÂÜÖÂ≠òÊÄªÈáè</td>
</tr>
<tr>
<td>used_memory_rss</td>
<td>redisËøõÁ®ãÂç†Áî®ÁöÑÊÄªÁâ©ÁêÜÂÜÖÂ≠ò</td>
</tr>
<tr>
<td>maxmemory</td>
<td>ÊúÄÂ§ßÂÜÖÂ≠ò</td>
</tr>
<tr>
<td>maxmemory_policy</td>
<td>ÂÜÖÂ≠òÂâîÈô§Á≠ñÁï•</td>
</tr>
<tr>
<td>mem_fragmentation_ratio</td>
<td>used_memory_rss/used_memoryÊØîÂÄºÔºåË°®Á§∫ÂÜÖÂ≠òÁ¢éÁâáÁéá</td>
</tr>
</tbody>
</table>
<p><strong>ÂÜÖÂ≠òÊ∂àËÄóÂàíÂàÜ</strong></p>
<p><img src="/img/redis/Memory-Used.png" alt="Memory-Used"></p>
<ul>
<li>
<p>ÂÆ¢Êà∑Á´ØÁºìÂÜ≤Âå∫ËÆæÁΩÆËßÑÂàô</p>
<p>client-output-buffer-limit &lt;class&gt; &lt;hard limit&gt; &lt;soft limit&gt; &lt;soft seconds&gt;</p>
<p>&lt;class&gt;:ÂÆ¢Êà∑Á´ØÁ±ªÂûãÔºåÂàÜ‰∏∫‰∏âÁßç</p>
<p>‚Äã		(a)normal:ÊôÆÈÄöÂÆ¢Êà∑Á´Ø</p>
<p>‚Äã		(b)slave:Áî®‰ªéËäÇÁÇπÁî®‰∫éÂ§çÂà∂Ôºå‰º™Ë£ùÊàêÂÆ¢Êà∑Á´Ø</p>
<p>‚Äã		(c)pubsub:ÂèëÂ∏ÉËÆ¢ÈòÖÂÆ¢Êà∑Á´Ø
&lt;hardlimit&gt;:Â¶ÇÂÆ¢Êà∑‰ΩøÁî®ÁöÑËæìÂá∫ÂÜ≤Âå∫Â§ß‰∫éhardlimitÂÆ¢Êà∑Á´Ø‰ºöË¢´Á´ãÂç≥ÂÖ≥Èó≠</p>
<p>&lt;soft limit&gt; Âíå&lt;soft seconds&gt;:Â¶ÇÊûúÂÆ¢Êà∑Á´Ø‰ΩøÁî®ÁöÑËæìÂá∫ÁºìÂÜ≤Âå∫Ë∂ÖËøá‰∫Ü &lt;soft limit&gt;Âπ∂‰∏îÊåÅÁª≠‰∫Ü&lt;soft seconds&gt;ÔºåÂÆ¢Êà∑‰ºöË¢´Á´ãÂç≥ÂÖ≥Èó≠</p>
<ul>
<li>ÊôÆÈÄöÂÆ¢Êà∑Á´ØÈªòËÆ§Ôºöclient-output-buffer-limit normal 0 0 0</li>
<li>salveÂÆ¢Êà∑Á´ØÈªòËÆ§Ôºöclient-output-buffer-limit slave 256mb 64mb 60</li>
<li>pubsubÂÆ¢Êà∑Á´ØÈªòËÆ§Ôºöclient-output-buffer-limit slave 32mb 8mb 60</li>
</ul>
</li>
<li>
<p>Â§çÂà∂ÁºìÂÜ≤Âå∫ÔºöÁî®‰∫éslaveÂíåmasterÊñ≠ÂºÄÈáçËøûÊó∂‰∏çËøõË°åÂÖ®ÈáèÂ§çÂà∂‰øùÂ≠òÂÅèÁßªÊï∞ÊçÆ‰ΩøÁî®</p>
<p>ÈªòËÆ§‰∏∫<code>repl-backlog-size 1mb</code></p>
</li>
<li>
<p>AOFÁºìÂÜ≤Âå∫ÔºöAOFÈáçÂÜôÊúüÈó¥ÔºåAOFÁºìÂÜ≤Âå∫ÔºåÊ≤°ÊúâÂÆπÈáèÈôêÂà∂</p>
</li>
</ul>
<h3 id="ÂÜÖÂ≠òÂõûÊî∂Á≠ñÁï•">ÂÜÖÂ≠òÂõûÊî∂Á≠ñÁï•</h3>
<p>Âà†Èô§ËøáÊúüÂÄº</p>
<ul>
<li>ÊÉ∞ÊÄßÂà†Èô§ÔºöËÆøÈóÆkey-&gt;expired dict-&gt;del key„ÄêÂÖàÂú®ËøáÊúüË°®‰∏≠ÊâæÔºåÂèëÁé∞ËøáÊúüÂà†Èô§keyÔºåËøîÂõûnull„Äë</li>
<li>ÂÆöÊó∂Âà†Èô§ÔºöÊØèÁßíËøêË°å10Ê¨°ÔºåÈááÊ†∑Âà†Èô§</li>
</ul>
<p>Ë∂ÖËøámaxmemory‰ΩøÁî®maxmemory-policyËøõË°åÊéßÂà∂ÔºåÂèÇËßÅ<a href="#cache_update">ÁºìÂ≠òÊõ¥Êñ∞Á≠ñÁï•</a></p>
<h2 id="ÂçÅ‰∫îÂºÄÂèëËøêÁª¥‰∫ãÈ°π">ÂçÅ‰∫î„ÄÅÂºÄÂèëËøêÁª¥‰∫ãÈ°π</h2>
<h3 id="linuxÂÜÖÊ†∏‰ºòÂåñ">LinuxÂÜÖÊ†∏‰ºòÂåñ</h3>
<p><strong>vm.overcommit_memory</strong></p>
<p>RedisÂª∫ËÆÆvm.overcommit_memory = 1(ÂΩ±ÂìçforkÊìç‰ΩúÔºâ</p>
<p>Á´ãÂç≥ÁîüÊïàÔºö</p>
<p>Ê∞∏‰πÖÁîüÊïàÔºövm.overcommit_memory = 1ÂÜôÂÖ•Âà∞/etc/sysctl.confÊñá‰ª∂‰∏≠</p>
<table>
<thead>
<tr>
<th>ÂÄº</th>
<th>Âê´‰πâ</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Ë°®Á§∫ÂÜÖÊ†∏Â∞ÜÊ£ÄÊü•ÊòØÂê¶ÊúâË∂≥Â§üÂèØÁî®ÁöÑÂÜÖÂ≠ò„ÄÇÂ¶ÇÊûúÊúâË∂≥Â§üÂèØÁî®ÁöÑÂÜÖÂ≠òÔºåÂÜÖÂ≠òÁî≥ËØ∑ÈÄöËøáÔºåÂê¶ÂàôÂÜÖÂ≠òÁî≥ËØ∑Â§±Ë¥•ÔºåÂπ∂ËøîÂõûÈîôËØØÁªôËøõÁ®ã</td>
</tr>
<tr>
<td>1</td>
<td>Ë°®Á§∫ÂÜÖÊ†∏ÂÖÅËÆ∏Ë∂ÖÈáè‰ΩøÁî®ÂÜÖÂ≠òÁõ¥Âà∞Áî®ÂÆå‰∏∫Ê≠¢</td>
</tr>
<tr>
<td>2</td>
<td>Ë°®Á§∫ÂÜÖÂ≠òÁªù‰∏çËøáÈáè‰ΩøÁî®ÔºåÂç≥Êï¥‰∏™Á≥ªÁªüÂÜÖÂ≠ò‰∏çËÉΩË∂ÖËøáswap+50%ÁöÑRAMÂÄº</td>
</tr>
</tbody>
</table>
<p><strong>swappiness</strong></p>
<table>
    <tr>
        <th>ÂÄº</th>
        <th>Á≠ñÁï•</th>
    </tr>
    <tr>
    	<td rowspan="2">0</td>
        <td>Linux3.5Âèä‰ª•‰∏äÔºöÂÆÅÊÑøOOM Killer‰πü‰∏çÁî®swap</td>
    </tr>
    <tr>
    	<td>Linux3.5Âèä‰ª•‰∏ãÔºöÂÆÅÊÑøswap‰πü‰∏çÁî®OOM Killer</td>
    </tr>
    <tr>
        <td>1</td>
    	<td>Linux3.5Âèä‰ª•‰∏äÔºöÂÆÅÊÑøswap‰πü‰∏çÁî®OOM Killer</td>
    </tr>
    <tr>
        <td>60</td>
    	<td>ÈªòËÆ§ÂÄº</td>
    </tr>
    <tr>
        <td>100</td>
    	<td>Êìç‰ΩúÁ≥ªÁªü‰ºö‰∏ªÂä®‰ΩøÁî®swap</td>
    </tr>
</table>
<p>Âª∫ËÆÆÔºöLinux3.5‰ª•‰∏ävm.swappiness = 1ÔºåÂê¶Âàôvm.swappiness = 0</p>
<p>Á´ãÂç≥ÁîüÊïàÔºöecho {bestValue} &gt; /proc/sys/vm/swappiness</p>
<p>Ê∞∏‰πÖÁîüÊïàÔºövm.swappiness = {bestValue} ÂÜôÂÖ•Âà∞/etc/sysctl.conf</p>
<p><strong>THP(Transparent huge page)</strong></p>
<p>Âª∫ËÆÆÁ¶ÅÁî®ÔºåCentos7Âú®<code>/sys/kernel/mm/transparent_hugepage/enabled</code>‰∏ãËÆæÁΩÆ‰∏∫neverÂç≥ÂèØ</p>
<p>THP‰∏∫Â§ßÂÜÖÂ≠òÈ°µÊó∂forkÂ≠êÁ∫øÁ®ãÊó∂Copy-On-WriteÂèØËÉΩÈÄ†ÊàêÂª∂Ëøü</p>
<p><strong>ulimit</strong></p>
<p>Âª∫ËÆÆÂ∞ÜRedisÂêØÂä®Áî®Êà∑ÁöÑÊñá‰ª∂Âè•ÊüÑÈôêÂà∂Ë∞ÉÊàê10032ÔºåÈôêÂà∂Êñá‰ª∂<code>etc/security/limits</code></p>
<p><strong>TCP backlog</strong></p>
<p>Âª∫ËÆÆÂ∞Ü<code>/proc/sys/net/core/somaxconn</code>Á≥ªÁªüTCP backlogÁöÑÈôêÂà∂ËÆæÁΩÆ‰∏∫‰∏éRedis‰∏ÄÊ†∑ÈªòËÆ§511</p>
<h3 id="redisÂÆâÂÖ®ÈóÆÈ¢ò">RedisÂÆâÂÖ®ÈóÆÈ¢ò</h3>
<p>Âú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠ÈÖçÁΩÆ</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>#Â∞ÜÂëΩ‰ª§Êõ¥Êîπ‰∏∫Âè¶‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÔºåÂéüÂëΩ‰ª§Â§±Êïà„ÄÇÂ¶ÇÊûúÂ≠óÁ¨¶‰∏≤‰∏∫Á©∫ÂàôË°®Á§∫Á¶ÅÁî®Ê≠§ÂëΩ‰ª§
</span></span><span style="display:flex;"><span>rename-command {cmd} {str}
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<p>ÈôÑÂêÑÁßçÊï∞ÊçÆÁ±ªÂûãÁöÑÂÜÖÈÉ®ÁºñÁ†ÅÔºö</p>
<p><img src="/img/redis/Data-Encoding.png" alt="Data-Encoding"></p>
<p>ÈôÑRedis‰∫ëÂπ≥Âè∞CacheCloud„Äê‰∏ÄÈîÆÈÉ®ÁΩ≤„ÄÅÁõëÊéß„ÄÅËøêÁª¥„ÄÅÊï∞ÊçÆËøÅÁßªÂ∑•ÂÖ∑Á≠â„Äë <a href="https://github.com/sohutv/cachecloud">GitHubÈ°πÁõÆÂú∞ÂùÄ</a></p>

    </div>

    

    <div class="container-comment-giscus">
        <script src="https://giscus.app/client.js"
        data-repo="loveminimal/comment"
        data-repo-id="R_kgDOJNJQ8g"
        data-category="General"
        data-category-id="DIC_kwDOJNJQ8s4CYl0m"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="noborder_light"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
        </script>
</div>
</div>

        </div>
        <div id="footer"><div class="container-footer">
    

    <div class="beian">
        
        <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=41092802000242">
            

        </a>

        
        <a href="//beian.miit.gov.cn" target="_blank">
            
            <span class="some">icp...<span>
            
        </a>
    </div>

    
    <div class="info">
        
        <a href="https://github.com/loveminimal/hugo-theme-virgo">üïäÔ∏è</a> 2016 - <span id="info-date"></span>
    </div>

</div></div>
        <div class="cool-after" style="
            
                background-color: rgba(255, 255, 255, 0.49); 
                backdrop-filter: saturate(100%) blur(6px);
            
            "></div>
    </body>
</html>
